(self.webpackChunkangular_entropy=self.webpackChunkangular_entropy||[]).push([[795],{1718:(T,A,f)=>{"use strict";f.d(A,{$:()=>E});var m=f(1571);class E{transform(k){const x=new Date(1e3*k);return x.toLocaleDateString("en-GB",{year:"numeric",month:"2-digit",day:"2-digit"})+" - "+String(x.getHours()).padStart(2,"0")+":"+String(x.getMinutes()).padStart(2,"0")}}E.\u0275fac=function(k){return new(k||E)},E.\u0275pipe=m.Yjl({name:"dateLabel",type:E,pure:!0})},1795:(T,A,f)=>{"use strict";f.r(A),f.d(A,{ClassroomModule:()=>Qt});var m=f(6895),E=f(3135),h=f(9181),k=f(7315),x=f(4415),_=f(7618),d=f(1571),g=f(301);class y{constructor(Et,ft,Rt,Jt){this._route=Et,this._classroomService=ft,this._alertService=Rt,this._router=Jt}ngOnInit(){this.invite_token=this._route.snapshot.paramMap.get("invite_token"),this.invite_token&&this._classroomService.joinStudentClassroom(this.invite_token).subscribe(Et=>{Et.hasOwnProperty("error")||this._alertService.success("Class successfully joined"),this._router.navigate(["/"])})}}y.\u0275fac=function(Et){return new(Et||y)(d.Y36(x.gz),d.Y36(k.u),d.Y36(g.c),d.Y36(x.F0))},y.\u0275cmp=d.Xpm({type:y,selectors:[["app-classroom-invite-link"]],decls:0,vars:0,template:function(Et,ft){},encapsulation:2});var N,gt,w=f(4696),o=f(433),C=f(571);(gt=N||(N={}))[gt.CREATE=0]="CREATE",gt[gt.UPDATE=1]="UPDATE",gt[gt.DELETE=2]="DELETE";var I=f(4937);function L(gt,Et){1&gt&&(d.TgZ(0,"div",25),d._UZ(1,"div",26),d.TgZ(2,"div",27),d._UZ(3,"div",28),d.qZA()())}function z(gt,Et){if(1&gt&&(d.TgZ(0,"button",29),d._uU(1,"Create"),d.qZA()),2&gt){const ft=d.oxw();d.Q6J("disabled",!ft.classroomHomeworkCreateForm.valid)}}const H=gt=>parseInt(gt.get("node_min").value)>parseInt(gt.get("node_max").value)?{inRange:!1}:null;class Z{constructor(Et,ft,Rt){this._classroomHomeworkService=Et,this._alertService=ft,this._route=Rt,this.toolbar=[["bold","italic"],["underline","strike"],["code","blockquote"],["ordered_list","bullet_list"],[{heading:["h1","h2","h3","h4","h5","h6"]}],["link","image"],["text_color","background_color"],["align_left","align_center","align_right","align_justify"]],this.classroomHomeworkCreateForm=new o.cw({title:new o.NI(null,o.kI.required),body:new o.NI(null,o.kI.required),node_min:new o.NI(null,[o.kI.required,o.kI.min(1)]),node_max:new o.NI(null,[o.kI.required,o.kI.max(30)]),start_date:new o.NI(null,o.kI.required),expire_date:new o.NI(null,o.kI.required)},H),this.loading=!1}ngOnInit(){this.classroom_id=this._route.snapshot.paramMap.get("classroom_id"),this.editor=new C.ML}ngOnDestroy(){this.editor.destroy()}onSubmit(){const Et=new Date(this.classroomHomeworkCreateForm.value.start_date).getTime()/1e3,ft=new Date(this.classroomHomeworkCreateForm.value.expire_date).getTime()/1e3;if(Et>ft)return this._alertService.error("Type an expiration date greater than the start date");let Rt={classroom_id:this.classroom_id,title:this.classroomHomeworkCreateForm.value.title,body:JSON.stringify(this.classroomHomeworkCreateForm.value.body),node_min:this.classroomHomeworkCreateForm.value.node_min,node_max:this.classroomHomeworkCreateForm.value.node_max,start_datetime:Et,expire_datetime:ft};this.loading=!0,this._classroomHomeworkService.createClassroomHomework(Rt).subscribe(Jt=>{Jt.hasOwnProperty("error")||(this._alertService.success("Homework successfully created"),this._classroomHomeworkService.updatedClassroomHomeworks$.emit(N.CREATE),this.classroomHomeworkCreateForm.reset()),this.loading=!1})}}Z.\u0275fac=function(Et){return new(Et||Z)(d.Y36(I.c),d.Y36(g.c),d.Y36(x.gz))},Z.\u0275cmp=d.Xpm({type:Z,selectors:[["app-classroom-homework-create"]],decls:37,vars:8,consts:[[1,"card"],[1,"card-body"],[1,"mb-4","text-center"],[1,"fa-solid","fa-file-pen"],[1,"mb-3",3,"formGroup","ngSubmit"],[1,"mb-3"],["for","title",1,"form-label"],["type","text","id","title","name","homework_title","placeholder","Type the homework title","formControlName","title",1,"form-control"],["for","body",1,"form-label"],[1,"NgxEditor__Wrapper"],[3,"editor","toolbar"],["formControlName","body",3,"editor","disabled","placeholder"],[1,"row","mb-3"],[1,"col-6"],["for","node_min",1,"form-label"],["type","text","id","node_min","name","homework_node_min","placeholder","Type a number above 1","formControlName","node_min",1,"form-control"],["for","node_max",1,"form-label"],["type","text","id","node_max","name","homework_node_max","placeholder","Type a number equal or below 30","formControlName","node_max",1,"form-control"],["for","start_date",1,"form-label"],["type","datetime-local","id","start_date","name","homework_start_date","formControlName","start_date",1,"form-control"],["for","expire_date",1,"form-label"],["type","datetime-local","id","expire_date","name","homework_expire_date","formControlName","expire_date",1,"form-control"],[1,"text-center"],["class","row mt-3",4,"ngIf"],["class","btn btn-primary d-grid w-100 mb-3","type","submit",3,"disabled",4,"ngIf"],[1,"row","mt-3"],[1,"col-5"],[1,"col-2","ms-3"],[1,"custom-loader","text-center"],["type","submit",1,"btn","btn-primary","d-grid","w-100","mb-3",3,"disabled"]],template:function(Et,ft){1&Et&&(d.TgZ(0,"div",0)(1,"div",1)(2,"h4",2),d._UZ(3,"i",3),d._uU(4," Create Homework"),d.qZA(),d.TgZ(5,"form",4),d.NdJ("ngSubmit",function(){return ft.onSubmit()}),d.TgZ(6,"div",5)(7,"label",6),d._uU(8,"Title:"),d.qZA(),d._UZ(9,"input",7),d.qZA(),d.TgZ(10,"div",5)(11,"label",8),d._uU(12,"Body:"),d.qZA(),d.TgZ(13,"div",9),d._UZ(14,"ngx-editor-menu",10)(15,"ngx-editor",11),d.qZA()(),d.TgZ(16,"div",12)(17,"div",13)(18,"label",14),d._uU(19,"Concept Map Minimum Nodes Count:"),d.qZA(),d._UZ(20,"input",15),d.qZA(),d.TgZ(21,"div",13)(22,"label",16),d._uU(23,"Concept Map Maximum Nodes Count:"),d.qZA(),d._UZ(24,"input",17),d.qZA()(),d.TgZ(25,"div",12)(26,"div",13)(27,"label",18),d._uU(28,"Start date:"),d.qZA(),d._UZ(29,"input",19),d.qZA(),d.TgZ(30,"div",13)(31,"label",20),d._uU(32,"Expire date:"),d.qZA(),d._UZ(33,"input",21),d.qZA()(),d.TgZ(34,"div",22),d.YNc(35,L,4,0,"div",23),d.YNc(36,z,2,1,"button",24),d.qZA()()()()),2&Et&&(d.xp6(5),d.Q6J("formGroup",ft.classroomHomeworkCreateForm),d.xp6(9),d.Q6J("editor",ft.editor)("toolbar",ft.toolbar),d.xp6(1),d.Q6J("editor",ft.editor)("disabled",!1)("placeholder","Type the homework text"),d.xp6(20),d.Q6J("ngIf",ft.loading),d.xp6(1),d.Q6J("ngIf",!ft.loading))},dependencies:[m.O5,o._Y,o.Fj,o.JJ,o.JL,o.sg,o.u,C.tP,C.Mn],encapsulation:2});var V=f(427),K=f(1718);function q(gt,Et){if(1&gt){const ft=d.EpF();d.TgZ(0,"div",3)(1,"button",10),d.NdJ("click",function(){d.CHM(ft);const Jt=d.oxw();return d.KtG(Jt.downloadJson())}),d._UZ(2,"i",11),d._uU(3," Export"),d.qZA()()}}function st(gt,Et){1&gt&&(d.TgZ(0,"div",12),d._UZ(1,"div",13),d.TgZ(2,"div",14),d._UZ(3,"div",15),d.qZA()())}function it(gt,Et){1&gt&&(d.TgZ(0,"div")(1,"p",17),d._uU(2,"There are no homeworks."),d.qZA()())}function lt(gt,Et){1&gt&&(d.TgZ(0,"th"),d._uU(1,"Students Completion"),d.qZA())}function F(gt,Et){if(1&gt&&(d.TgZ(0,"td"),d._uU(1),d.qZA()),2&gt){const ft=d.oxw().$implicit,Rt=d.oxw(3);d.xp6(1),d.AsE("",null==ft.maps?null:ft.maps.length," / ",Rt.classroom.size,"")}}const $=function(gt){return[gt]};function Y(gt,Et){if(1&gt&&(d.TgZ(0,"tr",17)(1,"td"),d._uU(2),d.qZA(),d.YNc(3,F,2,2,"td",9),d.TgZ(4,"td"),d._uU(5),d.ALo(6,"dateLabel"),d.qZA(),d.TgZ(7,"td"),d._uU(8),d.ALo(9,"dateLabel"),d.qZA(),d.TgZ(10,"td"),d._UZ(11,"i",20),d.qZA()()),2&gt){const ft=Et.$implicit,Rt=d.oxw(3);d.xp6(2),d.Oqu(ft.title),d.xp6(1),d.Q6J("ngIf",Rt.classroom),d.xp6(2),d.Oqu(d.lcZ(6,5,ft.start_datetime)),d.xp6(3),d.Oqu(d.lcZ(9,7,ft.expire_datetime)),d.xp6(3),d.Q6J("routerLink",d.VKq(9,$,"homeworks/"+ft._id.$oid))}}function j(gt,Et){if(1&gt&&(d.TgZ(0,"table",18)(1,"thead")(2,"tr",17)(3,"th"),d._uU(4,"Title"),d.qZA(),d.YNc(5,lt,2,0,"th",9),d.TgZ(6,"th"),d._uU(7,"Start Datetime"),d.qZA(),d.TgZ(8,"th"),d._uU(9,"Expire Datetime"),d.qZA(),d._UZ(10,"th"),d.qZA()(),d.TgZ(11,"tbody"),d.YNc(12,Y,12,11,"tr",19),d.qZA()()),2&gt){const ft=d.oxw(2);d.xp6(5),d.Q6J("ngIf",ft.classroom),d.xp6(7),d.Q6J("ngForOf",ft.homeworks)}}function W(gt,Et){if(1&gt&&(d.TgZ(0,"div"),d.YNc(1,it,3,0,"div",9),d.YNc(2,j,13,2,"table",16),d.qZA()),2&gt){const ft=d.oxw();d.xp6(1),d.Q6J("ngIf",ft.homeworks&&0==ft.homeworks.length),d.xp6(1),d.Q6J("ngIf",ft.homeworks&&ft.homeworks.length>0)}}class at{constructor(Et,ft,Rt){this._classroomHomeworkService=Et,this._router=ft,this._userService=Rt,this.loading=!1,this.homeworks=[];let Jt=JSON.parse(localStorage.getItem("currentUserData"));Jt||this._router.navigate(["/users/auth"]),this.user=Jt,this._classroomHomeworkService.updatedClassroomHomeworks$.subscribe(fn=>{fn==N.CREATE&&this.getClassroomHomeworks()})}ngOnInit(){this.getClassroomHomeworks()}getClassroomHomeworks(){this.loading=!0,this.classroom?this._classroomHomeworkService.getClassroomHomeworks(this.classroom._id?.$oid).subscribe(Et=>{Et.hasOwnProperty("error")||(this.homeworks=Et,this.homeworks&&this.homeworks.sort((ft,Rt)=>0==this.user.role?ft.expire_datetime-Rt.expire_datetime:Rt.expire_datetime-ft.expire_datetime)),this.loading=!1}):this._userService.getCurrentUserHomeworks().subscribe(Et=>{Et.hasOwnProperty("error")||(this.homeworks=Et,this.homeworks&&this.homeworks.sort((ft,Rt)=>0==this.user.role?ft.expire_datetime-Rt.expire_datetime:Rt.expire_datetime-ft.expire_datetime)),this.loading=!1})}downloadJson(){let Et=this.homeworks.map(Jt=>{const fn=new Date(1e3*Jt.start_datetime),Ge=new Date(1e3*Jt.expire_datetime),Oe=new Date(1e3*Jt.created_at);return{title:Jt.title,body:Jt.body,node_min:Jt.node_min,node_max:Jt.node_max,start_datetime:fn.toLocaleDateString("en-GB",{year:"numeric",month:"2-digit",day:"2-digit"})+" - "+String(fn.getHours()).padStart(2,"0")+":"+String(fn.getMinutes()).padStart(2,"0"),expire_datetime:Ge.toLocaleDateString("en-GB",{year:"numeric",month:"2-digit",day:"2-digit"})+" - "+String(Ge.getHours()).padStart(2,"0")+":"+String(Ge.getMinutes()).padStart(2,"0"),created_at:Oe.toLocaleDateString("en-GB",{year:"numeric",month:"2-digit",day:"2-digit"})+" - "+String(Oe.getHours()).padStart(2,"0")+":"+String(Oe.getMinutes()).padStart(2,"0")}}),ft=JSON.stringify(Et),Rt=document.createElement("a");Rt.setAttribute("href","data:text/json;charset=UTF-8,"+encodeURIComponent(ft)),Rt.setAttribute("download","exported_homeworks_"+Date.now()+".json"),Rt.style.display="none",document.body.appendChild(Rt),Rt.click(),document.body.removeChild(Rt)}}function ot(gt,Et){if(1&gt&&(d.TgZ(0,"span"),d._uU(1),d.qZA()),2&gt){const ft=d.oxw(2);d.xp6(1),d.AsE("(",ft.students.length," / ",ft.classroom.size,")")}}function et(gt,Et){if(1&gt){const ft=d.EpF();d.TgZ(0,"div",4)(1,"button",11),d.NdJ("click",function(){d.CHM(ft);const Jt=d.oxw(2);return d.KtG(Jt.downloadJson())}),d._UZ(2,"i",12),d._uU(3," Export"),d.qZA()()}}function X(gt,Et){1&gt&&(d.TgZ(0,"div",13),d._UZ(1,"div",14),d.TgZ(2,"div",15),d._UZ(3,"div",16),d.qZA()())}function dt(gt,Et){1&gt&&(d.TgZ(0,"div")(1,"p",18),d._uU(2,"There are no students in this class."),d.qZA()())}function pt(gt,Et){if(1&gt&&(d.TgZ(0,"tr",18)(1,"td"),d._uU(2),d.qZA(),d.TgZ(3,"td"),d._uU(4),d.qZA(),d._UZ(5,"td"),d.qZA()),2&gt){const ft=Et.$implicit;d.xp6(2),d.AsE("",ft.lastname," ",ft.firstname," "),d.xp6(2),d.Oqu(ft.email)}}function bt(gt,Et){if(1&gt&&(d.TgZ(0,"table",19)(1,"thead")(2,"tr",18)(3,"th"),d._uU(4,"Name"),d.qZA(),d.TgZ(5,"th"),d._uU(6,"E-Mail"),d.qZA(),d._UZ(7,"th"),d.qZA()(),d.TgZ(8,"tbody"),d.YNc(9,pt,6,3,"tr",20),d.qZA()()),2&gt){const ft=d.oxw(3);d.xp6(9),d.Q6J("ngForOf",ft.students)}}function yt(gt,Et){if(1&gt&&(d.TgZ(0,"div"),d.YNc(1,dt,3,0,"div",8),d.YNc(2,bt,10,1,"table",17),d.qZA()),2&gt){const ft=d.oxw(2);d.xp6(1),d.Q6J("ngIf",ft.students&&0==ft.students.length),d.xp6(1),d.Q6J("ngIf",ft.students&&ft.students.length>0)}}function kt(gt,Et){if(1&gt&&(d.TgZ(0,"div",1)(1,"div",2)(2,"div",3),d._UZ(3,"div",4),d.TgZ(4,"div",5)(5,"h4",6),d._UZ(6,"i",7),d._uU(7," Students List "),d.YNc(8,ot,2,2,"span",8),d.qZA()(),d.YNc(9,et,4,0,"div",9),d.qZA(),d.YNc(10,X,4,0,"div",10),d.YNc(11,yt,3,2,"div",8),d.qZA()()),2&gt){const ft=d.oxw();d.xp6(8),d.Q6J("ngIf",ft.students),d.xp6(1),d.Q6J("ngIf",ft.students&&ft.students.length>0&&1==ft.user.role),d.xp6(1),d.Q6J("ngIf",ft.loading),d.xp6(1),d.Q6J("ngIf",!ft.loading)}}at.\u0275fac=function(Et){return new(Et||at)(d.Y36(I.c),d.Y36(x.F0),d.Y36(V.K))},at.\u0275cmp=d.Xpm({type:at,selectors:[["app-classroom-homework-list"]],inputs:{classroom:"classroom"},decls:11,vars:3,consts:[[1,"card"],[1,"card-body"],[1,"row"],[1,"col-3"],[1,"col-6","text-center"],[1,"mb-4","pt-2"],[1,"fa-solid","fa-graduation-cap"],["class","col-3",4,"ngIf"],["class","row mt-3",4,"ngIf"],[4,"ngIf"],["type","button",1,"btn","btn-primary","w-100",3,"click"],[1,"fa-solid","fa-download","pe-clickable"],[1,"row","mt-3"],[1,"col-5"],[1,"col-2","ms-3"],[1,"custom-loader","text-center"],["class","table table-hover",4,"ngIf"],[1,"text-center"],[1,"table","table-hover"],["class","text-center",4,"ngFor","ngForOf"],["title","Show homework maps",1,"pe-clickable","fa-solid","fa-eye",2,"color","darkgreen",3,"routerLink"]],template:function(Et,ft){1&Et&&(d.TgZ(0,"div",0)(1,"div",1)(2,"div",2),d._UZ(3,"div",3),d.TgZ(4,"div",4)(5,"h4",5),d._UZ(6,"i",6),d._uU(7," Homeworks List"),d.qZA()(),d.YNc(8,q,4,0,"div",7),d.qZA(),d.YNc(9,st,4,0,"div",8),d.YNc(10,W,3,2,"div",9),d.qZA()()),2&Et&&(d.xp6(8),d.Q6J("ngIf",ft.homeworks&&ft.homeworks.length>0),d.xp6(1),d.Q6J("ngIf",ft.loading),d.xp6(1),d.Q6J("ngIf",!ft.loading))},dependencies:[m.sg,m.O5,x.rH,K.$],encapsulation:2});class Nt{constructor(Et,ft){this._classroomService=Et,this._router=ft,this.loading=!1,this.students=[];let Rt=JSON.parse(localStorage.getItem("currentUserData"));Rt||this._router.navigate(["/users/auth"]),this.user=Rt}ngOnInit(){this.getClassroomStudents()}getClassroomStudents(){this.loading=!0,this._classroomService.getClassroomStudents(this.classroom._id?.$oid).subscribe(Et=>{Et.hasOwnProperty("error")||(this.students=Et,this.students&&this.students.sort((ft,Rt)=>ft.lastname.localeCompare(Rt.lastname)||ft.firstname.localeCompare(Rt.firstname))),this.loading=!1})}downloadJson(){let Et=this.students.map(Jt=>({firstname:Jt.firstname,lastname:Jt.lastname,email:Jt.email})),ft=JSON.stringify(Et),Rt=document.createElement("a");Rt.setAttribute("href","data:text/json;charset=UTF-8,"+encodeURIComponent(ft)),Rt.setAttribute("download","exported_students_"+Date.now()+".json"),Rt.style.display="none",document.body.appendChild(Rt),Rt.click(),document.body.removeChild(Rt)}}function Ft(gt,Et){1&gt&&(d.TgZ(0,"div",2),d._UZ(1,"div",3),d.TgZ(2,"div",4),d._UZ(3,"div",5),d.qZA()())}function ht(gt,Et){if(1&gt&&(d.TgZ(0,"div",17),d._UZ(1,"app-classroom-homework-list",18),d.qZA()),2&gt){const ft=d.oxw(3);d.xp6(1),d.Q6J("classroom",ft.classroom)}}function mt(gt,Et){if(1&gt&&(d.TgZ(0,"div",12)(1,"div",13),d._UZ(2,"app-classroom-homework-create"),d.qZA(),d.TgZ(3,"div",13)(4,"div",14),d.YNc(5,ht,2,1,"div",15),d.qZA(),d.TgZ(6,"div",16)(7,"div",17),d._UZ(8,"app-classroom-student-list",18),d.qZA()()()()),2&gt){const ft=d.oxw(2);d.xp6(5),d.Q6J("ngIf",ft.classroom),d.xp6(3),d.Q6J("classroom",ft.classroom)}}function _t(gt,Et){if(1&gt&&(d.TgZ(0,"div",13),d._UZ(1,"app-classroom-homework-list",18),d.qZA()),2&gt){const ft=d.oxw(3);d.xp6(1),d.Q6J("classroom",ft.classroom)}}function Tt(gt,Et){if(1&gt&&(d.TgZ(0,"div",13),d._UZ(1,"app-classroom-student-list",18),d.qZA()),2&gt){const ft=d.oxw(3);d.xp6(1),d.Q6J("classroom",ft.classroom)}}function Pt(gt,Et){if(1&gt&&(d.TgZ(0,"div",12),d.YNc(1,_t,2,1,"div",19),d.YNc(2,Tt,2,1,"div",19),d.qZA()),2&gt){const ft=d.oxw(2);d.xp6(1),d.Q6J("ngIf",ft.classroom),d.xp6(1),d.Q6J("ngIf",ft.classroom)}}function At(gt,Et){if(1&gt&&(d.TgZ(0,"div",6)(1,"div",7),d._UZ(2,"div",8),d.TgZ(3,"div",9)(4,"div",10)(5,"strong"),d._uU(6,"Class:"),d.qZA(),d._uU(7),d._UZ(8,"br"),d.TgZ(9,"strong"),d._uU(10,"Teacher:"),d.qZA(),d._uU(11),d.qZA()()(),d.YNc(12,mt,9,2,"div",11),d.YNc(13,Pt,3,2,"div",11),d.qZA()),2&gt){const ft=d.oxw();d.xp6(7),d.hij(" ",ft.classroom.name," "),d.xp6(4),d.lnq(" ",null==ft.classroom.teacher?null:ft.classroom.teacher.firstname," ",null==ft.classroom.teacher?null:ft.classroom.teacher.lastname," (",null==ft.classroom.teacher?null:ft.classroom.teacher.email,") "),d.xp6(1),d.Q6J("ngIf",1==ft.user.role),d.xp6(1),d.Q6J("ngIf",0==ft.user.role)}}Nt.\u0275fac=function(Et){return new(Et||Nt)(d.Y36(k.u),d.Y36(x.F0))},Nt.\u0275cmp=d.Xpm({type:Nt,selectors:[["app-classroom-student-list"]],inputs:{classroom:"classroom"},decls:1,vars:1,consts:[["class","card",4,"ngIf"],[1,"card"],[1,"card-body"],[1,"row"],[1,"col-3"],[1,"col-6","text-center"],[1,"mb-4","pt-2"],[1,"fa-solid","fa-graduation-cap"],[4,"ngIf"],["class","col-3",4,"ngIf"],["class","row mt-3",4,"ngIf"],["type","button",1,"btn","btn-primary","w-100",3,"click"],[1,"fa-solid","fa-download","pe-clickable"],[1,"row","mt-3"],[1,"col-5"],[1,"col-2","ms-3"],[1,"custom-loader","text-center"],["class","table table-hover",4,"ngIf"],[1,"text-center"],[1,"table","table-hover"],["class","text-center",4,"ngFor","ngForOf"]],template:function(Et,ft){1&Et&&d.YNc(0,kt,12,4,"div",0),2&Et&&d.Q6J("ngIf",ft.classroom)},dependencies:[m.sg,m.O5],encapsulation:2});class Ht{constructor(Et,ft,Rt){this._route=Et,this._classroomService=ft,this._router=Rt,this.loading=!1;let Jt=JSON.parse(localStorage.getItem("currentUserData"));Jt||this._router.navigate(["/users/auth"]),this.user=Jt}ngOnInit(){this.classroom_id=this._route.snapshot.paramMap.get("classroom_id"),this.getClassroom()}getClassroom(){this.loading=!0,this._classroomService.getClassroom(this.classroom_id).subscribe(Et=>{Et.hasOwnProperty("error")?this._router.navigate(["/"]):this.classroom=Et,this.loading=!1})}}Ht.\u0275fac=function(Et){return new(Et||Ht)(d.Y36(x.gz),d.Y36(k.u),d.Y36(x.F0))},Ht.\u0275cmp=d.Xpm({type:Ht,selectors:[["app-classroom-view"]],decls:3,vars:2,consts:[["class","row mt-5 g-0",4,"ngIf"],["class","mt-4 container-fluid",4,"ngIf"],[1,"row","mt-5","g-0"],[1,"col-5"],[1,"col-2","ms-5","mt-5"],[1,"ms-3","custom-big-loader","mt-5"],[1,"mt-4","container-fluid"],[1,"row","px-2","mb-1"],[1,"col-3"],[1,"col-6","text-center"],["role","alert",1,"alert","alert-primary"],["class","row px-2",4,"ngIf"],[1,"row","px-2"],[1,"col-6"],[1,"row","mb-4"],["class","col-12",4,"ngIf"],[1,"row"],[1,"col-12"],[3,"classroom"],["class","col-6",4,"ngIf"]],template:function(Et,ft){1&Et&&(d._UZ(0,"app-navbar"),d.YNc(1,Ft,4,0,"div",0),d.YNc(2,At,14,6,"div",1)),2&Et&&(d.xp6(1),d.Q6J("ngIf",ft.loading),d.xp6(1),d.Q6J("ngIf",!ft.loading&&ft.classroom))},dependencies:[m.O5,w.S,Z,at,Nt],encapsulation:2});const $t=[{path:"",pathMatch:"full",redirectTo:"/dashboard"},{path:"invite/:invite_token",component:y,canActivate:[_.a]},{path:":classroom_id",canActivate:[_.a],children:[{path:"",pathMatch:"full",component:Ht},{path:"homeworks",loadChildren:()=>Promise.resolve().then(f.bind(f,5273)).then(gt=>gt.ClassroomHomeworkModule)}]}];class fe{}fe.\u0275fac=function(Et){return new(Et||fe)},fe.\u0275mod=d.oAB({type:fe}),fe.\u0275inj=d.cJS({imports:[x.Bz.forChild($t),x.Bz]});var Wt=f(5273);class Qt{}Qt.\u0275fac=function(Et){return new(Et||Qt)},Qt.\u0275mod=d.oAB({type:Qt}),Qt.\u0275inj=d.cJS({providers:[k.u],imports:[m.ez,E.m,h.UserModule,fe,Wt.ClassroomHomeworkModule]})},5273:(T,A,f)=>{"use strict";f.r(A),f.d(A,{ClassroomHomeworkModule:()=>Fr});var m={};f.r(m),f.d(m,{forceCenter:()=>xu,forceCollide:()=>es,forceLink:()=>is,forceManyBody:()=>ne,forceRadial:()=>Tu,forceSimulation:()=>ss,forceX:()=>Nu,forceY:()=>Su});var E={};f.r(E),f.d(E,{dispatch:()=>go});var h={};f.r(h),f.d(h,{interval:()=>Xa,now:()=>Gt,timeout:()=>yo,timer:()=>Kr,timerFlush:()=>Kt});var k=f(6895),x=f(3135),_=f(9181),d=f(4937),g=f(4415),y=f(7618),w=f(571),o=f(1571),C=f(301),N=f(4696),I=f(433),L=f(9102),z=f(655),H=f(7340);function Z(){}function V(a){return null==a?Z:function(){return this.querySelector(a)}}function q(){return[]}function st(a){return null==a?q:function(){return this.querySelectorAll(a)}}function lt(a){return function(){return this.matches(a)}}function $(a){return new Array(a.length)}function j(a,l){this.ownerDocument=a.ownerDocument,this.namespaceURI=a.namespaceURI,this._next=null,this._parent=a,this.__data__=l}j.prototype={constructor:j,appendChild:function(a){return this._parent.insertBefore(a,this._next)},insertBefore:function(a,l){return this._parent.insertBefore(a,l)},querySelector:function(a){return this._parent.querySelector(a)},querySelectorAll:function(a){return this._parent.querySelectorAll(a)}};function ot(a,l,u,v,M,D){for(var P,R=0,G=l.length,Q=D.length;R<Q;++R)(P=l[R])?(P.__data__=D[R],v[R]=P):u[R]=new j(a,D[R]);for(;R<G;++R)(P=l[R])&&(M[R]=P)}function et(a,l,u,v,M,D,R){var P,G,xt,Q={},rt=l.length,ut=D.length,tt=new Array(rt);for(P=0;P<rt;++P)(G=l[P])&&(tt[P]=xt="$"+R.call(G,G.__data__,P,l),xt in Q?M[P]=G:Q[xt]=G);for(P=0;P<ut;++P)(G=Q[xt="$"+R.call(a,D[P],P,D)])?(v[P]=G,G.__data__=D[P],Q[xt]=null):u[P]=new j(a,D[P]);for(P=0;P<rt;++P)(G=l[P])&&Q[tt[P]]===G&&(M[P]=G)}function Nt(a,l){return a<l?-1:a>l?1:a>=l?0:NaN}var At="http://www.w3.org/1999/xhtml";const Ht={svg:"http://www.w3.org/2000/svg",xhtml:At,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function $t(a){var l=a+="",u=l.indexOf(":");return u>=0&&"xmlns"!==(l=a.slice(0,u))&&(a=a.slice(u+1)),Ht.hasOwnProperty(l)?{space:Ht[l],local:a}:a}function fe(a){return function(){this.removeAttribute(a)}}function Wt(a){return function(){this.removeAttributeNS(a.space,a.local)}}function Qt(a,l){return function(){this.setAttribute(a,l)}}function gt(a,l){return function(){this.setAttributeNS(a.space,a.local,l)}}function Et(a,l){return function(){var u=l.apply(this,arguments);null==u?this.removeAttribute(a):this.setAttribute(a,u)}}function ft(a,l){return function(){var u=l.apply(this,arguments);null==u?this.removeAttributeNS(a.space,a.local):this.setAttributeNS(a.space,a.local,u)}}function Jt(a){return a.ownerDocument&&a.ownerDocument.defaultView||a.document&&a||a.defaultView}function fn(a){return function(){this.style.removeProperty(a)}}function Ge(a,l,u){return function(){this.style.setProperty(a,l,u)}}function Oe(a,l,u){return function(){var v=l.apply(this,arguments);null==v?this.style.removeProperty(a):this.style.setProperty(a,v,u)}}function Ue(a,l){return a.style.getPropertyValue(l)||Jt(a).getComputedStyle(a,null).getPropertyValue(l)}function cr(a){return function(){delete this[a]}}function bi(a,l){return function(){this[a]=l}}function Gr(a,l){return function(){var u=l.apply(this,arguments);null==u?delete this[a]:this[a]=u}}function Ur(a){return a.trim().split(/^|\s+/)}function Jn(a){return a.classList||new Jr(a)}function Jr(a){this._node=a,this._names=Ur(a.getAttribute("class")||"")}function hr(a,l){for(var u=Jn(a),v=-1,M=l.length;++v<M;)u.add(l[v])}function Ae(a,l){for(var u=Jn(a),v=-1,M=l.length;++v<M;)u.remove(l[v])}function pn(a){return function(){hr(this,a)}}function Ci(a){return function(){Ae(this,a)}}function El(a,l){return function(){(l.apply(this,arguments)?hr:Ae)(this,a)}}function $n(){this.textContent=""}function Os(a){return function(){this.textContent=a}}function Ml(a){return function(){var l=a.apply(this,arguments);this.textContent=l??""}}function ki(){this.innerHTML=""}function Ei(a){return function(){this.innerHTML=a}}function $r(a){return function(){var l=a.apply(this,arguments);this.innerHTML=l??""}}function Mi(){this.nextSibling&&this.parentNode.appendChild(this)}function Tl(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Sl(a){return function(){var l=this.ownerDocument,u=this.namespaceURI;return u===At&&l.documentElement.namespaceURI===At?l.createElement(a):l.createElementNS(u,a)}}function Ls(a){return function(){return this.ownerDocument.createElementNS(a.space,a.local)}}function Fs(a){var l=$t(a);return(l.local?Ls:Sl)(l)}function qe(){return null}function uo(){var a=this.parentNode;a&&a.removeChild(this)}function zs(){var a=this.cloneNode(!1),l=this.parentNode;return l?l.insertBefore(a,this.nextSibling):a}function Ol(){var a=this.cloneNode(!0),l=this.parentNode;return l?l.insertBefore(a,this.nextSibling):a}Jr.prototype={add:function(a){this._names.indexOf(a)<0&&(this._names.push(a),this._node.setAttribute("class",this._names.join(" ")))},remove:function(a){var l=this._names.indexOf(a);l>=0&&(this._names.splice(l,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(a){return this._names.indexOf(a)>=0}};var co={},Nn=null;typeof document<"u"&&("onmouseenter"in document.documentElement||(co={mouseenter:"mouseover",mouseleave:"mouseout"}));function Vs(a,l,u){return a=Ni(a,l,u),function(v){var M=v.relatedTarget;(!M||M!==this&&!(8&M.compareDocumentPosition(this)))&&a.call(this,v)}}function Ni(a,l,u){return function(v){var M=Nn;Nn=v;try{a.call(this,this.__data__,l,u)}finally{Nn=M}}}function Le(a){return a.trim().split(/^|\s+/).map(function(l){var u="",v=l.indexOf(".");return v>=0&&(u=l.slice(v+1),l=l.slice(0,v)),{type:l,name:u}})}function dr(a){return function(){var l=this.__on;if(l){for(var D,u=0,v=-1,M=l.length;u<M;++u)D=l[u],a.type&&D.type!==a.type||D.name!==a.name?l[++v]=D:this.removeEventListener(D.type,D.listener,D.capture);++v?l.length=v:delete this.__on}}}function ho(a,l,u){var v=co.hasOwnProperty(a.type)?Vs:Ni;return function(M,D,R){var G,P=this.__on,Q=v(l,D,R);if(P)for(var rt=0,ut=P.length;rt<ut;++rt)if((G=P[rt]).type===a.type&&G.name===a.name)return this.removeEventListener(G.type,G.listener,G.capture),this.addEventListener(G.type,G.listener=Q,G.capture=u),void(G.value=l);this.addEventListener(a.type,Q,u),G={type:a.type,name:a.name,value:l,listener:Q,capture:u},P?P.push(G):this.__on=[G]}}function Si(a,l,u){var v=Jt(a),M=v.CustomEvent;"function"==typeof M?M=new M(l,u):(M=v.document.createEvent("Event"),u?(M.initEvent(l,u.bubbles,u.cancelable),M.detail=u.detail):M.initEvent(l,!1,!1)),a.dispatchEvent(M)}function Sn(a,l){return function(){return Si(this,a,l)}}function tn(a,l){return function(){return Si(this,a,l.apply(this,arguments))}}var Yn=[null];function Xt(a,l){this._groups=a,this._parents=l}function pe(){return new Xt([[document.documentElement]],Yn)}Xt.prototype=pe.prototype={constructor:Xt,select:function K(a){"function"!=typeof a&&(a=V(a));for(var l=this._groups,u=l.length,v=new Array(u),M=0;M<u;++M)for(var G,Q,D=l[M],R=D.length,P=v[M]=new Array(R),rt=0;rt<R;++rt)(G=D[rt])&&(Q=a.call(G,G.__data__,rt,D))&&("__data__"in G&&(Q.__data__=G.__data__),P[rt]=Q);return new Xt(v,this._parents)},selectAll:function it(a){"function"!=typeof a&&(a=st(a));for(var l=this._groups,u=l.length,v=[],M=[],D=0;D<u;++D)for(var G,R=l[D],P=R.length,Q=0;Q<P;++Q)(G=R[Q])&&(v.push(a.call(G,G.__data__,Q,R)),M.push(G));return new Xt(v,M)},filter:function F(a){"function"!=typeof a&&(a=lt(a));for(var l=this._groups,u=l.length,v=new Array(u),M=0;M<u;++M)for(var G,D=l[M],R=D.length,P=v[M]=[],Q=0;Q<R;++Q)(G=D[Q])&&a.call(G,G.__data__,Q,D)&&P.push(G);return new Xt(v,this._parents)},data:function X(a,l){if(!a)return xt=new Array(this.size()),Q=-1,this.each(function(ve){xt[++Q]=ve}),xt;var u=l?et:ot,v=this._parents,M=this._groups;"function"!=typeof a&&(a=function W(a){return function(){return a}}(a));for(var D=M.length,R=new Array(D),P=new Array(D),G=new Array(D),Q=0;Q<D;++Q){var rt=v[Q],ut=M[Q],tt=ut.length,xt=a.call(rt,rt&&rt.__data__,Q,v),vt=xt.length,wt=P[Q]=new Array(vt),Mt=R[Q]=new Array(vt);u(rt,ut,wt,Mt,G[Q]=new Array(tt),xt,l);for(var te,re,Dt=0,Ot=0;Dt<vt;++Dt)if(te=wt[Dt]){for(Dt>=Ot&&(Ot=Dt+1);!(re=Mt[Ot])&&++Ot<vt;);te._next=re||null}}return(R=new Xt(R,v))._enter=P,R._exit=G,R},enter:function Y(){return new Xt(this._enter||this._groups.map($),this._parents)},exit:function dt(){return new Xt(this._exit||this._groups.map($),this._parents)},join:function pt(a,l,u){var v=this.enter(),M=this,D=this.exit();return v="function"==typeof a?a(v):v.append(a+""),null!=l&&(M=l(M)),null==u?D.remove():u(D),v&&M?v.merge(M).order():M},merge:function bt(a){for(var l=this._groups,u=a._groups,v=l.length,M=u.length,D=Math.min(v,M),R=new Array(v),P=0;P<D;++P)for(var tt,G=l[P],Q=u[P],rt=G.length,ut=R[P]=new Array(rt),xt=0;xt<rt;++xt)(tt=G[xt]||Q[xt])&&(ut[xt]=tt);for(;P<v;++P)R[P]=l[P];return new Xt(R,this._parents)},order:function yt(){for(var a=this._groups,l=-1,u=a.length;++l<u;)for(var R,v=a[l],M=v.length-1,D=v[M];--M>=0;)(R=v[M])&&(D&&4^R.compareDocumentPosition(D)&&D.parentNode.insertBefore(R,D),D=R);return this},sort:function kt(a){function l(ut,tt){return ut&&tt?a(ut.__data__,tt.__data__):!ut-!tt}a||(a=Nt);for(var u=this._groups,v=u.length,M=new Array(v),D=0;D<v;++D){for(var Q,R=u[D],P=R.length,G=M[D]=new Array(P),rt=0;rt<P;++rt)(Q=R[rt])&&(G[rt]=Q);G.sort(l)}return new Xt(M,this._parents).order()},call:function Ft(){var a=arguments[0];return arguments[0]=this,a.apply(null,arguments),this},nodes:function ht(){var a=new Array(this.size()),l=-1;return this.each(function(){a[++l]=this}),a},node:function mt(){for(var a=this._groups,l=0,u=a.length;l<u;++l)for(var v=a[l],M=0,D=v.length;M<D;++M){var R=v[M];if(R)return R}return null},size:function _t(){var a=0;return this.each(function(){++a}),a},empty:function Tt(){return!this.node()},each:function Pt(a){for(var l=this._groups,u=0,v=l.length;u<v;++u)for(var P,M=l[u],D=0,R=M.length;D<R;++D)(P=M[D])&&a.call(P,P.__data__,D,M);return this},attr:function Rt(a,l){var u=$t(a);if(arguments.length<2){var v=this.node();return u.local?v.getAttributeNS(u.space,u.local):v.getAttribute(u)}return this.each((null==l?u.local?Wt:fe:"function"==typeof l?u.local?ft:Et:u.local?gt:Qt)(u,l))},style:function xe(a,l,u){return arguments.length>1?this.each((null==l?fn:"function"==typeof l?Oe:Ge)(a,l,u??"")):Ue(this.node(),a)},property:function Tn(a,l){return arguments.length>1?this.each((null==l?cr:"function"==typeof l?Gr:bi)(a,l)):this.node()[a]},classed:function Is(a,l){var u=Ur(a+"");if(arguments.length<2){for(var v=Jn(this.node()),M=-1,D=u.length;++M<D;)if(!v.contains(u[M]))return!1;return!0}return this.each(("function"==typeof l?El:l?pn:Ci)(u,l))},text:function As(a){return arguments.length?this.each(null==a?$n:("function"==typeof a?Ml:Os)(a)):this.node().textContent},html:function Ds(a){return arguments.length?this.each(null==a?ki:("function"==typeof a?$r:Ei)(a)):this.node().innerHTML},raise:function Ps(){return this.each(Mi)},lower:function Nl(){return this.each(Tl)},append:function Il(a){var l="function"==typeof a?a:Fs(a);return this.select(function(){return this.appendChild(l.apply(this,arguments))})},insert:function Rs(a,l){var u="function"==typeof a?a:Fs(a),v=null==l?qe:"function"==typeof l?l:V(l);return this.select(function(){return this.insertBefore(u.apply(this,arguments),v.apply(this,arguments)||null)})},remove:function Bs(){return this.each(uo)},clone:function Hs(a){return this.select(a?Ol:zs)},datum:function Al(a){return arguments.length?this.property("__data__",a):this.node().__data__},on:function _e(a,l,u){var M,R,v=Le(a+""),D=v.length;if(!(arguments.length<2)){for(P=l?ho:dr,null==u&&(u=!1),M=0;M<D;++M)this.each(P(v[M],l,u));return this}var P=this.node().__on;if(P)for(var rt,G=0,Q=P.length;G<Q;++G)for(M=0,rt=P[G];M<D;++M)if((R=v[M]).type===rt.type&&R.name===rt.name)return rt.value},dispatch:function In(a,l){return this.each(("function"==typeof l?tn:Sn)(a,l))}};const Wn=pe;function Zs(a){return"string"==typeof a?new Xt([[document.querySelector(a)]],[document.documentElement]):new Xt([[a]],Yn)}function Gs(a,l,u){a._context.bezierCurveTo((2*a._x0+a._x1)/3,(2*a._y0+a._y1)/3,(a._x0+2*a._x1)/3,(a._y0+2*a._y1)/3,(a._x0+4*a._x1+l)/6,(a._y0+4*a._y1+u)/6)}function Ii(a){this._context=a}function fr(a,l){this._basis=new Ii(a),this._beta=l}Ii.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Gs(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(a,l){switch(a=+a,l=+l,this._point){case 0:this._point=1,this._line?this._context.lineTo(a,l):this._context.moveTo(a,l);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Gs(this,a,l)}this._x0=this._x1,this._x1=a,this._y0=this._y1,this._y1=l}},fr.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var a=this._x,l=this._y,u=a.length-1;if(u>0)for(var G,v=a[0],M=l[0],D=a[u]-v,R=l[u]-M,P=-1;++P<=u;)G=P/u,this._basis.point(this._beta*a[P]+(1-this._beta)*(v+G*D),this._beta*l[P]+(1-this._beta)*(M+G*R));this._x=this._y=null,this._basis.lineEnd()},point:function(a,l){this._x.push(+a),this._y.push(+l)}};const Dl=function a(l){function u(v){return 1===l?new Ii(v):new fr(v,l)}return u.beta=function(v){return a(+v)},u}(.85);var Yr=Math.PI,Oi=2*Yr,jn=1e-6,Pl=Oi-jn;function fo(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Us(){return new fo}fo.prototype=Us.prototype={constructor:fo,moveTo:function(a,l){this._+="M"+(this._x0=this._x1=+a)+","+(this._y0=this._y1=+l)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(a,l){this._+="L"+(this._x1=+a)+","+(this._y1=+l)},quadraticCurveTo:function(a,l,u,v){this._+="Q"+ +a+","+ +l+","+(this._x1=+u)+","+(this._y1=+v)},bezierCurveTo:function(a,l,u,v,M,D){this._+="C"+ +a+","+ +l+","+ +u+","+ +v+","+(this._x1=+M)+","+(this._y1=+D)},arcTo:function(a,l,u,v,M){a=+a,l=+l,u=+u,v=+v,M=+M;var D=this._x1,R=this._y1,P=u-a,G=v-l,Q=D-a,rt=R-l,ut=Q*Q+rt*rt;if(M<0)throw new Error("negative radius: "+M);if(null===this._x1)this._+="M"+(this._x1=a)+","+(this._y1=l);else if(ut>jn)if(Math.abs(rt*P-G*Q)>jn&&M){var tt=u-D,xt=v-R,vt=P*P+G*G,wt=tt*tt+xt*xt,Mt=Math.sqrt(vt),It=Math.sqrt(ut),Dt=M*Math.tan((Yr-Math.acos((vt+ut-wt)/(2*Mt*It)))/2),Ot=Dt/It,te=Dt/Mt;Math.abs(Ot-1)>jn&&(this._+="L"+(a+Ot*Q)+","+(l+Ot*rt)),this._+="A"+M+","+M+",0,0,"+ +(rt*tt>Q*xt)+","+(this._x1=a+te*P)+","+(this._y1=l+te*G)}else this._+="L"+(this._x1=a)+","+(this._y1=l)},arc:function(a,l,u,v,M,D){a=+a,l=+l,D=!!D;var R=(u=+u)*Math.cos(v),P=u*Math.sin(v),G=a+R,Q=l+P,rt=1^D,ut=D?v-M:M-v;if(u<0)throw new Error("negative radius: "+u);null===this._x1?this._+="M"+G+","+Q:(Math.abs(this._x1-G)>jn||Math.abs(this._y1-Q)>jn)&&(this._+="L"+G+","+Q),u&&(ut<0&&(ut=ut%Oi+Oi),ut>Pl?this._+="A"+u+","+u+",0,1,"+rt+","+(a-R)+","+(l-P)+"A"+u+","+u+",0,1,"+rt+","+(this._x1=G)+","+(this._y1=Q):ut>jn&&(this._+="A"+u+","+u+",0,"+ +(ut>=Yr)+","+rt+","+(this._x1=a+u*Math.cos(M))+","+(this._y1=l+u*Math.sin(M))))},rect:function(a,l,u,v){this._+="M"+(this._x0=this._x1=+a)+","+(this._y0=this._y1=+l)+"h"+ +u+"v"+ +v+"h"+-u+"Z"},toString:function(){return this._}};const Ll=Us;function Ai(a){return function(){return a}}function Kn(a){this._context=a}function Fl(a){return new Kn(a)}function Di(a){return a[0]}function Js(a){return a[1]}Kn.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(a,l){switch(a=+a,l=+l,this._point){case 0:this._point=1,this._line?this._context.lineTo(a,l):this._context.moveTo(a,l);break;case 1:this._point=2;default:this._context.lineTo(a,l)}}};var $s=Math.PI;function po(a){return(1-Math.cos($s*a))/2}var Rl={value:function(){}};function pr(){for(var v,a=0,l=arguments.length,u={};a<l;++a){if(!(v=arguments[a]+"")||v in u||/[\s.]/.test(v))throw new Error("illegal type: "+v);u[v]=[]}return new On(u)}function On(a){this._=a}function mo(a,l){return a.trim().split(/^|\s+/).map(function(u){var v="",M=u.indexOf(".");if(M>=0&&(v=u.slice(M+1),u=u.slice(0,M)),u&&!l.hasOwnProperty(u))throw new Error("unknown type: "+u);return{type:u,name:v}})}function js(a,l){for(var M,u=0,v=a.length;u<v;++u)if((M=a[u]).name===l)return M.value}function Pi(a,l,u){for(var v=0,M=a.length;v<M;++v)if(a[v].name===l){a[v]=Rl,a=a.slice(0,v).concat(a.slice(v+1));break}return null!=u&&a.push({name:l,value:u}),a}On.prototype=pr.prototype={constructor:On,on:function(a,l){var M,u=this._,v=mo(a+"",u),D=-1,R=v.length;if(!(arguments.length<2)){if(null!=l&&"function"!=typeof l)throw new Error("invalid callback: "+l);for(;++D<R;)if(M=(a=v[D]).type)u[M]=Pi(u[M],a.name,l);else if(null==l)for(M in u)u[M]=Pi(u[M],a.name,null);return this}for(;++D<R;)if((M=(a=v[D]).type)&&(M=js(u[M],a.name)))return M},copy:function(){var a={},l=this._;for(var u in l)a[u]=l[u].slice();return new On(a)},call:function(a,l){if((M=arguments.length-2)>0)for(var M,D,u=new Array(M),v=0;v<M;++v)u[v]=arguments[v+2];if(!this._.hasOwnProperty(a))throw new Error("unknown type: "+a);for(v=0,M=(D=this._[a]).length;v<M;++v)D[v].value.apply(l,u)},apply:function(a,l,u){if(!this._.hasOwnProperty(a))throw new Error("unknown type: "+a);for(var v=this._[a],M=0,D=v.length;M<D;++M)v[M].value.apply(l,u)}};const go=pr;var Li,vr,mr=0,Wr=0,gr=0,mn=0,Je=0,gn=0,jr="object"==typeof performance&&performance.now?performance:Date,Fi="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(a){setTimeout(a,17)};function Gt(){return Je||(Fi(Bl),Je=jr.now()+gn)}function Bl(){Je=0}function yr(){this._call=this._time=this._next=null}function Kr(a,l,u){var v=new yr;return v.restart(a,l,u),v}function Kt(){Gt(),++mr;for(var l,a=Li;a;)(l=Je-a._time)>=0&&a._call.call(null,l),a=a._next;--mr}function Qr(){Je=(mn=jr.now())+gn,mr=Wr=0;try{Kt()}finally{mr=0,function vo(){for(var a,u,l=Li,v=1/0;l;)l._call?(v>l._time&&(v=l._time),a=l,l=l._next):(u=l._next,l._next=null,l=a?a._next=u:Li=u);vr=a,be(v)}(),Je=0}}function Vt(){var a=jr.now(),l=a-mn;l>1e3&&(gn-=l,mn=a)}function be(a){mr||(Wr&&(Wr=clearTimeout(Wr)),a-Je>24?(a<1/0&&(Wr=setTimeout(Qr,a-jr.now()-gn)),gr&&(gr=clearInterval(gr))):(gr||(mn=jr.now(),gr=setInterval(Vt,1e3)),mr=1,Fi(Qr)))}function yo(a,l,u){var v=new yr;return l=null==l?0:+l,v.restart(function(M){v.stop(),a(M+l)},l,u),v}yr.prototype=Kr.prototype={constructor:yr,restart:function(a,l,u){if("function"!=typeof a)throw new TypeError("callback is not a function");u=(null==u?Gt():+u)+(null==l?0:+l),!this._next&&vr!==this&&(vr?vr._next=this:Li=this,vr=this),this._call=a,this._time=u,be()},stop:function(){this._call&&(this._call=null,this._time=1/0,be())}};var xr=go("start","end","cancel","interrupt"),Qs=[];function _r(a,l,u,v,M,D){var R=a.__transition;if(R){if(u in R)return}else a.__transition={};!function wo(a,l,u){var M,v=a.__transition;function D(Q){u.state=1,u.timer.restart(R,u.delay,u.time),u.delay<=Q&&R(Q-u.delay)}function R(Q){var rt,ut,tt,xt;if(1!==u.state)return G();for(rt in v)if((xt=v[rt]).name===u.name){if(3===xt.state)return yo(R);4===xt.state?(xt.state=6,xt.timer.stop(),xt.on.call("interrupt",a,a.__data__,xt.index,xt.group),delete v[rt]):+rt<l&&(xt.state=6,xt.timer.stop(),xt.on.call("cancel",a,a.__data__,xt.index,xt.group),delete v[rt])}if(yo(function(){3===u.state&&(u.state=4,u.timer.restart(P,u.delay,u.time),P(Q))}),u.state=2,u.on.call("start",a,a.__data__,u.index,u.group),2===u.state){for(u.state=3,M=new Array(tt=u.tween.length),rt=0,ut=-1;rt<tt;++rt)(xt=u.tween[rt].value.call(a,a.__data__,u.index,u.group))&&(M[++ut]=xt);M.length=ut+1}}function P(Q){for(var rt=Q<u.duration?u.ease.call(null,Q/u.duration):(u.timer.restart(G),u.state=5,1),ut=-1,tt=M.length;++ut<tt;)M[ut].call(a,rt);5===u.state&&(u.on.call("end",a,a.__data__,u.index,u.group),G())}function G(){for(var Q in u.state=6,u.timer.stop(),delete v[l],v)return;delete a.__transition}v[l]=u,u.timer=Kr(D,0,u.time)}(a,u,{name:l,index:v,group:M,on:xr,tween:Qs,time:D.time,delay:D.delay,duration:D.duration,ease:D.ease,timer:null,state:0})}function An(a,l){var u=oe(a,l);if(u.state>0)throw new Error("too late; already scheduled");return u}function en(a,l){var u=oe(a,l);if(u.state>3)throw new Error("too late; already running");return u}function oe(a,l){var u=a.__transition;if(!u||!(u=u[l]))throw new Error("transition not found");return u}function se(a,l){return a=+a,l=+l,function(u){return a*(1-u)+l*u}}var $e,bo,Co,Fe,wr=180/Math.PI,Hi={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function nn(a,l,u,v,M,D){var R,P,G;return(R=Math.sqrt(a*a+l*l))&&(a/=R,l/=R),(G=a*u+l*v)&&(u-=a*G,v-=l*G),(P=Math.sqrt(u*u+v*v))&&(u/=P,v/=P,G/=P),a*v<l*u&&(a=-a,l=-l,G=-G,R=-R),{translateX:M,translateY:D,rotate:Math.atan2(l,a)*wr,skewX:Math.atan(G)*wr,scaleX:R,scaleY:P}}function qr(a,l,u,v){function M(Q){return Q.length?Q.pop()+" ":""}return function(Q,rt){var ut=[],tt=[];return Q=a(Q),rt=a(rt),function D(Q,rt,ut,tt,xt,vt){if(Q!==ut||rt!==tt){var wt=xt.push("translate(",null,l,null,u);vt.push({i:wt-4,x:se(Q,ut)},{i:wt-2,x:se(rt,tt)})}else(ut||tt)&&xt.push("translate("+ut+l+tt+u)}(Q.translateX,Q.translateY,rt.translateX,rt.translateY,ut,tt),function R(Q,rt,ut,tt){Q!==rt?(Q-rt>180?rt+=360:rt-Q>180&&(Q+=360),tt.push({i:ut.push(M(ut)+"rotate(",null,v)-2,x:se(Q,rt)})):rt&&ut.push(M(ut)+"rotate("+rt+v)}(Q.rotate,rt.rotate,ut,tt),function P(Q,rt,ut,tt){Q!==rt?tt.push({i:ut.push(M(ut)+"skewX(",null,v)-2,x:se(Q,rt)}):rt&&ut.push(M(ut)+"skewX("+rt+v)}(Q.skewX,rt.skewX,ut,tt),function G(Q,rt,ut,tt,xt,vt){if(Q!==ut||rt!==tt){var wt=xt.push(M(xt)+"scale(",null,",",null,")");vt.push({i:wt-4,x:se(Q,ut)},{i:wt-2,x:se(rt,tt)})}else(1!==ut||1!==tt)&&xt.push(M(xt)+"scale("+ut+","+tt+")")}(Q.scaleX,Q.scaleY,rt.scaleX,rt.scaleY,ut,tt),Q=rt=null,function(xt){for(var Mt,vt=-1,wt=tt.length;++vt<wt;)ut[(Mt=tt[vt]).i]=Mt.x(xt);return ut.join("")}}}var Xn=qr(function zl(a){return"none"===a?Hi:($e||($e=document.createElement("DIV"),bo=document.documentElement,Co=document.defaultView),$e.style.transform=a,a=Co.getComputedStyle(bo.appendChild($e),null).getPropertyValue("transform"),bo.removeChild($e),nn(+(a=a.slice(7,-1).split(","))[0],+a[1],+a[2],+a[3],+a[4],+a[5]))},"px, ","px)","deg)"),Vl=qr(function Hl(a){return null!=a&&(Fe||(Fe=document.createElementNS("http://www.w3.org/2000/svg","g")),Fe.setAttribute("transform",a),a=Fe.transform.baseVal.consolidate())?nn((a=a.matrix).a,a.b,a.c,a.d,a.e,a.f):Hi},", ",")",")");function Dn(a,l){var u,v;return function(){var M=en(this,a),D=M.tween;if(D!==u)for(var R=0,P=(v=u=D).length;R<P;++R)if(v[R].name===l){(v=v.slice()).splice(R,1);break}M.tween=v}}function qs(a,l,u){var v,M;if("function"!=typeof u)throw new Error;return function(){var D=en(this,a),R=D.tween;if(R!==v){M=(v=R).slice();for(var P={name:l,value:u},G=0,Q=M.length;G<Q;++G)if(M[G].name===l){M[G]=P;break}G===Q&&M.push(P)}D.tween=M}}function ti(a,l,u){var v=a._id;return a.each(function(){var M=en(this,v);(M.value||(M.value={}))[l]=u.apply(this,arguments)}),function(M){return oe(M,v).value[l]}}function Vi(a,l,u){a.prototype=l.prototype=u,u.constructor=a}function Zi(a,l){var u=Object.create(a.prototype);for(var v in l)u[v]=l[v];return u}function me(){}var De=1/.7,Ln="\\s*([+-]?\\d+)\\s*",de="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",rn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ce=/^#([0-9a-f]{3,8})$/,br=new RegExp("^rgb\\("+[Ln,Ln,Ln]+"\\)$"),ze=new RegExp("^rgb\\("+[rn,rn,rn]+"\\)$"),Ye=new RegExp("^rgba\\("+[Ln,Ln,Ln,de]+"\\)$"),Gi=new RegExp("^rgba\\("+[rn,rn,rn,de]+"\\)$"),Zl=new RegExp("^hsl\\("+[de,rn,rn]+"\\)$"),Gl=new RegExp("^hsla\\("+[de,rn,rn,de]+"\\)$"),yn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function ta(){return this.rgb().formatHex()}function na(){return this.rgb().formatRgb()}function Cr(a){var l,u;return a=(a+"").trim().toLowerCase(),(l=Ce.exec(a))?(u=l[1].length,l=parseInt(l[1],16),6===u?ra(l):3===u?new Pe(l>>8&15|l>>4&240,l>>4&15|240&l,(15&l)<<4|15&l,1):8===u?ei(l>>24&255,l>>16&255,l>>8&255,(255&l)/255):4===u?ei(l>>12&15|l>>8&240,l>>8&15|l>>4&240,l>>4&15|240&l,((15&l)<<4|15&l)/255):null):(l=br.exec(a))?new Pe(l[1],l[2],l[3],1):(l=ze.exec(a))?new Pe(255*l[1]/100,255*l[2]/100,255*l[3]/100,1):(l=Ye.exec(a))?ei(l[1],l[2],l[3],l[4]):(l=Gi.exec(a))?ei(255*l[1]/100,255*l[2]/100,255*l[3]/100,l[4]):(l=Zl.exec(a))?oa(l[1],l[2]/100,l[3]/100,1):(l=Gl.exec(a))?oa(l[1],l[2]/100,l[3]/100,l[4]):yn.hasOwnProperty(a)?ra(yn[a]):"transparent"===a?new Pe(NaN,NaN,NaN,0):null}function ra(a){return new Pe(a>>16&255,a>>8&255,255&a,1)}function ei(a,l,u,v){return v<=0&&(a=l=u=NaN),new Pe(a,l,u,v)}function kr(a){return a instanceof me||(a=Cr(a)),a?new Pe((a=a.rgb()).r,a.g,a.b,a.opacity):new Pe}function Ui(a,l,u,v){return 1===arguments.length?kr(a):new Pe(a,l,u,v??1)}function Pe(a,l,u,v){this.r=+a,this.g=+l,this.b=+u,this.opacity=+v}function ia(){return"#"+ko(this.r)+ko(this.g)+ko(this.b)}function Ji(){var a=this.opacity;return(1===(a=isNaN(a)?1:Math.max(0,Math.min(1,a)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===a?")":", "+a+")")}function ko(a){return((a=Math.max(0,Math.min(255,Math.round(a)||0)))<16?"0":"")+a.toString(16)}function oa(a,l,u,v){return v<=0?a=l=u=NaN:u<=0||u>=1?a=l=NaN:l<=0&&(a=NaN),new on(a,l,u,v)}function sa(a){if(a instanceof on)return new on(a.h,a.s,a.l,a.opacity);if(a instanceof me||(a=Cr(a)),!a)return new on;if(a instanceof on)return a;var l=(a=a.rgb()).r/255,u=a.g/255,v=a.b/255,M=Math.min(l,u,v),D=Math.max(l,u,v),R=NaN,P=D-M,G=(D+M)/2;return P?(R=l===D?(u-v)/P+6*(u<v):u===D?(v-l)/P+2:(l-u)/P+4,P/=G<.5?D+M:2-D-M,R*=60):P=G>0&&G<1?0:R,new on(R,P,G,a.opacity)}function on(a,l,u,v){this.h=+a,this.s=+l,this.l=+u,this.opacity=+v}function sn(a,l,u){return 255*(a<60?l+(u-l)*a/60:a<180?u:a<240?l+(u-l)*(240-a)/60:l)}function la(a,l,u,v,M){var D=a*a,R=D*a;return((1-3*a+3*D-R)*l+(4-6*D+3*R)*u+(1+3*a+3*D-3*R)*v+R*M)/6}function $i(a){return function(){return a}}function Eo(a,l){return function(u){return a+u*l}}function Jl(a){return 1==(a=+a)?Mo:function(l,u){return u-l?function Ul(a,l,u){return a=Math.pow(a,u),l=Math.pow(l,u)-a,u=1/u,function(v){return Math.pow(a+v*l,u)}}(l,u,a):$i(isNaN(l)?u:l)}}function Mo(a,l){var u=l-a;return u?Eo(a,u):$i(isNaN(a)?l:a)}Vi(me,Cr,{copy:function(a){return Object.assign(new this.constructor,this,a)},displayable:function(){return this.rgb().displayable()},hex:ta,formatHex:ta,formatHsl:function ea(){return sa(this).formatHsl()},formatRgb:na,toString:na}),Vi(Pe,Ui,Zi(me,{brighter:function(a){return a=null==a?De:Math.pow(De,a),new Pe(this.r*a,this.g*a,this.b*a,this.opacity)},darker:function(a){return a=null==a?.7:Math.pow(.7,a),new Pe(this.r*a,this.g*a,this.b*a,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ia,formatHex:ia,formatRgb:Ji,toString:Ji})),Vi(on,function aa(a,l,u,v){return 1===arguments.length?sa(a):new on(a,l,u,v??1)},Zi(me,{brighter:function(a){return a=null==a?De:Math.pow(De,a),new on(this.h,this.s,this.l*a,this.opacity)},darker:function(a){return a=null==a?.7:Math.pow(.7,a),new on(this.h,this.s,this.l*a,this.opacity)},rgb:function(){var a=this.h%360+360*(this.h<0),l=isNaN(a)||isNaN(this.s)?0:this.s,u=this.l,v=u+(u<.5?u:1-u)*l,M=2*u-v;return new Pe(sn(a>=240?a-240:a+120,M,v),sn(a,M,v),sn(a<120?a+240:a-120,M,v),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var a=this.opacity;return(1===(a=isNaN(a)?1:Math.max(0,Math.min(1,a)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===a?")":", "+a+")")}}));const To=function a(l){var u=Jl(l);function v(M,D){var R=u((M=Ui(M)).r,(D=Ui(D)).r),P=u(M.g,D.g),G=u(M.b,D.b),Q=Mo(M.opacity,D.opacity);return function(rt){return M.r=R(rt),M.g=P(rt),M.b=G(rt),M.opacity=Q(rt),M+""}}return v.gamma=a,v}(1);function No(a){return function(l){var R,P,u=l.length,v=new Array(u),M=new Array(u),D=new Array(u);for(R=0;R<u;++R)P=Ui(l[R]),v[R]=P.r||0,M[R]=P.g||0,D[R]=P.b||0;return v=a(v),M=a(M),D=a(D),P.opacity=1,function(G){return P.r=v(G),P.g=M(G),P.b=D(G),P+""}}}No(function ua(a){var l=a.length-1;return function(u){var v=u<=0?u=0:u>=1?(u=1,l-1):Math.floor(u*l),M=a[v],D=a[v+1],R=v>0?a[v-1]:2*M-D,P=v<l-1?a[v+2]:2*D-M;return la((u-v/l)*l,R,M,D,P)}}),No(function ni(a){var l=a.length;return function(u){var v=Math.floor(((u%=1)<0?++u:u)*l),M=a[(v+l-1)%l],D=a[v%l],R=a[(v+1)%l],P=a[(v+2)%l];return la((u-v/l)*l,M,D,R,P)}});var Yi=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Fn=new RegExp(Yi.source,"g");function ca(a,l){var v,M,D,u=Yi.lastIndex=Fn.lastIndex=0,R=-1,P=[],G=[];for(a+="",l+="";(v=Yi.exec(a))&&(M=Fn.exec(l));)(D=M.index)>u&&(D=l.slice(u,D),P[R]?P[R]+=D:P[++R]=D),(v=v[0])===(M=M[0])?P[R]?P[R]+=M:P[++R]=M:(P[++R]=null,G.push({i:R,x:se(v,M)})),u=Fn.lastIndex;return u<l.length&&(D=l.slice(u),P[R]?P[R]+=D:P[++R]=D),P.length<2?G[0]?function ri(a){return function(l){return a(l)+""}}(G[0].x):function ln(a){return function(){return a}}(l):(l=G.length,function(Q){for(var ut,rt=0;rt<l;++rt)P[(ut=G[rt]).i]=ut.x(Q);return P.join("")})}function ha(a,l){var u;return("number"==typeof l?se:l instanceof Cr?To:(u=Cr(l))?(l=u,To):ca)(a,l)}function qn(a){return function(){this.removeAttribute(a)}}function tr(a){return function(){this.removeAttributeNS(a.space,a.local)}}function da(a,l,u){var v,D,M=u+"";return function(){var R=this.getAttribute(a);return R===M?null:R===v?D:D=l(v=R,u)}}function Wi(a,l,u){var v,D,M=u+"";return function(){var R=this.getAttributeNS(a.space,a.local);return R===M?null:R===v?D:D=l(v=R,u)}}function fa(a,l,u){var v,M,D;return function(){var R,G,P=u(this);return null==P?void this.removeAttribute(a):(R=this.getAttribute(a))===(G=P+"")?null:R===v&&G===M?D:(M=G,D=l(v=R,P))}}function $l(a,l,u){var v,M,D;return function(){var R,G,P=u(this);return null==P?void this.removeAttributeNS(a.space,a.local):(R=this.getAttributeNS(a.space,a.local))===(G=P+"")?null:R===v&&G===M?D:(M=G,D=l(v=R,P))}}function ii(a,l){return function(u){this.setAttribute(a,l.call(this,u))}}function er(a,l){return function(u){this.setAttributeNS(a.space,a.local,l.call(this,u))}}function So(a,l){var u,v;function M(){var D=l.apply(this,arguments);return D!==v&&(u=(v=D)&&er(a,D)),u}return M._value=l,M}function ma(a,l){var u,v;function M(){var D=l.apply(this,arguments);return D!==v&&(u=(v=D)&&ii(a,D)),u}return M._value=l,M}function ga(a,l){return function(){An(this,a).delay=+l.apply(this,arguments)}}function Io(a,l){return l=+l,function(){An(this,a).delay=l}}function Wl(a,l){return function(){en(this,a).duration=+l.apply(this,arguments)}}function jl(a,l){return l=+l,function(){en(this,a).duration=l}}function Ql(a,l){if("function"!=typeof l)throw new Error;return function(){en(this,a).ease=l}}function Ao(a,l,u){var v,M,D=function Oo(a){return(a+"").trim().split(/^|\s+/).every(function(l){var u=l.indexOf(".");return u>=0&&(l=l.slice(0,u)),!l||"start"===l})}(l)?An:en;return function(){var R=D(this,a),P=R.on;P!==v&&(M=(v=P).copy()).on(l,u),R.on=M}}var wa=Wn.prototype.constructor;function Po(a){return function(){this.style.removeProperty(a)}}function ru(a,l,u){return function(v){this.style.setProperty(a,l.call(this,v),u)}}function Fo(a,l,u){var v,M;function D(){var R=l.apply(this,arguments);return R!==M&&(v=(M=R)&&ru(a,R,u)),v}return D._value=l,D}function Ro(a){return function(l){this.textContent=a.call(this,l)}}function Bo(a){var l,u;function v(){var M=a.apply(this,arguments);return M!==u&&(l=(u=M)&&Ro(M)),l}return v._value=a,v}var Na=0;function un(a,l,u,v){this._groups=a,this._parents=l,this._name=u,this._id=v}function Sa(){return++Na}var Er=Wn.prototype;un.prototype=function iu(a){return Wn().transition(a)}.prototype={constructor:un,select:function _a(a){var l=this._name,u=this._id;"function"!=typeof a&&(a=V(a));for(var v=this._groups,M=v.length,D=new Array(M),R=0;R<M;++R)for(var rt,ut,P=v[R],G=P.length,Q=D[R]=new Array(G),tt=0;tt<G;++tt)(rt=P[tt])&&(ut=a.call(rt,rt.__data__,tt,P))&&("__data__"in rt&&(ut.__data__=rt.__data__),Q[tt]=ut,_r(Q[tt],l,u,tt,Q,oe(rt,u)));return new un(D,this._parents,l,u)},selectAll:function Do(a){var l=this._name,u=this._id;"function"!=typeof a&&(a=st(a));for(var v=this._groups,M=v.length,D=[],R=[],P=0;P<M;++P)for(var rt,G=v[P],Q=G.length,ut=0;ut<Q;++ut)if(rt=G[ut]){for(var xt,tt=a.call(rt,rt.__data__,ut,G),vt=oe(rt,u),wt=0,Mt=tt.length;wt<Mt;++wt)(xt=tt[wt])&&_r(xt,l,u,wt,tt,vt);D.push(tt),R.push(rt)}return new un(D,R,l,u)},filter:function ql(a){"function"!=typeof a&&(a=lt(a));for(var l=this._groups,u=l.length,v=new Array(u),M=0;M<u;++M)for(var G,D=l[M],R=D.length,P=v[M]=[],Q=0;Q<R;++Q)(G=D[Q])&&a.call(G,G.__data__,Q,D)&&P.push(G);return new un(v,this._parents,this._name,this._id)},merge:function tu(a){if(a._id!==this._id)throw new Error;for(var l=this._groups,u=a._groups,v=l.length,M=u.length,D=Math.min(v,M),R=new Array(v),P=0;P<D;++P)for(var tt,G=l[P],Q=u[P],rt=G.length,ut=R[P]=new Array(rt),xt=0;xt<rt;++xt)(tt=G[xt]||Q[xt])&&(ut[xt]=tt);for(;P<v;++P)R[P]=l[P];return new un(R,this._parents,this._name,this._id)},selection:function eu(){return new wa(this._groups,this._parents)},transition:function zo(){for(var a=this._name,l=this._id,u=Sa(),v=this._groups,M=v.length,D=0;D<M;++D)for(var G,R=v[D],P=R.length,Q=0;Q<P;++Q)if(G=R[Q]){var rt=oe(G,l);_r(G,a,u,Q,R,{time:rt.time+rt.delay+rt.duration,delay:0,duration:rt.duration,ease:rt.ease})}return new un(v,this._parents,a,u)},call:Er.call,nodes:Er.nodes,node:Er.node,size:Er.size,empty:Er.empty,each:Er.each,on:function ya(a,l){var u=this._id;return arguments.length<2?oe(this.node(),u).on.on(a):this.each(Ao(u,a,l))},attr:function pa(a,l){var u=$t(a),v="transform"===u?Vl:ha;return this.attrTween(a,"function"==typeof l?(u.local?$l:fa)(u,v,ti(this,"attr."+a,l)):null==l?(u.local?tr:qn)(u):(u.local?Wi:da)(u,v,l))},attrTween:function Yl(a,l){var u="attr."+a;if(arguments.length<2)return(u=this.tween(u))&&u._value;if(null==l)return this.tween(u,null);if("function"!=typeof l)throw new Error;var v=$t(a);return this.tween(u,(v.local?So:ma)(v,l))},style:function ka(a,l,u){var v="transform"==(a+="")?Xn:ha;return null==l?this.styleTween(a,function nu(a,l){var u,v,M;return function(){var D=Ue(this,a),R=(this.style.removeProperty(a),Ue(this,a));return D===R?null:D===u&&R===v?M:M=l(u=D,v=R)}}(a,v)).on("end.style."+a,Po(a)):"function"==typeof l?this.styleTween(a,function Lo(a,l,u){var v,M,D;return function(){var R=Ue(this,a),P=u(this),G=P+"";return null==P&&(this.style.removeProperty(a),G=P=Ue(this,a)),R===G?null:R===v&&G===M?D:(M=G,D=l(v=R,P))}}(a,v,ti(this,"style."+a,l))).each(function Ca(a,l){var u,v,M,P,D="style."+l,R="end."+D;return function(){var G=en(this,a),Q=G.on,rt=null==G.value[D]?P||(P=Po(l)):void 0;(Q!==u||M!==rt)&&(v=(u=Q).copy()).on(R,M=rt),G.on=v}}(this._id,a)):this.styleTween(a,function ba(a,l,u){var v,D,M=u+"";return function(){var R=Ue(this,a);return R===M?null:R===v?D:D=l(v=R,u)}}(a,v,l),u).on("end.style."+a,null)},styleTween:function nr(a,l,u){var v="style."+(a+="");if(arguments.length<2)return(v=this.tween(v))&&v._value;if(null==l)return this.tween(v,null);if("function"!=typeof l)throw new Error;return this.tween(v,Fo(a,l,u??""))},text:function oi(a){return this.tween("text","function"==typeof a?function ji(a){return function(){var l=a(this);this.textContent=l??""}}(ti(this,"text",a)):function Ea(a){return function(){this.textContent=a}}(null==a?"":a+""))},textTween:function Ma(a){var l="text";if(arguments.length<1)return(l=this.tween(l))&&l._value;if(null==a)return this.tween(l,null);if("function"!=typeof a)throw new Error;return this.tween(l,Bo(a))},remove:function xa(){return this.on("end.remove",function xn(a){return function(){var l=this.parentNode;for(var u in this.__transition)if(+u!==a)return;l&&l.removeChild(this)}}(this._id))},tween:function Pn(a,l){var u=this._id;if(a+="",arguments.length<2){for(var R,v=oe(this.node(),u).tween,M=0,D=v.length;M<D;++M)if((R=v[M]).name===a)return R.value;return null}return this.each((null==l?Dn:qs)(u,a,l))},delay:function va(a){var l=this._id;return arguments.length?this.each(("function"==typeof a?ga:Io)(l,a)):oe(this.node(),l).delay},duration:function Kl(a){var l=this._id;return arguments.length?this.each(("function"==typeof a?Wl:jl)(l,a)):oe(this.node(),l).duration},ease:function Xl(a){var l=this._id;return arguments.length?this.each(Ql(l,a)):oe(this.node(),l).ease},end:function Ta(){var a,l,u=this,v=u._id,M=u.size();return new Promise(function(D,R){var P={value:R},G={value:function(){0==--M&&D()}};u.each(function(){var Q=en(this,v),rt=Q.on;rt!==a&&((l=(a=rt).copy())._.cancel.push(P),l._.interrupt.push(P),l._.end.push(G)),Q.on=l})})}};var Ho={time:null,delay:0,duration:250,ease:function au(a){return((a*=2)<=1?a*a*a:(a-=2)*a*a+2)/2}};function Ia(a,l){for(var u;!(u=a.__transition)||!(u=u[l]);)if(!(a=a.parentNode))return Ho.time=Gt(),Ho;return u}Wn.prototype.interrupt=function vn(a){return this.each(function(){!function Xs(a,l){var v,M,R,u=a.__transition,D=!0;if(u){for(R in l=null==l?null:l+"",u)(v=u[R]).name===l?(M=v.state>2&&v.state<5,v.state=6,v.timer.stop(),v.on.call(M?"interrupt":"cancel",a,a.__data__,v.index,v.group),delete u[R]):D=!1;D&&delete a.__transition}}(this,a)})},Wn.prototype.transition=function Oa(a){var l,u;a instanceof un?(l=a._id,a=a._name):(l=Sa(),(u=Ho).time=Gt(),a=null==a?null:a+"");for(var v=this._groups,M=v.length,D=0;D<M;++D)for(var G,R=v[D],P=R.length,Q=0;Q<P;++Q)(G=R[Q])&&_r(G,a,l,Q,R,u||Ia(G,l));return new un(v,this._parents,a,l)};var Vo=f(7579),Zo=f(727),Go=f(9751),Uo=f(9646),lu=f(4968),uu=f(590),cu=f(8372);"function"==typeof Symbol&&Symbol.iterator;Math.cos,Math.sin,Math.PI;function fu(a){return typeof a>"u"}Math.tan;function La(a){return"matrix("+a.a+","+a.b+","+a.c+","+a.d+","+a.e+","+a.f+")"}function mu(a){if(Array.isArray(a)){for(var l=0,u=Array(a.length);l<a.length;l++)u[l]=a[l];return u}return Array.from(a)}function gu(a){return Array.isArray(a)?a:Array.from(a)}function ai(){for(var a=arguments.length,l=Array(a),u=0;u<a;u++)l[u]=arguments[u];var v=function(ut,tt){return{a:ut.a*tt.a+ut.c*tt.b,c:ut.a*tt.c+ut.c*tt.d,e:ut.a*tt.e+ut.c*tt.f+ut.e,b:ut.b*tt.a+ut.d*tt.b,d:ut.b*tt.c+ut.d*tt.d,f:ut.b*tt.e+ut.d*tt.f+ut.f}};switch((l=Array.isArray(l[0])?l[0]:l).length){case 0:throw new Error("no matrices provided");case 1:return l[0];case 2:return v(l[0],l[1]);default:var M=l,D=gu(M),R=D[0],P=D[1],G=D.slice(2),Q=v(R,P);return ai.apply(void 0,[Q].concat(mu(G)))}}function Wo(a){var l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{a:1,c:0,e:a,b:0,d:1,f:l}}class jo extends Map{constructor(l,u=li){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:u}}),null!=l)for(const[v,M]of l)this.set(v,M)}get(l){return super.get(Qi(this,l))}has(l){return super.has(Qi(this,l))}set(l,u){return super.set(Ko(this,l),u)}delete(l){return super.delete(Ra(this,l))}}class wc extends Set{constructor(l,u=li){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:u}}),null!=l)for(const v of l)this.add(v)}has(l){return super.has(Qi(this,l))}add(l){return super.add(Ko(this,l))}delete(l){return super.delete(Ra(this,l))}}function Qi({_intern:a,_key:l},u){const v=l(u);return a.has(v)?a.get(v):u}function Ko({_intern:a,_key:l},u){const v=l(u);return a.has(v)?a.get(v):(a.set(v,u),u)}function Ra({_intern:a,_key:l},u){const v=l(u);return a.has(v)&&(u=a.get(v),a.delete(v)),u}function li(a){return null!==a&&"object"==typeof a?a.valueOf():a}function yu(a,l){switch(arguments.length){case 0:break;case 1:this.range(a);break;default:this.range(l).domain(a)}return this}const Ba=Symbol("implicit");function za(){var a=new jo,l=[],u=[],v=Ba;function M(D){let R=a.get(D);if(void 0===R){if(v!==Ba)return v;a.set(D,R=l.push(D)-1)}return u[R%u.length]}return M.domain=function(D){if(!arguments.length)return l.slice();l=[],a=new jo;for(const R of D)a.has(R)||a.set(R,l.push(R)-1);return M},M.range=function(D){return arguments.length?(u=Array.from(D),M):u.slice()},M.unknown=function(D){return arguments.length?(v=D,M):v},M.copy=function(){return za(l,u).unknown(v)},yu.apply(M,arguments),M}var cn=f(9695);function xu(a,l){var u;function v(){var M,R,D=u.length,P=0,G=0;for(M=0;M<D;++M)P+=(R=u[M]).x,G+=R.y;for(P=P/D-a,G=G/D-l,M=0;M<D;++M)(R=u[M]).x-=P,R.y-=G}return null==a&&(a=0),null==l&&(l=0),v.initialize=function(M){u=M},v.x=function(M){return arguments.length?(a=+M,v):a},v.y=function(M){return arguments.length?(l=+M,v):l},v}function ae(a){return function(){return a}}function He(){return 1e-6*(Math.random()-.5)}function _n(a,l,u,v){if(isNaN(l)||isNaN(u))return a;var M,ut,tt,xt,vt,wt,Mt,It,Dt,D=a._root,R={data:v},P=a._x0,G=a._y0,Q=a._x1,rt=a._y1;if(!D)return a._root=R,a;for(;D.length;)if((wt=l>=(ut=(P+Q)/2))?P=ut:Q=ut,(Mt=u>=(tt=(G+rt)/2))?G=tt:rt=tt,M=D,!(D=D[It=Mt<<1|wt]))return M[It]=R,a;if(xt=+a._x.call(null,D.data),vt=+a._y.call(null,D.data),l===xt&&u===vt)return R.next=D,M?M[It]=R:a._root=R,a;do{M=M?M[It]=new Array(4):a._root=new Array(4),(wt=l>=(ut=(P+Q)/2))?P=ut:Q=ut,(Mt=u>=(tt=(G+rt)/2))?G=tt:rt=tt}while((It=Mt<<1|wt)==(Dt=(vt>=tt)<<1|xt>=ut));return M[Dt]=D,M[It]=R,a}function Yt(a,l,u,v,M){this.node=a,this.x0=l,this.y0=u,this.x1=v,this.y1=M}function Xi(a){return a[0]}function qo(a){return a[1]}function ci(a,l,u){var v=new ts(l??Xi,u??qo,NaN,NaN,NaN,NaN);return null==a?v:v.addAll(a)}function ts(a,l,u,v,M,D){this._x=a,this._y=l,this._x0=u,this._y0=v,this._x1=M,this._y1=D,this._root=void 0}function Ua(a){for(var l={data:a.data},u=l;a=a.next;)u=u.next={data:a.data};return l}var Me=ci.prototype=ts.prototype;function bu(a){return a.x+a.vx}function Ja(a){return a.y+a.vy}function es(a){var l,u,v=1,M=1;function D(){for(var G,rt,ut,tt,xt,vt,wt,Q=l.length,Mt=0;Mt<M;++Mt)for(rt=ci(l,bu,Ja).visitAfter(R),G=0;G<Q;++G)ut=l[G],vt=u[ut.index],wt=vt*vt,tt=ut.x+ut.vx,xt=ut.y+ut.vy,rt.visit(It);function It(Dt,Ot,te,re,ve){var ie=Dt.data,ye=Dt.r,ue=vt+ye;if(!ie)return Ot>tt+ue||re<tt-ue||te>xt+ue||ve<xt-ue;if(ie.index>ut.index){var We=tt-ie.x-ie.vx,Te=xt-ie.y-ie.vy,je=We*We+Te*Te;je<ue*ue&&(0===We&&(je+=(We=He())*We),0===Te&&(je+=(Te=He())*Te),je=(ue-(je=Math.sqrt(je)))/je*v,ut.vx+=(We*=je)*(ue=(ye*=ye)/(wt+ye)),ut.vy+=(Te*=je)*ue,ie.vx-=We*(ue=1-ue),ie.vy-=Te*ue)}}}function R(G){if(G.data)return G.r=u[G.data.index];for(var Q=G.r=0;Q<4;++Q)G[Q]&&G[Q].r>G.r&&(G.r=G[Q].r)}function P(){if(l){var G,rt,Q=l.length;for(u=new Array(Q),G=0;G<Q;++G)rt=l[G],u[rt.index]=+a(rt,G,l)}}return"function"!=typeof a&&(a=ae(null==a?1:+a)),D.initialize=function(G){l=G,P()},D.iterations=function(G){return arguments.length?(M=+G,D):M},D.strength=function(G){return arguments.length?(v=+G,D):v},D.radius=function(G){return arguments.length?(a="function"==typeof G?G:ae(+G),P(),D):a},D}Me.copy=function(){var u,v,a=new ts(this._x,this._y,this._x0,this._y0,this._x1,this._y1),l=this._root;if(!l)return a;if(!l.length)return a._root=Ua(l),a;for(u=[{source:l,target:a._root=new Array(4)}];l=u.pop();)for(var M=0;M<4;++M)(v=l.source[M])&&(v.length?u.push({source:v,target:l.target[M]=new Array(4)}):l.target[M]=Ua(v));return a},Me.add=function Qo(a){var l=+this._x.call(null,a),u=+this._y.call(null,a);return _n(this.cover(l,u),l,u,a)},Me.addAll=function Xo(a){var l,u,M,D,v=a.length,R=new Array(v),P=new Array(v),G=1/0,Q=1/0,rt=-1/0,ut=-1/0;for(u=0;u<v;++u)isNaN(M=+this._x.call(null,l=a[u]))||isNaN(D=+this._y.call(null,l))||(R[u]=M,P[u]=D,M<G&&(G=M),M>rt&&(rt=M),D<Q&&(Q=D),D>ut&&(ut=D));if(G>rt||Q>ut)return this;for(this.cover(G,Q).cover(rt,ut),u=0;u<v;++u)_n(this,R[u],P[u],a[u]);return this},Me.cover=function Ve(a,l){if(isNaN(a=+a)||isNaN(l=+l))return this;var u=this._x0,v=this._y0,M=this._x1,D=this._y1;if(isNaN(u))M=(u=Math.floor(a))+1,D=(v=Math.floor(l))+1;else{for(var G,Q,R=M-u,P=this._root;u>a||a>=M||v>l||l>=D;)switch(Q=(l<v)<<1|a<u,G=new Array(4),G[Q]=P,P=G,R*=2,Q){case 0:M=u+R,D=v+R;break;case 1:u=M-R,D=v+R;break;case 2:M=u+R,v=D-R;break;case 3:u=M-R,v=D-R}this._root&&this._root.length&&(this._root=P)}return this._x0=u,this._y0=v,this._x1=M,this._y1=D,this},Me.data=function Tr(){var a=[];return this.visit(function(l){if(!l.length)do{a.push(l.data)}while(l=l.next)}),a},Me.extent=function rr(a){return arguments.length?this.cover(+a[0][0],+a[0][1]).cover(+a[1][0],+a[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},Me.find=function we(a,l,u){var v,R,P,G,Q,vt,wt,M=this._x0,D=this._y0,rt=this._x1,ut=this._y1,tt=[],xt=this._root;for(xt&&tt.push(new Yt(xt,M,D,rt,ut)),null==u?u=1/0:(M=a-u,D=l-u,rt=a+u,ut=l+u,u*=u);vt=tt.pop();)if(!(!(xt=vt.node)||(R=vt.x0)>rt||(P=vt.y0)>ut||(G=vt.x1)<M||(Q=vt.y1)<D))if(xt.length){var Mt=(R+G)/2,It=(P+Q)/2;tt.push(new Yt(xt[3],Mt,It,G,Q),new Yt(xt[2],R,It,Mt,Q),new Yt(xt[1],Mt,P,G,It),new Yt(xt[0],R,P,Mt,It)),(wt=(l>=It)<<1|a>=Mt)&&(vt=tt[tt.length-1],tt[tt.length-1]=tt[tt.length-1-wt],tt[tt.length-1-wt]=vt)}else{var Dt=a-+this._x.call(null,xt.data),Ot=l-+this._y.call(null,xt.data),te=Dt*Dt+Ot*Ot;if(te<u){var re=Math.sqrt(u=te);M=a-re,D=l-re,rt=a+re,ut=l+re,v=xt.data}}return v},Me.remove=function Bn(a){if(isNaN(rt=+this._x.call(null,a))||isNaN(ut=+this._y.call(null,a)))return this;var l,v,M,D,rt,ut,tt,xt,vt,wt,Mt,It,u=this._root,R=this._x0,P=this._y0,G=this._x1,Q=this._y1;if(!u)return this;if(u.length)for(;;){if((vt=rt>=(tt=(R+G)/2))?R=tt:G=tt,(wt=ut>=(xt=(P+Q)/2))?P=xt:Q=xt,l=u,!(u=u[Mt=wt<<1|vt]))return this;if(!u.length)break;(l[Mt+1&3]||l[Mt+2&3]||l[Mt+3&3])&&(v=l,It=Mt)}for(;u.data!==a;)if(M=u,!(u=u.next))return this;return(D=u.next)&&delete u.next,M?(D?M.next=D:delete M.next,this):l?(D?l[Mt]=D:delete l[Mt],(u=l[0]||l[1]||l[2]||l[3])&&u===(l[3]||l[2]||l[1]||l[0])&&!u.length&&(v?v[It]=u:this._root=u),this):(this._root=D,this)},Me.removeAll=function _u(a){for(var l=0,u=a.length;l<u;++l)this.remove(a[l]);return this},Me.root=function Ha(){return this._root},Me.size=function wu(){var a=0;return this.visit(function(l){if(!l.length)do{++a}while(l=l.next)}),a},Me.visit=function Va(a){var u,M,D,R,P,G,l=[],v=this._root;for(v&&l.push(new Yt(v,this._x0,this._y0,this._x1,this._y1));u=l.pop();)if(!a(v=u.node,D=u.x0,R=u.y0,P=u.x1,G=u.y1)&&v.length){var Q=(D+P)/2,rt=(R+G)/2;(M=v[3])&&l.push(new Yt(M,Q,rt,P,G)),(M=v[2])&&l.push(new Yt(M,D,rt,Q,G)),(M=v[1])&&l.push(new Yt(M,Q,R,P,rt)),(M=v[0])&&l.push(new Yt(M,D,R,Q,rt))}return this},Me.visitAfter=function Za(a){var v,l=[],u=[];for(this._root&&l.push(new Yt(this._root,this._x0,this._y0,this._x1,this._y1));v=l.pop();){var M=v.node;if(M.length){var D,R=v.x0,P=v.y0,G=v.x1,Q=v.y1,rt=(R+G)/2,ut=(P+Q)/2;(D=M[0])&&l.push(new Yt(D,R,P,rt,ut)),(D=M[1])&&l.push(new Yt(D,rt,P,G,ut)),(D=M[2])&&l.push(new Yt(D,R,ut,rt,Q)),(D=M[3])&&l.push(new Yt(D,rt,ut,G,Q))}u.push(v)}for(;v=u.pop();)a(v.node,v.x0,v.y0,v.x1,v.y1);return this},Me.x=function ir(a){return arguments.length?(this._x=a,this):this._x},Me.y=function Ga(a){return arguments.length?(this._y=a,this):this._y};var Ze="$";function qi(){}function $a(a,l){var u=new qi;if(a instanceof qi)a.each(function(P,G){u.set(G,P)});else if(Array.isArray(a)){var D,v=-1,M=a.length;if(null==l)for(;++v<M;)u.set(v,a[v]);else for(;++v<M;)u.set(l(D=a[v],v,a),D)}else if(a)for(var R in a)u.set(R,a[R]);return u}qi.prototype=$a.prototype={constructor:qi,has:function(a){return Ze+a in this},get:function(a){return this[Ze+a]},set:function(a,l){return this[Ze+a]=l,this},remove:function(a){var l=Ze+a;return l in this&&delete this[l]},clear:function(){for(var a in this)a[0]===Ze&&delete this[a]},keys:function(){var a=[];for(var l in this)l[0]===Ze&&a.push(l.slice(1));return a},values:function(){var a=[];for(var l in this)l[0]===Ze&&a.push(this[l]);return a},entries:function(){var a=[];for(var l in this)l[0]===Ze&&a.push({key:l.slice(1),value:this[l]});return a},size:function(){var a=0;for(var l in this)l[0]===Ze&&++a;return a},empty:function(){for(var a in this)if(a[0]===Ze)return!1;return!0},each:function(a){for(var l in this)l[0]===Ze&&a(this[l],l.slice(1),this)}};const ns=$a;function eo(){}var Nr=ns.prototype;eo.prototype=function Cc(a,l){var u=new eo;if(a instanceof eo)a.each(function(D){u.add(D)});else if(a){var v=-1,M=a.length;if(null==l)for(;++v<M;)u.add(a[v]);else for(;++v<M;)u.add(l(a[v],v,a))}return u}.prototype={constructor:eo,has:Nr.has,add:function(a){return this[Ze+(a+="")]=a,this},remove:Nr.remove,clear:Nr.clear,values:Nr.keys,size:Nr.size,empty:Nr.empty,each:Nr.each};function ku(a){return a.index}function rs(a,l){var u=a.get(l);if(!u)throw new Error("missing: "+l);return u}function is(a){var v,D,R,P,G,l=ku,u=function rt(wt){return 1/Math.min(P[wt.source.index],P[wt.target.index])},M=ae(30),Q=1;function ut(wt){for(var Mt=0,It=a.length;Mt<Q;++Mt)for(var Ot,te,re,ve,ie,ye,ue,Dt=0;Dt<It;++Dt)te=(Ot=a[Dt]).source,ve=(re=Ot.target).x+re.vx-te.x-te.vx||He(),ie=re.y+re.vy-te.y-te.vy||He(),ve*=ye=((ye=Math.sqrt(ve*ve+ie*ie))-D[Dt])/ye*wt*v[Dt],ie*=ye,re.vx-=ve*(ue=G[Dt]),re.vy-=ie*ue,te.vx+=ve*(ue=1-ue),te.vy+=ie*ue}function tt(){if(R){var wt,Ot,Mt=R.length,It=a.length,Dt=ns(R,l);for(wt=0,P=new Array(Mt);wt<It;++wt)(Ot=a[wt]).index=wt,"object"!=typeof Ot.source&&(Ot.source=rs(Dt,Ot.source)),"object"!=typeof Ot.target&&(Ot.target=rs(Dt,Ot.target)),P[Ot.source.index]=(P[Ot.source.index]||0)+1,P[Ot.target.index]=(P[Ot.target.index]||0)+1;for(wt=0,G=new Array(It);wt<It;++wt)Ot=a[wt],G[wt]=P[Ot.source.index]/(P[Ot.source.index]+P[Ot.target.index]);v=new Array(It),xt(),D=new Array(It),vt()}}function xt(){if(R)for(var wt=0,Mt=a.length;wt<Mt;++wt)v[wt]=+u(a[wt],wt,a)}function vt(){if(R)for(var wt=0,Mt=a.length;wt<Mt;++wt)D[wt]=+M(a[wt],wt,a)}return null==a&&(a=[]),ut.initialize=function(wt){R=wt,tt()},ut.links=function(wt){return arguments.length?(a=wt,tt(),ut):a},ut.id=function(wt){return arguments.length?(l=wt,ut):l},ut.iterations=function(wt){return arguments.length?(Q=+wt,ut):Q},ut.strength=function(wt){return arguments.length?(u="function"==typeof wt?wt:ae(+wt),xt(),ut):u},ut.distance=function(wt){return arguments.length?(M="function"==typeof wt?wt:ae(+wt),vt(),ut):M},ut}function ja(a){return a.x}function Eu(a){return a.y}var Mu=Math.PI*(3-Math.sqrt(5));function ss(a){var l,u=1,v=.001,M=1-Math.pow(v,1/300),D=0,R=.6,P=ns(),G=Kr(rt),Q=go("tick","end");function rt(){ut(),Q.call("tick",l),u<v&&(G.stop(),Q.call("end",l))}function ut(vt){var wt,It,Mt=a.length;void 0===vt&&(vt=1);for(var Dt=0;Dt<vt;++Dt)for(u+=(D-u)*M,P.each(function(Ot){Ot(u)}),wt=0;wt<Mt;++wt)null==(It=a[wt]).fx?It.x+=It.vx*=R:(It.x=It.fx,It.vx=0),null==It.fy?It.y+=It.vy*=R:(It.y=It.fy,It.vy=0);return l}function tt(){for(var Mt,vt=0,wt=a.length;vt<wt;++vt){if((Mt=a[vt]).index=vt,null!=Mt.fx&&(Mt.x=Mt.fx),null!=Mt.fy&&(Mt.y=Mt.fy),isNaN(Mt.x)||isNaN(Mt.y)){var It=10*Math.sqrt(vt),Dt=vt*Mu;Mt.x=It*Math.cos(Dt),Mt.y=It*Math.sin(Dt)}(isNaN(Mt.vx)||isNaN(Mt.vy))&&(Mt.vx=Mt.vy=0)}}function xt(vt){return vt.initialize&&vt.initialize(a),vt}return null==a&&(a=[]),tt(),l={tick:ut,restart:function(){return G.restart(rt),l},stop:function(){return G.stop(),l},nodes:function(vt){return arguments.length?(a=vt,tt(),P.each(xt),l):a},alpha:function(vt){return arguments.length?(u=+vt,l):u},alphaMin:function(vt){return arguments.length?(v=+vt,l):v},alphaDecay:function(vt){return arguments.length?(M=+vt,l):+M},alphaTarget:function(vt){return arguments.length?(D=+vt,l):D},velocityDecay:function(vt){return arguments.length?(R=1-vt,l):1-R},force:function(vt,wt){return arguments.length>1?(null==wt?P.remove(vt):P.set(vt,xt(wt)),l):P.get(vt)},find:function(vt,wt,Mt){var Ot,te,re,ve,ie,It=0,Dt=a.length;for(null==Mt?Mt=1/0:Mt*=Mt,It=0;It<Dt;++It)(re=(Ot=vt-(ve=a[It]).x)*Ot+(te=wt-ve.y)*te)<Mt&&(ie=ve,Mt=re);return ie},on:function(vt,wt){return arguments.length>1?(Q.on(vt,wt),l):Q.on(vt)}}}function ne(){var a,l,u,M,v=ae(-30),D=1,R=1/0,P=.81;function G(tt){var xt,vt=a.length,wt=ci(a,ja,Eu).visitAfter(rt);for(u=tt,xt=0;xt<vt;++xt)l=a[xt],wt.visit(ut)}function Q(){if(a){var tt,vt,xt=a.length;for(M=new Array(xt),tt=0;tt<xt;++tt)vt=a[tt],M[vt.index]=+v(vt,tt,a)}}function rt(tt){var vt,wt,It,Dt,Ot,xt=0,Mt=0;if(tt.length){for(It=Dt=Ot=0;Ot<4;++Ot)(vt=tt[Ot])&&(wt=Math.abs(vt.value))&&(xt+=vt.value,Mt+=wt,It+=wt*vt.x,Dt+=wt*vt.y);tt.x=It/Mt,tt.y=Dt/Mt}else{(vt=tt).x=vt.data.x,vt.y=vt.data.y;do{xt+=M[vt.data.index]}while(vt=vt.next)}tt.value=xt}function ut(tt,xt,vt,wt){if(!tt.value)return!0;var Mt=tt.x-l.x,It=tt.y-l.y,Dt=wt-xt,Ot=Mt*Mt+It*It;if(Dt*Dt/P<Ot)return Ot<R&&(0===Mt&&(Ot+=(Mt=He())*Mt),0===It&&(Ot+=(It=He())*It),Ot<D&&(Ot=Math.sqrt(D*Ot)),l.vx+=Mt*tt.value*u/Ot,l.vy+=It*tt.value*u/Ot),!0;if(!(tt.length||Ot>=R)){(tt.data!==l||tt.next)&&(0===Mt&&(Ot+=(Mt=He())*Mt),0===It&&(Ot+=(It=He())*It),Ot<D&&(Ot=Math.sqrt(D*Ot)));do{tt.data!==l&&(Dt=M[tt.data.index]*u/Ot,l.vx+=Mt*Dt,l.vy+=It*Dt)}while(tt=tt.next)}}return G.initialize=function(tt){a=tt,Q()},G.strength=function(tt){return arguments.length?(v="function"==typeof tt?tt:ae(+tt),Q(),G):v},G.distanceMin=function(tt){return arguments.length?(D=tt*tt,G):Math.sqrt(D)},G.distanceMax=function(tt){return arguments.length?(R=tt*tt,G):Math.sqrt(R)},G.theta=function(tt){return arguments.length?(P=tt*tt,G):Math.sqrt(P)},G}function Tu(a,l,u){var v,D,R,M=ae(.1);function P(Q){for(var rt=0,ut=v.length;rt<ut;++rt){var tt=v[rt],xt=tt.x-l||1e-6,vt=tt.y-u||1e-6,wt=Math.sqrt(xt*xt+vt*vt),Mt=(R[rt]-wt)*D[rt]*Q/wt;tt.vx+=xt*Mt,tt.vy+=vt*Mt}}function G(){if(v){var Q,rt=v.length;for(D=new Array(rt),R=new Array(rt),Q=0;Q<rt;++Q)R[Q]=+a(v[Q],Q,v),D[Q]=isNaN(R[Q])?0:+M(v[Q],Q,v)}}return"function"!=typeof a&&(a=ae(+a)),null==l&&(l=0),null==u&&(u=0),P.initialize=function(Q){v=Q,G()},P.strength=function(Q){return arguments.length?(M="function"==typeof Q?Q:ae(+Q),G(),P):M},P.radius=function(Q){return arguments.length?(a="function"==typeof Q?Q:ae(+Q),G(),P):a},P.x=function(Q){return arguments.length?(l=+Q,P):l},P.y=function(Q){return arguments.length?(u=+Q,P):u},P}function Nu(a){var u,v,M,l=ae(.1);function D(P){for(var rt,G=0,Q=u.length;G<Q;++G)(rt=u[G]).vx+=(M[G]-rt.x)*v[G]*P}function R(){if(u){var P,G=u.length;for(v=new Array(G),M=new Array(G),P=0;P<G;++P)v[P]=isNaN(M[P]=+a(u[P],P,u))?0:+l(u[P],P,u)}}return"function"!=typeof a&&(a=ae(null==a?0:+a)),D.initialize=function(P){u=P,R()},D.strength=function(P){return arguments.length?(l="function"==typeof P?P:ae(+P),R(),D):l},D.x=function(P){return arguments.length?(a="function"==typeof P?P:ae(+P),R(),D):a},D}function Su(a){var u,v,M,l=ae(.1);function D(P){for(var rt,G=0,Q=u.length;G<Q;++G)(rt=u[G]).vy+=(M[G]-rt.y)*v[G]*P}function R(){if(u){var P,G=u.length;for(v=new Array(G),M=new Array(G),P=0;P<G;++P)v[P]=isNaN(M[P]=+a(u[P],P,u))?0:+l(u[P],P,u)}}return"function"!=typeof a&&(a=ae(null==a?0:+a)),D.initialize=function(P){u=P,R()},D.strength=function(P){return arguments.length?(l="function"==typeof P?P:ae(+P),R(),D):l},D.y=function(P){return arguments.length?(a="function"==typeof P?P:ae(+P),R(),D):a},D}var Qa=f(7824);function Xa(a,l,u){var v=new yr,M=l;return null==l?(v.restart(a,l,u),v):(l=+l,u=null==u?Gt():+u,v.restart(function D(R){R+=M,v.restart(D,M+=l,u),a(R)},l,u),v)}const qa=["linkTemplate"],as=["nodeTemplate"],kc=["clusterTemplate"],Iu=["defsTemplate"],Ou=["miniMapNodeTemplate"],Au=["nodeElement"],tl=["linkElement"];function Du(a,l){if(1&a&&(o.O4$(),o.GkF(0,14)),2&a){const u=o.oxw(2);o.Q6J("ngTemplateOutlet",u.defsTemplate)}}function Pu(a,l){if(1&a&&(o.O4$(),o._UZ(0,"path",15)),2&a){const u=l.$implicit;o.uIk("d",u.textPath)("id",u.id)}}const Sr=function(a){return{$implicit:a}};function Ec(a,l){if(1&a&&(o.O4$(),o.GkF(0,20)),2&a){const u=o.oxw().$implicit,v=o.oxw(2);o.Q6J("ngTemplateOutlet",v.clusterTemplate)("ngTemplateOutletContext",o.VKq(2,Sr,u))}}function Mc(a,l){if(1&a&&(o.O4$(),o.TgZ(0,"g",21),o._UZ(1,"rect"),o.TgZ(2,"text",22),o._uU(3),o.qZA()()),2&a){const u=o.oxw().$implicit;o.xp6(1),o.uIk("width",u.dimension.width)("height",u.dimension.height)("fill",null==u.data?null:u.data.color),o.xp6(1),o.uIk("x",10)("y",u.dimension.height/2),o.xp6(1),o.hij(" ",u.label," ")}}function Tc(a,l){if(1&a){const u=o.EpF();o.O4$(),o.TgZ(0,"g",16,17),o.NdJ("click",function(){const D=o.CHM(u).$implicit,R=o.oxw(2);return o.KtG(R.onClick(D))}),o.YNc(2,Ec,1,4,"ng-container",18),o.YNc(3,Mc,4,6,"g",19),o.qZA()}if(2&a){const u=l.$implicit,v=o.oxw(2);o.ekj("old-node",v.animate&&v.oldClusters.has(u.id)),o.Q6J("id",u.id),o.uIk("transform",u.transform),o.xp6(2),o.Q6J("ngIf",v.clusterTemplate),o.xp6(1),o.Q6J("ngIf",!v.clusterTemplate)}}function Nc(a,l){if(1&a&&(o.O4$(),o.GkF(0,20)),2&a){const u=o.oxw().$implicit,v=o.oxw(2);o.Q6J("ngTemplateOutlet",v.linkTemplate)("ngTemplateOutletContext",o.VKq(2,Sr,u))}}function Sc(a,l){if(1&a&&(o.O4$(),o._UZ(0,"path",26)),2&a){const u=o.oxw().$implicit;o.uIk("d",u.line)}}function Ic(a,l){if(1&a&&(o.O4$(),o.TgZ(0,"g",23,24),o.YNc(2,Nc,1,4,"ng-container",18),o.YNc(3,Sc,1,1,"path",25),o.qZA()),2&a){const u=l.$implicit,v=o.oxw(2);o.Q6J("id",u.id),o.xp6(2),o.Q6J("ngIf",v.linkTemplate),o.xp6(1),o.Q6J("ngIf",!v.linkTemplate)}}function Oc(a,l){if(1&a&&(o.O4$(),o.GkF(0,20)),2&a){const u=o.oxw().$implicit,v=o.oxw(2);o.Q6J("ngTemplateOutlet",v.nodeTemplate)("ngTemplateOutletContext",o.VKq(2,Sr,u))}}function Ac(a,l){if(1&a&&(o.O4$(),o._UZ(0,"circle",30)),2&a){const u=o.oxw().$implicit;o.uIk("cx",u.dimension.width/2)("cy",u.dimension.height/2)("fill",null==u.data?null:u.data.color)}}function Lu(a,l){if(1&a){const u=o.EpF();o.O4$(),o.TgZ(0,"g",27,28),o.NdJ("click",function(){const D=o.CHM(u).$implicit,R=o.oxw(2);return o.KtG(R.onClick(D))})("mousedown",function(M){const R=o.CHM(u).$implicit,P=o.oxw(2);return o.KtG(P.onNodeMouseDown(M,R))}),o.YNc(2,Oc,1,4,"ng-container",18),o.YNc(3,Ac,1,3,"circle",29),o.qZA()}if(2&a){const u=l.$implicit,v=o.oxw(2);o.ekj("old-node",v.animate&&v.oldNodes.has(u.id)),o.Q6J("id",u.id),o.uIk("transform",u.transform),o.xp6(2),o.Q6J("ngIf",v.nodeTemplate),o.xp6(1),o.Q6J("ngIf",!v.nodeTemplate)}}function Fu(a,l){if(1&a){const u=o.EpF();o.O4$(),o.TgZ(0,"g",4),o.NdJ("touchstart",function(M){o.CHM(u);const D=o.oxw();return o.KtG(D.onTouchStart(M))})("touchend",function(M){o.CHM(u);const D=o.oxw();return o.KtG(D.onTouchEnd(M))}),o.TgZ(1,"defs"),o.YNc(2,Du,1,1,"ng-container",5),o.YNc(3,Pu,1,2,"path",6),o.qZA(),o.TgZ(4,"rect",7),o.NdJ("mousedown",function(){o.CHM(u);const M=o.oxw();return o.KtG(M.isPanning=!0)}),o.qZA(),o.Hsn(5),o.TgZ(6,"g",8),o.YNc(7,Tc,4,6,"g",9),o.qZA(),o.TgZ(8,"g",10),o.YNc(9,Ic,4,3,"g",11),o.qZA(),o.TgZ(10,"g",12),o.YNc(11,Lu,4,6,"g",13),o.qZA()()}if(2&a){const u=o.oxw();o.uIk("transform",u.transform),o.xp6(2),o.Q6J("ngIf",u.defsTemplate),o.xp6(1),o.Q6J("ngForOf",u.graph.edges),o.xp6(1),o.uIk("width",100*u.dims.width)("height",100*u.dims.height)("transform","translate("+50*(-u.dims.width||0)+","+50*(-u.dims.height||0)+")"),o.xp6(3),o.Q6J("ngForOf",u.graph.clusters)("ngForTrackBy",u.trackNodeBy),o.xp6(2),o.Q6J("ngForOf",u.graph.edges)("ngForTrackBy",u.trackLinkBy),o.xp6(2),o.Q6J("ngForOf",u.graph.nodes)("ngForTrackBy",u.trackNodeBy)}}function Ru(a,l){if(1&a&&(o.O4$(),o.GkF(0,20)),2&a){const u=o.oxw().$implicit,v=o.oxw(2);o.Q6J("ngTemplateOutlet",v.miniMapNodeTemplate)("ngTemplateOutletContext",o.VKq(2,Sr,u))}}function Bu(a,l){if(1&a&&(o.O4$(),o.GkF(0,20)),2&a){const u=o.oxw().$implicit,v=o.oxw(2);o.Q6J("ngTemplateOutlet",v.nodeTemplate)("ngTemplateOutletContext",o.VKq(2,Sr,u))}}function zu(a,l){if(1&a&&(o.O4$(),o._UZ(0,"circle",30)),2&a){const u=o.oxw().$implicit,v=o.oxw(2);o.uIk("cx",u.dimension.width/2/v.minimapScaleCoefficient)("cy",u.dimension.height/2/v.minimapScaleCoefficient)("fill",null==u.data?null:u.data.color)}}function Hu(a,l){if(1&a&&(o.O4$(),o.TgZ(0,"g",36,28),o.YNc(2,Ru,1,4,"ng-container",18),o.YNc(3,Bu,1,4,"ng-container",18),o.YNc(4,zu,1,3,"circle",29),o.qZA()),2&a){const u=l.$implicit,v=o.oxw(2);o.ekj("old-node",v.animate&&v.oldNodes.has(u.id)),o.Q6J("id",u.id),o.uIk("transform",u.transform),o.xp6(2),o.Q6J("ngIf",v.miniMapNodeTemplate),o.xp6(1),o.Q6J("ngIf",!v.miniMapNodeTemplate&&v.nodeTemplate),o.xp6(1),o.Q6J("ngIf",!v.nodeTemplate&&!v.miniMapNodeTemplate)}}function Vu(a,l){if(1&a){const u=o.EpF();o.O4$(),o.TgZ(0,"g",31)(1,"rect",32),o.NdJ("mousedown",function(M){o.CHM(u);const D=o.oxw();return o.KtG(D.onMinimapPanTo(M))}),o.qZA(),o.TgZ(2,"g")(3,"g",33),o.YNc(4,Hu,5,7,"g",34),o.qZA(),o.TgZ(5,"rect",35),o.NdJ("mousedown",function(){o.CHM(u);const M=o.oxw();return o.KtG(M.onMinimapDragMouseDown())}),o.qZA()()()}if(2&a){const u=o.oxw();o.uIk("transform",u.minimapTransform)("clip-path","url(#"+u.minimapClipPathId+")"),o.xp6(1),o.uIk("width",u.graphDims.width/u.minimapScaleCoefficient)("height",u.graphDims.height/u.minimapScaleCoefficient),o.xp6(1),o.Udp("transform","translate("+-u.minimapOffsetX/u.minimapScaleCoefficient+"px,"+-u.minimapOffsetY/u.minimapScaleCoefficient+"px)"),o.xp6(1),o.Udp("transform","scale("+1/u.minimapScaleCoefficient+")"),o.xp6(1),o.Q6J("ngForOf",u.graph.nodes)("ngForTrackBy",u.trackNodeBy),o.xp6(1),o.ekj("panning",u.isMinimapPanning),o.uIk("transform","translate("+u.panOffsetX/u.zoomLevel/-u.minimapScaleCoefficient+","+u.panOffsetY/u.zoomLevel/-u.minimapScaleCoefficient+")")("width",u.width/u.minimapScaleCoefficient/u.zoomLevel)("height",u.height/u.minimapScaleCoefficient/u.zoomLevel)}}const el={};function wn(){let a=("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4);return a=`a${a}`,el[a]?wn():(el[a]=!0,a)}var hi,a,di;function Gu(a,l,u){u=u||{};let v,M,D,R=null,P=0;function G(){P=!1===u.leading?0:+new Date,R=null,D=a.apply(v,M)}return function(...Q){const rt=+new Date;!P&&!1===u.leading&&(P=rt);const ut=l-(rt-P);return v=this,M=Q,ut<=0?(clearTimeout(R),R=null,P=rt,D=a.apply(v,M)):!R&&!1!==u.trailing&&(R=setTimeout(G,ut)),D}}(a=hi||(hi={})).Both="both",a.Horizontal="horizontal",a.Vertical="vertical",function(a){a.UpperLeft="UpperLeft",a.UpperRight="UpperRight"}(di||(di={}));const fi=[{name:"vivid",selectable:!0,group:"Ordinal",domain:["#647c8a","#3f51b5","#2196f3","#00b862","#afdf0a","#a7b61a","#f3e562","#ff9800","#ff5722","#ff4514"]},{name:"natural",selectable:!0,group:"Ordinal",domain:["#bf9d76","#e99450","#d89f59","#f2dfa7","#a5d7c6","#7794b1","#afafaf","#707160","#ba9383","#d9d5c3"]},{name:"cool",selectable:!0,group:"Ordinal",domain:["#a8385d","#7aa3e5","#a27ea8","#aae3f5","#adcded","#a95963","#8796c0","#7ed3ed","#50abcc","#ad6886"]},{name:"fire",selectable:!0,group:"Ordinal",domain:["#ff3d00","#bf360c","#ff8f00","#ff6f00","#ff5722","#e65100","#ffca28","#ffab00"]},{name:"solar",selectable:!0,group:"Continuous",domain:["#fff8e1","#ffecb3","#ffe082","#ffd54f","#ffca28","#ffc107","#ffb300","#ffa000","#ff8f00","#ff6f00"]},{name:"air",selectable:!0,group:"Continuous",domain:["#e1f5fe","#b3e5fc","#81d4fa","#4fc3f7","#29b6f6","#03a9f4","#039be5","#0288d1","#0277bd","#01579b"]},{name:"aqua",selectable:!0,group:"Continuous",domain:["#e0f7fa","#b2ebf2","#80deea","#4dd0e1","#26c6da","#00bcd4","#00acc1","#0097a7","#00838f","#006064"]},{name:"flame",selectable:!1,group:"Ordinal",domain:["#A10A28","#D3342D","#EF6D49","#FAAD67","#FDDE90","#DBED91","#A9D770","#6CBA67","#2C9653","#146738"]},{name:"ocean",selectable:!1,group:"Ordinal",domain:["#1D68FB","#33C0FC","#4AFFFE","#AFFFFF","#FFFC63","#FDBD2D","#FC8A25","#FA4F1E","#FA141B","#BA38D1"]},{name:"forest",selectable:!1,group:"Ordinal",domain:["#55C22D","#C1F33D","#3CC099","#AFFFFF","#8CFC9D","#76CFFA","#BA60FB","#EE6490","#C42A1C","#FC9F32"]},{name:"horizon",selectable:!1,group:"Ordinal",domain:["#2597FB","#65EBFD","#99FDD0","#FCEE4B","#FEFCFA","#FDD6E3","#FCB1A8","#EF6F7B","#CB96E8","#EFDEE0"]},{name:"neons",selectable:!1,group:"Ordinal",domain:["#FF3333","#FF33FF","#CC33FF","#0000FF","#33CCFF","#33FFFF","#33FF66","#CCFF33","#FFCC00","#FF6600"]},{name:"picnic",selectable:!1,group:"Ordinal",domain:["#FAC51D","#66BD6D","#FAA026","#29BB9C","#E96B56","#55ACD2","#B7332F","#2C83C9","#9166B8","#92E7E8"]},{name:"night",selectable:!1,group:"Ordinal",domain:["#2B1B5A","#501356","#183356","#28203F","#391B3C","#1E2B3C","#120634","#2D0432","#051932","#453080","#75267D","#2C507D","#4B3880","#752F7D","#35547D"]},{name:"nightLights",selectable:!1,group:"Ordinal",domain:["#4e31a5","#9c25a7","#3065ab","#57468b","#904497","#46648b","#32118d","#a00fb3","#1052a2","#6e51bd","#b63cc3","#6c97cb","#8671c1","#b455be","#7496c3"]}];class nl{constructor(l,u,v){"string"==typeof l&&(l=fi.find(M=>M.name===l)),this.colorDomain=l.domain,this.domain=u,this.customColors=v,this.scale=this.generateColorScheme(l,this.domain)}generateColorScheme(l,u){return"string"==typeof l&&(l=fi.find(v=>v.name===l)),za().range(l.domain).domain(u)}getColor(l){if(null==l)throw new Error("Value can not be null");if("function"==typeof this.customColors)return this.customColors(l);const u=l.toString();let v;return this.customColors&&this.customColors.length>0&&(v=this.customColors.find(M=>M.name.toLowerCase()===u.toLowerCase())),v?v.value:this.scale(l)}}class pi{constructor(l,u){this.element=l,this.zone=u,this.visible=new o.vpe,this.isVisible=!1,this.runCheck()}destroy(){clearTimeout(this.timeout)}onVisibilityChange(){this.zone.run(()=>{this.isVisible=!0,this.visible.emit(!0)})}runCheck(){const l=()=>{if(!this.element)return;const{offsetHeight:u,offsetWidth:v}=this.element.nativeElement;u&&v?(clearTimeout(this.timeout),this.onVisibilityChange()):(clearTimeout(this.timeout),this.zone.runOutsideAngular(()=>{this.timeout=setTimeout(()=>l(),100)}))};this.zone.runOutsideAngular(()=>{this.timeout=setTimeout(()=>l())})}}var Ir,Ju;pi.\u0275fac=function(l){return new(l||pi)(o.Y36(o.SBq),o.Y36(o.R0b))},pi.\u0275dir=o.lG2({type:pi,selectors:[["visibility-observer"]],outputs:{visible:"visible"}}),function(a){a.LEFT_TO_RIGHT="LR",a.RIGHT_TO_LEFT="RL",a.TOP_TO_BOTTOM="TB",a.BOTTOM_TO_TOM="BT"}(Ir||(Ir={})),function(a){a.CENTER="C",a.UP_LEFT="UL",a.UP_RIGHT="UR",a.DOWN_LEFT="DL",a.DOWN_RIGHT="DR"}(Ju||(Ju={}));function Ar(a){return"string"==typeof a?{id:a,x:0,y:0}:a}function Wu(a,l){return"number"==typeof l?a[l]:l}const sl={dagre:class il{constructor(){this.defaultSettings={orientation:Ir.LEFT_TO_RIGHT,marginX:20,marginY:20,edgePadding:100,rankPadding:100,nodePadding:50,multigraph:!0,compound:!0},this.settings={}}run(l){this.createDagreGraph(l),cn.layout(this.dagreGraph),l.edgeLabels=this.dagreGraph._edgeLabels;for(const u in this.dagreGraph._nodes){const v=this.dagreGraph._nodes[u],M=l.nodes.find(D=>D.id===v.id);M.position={x:v.x,y:v.y},M.dimension={width:v.width,height:v.height}}return l}updateEdge(l,u){const v=l.nodes.find(G=>G.id===u.source),M=l.nodes.find(G=>G.id===u.target),D=v.position.y<=M.position.y?-1:1,R={x:v.position.x,y:v.position.y-D*(v.dimension.height/2)},P={x:M.position.x,y:M.position.y+D*(M.dimension.height/2)};return u.points=[R,P],l}createDagreGraph(l){const u=Object.assign({},this.defaultSettings,this.settings);this.dagreGraph=new cn.graphlib.Graph({compound:u.compound,multigraph:u.multigraph}),this.dagreGraph.setGraph({rankdir:u.orientation,marginx:u.marginX,marginy:u.marginY,edgesep:u.edgePadding,ranksep:u.rankPadding,nodesep:u.nodePadding,align:u.align,acyclicer:u.acyclicer,ranker:u.ranker,multigraph:u.multigraph,compound:u.compound}),this.dagreGraph.setDefaultEdgeLabel(()=>({})),this.dagreNodes=l.nodes.map(v=>{const M=Object.assign({},v);return M.width=v.dimension.width,M.height=v.dimension.height,M.x=v.position.x,M.y=v.position.y,M}),this.dagreEdges=l.edges.map(v=>{const M=Object.assign({},v);return M.id||(M.id=wn()),M});for(const v of this.dagreNodes)v.width||(v.width=20),v.height||(v.height=30),this.dagreGraph.setNode(v.id,v);for(const v of this.dagreEdges)u.multigraph?this.dagreGraph.setEdge(v.source,v.target,v,v.id):this.dagreGraph.setEdge(v.source,v.target);return this.dagreGraph}},dagreCluster:class Or{constructor(){this.defaultSettings={orientation:Ir.LEFT_TO_RIGHT,marginX:20,marginY:20,edgePadding:100,rankPadding:100,nodePadding:50,multigraph:!0,compound:!0},this.settings={}}run(l){this.createDagreGraph(l),cn.layout(this.dagreGraph),l.edgeLabels=this.dagreGraph._edgeLabels;const u=v=>{const M=this.dagreGraph._nodes[v.id];return{...v,position:{x:M.x,y:M.y},dimension:{width:M.width,height:M.height}}};return l.clusters=(l.clusters||[]).map(u),l.nodes=l.nodes.map(u),l}updateEdge(l,u){const v=l.nodes.find(G=>G.id===u.source),M=l.nodes.find(G=>G.id===u.target),D=v.position.y<=M.position.y?-1:1,R={x:v.position.x,y:v.position.y-D*(v.dimension.height/2)},P={x:M.position.x,y:M.position.y+D*(M.dimension.height/2)};return u.points=[R,P],l}createDagreGraph(l){const u=Object.assign({},this.defaultSettings,this.settings);this.dagreGraph=new cn.graphlib.Graph({compound:u.compound,multigraph:u.multigraph}),this.dagreGraph.setGraph({rankdir:u.orientation,marginx:u.marginX,marginy:u.marginY,edgesep:u.edgePadding,ranksep:u.rankPadding,nodesep:u.nodePadding,align:u.align,acyclicer:u.acyclicer,ranker:u.ranker,multigraph:u.multigraph,compound:u.compound}),this.dagreGraph.setDefaultEdgeLabel(()=>({})),this.dagreNodes=l.nodes.map(v=>{const M=Object.assign({},v);return M.width=v.dimension.width,M.height=v.dimension.height,M.x=v.position.x,M.y=v.position.y,M}),this.dagreClusters=l.clusters||[],this.dagreEdges=l.edges.map(v=>{const M=Object.assign({},v);return M.id||(M.id=wn()),M});for(const v of this.dagreNodes)this.dagreGraph.setNode(v.id,v);for(const v of this.dagreClusters)this.dagreGraph.setNode(v.id,v),v.childNodeIds.forEach(M=>{this.dagreGraph.setParent(M,v.id)});for(const v of this.dagreEdges)u.multigraph?this.dagreGraph.setEdge(v.source,v.target,v,v.id):this.dagreGraph.setEdge(v.source,v.target);return this.dagreGraph}},dagreNodesOnly:class Yu{constructor(){this.defaultSettings={orientation:Ir.LEFT_TO_RIGHT,marginX:20,marginY:20,edgePadding:100,rankPadding:100,nodePadding:50,curveDistance:20,multigraph:!0,compound:!0},this.settings={}}run(l){this.createDagreGraph(l),cn.layout(this.dagreGraph),l.edgeLabels=this.dagreGraph._edgeLabels;for(const u in this.dagreGraph._nodes){const v=this.dagreGraph._nodes[u],M=l.nodes.find(D=>D.id===v.id);M.position={x:v.x,y:v.y},M.dimension={width:v.width,height:v.height}}for(const u of l.edges)this.updateEdge(l,u);return l}updateEdge(l,u){const v=l.nodes.find(vt=>vt.id===u.source),M=l.nodes.find(vt=>vt.id===u.target),D="BT"===this.settings.orientation||"TB"===this.settings.orientation?"y":"x",R="y"===D?"x":"y",P="y"===D?"height":"width",G=v.position[D]<=M.position[D]?-1:1,Q={[R]:v.position[R],[D]:v.position[D]-G*(v.dimension[P]/2)},rt={[R]:M.position[R],[D]:M.position[D]+G*(M.dimension[P]/2)},ut=this.settings.curveDistance||this.defaultSettings.curveDistance;u.points=[Q,{[R]:Q[R],[D]:Q[D]-G*ut},{[R]:rt[R],[D]:rt[D]+G*ut},rt];const tt=`${u.source}\x01${u.target}\x01\0`,xt=l.edgeLabels[tt];return xt&&(xt.points=u.points),l}createDagreGraph(l){const u=Object.assign({},this.defaultSettings,this.settings);this.dagreGraph=new cn.graphlib.Graph({compound:u.compound,multigraph:u.multigraph}),this.dagreGraph.setGraph({rankdir:u.orientation,marginx:u.marginX,marginy:u.marginY,edgesep:u.edgePadding,ranksep:u.rankPadding,nodesep:u.nodePadding,align:u.align,acyclicer:u.acyclicer,ranker:u.ranker,multigraph:u.multigraph,compound:u.compound}),this.dagreGraph.setDefaultEdgeLabel(()=>({})),this.dagreNodes=l.nodes.map(v=>{const M=Object.assign({},v);return M.width=v.dimension.width,M.height=v.dimension.height,M.x=v.position.x,M.y=v.position.y,M}),this.dagreEdges=l.edges.map(v=>{const M=Object.assign({},v);return M.id||(M.id=wn()),M});for(const v of this.dagreNodes)v.width||(v.width=20),v.height||(v.height=30),this.dagreGraph.setNode(v.id,v);for(const v of this.dagreEdges)u.multigraph?this.dagreGraph.setEdge(v.source,v.target,v,v.id):this.dagreGraph.setEdge(v.source,v.target);return this.dagreGraph}},d3ForceDirected:class us{constructor(){this.defaultSettings={force:ss().force("charge",ne().strength(-150)).force("collide",es(5)),forceLink:is().id(l=>l.id).distance(()=>100)},this.settings={},this.outputGraph$=new Vo.x}run(l){return this.inputGraph=l,this.d3Graph={nodes:[...this.inputGraph.nodes.map(u=>({...u}))],edges:[...this.inputGraph.edges.map(u=>({...u}))]},this.outputGraph={nodes:[],edges:[],edgeLabels:[]},this.outputGraph$.next(this.outputGraph),this.settings=Object.assign({},this.defaultSettings,this.settings),this.settings.force&&this.settings.force.nodes(this.d3Graph.nodes).force("link",this.settings.forceLink.links(this.d3Graph.edges)).alpha(.5).restart().on("tick",()=>{this.outputGraph$.next(this.d3GraphToOutputGraph(this.d3Graph))}),this.outputGraph$.asObservable()}updateEdge(l,u){const v=Object.assign({},this.defaultSettings,this.settings);return v.force&&v.force.nodes(this.d3Graph.nodes).force("link",v.forceLink.links(this.d3Graph.edges)).alpha(.5).restart().on("tick",()=>{this.outputGraph$.next(this.d3GraphToOutputGraph(this.d3Graph))}),this.outputGraph$.asObservable()}d3GraphToOutputGraph(l){return this.outputGraph.nodes=this.d3Graph.nodes.map(u=>({...u,id:u.id||wn(),position:{x:u.x,y:u.y},dimension:{width:u.dimension&&u.dimension.width||20,height:u.dimension&&u.dimension.height||20},transform:`translate(${u.x-(u.dimension&&u.dimension.width||20)/2||0}, ${u.y-(u.dimension&&u.dimension.height||20)/2||0})`})),this.outputGraph.edges=this.d3Graph.edges.map(u=>({...u,source:Ar(u.source).id,target:Ar(u.target).id,points:[{x:Ar(u.source).x,y:Ar(u.source).y},{x:Ar(u.target).x,y:Ar(u.target).y}]})),this.outputGraph.edgeLabels=this.outputGraph.edges,this.outputGraph}onDragStart(l,u){this.settings.force.alphaTarget(.3).restart();const v=this.d3Graph.nodes.find(M=>M.id===l.id);v&&(this.draggingStart={x:u.x-v.x,y:u.y-v.y},v.fx=u.x-this.draggingStart.x,v.fy=u.y-this.draggingStart.y)}onDrag(l,u){if(!l)return;const v=this.d3Graph.nodes.find(M=>M.id===l.id);v&&(v.fx=u.x-this.draggingStart.x,v.fy=u.y-this.draggingStart.y)}onDragEnd(l,u){if(!l)return;const v=this.d3Graph.nodes.find(M=>M.id===l.id);v&&(this.settings.force.alphaTarget(0),v.fx=void 0,v.fy=void 0)}},colaForceDirected:class Dc{constructor(){this.defaultSettings={force:(0,Qa.d3adaptor)({...E,...m,...h}).linkDistance(150).avoidOverlaps(!0),viewDimensions:{width:600,height:600}},this.settings={},this.outputGraph$=new Vo.x}run(l){return this.inputGraph=l,this.inputGraph.clusters||(this.inputGraph.clusters=[]),this.internalGraph={nodes:[...this.inputGraph.nodes.map(u=>({...u,width:u.dimension?u.dimension.width:20,height:u.dimension?u.dimension.height:20}))],groups:[...this.inputGraph.clusters.map(u=>({padding:5,groups:u.childNodeIds.map(v=>this.inputGraph.clusters.findIndex(M=>M.id===v)).filter(v=>v>=0),leaves:u.childNodeIds.map(v=>this.inputGraph.nodes.findIndex(M=>M.id===v)).filter(v=>v>=0)}))],links:[...this.inputGraph.edges.map(u=>{const v=this.inputGraph.nodes.findIndex(D=>u.source===D.id),M=this.inputGraph.nodes.findIndex(D=>u.target===D.id);if(-1!==v&&-1!==M)return{...u,source:v,target:M}}).filter(u=>!!u)],groupLinks:[...this.inputGraph.edges.map(u=>{const v=this.inputGraph.nodes.findIndex(D=>u.source===D.id),M=this.inputGraph.nodes.findIndex(D=>u.target===D.id);if(!(v>=0&&M>=0))return u}).filter(u=>!!u)]},this.outputGraph={nodes:[],clusters:[],edges:[],edgeLabels:[]},this.outputGraph$.next(this.outputGraph),this.settings=Object.assign({},this.defaultSettings,this.settings),this.settings.force&&(this.settings.force=this.settings.force.nodes(this.internalGraph.nodes).groups(this.internalGraph.groups).links(this.internalGraph.links).alpha(.5).on("tick",()=>{this.settings.onTickListener&&this.settings.onTickListener(this.internalGraph),this.outputGraph$.next(this.internalGraphToOutputGraph(this.internalGraph))}),this.settings.viewDimensions&&(this.settings.force=this.settings.force.size([this.settings.viewDimensions.width,this.settings.viewDimensions.height])),this.settings.forceModifierFn&&(this.settings.force=this.settings.forceModifierFn(this.settings.force)),this.settings.force.start()),this.outputGraph$.asObservable()}updateEdge(l,u){const v=Object.assign({},this.defaultSettings,this.settings);return v.force&&v.force.start(),this.outputGraph$.asObservable()}internalGraphToOutputGraph(l){return this.outputGraph.nodes=l.nodes.map(u=>({...u,id:u.id||wn(),position:{x:u.x,y:u.y},dimension:{width:u.dimension&&u.dimension.width||20,height:u.dimension&&u.dimension.height||20},transform:`translate(${u.x-(u.dimension&&u.dimension.width||20)/2||0}, ${u.y-(u.dimension&&u.dimension.height||20)/2||0})`})),this.outputGraph.edges=l.links.map(u=>{const v=Wu(l.nodes,u.source),M=Wu(l.nodes,u.target);return{...u,source:v.id,target:M.id,points:[v.bounds.rayIntersection(M.bounds.cx(),M.bounds.cy()),M.bounds.rayIntersection(v.bounds.cx(),v.bounds.cy())]}}).concat(l.groupLinks.map(u=>{const v=l.nodes.find(P=>P.id===u.source),M=l.nodes.find(P=>P.id===u.target),D=v||l.groups.find(P=>P.id===u.source),R=M||l.groups.find(P=>P.id===u.target);return{...u,source:D.id,target:R.id,points:[D.bounds.rayIntersection(R.bounds.cx(),R.bounds.cy()),R.bounds.rayIntersection(D.bounds.cx(),D.bounds.cy())]}})),this.outputGraph.clusters=l.groups.map((u,v)=>({...this.inputGraph.clusters[v],dimension:{width:u.bounds?u.bounds.width():20,height:u.bounds?u.bounds.height():20},position:{x:u.bounds?u.bounds.x+u.bounds.width()/2:0,y:u.bounds?u.bounds.y+u.bounds.height()/2:0}})),this.outputGraph.edgeLabels=this.outputGraph.edges,this.outputGraph}onDragStart(l,u){const v=this.outputGraph.nodes.findIndex(D=>D.id===l.id),M=this.internalGraph.nodes[v];M&&(this.draggingStart={x:M.x-u.x,y:M.y-u.y},M.fixed=1,this.settings.force.start())}onDrag(l,u){if(!l)return;const v=this.outputGraph.nodes.findIndex(D=>D.id===l.id),M=this.internalGraph.nodes[v];M&&(M.x=this.draggingStart.x+u.x,M.y=this.draggingStart.y+u.y)}onDragEnd(l,u){if(!l)return;const v=this.outputGraph.nodes.findIndex(D=>D.id===l.id),M=this.internalGraph.nodes[v];M&&(M.fixed=0)}}};class zn{getLayout(l){if(sl[l])return new sl[l];throw new Error(`Unknown layout type '${l}'`)}}zn.\u0275fac=function(l){return new(l||zn)},zn.\u0275prov=o.Yz7({token:zn,factory:zn.\u0275fac});class or{constructor(){this.mouseWheelUp=new o.vpe,this.mouseWheelDown=new o.vpe}onMouseWheelChrome(l){this.mouseWheelFunc(l)}onMouseWheelFirefox(l){this.mouseWheelFunc(l)}onWheel(l){this.mouseWheelFunc(l)}onMouseWheelIE(l){this.mouseWheelFunc(l)}mouseWheelFunc(l){window.event&&(l=window.event);const u=Math.max(-1,Math.min(1,l.wheelDelta||-l.detail||l.deltaY||l.deltaX)),v=l.wheelDelta?u>0:u<0,M=l.wheelDelta?u<0:u>0;v?this.mouseWheelUp.emit(l):M&&this.mouseWheelDown.emit(l),l.returnValue=!1,l.preventDefault&&l.preventDefault()}}or.\u0275fac=function(l){return new(l||or)},or.\u0275dir=o.lG2({type:or,selectors:[["","mouseWheel",""]],hostBindings:function(l,u){1&l&&o.NdJ("mousewheel",function(M){return u.onMouseWheelChrome(M)})("DOMMouseScroll",function(M){return u.onMouseWheelFirefox(M)})("wheel",function(M){return u.onWheel(M)})("onmousewheel",function(M){return u.onMouseWheelIE(M)})},outputs:{mouseWheelUp:"mouseWheelUp",mouseWheelDown:"mouseWheelDown"}});class Hn{constructor(l,u,v,M){this.el=l,this.zone=u,this.cd=v,this.layoutService=M,this.nodes=[],this.clusters=[],this.links=[],this.activeEntries=[],this.draggingEnabled=!0,this.panningEnabled=!0,this.panningAxis=hi.Both,this.enableZoom=!0,this.zoomSpeed=.1,this.minZoomLevel=.1,this.maxZoomLevel=4,this.autoZoom=!1,this.panOnZoom=!0,this.animate=!1,this.autoCenter=!1,this.enableTrackpadSupport=!1,this.showMiniMap=!1,this.miniMapMaxWidth=100,this.miniMapPosition=di.UpperRight,this.scheme="cool",this.animations=!0,this.select=new o.vpe,this.activate=new o.vpe,this.deactivate=new o.vpe,this.zoomChange=new o.vpe,this.clickHandler=new o.vpe,this.isMouseMoveCalled=!1,this.graphSubscription=new Zo.w0,this.subscriptions=[],this.isPanning=!1,this.isDragging=!1,this.initialized=!1,this.graphDims={width:0,height:0},this._oldLinks=[],this.oldNodes=new Set,this.oldClusters=new Set,this.transformationMatrix={a:1,c:0,e:0,b:0,d:1,f:0},this._touchLastX=null,this._touchLastY=null,this.minimapScaleCoefficient=3,this.minimapOffsetX=0,this.minimapOffsetY=0,this.isMinimapPanning=!1,this.groupResultsBy=D=>D.label}get zoomLevel(){return this.transformationMatrix.a}set zoomLevel(l){this.zoomTo(Number(l))}get panOffsetX(){return this.transformationMatrix.e}set panOffsetX(l){this.panTo(Number(l),null)}get panOffsetY(){return this.transformationMatrix.f}set panOffsetY(l){this.panTo(null,Number(l))}ngOnInit(){this.update$&&this.subscriptions.push(this.update$.subscribe(()=>{this.update()})),this.center$&&this.subscriptions.push(this.center$.subscribe(()=>{this.center()})),this.zoomToFit$&&this.subscriptions.push(this.zoomToFit$.subscribe(()=>{this.zoomToFit()})),this.panToNode$&&this.subscriptions.push(this.panToNode$.subscribe(l=>{this.panToNodeId(l)})),this.minimapClipPathId=`minimapClip${wn()}`}ngOnChanges(l){this.basicUpdate();const{layout:u,layoutSettings:v,nodes:M,clusters:D,links:R}=l;this.setLayout(this.layout),v&&this.setLayoutSettings(this.layoutSettings),this.update()}setLayout(l){this.initialized=!1,l||(l="dagre"),"string"==typeof l&&(this.layout=this.layoutService.getLayout(l),this.setLayoutSettings(this.layoutSettings))}setLayoutSettings(l){this.layout&&"string"!=typeof this.layout&&(this.layout.settings=l)}ngOnDestroy(){this.unbindEvents(),this.visibilityObserver&&(this.visibilityObserver.visible.unsubscribe(),this.visibilityObserver.destroy());for(const l of this.subscriptions)l.unsubscribe();this.subscriptions=null}ngAfterViewInit(){this.bindWindowResizeEvent(),this.visibilityObserver=new pi(this.el,this.zone),this.visibilityObserver.visible.subscribe(this.update.bind(this)),setTimeout(()=>this.update())}update(){this.basicUpdate(),this.curve||(this.curve=Dl.beta(1)),this.zone.run(()=>{this.dims=function rl({width:a,height:l}){let u=a,v=l;return u=Math.max(0,u),v=Math.max(0,v),{width:Math.floor(u),height:Math.floor(v)}}({width:this.width,height:this.height}),this.seriesDomain=this.getSeriesDomain(),this.setColors(),this.createGraph(),this.updateTransform(),this.initialized=!0})}createGraph(){this.graphSubscription.unsubscribe(),this.graphSubscription=new Zo.w0;const l=u=>(u.meta||(u.meta={}),u.id||(u.id=wn()),u.dimension?u.meta.forceDimensions=void 0===u.meta.forceDimensions||u.meta.forceDimensions:(u.dimension={width:this.nodeWidth?this.nodeWidth:30,height:this.nodeHeight?this.nodeHeight:30},u.meta.forceDimensions=!1),u.position={x:0,y:0},u.data=u.data?u.data:{},u);this.graph={nodes:this.nodes.length>0?[...this.nodes].map(l):[],clusters:this.clusters&&this.clusters.length>0?[...this.clusters].map(l):[],edges:this.links.length>0?[...this.links].map(u=>(u.id||(u.id=wn()),u)):[]},requestAnimationFrame(()=>this.draw())}draw(){if(!this.layout||"string"==typeof this.layout)return;this.applyNodeDimensions();const l=this.layout.run(this.graph),u=l instanceof Go.y?l:(0,Uo.of)(l);this.graphSubscription.add(u.subscribe(v=>{this.graph=v,this.tick()})),0!==this.graph.nodes.length&&u.pipe((0,uu.P)()).subscribe(()=>this.applyNodeDimensions())}tick(){const l=new Set;this.graph.nodes.map(M=>{M.transform=`translate(${M.position.x-M.dimension.width/2||0}, ${M.position.y-M.dimension.height/2||0})`,M.data||(M.data={}),M.data.color=this.colors.getColor(this.groupResultsBy(M)),l.add(M.id)});const u=new Set;(this.graph.clusters||[]).map(M=>{M.transform=`translate(${M.position.x-M.dimension.width/2||0}, ${M.position.y-M.dimension.height/2||0})`,M.data||(M.data={}),M.data.color=this.colors.getColor(this.groupResultsBy(M)),u.add(M.id)}),setTimeout(()=>{this.oldNodes=l,this.oldClusters=u},500);const v=[];for(const M in this.graph.edgeLabels){const D=this.graph.edgeLabels[M],R=M.replace(/[^\w-]*/g,""),P=this.layout&&"string"!=typeof this.layout&&this.layout.settings&&this.layout.settings.multigraph;let G=P?this._oldLinks.find(vt=>`${vt.source}${vt.target}${vt.id}`===R):this._oldLinks.find(vt=>`${vt.source}${vt.target}`===R);const Q=P?this.graph.edges.find(vt=>`${vt.source}${vt.target}${vt.id}`===R):this.graph.edges.find(vt=>`${vt.source}${vt.target}`===R);G?G.data&&Q&&Q.data&&JSON.stringify(G.data)!==JSON.stringify(Q.data)&&(G.data=Q.data):G=Q||D,G.oldLine=G.line;const rt=D.points,ut=this.generateLine(rt),tt=Object.assign({},G);tt.line=ut,tt.points=rt,this.updateMidpointOnEdge(tt,rt);const xt=rt[Math.floor(rt.length/2)];xt&&(tt.textTransform=`translate(${xt.x||0},${xt.y||0})`),tt.textAngle=0,tt.oldLine||(tt.oldLine=tt.line),this.calcDominantBaseline(tt),v.push(tt)}this.graph.edges=v,this.graph.edges&&(this._oldLinks=this.graph.edges.map(M=>{const D=Object.assign({},M);return D.oldLine=M.line,D})),this.updateMinimap(),this.autoZoom&&this.zoomToFit(),this.autoCenter&&this.center(),requestAnimationFrame(()=>this.redrawLines()),this.cd.markForCheck()}getMinimapTransform(){switch(this.miniMapPosition){case di.UpperLeft:return"";case di.UpperRight:return"translate("+(this.dims.width-this.graphDims.width/this.minimapScaleCoefficient)+",0)";default:return""}}updateGraphDims(){let l=1/0,u=-1/0,v=1/0,M=-1/0;for(let D=0;D<this.graph.nodes.length;D++){const R=this.graph.nodes[D];l=R.position.x<l?R.position.x:l,v=R.position.y<v?R.position.y:v,u=R.position.x+R.dimension.width>u?R.position.x+R.dimension.width:u,M=R.position.y+R.dimension.height>M?R.position.y+R.dimension.height:M}l-=100,v-=100,u+=100,M+=100,this.graphDims.width=u-l,this.graphDims.height=M-v,this.minimapOffsetX=l,this.minimapOffsetY=v}updateMinimap(){this.graph.nodes&&this.graph.nodes.length&&(this.updateGraphDims(),this.miniMapMaxWidth&&(this.minimapScaleCoefficient=this.graphDims.width/this.miniMapMaxWidth),this.miniMapMaxHeight&&(this.minimapScaleCoefficient=Math.max(this.minimapScaleCoefficient,this.graphDims.height/this.miniMapMaxHeight)),this.minimapTransform=this.getMinimapTransform())}applyNodeDimensions(){this.nodeElements&&this.nodeElements.length&&this.nodeElements.map(l=>{const u=l.nativeElement,v=this.graph.nodes.find(D=>D.id===u.id);if(!v)return;let M;try{if(M=u.getBBox(),!M.width||!M.height)return}catch{return}if(this.nodeHeight?v.dimension.height=v.dimension.height&&v.meta.forceDimensions?v.dimension.height:this.nodeHeight:v.dimension.height=v.dimension.height&&v.meta.forceDimensions?v.dimension.height:M.height,this.nodeMaxHeight&&(v.dimension.height=Math.max(v.dimension.height,this.nodeMaxHeight)),this.nodeMinHeight&&(v.dimension.height=Math.min(v.dimension.height,this.nodeMinHeight)),this.nodeWidth)v.dimension.width=v.dimension.width&&v.meta.forceDimensions?v.dimension.width:this.nodeWidth;else if(u.getElementsByTagName("text").length){let D;try{for(const R of u.getElementsByTagName("text")){const P=R.getBBox();D?(P.width>D.width&&(D.width=P.width),P.height>D.height&&(D.height=P.height)):D=P}}catch{return}v.dimension.width=v.dimension.width&&v.meta.forceDimensions?v.dimension.width:D.width+20}else v.dimension.width=v.dimension.width&&v.meta.forceDimensions?v.dimension.width:M.width;this.nodeMaxWidth&&(v.dimension.width=Math.max(v.dimension.width,this.nodeMaxWidth)),this.nodeMinWidth&&(v.dimension.width=Math.min(v.dimension.width,this.nodeMinWidth))})}redrawLines(l=this.animate){this.linkElements.map(u=>{const v=this.graph.edges.find(M=>M.id===u.nativeElement.id);v&&(Zs(u.nativeElement).select(".line").attr("d",v.oldLine).transition().ease(po).duration(l?500:0).attr("d",v.line),Zs(this.el.nativeElement).select(`#${v.id}`).attr("d",v.oldTextPath).transition().ease(po).duration(l?500:0).attr("d",v.textPath),this.updateMidpointOnEdge(v,v.points))})}calcDominantBaseline(l){const u=l.points[0],v=l.points[l.points.length-1];l.oldTextPath=l.textPath,v.x<u.x?(l.dominantBaseline="text-before-edge",l.textPath=this.generateLine([...l.points].reverse())):(l.dominantBaseline="text-after-edge",l.textPath=l.line)}generateLine(l){return function pc(){var a=Di,l=Js,u=Ai(!0),v=null,M=Fl,D=null;function R(P){var G,rt,tt,Q=P.length,ut=!1;for(null==v&&(D=M(tt=Ll())),G=0;G<=Q;++G)!(G<Q&&u(rt=P[G],G,P))===ut&&((ut=!ut)?D.lineStart():D.lineEnd()),ut&&D.point(+a(rt,G,P),+l(rt,G,P));if(tt)return D=null,tt+""||null}return R.x=function(P){return arguments.length?(a="function"==typeof P?P:Ai(+P),R):a},R.y=function(P){return arguments.length?(l="function"==typeof P?P:Ai(+P),R):l},R.defined=function(P){return arguments.length?(u="function"==typeof P?P:Ai(!!P),R):u},R.curve=function(P){return arguments.length?(M=P,null!=v&&(D=M(v)),R):M},R.context=function(P){return arguments.length?(null==P?v=D=null:D=M(v=P),R):v},R}().x(v=>v.x).y(v=>v.y).curve(this.curve)(l)}onZoom(l,u){if(this.enableTrackpadSupport&&!l.ctrlKey)return void this.pan(-1*l.deltaX,-1*l.deltaY);const v=1+("in"===u?this.zoomSpeed:-this.zoomSpeed),M=this.zoomLevel*v;if(!(M<=this.minZoomLevel||M>=this.maxZoomLevel)&&this.enableZoom)if(!0===this.panOnZoom&&l){const D=l.clientX,R=l.clientY,P=this.el.nativeElement.querySelector("svg"),G=P.querySelector("g.chart"),Q=P.createSVGPoint();Q.x=D,Q.y=R;const rt=Q.matrixTransform(G.getScreenCTM().inverse());this.pan(rt.x,rt.y,!0),this.zoom(v),this.pan(-rt.x,-rt.y,!0)}else this.zoom(v)}pan(l,u,v=!1){const M=v?1:this.zoomLevel;this.transformationMatrix=ai(this.transformationMatrix,Wo(l/M,u/M)),this.updateTransform()}panTo(l,u){if(null==l||isNaN(l)||null==u||isNaN(u))return;const v=-this.panOffsetX-l*this.zoomLevel+this.dims.width/2,M=-this.panOffsetY-u*this.zoomLevel+this.dims.height/2;this.transformationMatrix=ai(this.transformationMatrix,Wo(v/this.zoomLevel,M/this.zoomLevel)),this.updateTransform()}zoom(l){this.transformationMatrix=ai(this.transformationMatrix,function Ki(a){var l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return fu(l)&&(l=a),{a,c:0,e:0,b:0,d:l,f:0}}(l,l)),this.zoomChange.emit(this.zoomLevel),this.updateTransform()}zoomTo(l){this.transformationMatrix.a=isNaN(l)?this.transformationMatrix.a:Number(l),this.transformationMatrix.d=isNaN(l)?this.transformationMatrix.d:Number(l),this.zoomChange.emit(this.zoomLevel),this.updateTransform(),this.update()}onDrag(l){if(!this.draggingEnabled)return;const u=this.draggingNode;this.layout&&"string"!=typeof this.layout&&this.layout.onDrag&&this.layout.onDrag(u,l),u.position.x+=l.movementX/this.zoomLevel,u.position.y+=l.movementY/this.zoomLevel;const v=u.position.x-u.dimension.width/2,M=u.position.y-u.dimension.height/2;u.transform=`translate(${v}, ${M})`;for(const D of this.graph.edges)if((D.target===u.id||D.source===u.id||D.target.id===u.id||D.source.id===u.id)&&this.layout&&"string"!=typeof this.layout){const R=this.layout.updateEdge(this.graph,D),P=R instanceof Go.y?R:(0,Uo.of)(R);this.graphSubscription.add(P.subscribe(G=>{this.graph=G,this.redrawEdge(D)}))}this.redrawLines(!1),this.updateMinimap()}redrawEdge(l){const u=this.generateLine(l.points);this.calcDominantBaseline(l),l.oldLine=l.line,l.line=u}updateTransform(){this.transform=function pu(a){return La(a)}(function vu(a){var l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e10;return{a:Math.round(a.a*l)/l,b:Math.round(a.b*l)/l,c:Math.round(a.c*l)/l,d:Math.round(a.d*l)/l,e:Math.round(a.e*l)/l,f:Math.round(a.f*l)/l}}(this.transformationMatrix,100))}onClick(l){this.select.emit(l)}onActivate(l){this.activeEntries.indexOf(l)>-1||(this.activeEntries=[l,...this.activeEntries],this.activate.emit({value:l,entries:this.activeEntries}))}onDeactivate(l){const u=this.activeEntries.indexOf(l);this.activeEntries.splice(u,1),this.activeEntries=[...this.activeEntries],this.deactivate.emit({value:l,entries:this.activeEntries})}getSeriesDomain(){return this.nodes.map(l=>this.groupResultsBy(l)).reduce((l,u)=>-1!==l.indexOf(u)?l:l.concat([u]),[]).sort()}trackLinkBy(l,u){return u.id}trackNodeBy(l,u){return u.id}setColors(){this.colors=new nl(this.scheme,this.seriesDomain,this.customColors)}onMouseMove(l){this.isMouseMoveCalled=!0,(this.isPanning||this.isMinimapPanning)&&this.panningEnabled?this.panWithConstraints(this.panningAxis,l):this.isDragging&&this.draggingEnabled&&this.onDrag(l)}onMouseDown(l){this.isMouseMoveCalled=!1}graphClick(l){this.isMouseMoveCalled||this.clickHandler.emit(l)}onTouchStart(l){this._touchLastX=l.changedTouches[0].clientX,this._touchLastY=l.changedTouches[0].clientY,this.isPanning=!0}onTouchMove(l){if(this.isPanning&&this.panningEnabled){const u=l.changedTouches[0].clientX,v=l.changedTouches[0].clientY,M=u-this._touchLastX,D=v-this._touchLastY;this._touchLastX=u,this._touchLastY=v,this.pan(M,D)}}onTouchEnd(l){this.isPanning=!1}onMouseUp(l){this.isDragging=!1,this.isPanning=!1,this.isMinimapPanning=!1,this.layout&&"string"!=typeof this.layout&&this.layout.onDragEnd&&this.layout.onDragEnd(this.draggingNode,l)}onNodeMouseDown(l,u){this.draggingEnabled&&(this.isDragging=!0,this.draggingNode=u,this.layout&&"string"!=typeof this.layout&&this.layout.onDragStart&&this.layout.onDragStart(u,l))}onMinimapDragMouseDown(){this.isMinimapPanning=!0}onMinimapPanTo(l){const u=l.offsetX-(this.dims.width-(this.graphDims.width+this.minimapOffsetX)/this.minimapScaleCoefficient),v=l.offsetY+this.minimapOffsetY/this.minimapScaleCoefficient;this.panTo(u*this.minimapScaleCoefficient,v*this.minimapScaleCoefficient),this.isMinimapPanning=!0}center(){this.panTo(this.graphDims.width/2,this.graphDims.height/2)}zoomToFit(){const l=this.dims.height/this.graphDims.height,u=this.dims.width/this.graphDims.width;let v=Math.min(l,u,1);v<this.minZoomLevel&&(v=this.minZoomLevel),v>this.maxZoomLevel&&(v=this.maxZoomLevel),v!==this.zoomLevel&&(this.zoomLevel=v,this.updateTransform(),this.zoomChange.emit(this.zoomLevel))}panToNodeId(l){const u=this.graph.nodes.find(v=>v.id===l);u&&this.panTo(u.position.x,u.position.y)}panWithConstraints(l,u){let v=u.movementX,M=u.movementY;switch(this.isMinimapPanning&&(v=-this.minimapScaleCoefficient*v*this.zoomLevel,M=-this.minimapScaleCoefficient*M*this.zoomLevel),l){case hi.Horizontal:this.pan(v,0);break;case hi.Vertical:this.pan(0,M);break;default:this.pan(v,M)}}updateMidpointOnEdge(l,u){if(l&&u)if(u.length%2==1)l.midPoint=u[Math.floor(u.length/2)];else{const v=u[u.length/2],M=u[u.length/2-1];l.midPoint={x:(v.x+M.x)/2,y:(v.y+M.y)/2}}}basicUpdate(){if(this.view)this.width=this.view[0],this.height=this.view[1];else{const l=this.getContainerDims();l&&(this.width=l.width,this.height=l.height)}this.width||(this.width=600),this.height||(this.height=400),this.width=Math.floor(this.width),this.height=Math.floor(this.height),this.cd&&this.cd.markForCheck()}getContainerDims(){let l,u;const v=this.el.nativeElement;if(null!==v.parentNode){const M=v.parentNode.getBoundingClientRect();l=M.width,u=M.height}return l&&u?{width:l,height:u}:null}unbindEvents(){this.resizeSubscription&&this.resizeSubscription.unsubscribe()}bindWindowResizeEvent(){const u=(0,lu.R)(window,"resize").pipe((0,cu.b)(200)).subscribe(v=>{this.update(),this.cd&&this.cd.markForCheck()});this.resizeSubscription=u}}Hn.\u0275fac=function(l){return new(l||Hn)(o.Y36(o.SBq),o.Y36(o.R0b),o.Y36(o.sBO),o.Y36(zn))},Hn.\u0275cmp=o.Xpm({type:Hn,selectors:[["ngx-graph"]],contentQueries:function(l,u,v){if(1&l&&(o.Suo(v,qa,5),o.Suo(v,as,5),o.Suo(v,kc,5),o.Suo(v,Iu,5),o.Suo(v,Ou,5)),2&l){let M;o.iGM(M=o.CRH())&&(u.linkTemplate=M.first),o.iGM(M=o.CRH())&&(u.nodeTemplate=M.first),o.iGM(M=o.CRH())&&(u.clusterTemplate=M.first),o.iGM(M=o.CRH())&&(u.defsTemplate=M.first),o.iGM(M=o.CRH())&&(u.miniMapNodeTemplate=M.first)}},viewQuery:function(l,u){if(1&l&&(o.Gf(Au,5),o.Gf(tl,5)),2&l){let v;o.iGM(v=o.CRH())&&(u.nodeElements=v),o.iGM(v=o.CRH())&&(u.linkElements=v)}},hostBindings:function(l,u){1&l&&o.NdJ("mousemove",function(M){return u.onMouseMove(M)},!1,o.evT)("mousedown",function(M){return u.onMouseDown(M)},!1,o.evT)("click",function(M){return u.graphClick(M)},!1,o.evT)("touchmove",function(M){return u.onTouchMove(M)},!1,o.evT)("mouseup",function(M){return u.onMouseUp(M)},!1,o.evT)},inputs:{nodes:"nodes",clusters:"clusters",links:"links",activeEntries:"activeEntries",curve:"curve",draggingEnabled:"draggingEnabled",nodeHeight:"nodeHeight",nodeMaxHeight:"nodeMaxHeight",nodeMinHeight:"nodeMinHeight",nodeWidth:"nodeWidth",nodeMinWidth:"nodeMinWidth",nodeMaxWidth:"nodeMaxWidth",panningEnabled:"panningEnabled",panningAxis:"panningAxis",enableZoom:"enableZoom",zoomSpeed:"zoomSpeed",minZoomLevel:"minZoomLevel",maxZoomLevel:"maxZoomLevel",autoZoom:"autoZoom",panOnZoom:"panOnZoom",animate:"animate",autoCenter:"autoCenter",update$:"update$",center$:"center$",zoomToFit$:"zoomToFit$",panToNode$:"panToNode$",layout:"layout",layoutSettings:"layoutSettings",enableTrackpadSupport:"enableTrackpadSupport",showMiniMap:"showMiniMap",miniMapMaxWidth:"miniMapMaxWidth",miniMapMaxHeight:"miniMapMaxHeight",miniMapPosition:"miniMapPosition",view:"view",scheme:"scheme",customColors:"customColors",animations:"animations",groupResultsBy:"groupResultsBy",zoomLevel:"zoomLevel",panOffsetX:"panOffsetX",panOffsetY:"panOffsetY"},outputs:{select:"select",activate:"activate",deactivate:"deactivate",zoomChange:"zoomChange",clickHandler:"clickHandler"},features:[o.TTD],ngContentSelectors:["*"],decls:6,vars:11,consts:[["mouseWheel","",1,"ngx-charts-outer",3,"mouseWheelUp","mouseWheelDown"],[1,"ngx-charts"],["class","graph chart",3,"touchstart","touchend",4,"ngIf"],["class","minimap",4,"ngIf"],[1,"graph","chart",3,"touchstart","touchend"],[3,"ngTemplateOutlet",4,"ngIf"],["class","text-path",4,"ngFor","ngForOf"],[1,"panning-rect",3,"mousedown"],[1,"clusters"],["class","node-group",3,"old-node","id","click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"links"],["class","link-group",3,"id",4,"ngFor","ngForOf","ngForTrackBy"],[1,"nodes"],["class","node-group",3,"old-node","id","click","mousedown",4,"ngFor","ngForOf","ngForTrackBy"],[3,"ngTemplateOutlet"],[1,"text-path"],[1,"node-group",3,"id","click"],["clusterElement",""],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngIf"],["class","node cluster",4,"ngIf"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"node","cluster"],["alignment-baseline","central"],[1,"link-group",3,"id"],["linkElement",""],["class","edge",4,"ngIf"],[1,"edge"],[1,"node-group",3,"id","click","mousedown"],["nodeElement",""],["r","10",4,"ngIf"],["r","10"],[1,"minimap"],[1,"minimap-background",3,"mousedown"],[1,"minimap-nodes"],["class","node-group",3,"old-node","id",4,"ngFor","ngForOf","ngForTrackBy"],[1,"minimap-drag",3,"mousedown"],[1,"node-group",3,"id"]],template:function(l,u){1&l&&(o.F$t(),o.TgZ(0,"div",0),o.NdJ("mouseWheelUp",function(M){return u.onZoom(M,"in")})("mouseWheelDown",function(M){return u.onZoom(M,"out")}),o.O4$(),o.TgZ(1,"svg",1),o.YNc(2,Fu,12,12,"g",2),o.TgZ(3,"clipPath"),o._UZ(4,"rect"),o.qZA(),o.YNc(5,Vu,6,15,"g",3),o.qZA()()),2&l&&(o.Udp("width",u.width,"px"),o.Q6J("@animationState","active")("@.disabled",!u.animations),o.xp6(1),o.uIk("width",u.width)("height",u.height),o.xp6(1),o.Q6J("ngIf",u.initialized&&u.graph),o.xp6(1),o.uIk("id",u.minimapClipPathId),o.xp6(1),o.uIk("width",u.graphDims.width/u.minimapScaleCoefficient)("height",u.graphDims.height/u.minimapScaleCoefficient),o.xp6(1),o.Q6J("ngIf",u.showMiniMap))},dependencies:[or,k.O5,k.tP,k.sg],styles:[".minimap .minimap-background{fill:#0000001a}.minimap .minimap-drag{fill:#0003;stroke:#fff;stroke-width:1px;stroke-dasharray:2px;stroke-dashoffset:2px;cursor:pointer}.minimap .minimap-drag.panning{fill:#0000004d}.minimap .minimap-nodes{opacity:.5;pointer-events:none}.graph{-webkit-user-select:none;user-select:none}.graph .edge{stroke:#666;fill:none}.graph .edge .edge-label{stroke:none;font-size:12px;fill:#251e1e}.graph .panning-rect{fill:#0000;cursor:move}.graph .node-group.old-node{transition:transform .5s ease-in-out}.graph .node-group .node:focus{outline:none}.graph .cluster rect{opacity:.2}\n"],encapsulation:2,data:{animation:[(0,H.X$)("animationState",[(0,H.eR)(":enter",[(0,H.oB)({opacity:0}),(0,H.jt)("500ms 100ms",(0,H.oB)({opacity:1}))])])]},changeDetection:0}),(0,z.gn)([function Uu(a,l){return function(v,M,D){return{configurable:!0,enumerable:D.enumerable,get:function(){return Object.defineProperty(this,M,{configurable:!0,enumerable:D.enumerable,value:Gu(D.value,a,l)}),this[M]}}}}(500)],Hn.prototype,"updateMinimap",null);class sr{}sr.\u0275fac=function(l){return new(l||sr)},sr.\u0275mod=o.oAB({type:sr}),sr.\u0275inj=o.cJS({providers:[zn],imports:[[k.ez]]});class ar{}ar.\u0275fac=function(l){return new(l||ar)},ar.\u0275mod=o.oAB({type:ar}),ar.\u0275inj=o.cJS({imports:[[k.ez],sr]});var cs=f(9886);function hs(a,l){1&a&&(o.O4$(),o.TgZ(0,"marker",9),o._UZ(1,"path",10),o.qZA())}function Pc(a,l){if(1&a&&(o.O4$(),o.TgZ(0,"g",11),o._UZ(1,"rect",12),o.TgZ(2,"text",13),o._uU(3),o.qZA()()),2&a){const u=l.$implicit;o.xp6(1),o.uIk("width",u.dimension.width)("height",u.dimension.height)("fill",u.data.color),o.xp6(1),o.uIk("x",10)("y",u.dimension.height/2),o.xp6(1),o.hij(" ",u.label," ")}}function Lc(a,l){if(1&a&&(o.O4$(),o.TgZ(0,"g",14),o._UZ(1,"path",15),o.TgZ(2,"text",16)(3,"textPath",17),o._uU(4),o.qZA()()()),2&a){const u=l.$implicit;o.xp6(3),o.Udp("dominant-baseline",u.dominantBaseline),o.uIk("href","#"+u.id),o.xp6(1),o.hij(" ",u.label," ")}}class mi{constructor(l){this._modalService=l,this.layoutSettings={orientation:Ir.TOP_TO_BOTTOM},this.nodesCount=0,this.linksCount=0,this.nodes=[],this.links=[],this.isModal=!1}ngOnInit(){for(let l of this.map.nodes_labels)this.nodes=[...this.nodes,{id:"node"+this.nodesCount.toString(),label:l}],this.nodesCount++;for(let l=0;l<this.map.adjacency_matrix.length;l++)for(let u=0;u<this.map.adjacency_matrix[l].length;u++)this.map.adjacency_matrix[l][u]&&(this.links=[...this.links,{id:"link"+this.linksCount.toString(),source:"node"+l,target:"node"+u,label:this.map.adjacency_matrix_labels[l][u]}],this.linksCount++)}hideModal(){this._modalService.hide("ClassroomHomeworkMapViewComponent")}}function ju(a,l){if(1&a&&(o.TgZ(0,"div",38)(1,"p",35),o._UZ(2,"i",39),o._uU(3," Number of Maps: "),o.TgZ(4,"span",40),o._uU(5),o.qZA()(),o.TgZ(6,"p",41),o._UZ(7,"i",39),o._uU(8," Minimum Nodes Count: "),o.TgZ(9,"span",40),o._uU(10),o.qZA()(),o.TgZ(11,"p",35),o._UZ(12,"i",39),o._uU(13," Maximum Nodes Count: "),o.TgZ(14,"span",40),o._uU(15),o.qZA()(),o.TgZ(16,"p",41),o._UZ(17,"i",39),o._uU(18," Minimum Edges Count: "),o.TgZ(19,"span",40),o._uU(20),o.qZA()(),o.TgZ(21,"p",35),o._UZ(22,"i",39),o._uU(23," Maximum Edges Count: "),o.TgZ(24,"span",40),o._uU(25),o.qZA()()()),2&a){const u=o.oxw();o.xp6(5),o.Oqu(null==u.homework.maps?null:u.homework.maps.length),o.xp6(5),o.Oqu(u.homework.node_min),o.xp6(5),o.Oqu(u.homework.node_max),o.xp6(5),o.Oqu(u.homework.node_min-1),o.xp6(5),o.Oqu(u.maxMapsValues.edges)}}mi.\u0275fac=function(l){return new(l||mi)(o.Y36(cs.tT))},mi.\u0275cmp=o.Xpm({type:mi,selectors:[["app-classroom-homework-map-view"]],decls:15,vars:5,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],["type","button",1,"btn-close","close","pull-right",3,"click"],[1,"visually-hidden"],[1,"modal-body"],[1,"chart-container",3,"showMiniMap","layoutSettings","links","nodes","autoCenter"],["defsTemplate",""],["nodeTemplate",""],["linkTemplate",""],["id","arrow","viewBox","0 -5 10 10","refX","8","refY","0","markerWidth","4","markerHeight","4","orient","auto"],["d","M0,-5L10,0L0,5",1,"arrow-head"],[1,"node"],["rx","15"],["alignment-baseline","central"],[1,"edge"],["stroke-width","2","marker-end","url(#arrow)",1,"line"],["text-anchor","middle",1,"edge-label"],["startOffset","50%",1,"text-path"]],template:function(l,u){1&l&&(o.TgZ(0,"div",0)(1,"h4",1),o._uU(2,"Map Graph"),o.qZA(),o.TgZ(3,"button",2),o.NdJ("click",function(){return u.hideModal()}),o.TgZ(4,"span",3),o._uU(5,"\xd7"),o.qZA()()(),o.TgZ(6,"div",4)(7,"div")(8,"ngx-graph",5),o.YNc(9,hs,2,0,"ng-template",null,6,o.W1O),o.YNc(11,Pc,4,6,"ng-template",null,7,o.W1O),o.YNc(13,Lc,5,4,"ng-template",null,8,o.W1O),o.qZA()()()),2&l&&(o.xp6(8),o.Q6J("showMiniMap",!1)("layoutSettings",u.layoutSettings)("links",u.links)("nodes",u.nodes)("autoCenter",!0))},dependencies:[Hn],encapsulation:2});const no=function(a){return{"btn-primary":a}},al=function(a){return{"d-none":a}};var le;!function(a){a[a.Entropy=0]="Entropy",a[a.EntropyPercent=1]="EntropyPercent",a[a.Effort=2]="Effort"}(le||(le={}));const Ku=a=>{const l=parseInt(a.get("node_min").value),u=parseInt(a.get("node_max").value),v=parseInt(a.get("edge_min").value),M=parseInt(a.get("edge_max").value),D=parseInt(a.get("param_min").value),R=parseInt(a.get("param_max").value);return l>u||v>M||D>R?{inRange:!1}:null};class Dr{constructor(l,u,v,M,D,R){this._route=l,this._classroomHomeworkService=u,this._router=v,this._alertService=M,this._modalService=D,this._location=R,this.homeworkFilterForm=new I.cw({node_min:new I.NI(0,I.kI.required),node_max:new I.NI(0,I.kI.required),edge_min:new I.NI(0,I.kI.required),edge_max:new I.NI(0,I.kI.required),param_min:new I.NI(0,I.kI.required),param_max:new I.NI(0,I.kI.required)},Ku),this.loading=!1,this.homework=null,this.currentMap=null,this.current_chart_type=le.Entropy,this.maxMapsValues={nodes:0,edges:0,entropy:0,entropy_percent:0,effort:0},this.minMapsValues={nodes:999999999,edges:999999999,entropy:999999999,entropy_percent:999999999,effort:999999999};let P=JSON.parse(localStorage.getItem("currentUserData"));P||this._router.navigate(["/users/auth"]),this.user=P}ngOnInit(){this.classroom_id=this._route.snapshot.paramMap.get("classroom_id"),this.homework_id=this._route.snapshot.paramMap.get("homework_id"),this.getClassroomHomework()}getClassroomHomework(){this._classroomHomeworkService.getClassroomHomework(this.classroom_id,this.homework_id).subscribe(l=>{if(this.loading=!1,l.hasOwnProperty("error"))return void this._router.navigate(["/not-found"]);this.homework=l;let u=[];if(!(this.homework.maps&&this.homework.maps.length>0))return this._location.back(),void this._alertService.error("Homework has no submitted maps.");{for(let tt of this.homework.maps)tt.nodes_count>this.maxMapsValues.nodes&&(this.maxMapsValues.nodes=tt.nodes_count),tt.edges_count>this.maxMapsValues.edges&&(this.maxMapsValues.edges=tt.edges_count),tt.entropy&&tt.entropy>this.maxMapsValues.entropy&&(this.maxMapsValues.entropy=tt.entropy),tt.entropy_percent&&tt.entropy_percent>this.maxMapsValues.entropy_percent&&(this.maxMapsValues.entropy_percent=tt.entropy_percent),tt.effort&&tt.effort>this.maxMapsValues.effort&&(this.maxMapsValues.effort=tt.effort),tt.nodes_count<this.minMapsValues.nodes&&(this.minMapsValues.nodes=tt.nodes_count),tt.edges_count<this.minMapsValues.edges&&(this.minMapsValues.edges=tt.edges_count),tt.entropy<this.minMapsValues.entropy&&(this.minMapsValues.entropy=tt.entropy),tt.entropy_percent<this.minMapsValues.entropy_percent&&(this.minMapsValues.entropy_percent=tt.entropy_percent),tt.effort<this.minMapsValues.effort&&(this.minMapsValues.effort=tt.effort);this.resetFilterForm(this.current_chart_type);let v=(this.maxMapsValues.entropy-this.minMapsValues.entropy)/3,M=this.minMapsValues.entropy+v,D=M+v,R=(this.maxMapsValues.entropy_percent-this.minMapsValues.entropy_percent)/3,P=this.minMapsValues.entropy_percent+R,G=P+R,Q=(this.maxMapsValues.effort-this.minMapsValues.effort)/3,rt=this.minMapsValues.effort+Q,ut=rt+Q;for(let tt of this.homework.maps){let xt=0,vt=0,wt=0;tt.is_teacher_map?(xt=3,vt=3,wt=3):(tt.entropy>M&&tt.entropy<D?xt=1:tt.entropy>=D&&(xt=2),tt.entropy_percent>P&&tt.entropy_percent<G?vt=1:tt.entropy_percent>=G&&(vt=2),tt.effort>rt&&tt.effort<ut?wt=1:tt.effort>=ut&&(wt=2)),u=[...u,{_id:tt._id,color_entropy:xt,color_entropy_percent:vt,color_effort:wt,edges_count:tt.edges_count,entropy:tt.entropy,entropy_percent:tt.entropy_percent,effort:tt.effort,nodes_count:tt.nodes_count,homework_id:tt.homework_id,adjacency_matrix:tt.adjacency_matrix,created_at:tt.created_at,nodes_labels:tt.nodes_labels,adjacency_matrix_labels:tt.adjacency_matrix_labels,author_name:tt.author_name,is_teacher_map:tt.is_teacher_map,map_name:tt.map_name,display_name:"<b>Nodes Count:</b> "+tt.nodes_count+"<br><b>Edges Count:</b> "+tt.edges_count+"<br><br><b>Entropy:</b> "+tt.entropy+"<br><b>Entropy Percent:</b> "+tt.entropy_percent+"%<br><b>Effort:</b> "+tt.effort+"<br><br><b>Map Name:</b> "+tt.map_name+"<br><b>Author:</b> "+tt.author_name+"<br><b>Created At:</b> "+this.dateTransform(tt.created_at)}]}}this.homework={classroom_id:this.homework.classroom_id,title:this.homework.title,node_min:this.homework.node_min,node_max:this.homework.node_max,maps:u,body:this.homework.body,start_datetime:this.homework.start_datetime,expire_datetime:this.homework.expire_datetime},this.renderScatterPlot(this.current_chart_type)})}unpack(l,u){return l.map(function(v){return v[u]})}resetFilterForm(l){this.homeworkFilterForm.get("node_min").setValidators([I.kI.min(this.minMapsValues.nodes),I.kI.required]),this.homeworkFilterForm.patchValue({node_min:this.minMapsValues.nodes}),this.homeworkFilterForm.get("node_min").updateValueAndValidity(),this.homeworkFilterForm.get("edge_min").setValidators([I.kI.min(this.minMapsValues.edges),I.kI.required]),this.homeworkFilterForm.patchValue({edge_min:this.minMapsValues.edges}),this.homeworkFilterForm.get("edge_min").updateValueAndValidity(),l==le.Entropy?(this.homeworkFilterForm.get("param_min").setValidators([I.kI.min(this.minMapsValues.entropy),I.kI.required]),this.homeworkFilterForm.patchValue({param_min:parseFloat(this.minMapsValues.entropy.toFixed(2))}),this.homeworkFilterForm.get("param_min").updateValueAndValidity(),this.homeworkFilterForm.get("param_max").setValidators([I.kI.max(this.maxMapsValues.entropy),I.kI.required]),this.homeworkFilterForm.patchValue({param_max:parseFloat(this.maxMapsValues.entropy.toFixed(2))}),this.homeworkFilterForm.get("param_max").updateValueAndValidity()):l==le.EntropyPercent?(this.homeworkFilterForm.get("param_min").setValidators([I.kI.min(this.minMapsValues.entropy_percent),I.kI.required]),this.homeworkFilterForm.patchValue({param_min:parseFloat(this.minMapsValues.entropy_percent.toFixed(2))}),this.homeworkFilterForm.get("param_min").updateValueAndValidity(),this.homeworkFilterForm.get("param_max").setValidators([I.kI.max(this.maxMapsValues.entropy_percent),I.kI.required]),this.homeworkFilterForm.patchValue({param_max:parseFloat(this.maxMapsValues.entropy_percent.toFixed(2))}),this.homeworkFilterForm.get("param_max").updateValueAndValidity()):l==le.Effort&&(this.homeworkFilterForm.get("param_min").setValidators([I.kI.min(this.minMapsValues.effort),I.kI.required]),this.homeworkFilterForm.patchValue({param_min:parseFloat(this.minMapsValues.effort.toFixed(2))}),this.homeworkFilterForm.get("param_min").updateValueAndValidity(),this.homeworkFilterForm.get("param_max").setValidators([I.kI.max(this.maxMapsValues.effort),I.kI.required]),this.homeworkFilterForm.patchValue({param_max:parseFloat(this.maxMapsValues.effort.toFixed(2))}),this.homeworkFilterForm.get("param_max").updateValueAndValidity()),this.homeworkFilterForm.get("node_max").setValidators([I.kI.max(this.maxMapsValues.nodes),I.kI.required]),this.homeworkFilterForm.patchValue({node_max:this.maxMapsValues.nodes}),this.homeworkFilterForm.get("node_max").updateValueAndValidity(),this.homeworkFilterForm.get("edge_max").setValidators([I.kI.max(this.maxMapsValues.edges),I.kI.required]),this.homeworkFilterForm.patchValue({edge_max:this.maxMapsValues.edges}),this.homeworkFilterForm.get("edge_max").updateValueAndValidity()}getCoordsDatum(l,u){let v=this.unpack(this.homework.maps.filter(P=>P.color_entropy==u&&P.nodes_count>=this.homeworkFilterForm.value.node_min&&P.nodes_count<=this.homeworkFilterForm.value.node_max&&P.edges_count>=this.homeworkFilterForm.value.edge_min&&P.edges_count<=this.homeworkFilterForm.value.edge_max&&P.entropy>=this.homeworkFilterForm.value.param_min&&P.entropy<=this.homeworkFilterForm.value.param_max),"nodes_count"),M=this.unpack(this.homework.maps.filter(P=>P.color_entropy==u&&P.nodes_count>=this.homeworkFilterForm.value.node_min&&P.nodes_count<=this.homeworkFilterForm.value.node_max&&P.edges_count>=this.homeworkFilterForm.value.edge_min&&P.edges_count<=this.homeworkFilterForm.value.edge_max&&P.entropy>=this.homeworkFilterForm.value.param_min&&P.entropy<=this.homeworkFilterForm.value.param_max),"edges_count"),D=this.unpack(this.homework.maps.filter(P=>P.color_entropy==u&&P.nodes_count>=this.homeworkFilterForm.value.node_min&&P.nodes_count<=this.homeworkFilterForm.value.node_max&&P.edges_count>=this.homeworkFilterForm.value.edge_min&&P.edges_count<=this.homeworkFilterForm.value.edge_max&&P.entropy>=this.homeworkFilterForm.value.param_min&&P.entropy<=this.homeworkFilterForm.value.param_max),"entropy"),R=this.unpack(this.homework.maps.filter(P=>P.color_entropy==u&&P.nodes_count>=this.homeworkFilterForm.value.node_min&&P.nodes_count<=this.homeworkFilterForm.value.node_max&&P.edges_count>=this.homeworkFilterForm.value.edge_min&&P.edges_count<=this.homeworkFilterForm.value.edge_max&&P.entropy>=this.homeworkFilterForm.value.param_min&&P.entropy<=this.homeworkFilterForm.value.param_max),"display_name");return l==le.EntropyPercent?(v=this.unpack(this.homework.maps.filter(P=>P.color_entropy_percent==u&&P.nodes_count>=this.homeworkFilterForm.value.node_min&&P.nodes_count<=this.homeworkFilterForm.value.node_max&&P.edges_count>=this.homeworkFilterForm.value.edge_min&&P.edges_count<=this.homeworkFilterForm.value.edge_max&&P.entropy_percent>=this.homeworkFilterForm.value.param_min&&P.entropy_percent<=this.homeworkFilterForm.value.param_max),"nodes_count"),M=this.unpack(this.homework.maps.filter(P=>P.color_entropy_percent==u&&P.nodes_count>=this.homeworkFilterForm.value.node_min&&P.nodes_count<=this.homeworkFilterForm.value.node_max&&P.edges_count>=this.homeworkFilterForm.value.edge_min&&P.edges_count<=this.homeworkFilterForm.value.edge_max&&P.entropy_percent>=this.homeworkFilterForm.value.param_min&&P.entropy_percent<=this.homeworkFilterForm.value.param_max),"edges_count"),D=this.unpack(this.homework.maps.filter(P=>P.color_entropy_percent==u&&P.nodes_count>=this.homeworkFilterForm.value.node_min&&P.nodes_count<=this.homeworkFilterForm.value.node_max&&P.edges_count>=this.homeworkFilterForm.value.edge_min&&P.edges_count<=this.homeworkFilterForm.value.edge_max&&P.entropy_percent>=this.homeworkFilterForm.value.param_min&&P.entropy_percent<=this.homeworkFilterForm.value.param_max),"entropy_percent"),R=this.unpack(this.homework.maps.filter(P=>P.color_entropy_percent==u&&P.nodes_count>=this.homeworkFilterForm.value.node_min&&P.nodes_count<=this.homeworkFilterForm.value.node_max&&P.edges_count>=this.homeworkFilterForm.value.edge_min&&P.edges_count<=this.homeworkFilterForm.value.edge_max&&P.entropy_percent>=this.homeworkFilterForm.value.param_min&&P.entropy_percent<=this.homeworkFilterForm.value.param_max),"display_name")):l==le.Effort&&(v=this.unpack(this.homework.maps.filter(P=>P.color_effort==u&&P.nodes_count>=this.homeworkFilterForm.value.node_min&&P.nodes_count<=this.homeworkFilterForm.value.node_max&&P.edges_count>=this.homeworkFilterForm.value.edge_min&&P.edges_count<=this.homeworkFilterForm.value.edge_max&&P.effort>=this.homeworkFilterForm.value.param_min&&P.effort<=this.homeworkFilterForm.value.param_max),"nodes_count"),M=this.unpack(this.homework.maps.filter(P=>P.color_effort==u&&P.nodes_count>=this.homeworkFilterForm.value.node_min&&P.nodes_count<=this.homeworkFilterForm.value.node_max&&P.edges_count>=this.homeworkFilterForm.value.edge_min&&P.edges_count<=this.homeworkFilterForm.value.edge_max&&P.effort>=this.homeworkFilterForm.value.param_min&&P.effort<=this.homeworkFilterForm.value.param_max),"edges_count"),D=this.unpack(this.homework.maps.filter(P=>P.color_effort==u&&P.nodes_count>=this.homeworkFilterForm.value.node_min&&P.nodes_count<=this.homeworkFilterForm.value.node_max&&P.edges_count>=this.homeworkFilterForm.value.edge_min&&P.edges_count<=this.homeworkFilterForm.value.edge_max&&P.effort>=this.homeworkFilterForm.value.param_min&&P.effort<=this.homeworkFilterForm.value.param_max),"effort"),R=this.unpack(this.homework.maps.filter(P=>P.color_effort==u&&P.nodes_count>=this.homeworkFilterForm.value.node_min&&P.nodes_count<=this.homeworkFilterForm.value.node_max&&P.edges_count>=this.homeworkFilterForm.value.edge_min&&P.edges_count<=this.homeworkFilterForm.value.edge_max&&P.effort>=this.homeworkFilterForm.value.param_min&&P.effort<=this.homeworkFilterForm.value.param_max),"display_name")),[v,M,D,R]}dateTransform(l){const u=new Date(1e3*l);return u.toLocaleDateString("en-GB",{year:"numeric",month:"2-digit",day:"2-digit"})+" - "+String(u.getHours()).padStart(2,"0")+":"+String(u.getMinutes()).padStart(2,"0")}renderScatterPlot(l){L.purge("container");const u=["rgba(168, 50, 50, 0.95)","rgba(161, 158, 157, 0.95)","rgba(86, 199, 30, 0.95)","rgba(51, 102, 255, 0.95)"];let v={x:this.getCoordsDatum(l,0)[0],y:this.getCoordsDatum(l,0)[1],z:this.getCoordsDatum(l,0)[2],mode:"markers",marker:{size:5,line:{color:u[0],width:.5},opacity:.6},type:"scatter3d",text:this.getCoordsDatum(l,0)[3],hoverinfo:"text"},M={x:this.getCoordsDatum(l,1)[0],y:this.getCoordsDatum(l,1)[1],z:this.getCoordsDatum(l,1)[2],mode:"markers",marker:{size:5,line:{color:u[1],width:.5},opacity:.6},type:"scatter3d",text:this.getCoordsDatum(l,1)[3],hoverinfo:"text"},D={x:this.getCoordsDatum(l,2)[0],y:this.getCoordsDatum(l,2)[1],z:this.getCoordsDatum(l,2)[2],mode:"markers",marker:{size:5,line:{color:u[2],width:.5},opacity:.6},type:"scatter3d",text:this.getCoordsDatum(l,2)[3],hoverinfo:"text"};console.log(this.getCoordsDatum(l,3)[0]);let P=[v,M,D,{x:this.getCoordsDatum(l,3)[0],y:this.getCoordsDatum(l,3)[1],z:this.getCoordsDatum(l,3)[2],mode:"markers",marker:{size:5,line:{color:u[3],width:.5},opacity:.6},name:"teacher maps",type:"scatter3d",text:this.getCoordsDatum(l,3)[3],hoverinfo:"text"}],G={margin:{l:0,r:0,b:0,t:50},width:window.innerWidth-window.innerWidth/2.5,height:window.innerHeight-200,colorway:u,scene:{xaxis:{title:"Nodes",range:[0,this.maxMapsValues.nodes]},yaxis:{title:"Edges",range:[0,this.maxMapsValues.edges]},zaxis:{title:this.getChartTypeLabel(this.current_chart_type)}}};L.newPlot("container",P,G,{responsive:!0}),document.getElementById("container").on("plotly_click",rt=>{this.current_chart_type==le.Entropy?this.currentMap=this.homework?.maps?.filter(ut=>rt.points[0].x==ut.nodes_count&&rt.points[0].y==ut.edges_count&&rt.points[0].z==ut.entropy)[0]:this.current_chart_type==le.EntropyPercent?this.currentMap=this.homework?.maps?.filter(ut=>rt.points[0].x==ut.nodes_count&&rt.points[0].y==ut.edges_count&&rt.points[0].z==ut.entropy_percent)[0]:this.current_chart_type==le.Effort&&(this.currentMap=this.homework?.maps?.filter(ut=>rt.points[0].x==ut.nodes_count&&rt.points[0].y==ut.edges_count&&rt.points[0].z==ut.effort)[0]),this.showCurrentMap()})}getChartTypeLabel(l){switch(l){case le.Entropy:return"Entropy (H)";case le.EntropyPercent:return"Entropy Percent (Hr)";case le.Effort:return"Effort (M)"}}getChartTypeValue(l,u){switch(u){case le.Entropy:return l.entropy.toFixed(2);case le.EntropyPercent:return l.entropy_percent.toFixed(2);case le.Effort:return l.effort.toFixed(2)}}getChartId(l){switch(l){case le.Entropy:return"chartHolderEntropy";case le.EntropyPercent:return"chartHolderEntropyPercent";case le.Effort:return"chartHolderEffort"}}updateChartType(l){this.current_chart_type=l,this.resetFilterForm(this.current_chart_type),this.renderScatterPlot(this.current_chart_type)}downloadJson(){var l=JSON.stringify(this.homework?.maps),u=document.createElement("a");u.setAttribute("href","data:text/json;charset=UTF-8,"+encodeURIComponent(l)),u.setAttribute("download",this.homework?.title?this.homework?.title+"_maps.json":"undefined.json"),u.style.display="none",document.body.appendChild(u),u.click(),document.body.removeChild(u)}showCurrentMap(){const l={map:this.currentMap,isModal:!0};this._modalService.show(mi,{id:"ClassroomHomeworkMapViewComponent",class:"modal-lg",initialState:l})}}Dr.\u0275fac=function(l){return new(l||Dr)(o.Y36(g.gz),o.Y36(d.c),o.Y36(g.F0),o.Y36(C.c),o.Y36(cs.tT),o.Y36(k.Ye))},Dr.\u0275cmp=o.Xpm({type:Dr,selectors:[["app-classroom-homework-teacher-view"]],decls:62,vars:17,consts:[[1,"row","h-90","my-4","mx-2"],[1,"col-4","h-100"],[1,"row","h-100"],[1,"col-12","h-100","ps-0"],[1,"card","mb-4","h-100"],[1,"card-body"],["type","button",1,"btn","btn-primary","w-100","mb-3",3,"click"],[1,"fa-solid","fa-download","pe-clickable"],["class","alert alert-primary mb-2","role","alert",4,"ngIf"],[1,"form-label"],[1,"me-3","btn","btn-secondary",3,"ngClass","click"],[1,"btn","btn-secondary",3,"ngClass","click"],[1,"mt-3",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-6"],["for","node_min",1,"form-label"],["type","text","id","node_min","name","homework_node_min","placeholder","","formControlName","node_min",1,"form-control"],["for","node_max",1,"form-label"],["type","text","id","node_max","name","homework_node_max","placeholder","","formControlName","node_max",1,"form-control"],[1,"row","mt-2"],["for","edge_min",1,"form-label"],["type","text","id","edge_min","name","homework_edge_min","placeholder","","formControlName","edge_min",1,"form-control"],["for","edge_max",1,"form-label"],["type","text","id","edge_max","name","homework_edge_max","placeholder","","formControlName","edge_max",1,"form-control"],["for","param_min",1,"form-label"],["type","text","id","param_min","name","homework_param_min","placeholder","","formControlName","param_min",1,"form-control"],["for","param_max",1,"form-label"],["type","text","id","param_max","name","homework_param_max","placeholder","","formControlName","param_max",1,"form-control"],[1,"row","mt-4"],[1,"col-12","text-center"],["type","submit",1,"btn","btn-primary","me-3"],[1,"btn","btn-secondary",3,"click"],[1,"col-8","pe-0",3,"ngClass"],[1,"card"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[1,"mb-0"],[1,"card-body","text-center","p-0"],["id","container"],["role","alert",1,"alert","alert-primary","mb-2"],[1,"fa-solid","fa-genderless"],[1,"ms-2"],[1,"mb-0","mt-2"]],template:function(l,u){1&l&&(o.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"button",6),o.NdJ("click",function(){return u.downloadJson()}),o._UZ(7,"i",7),o._uU(8," Export"),o.qZA(),o.YNc(9,ju,26,5,"div",8),o.TgZ(10,"label",9),o._uU(11,"Scatter Plot Param:"),o.qZA(),o.TgZ(12,"div")(13,"button",10),o.NdJ("click",function(){return u.updateChartType(0)}),o._uU(14,"Entropy"),o.qZA(),o.TgZ(15,"button",10),o.NdJ("click",function(){return u.updateChartType(1)}),o._uU(16,"Entropy Percent"),o.qZA(),o.TgZ(17,"button",11),o.NdJ("click",function(){return u.updateChartType(2)}),o._uU(18,"Effort"),o.qZA()(),o.TgZ(19,"form",12),o.NdJ("ngSubmit",function(){return u.renderScatterPlot(u.current_chart_type)}),o.TgZ(20,"div",13)(21,"div",14)(22,"label",15),o._uU(23,"Nodes Min:"),o.qZA(),o._UZ(24,"input",16),o.qZA(),o.TgZ(25,"div",14)(26,"label",17),o._uU(27,"Nodes Max:"),o.qZA(),o._UZ(28,"input",18),o.qZA()(),o.TgZ(29,"div",19)(30,"div",14)(31,"label",20),o._uU(32,"Edges Min:"),o.qZA(),o._UZ(33,"input",21),o.qZA(),o.TgZ(34,"div",14)(35,"label",22),o._uU(36,"Edges Max:"),o.qZA(),o._UZ(37,"input",23),o.qZA()(),o.TgZ(38,"div",19)(39,"div",14)(40,"label",24),o._uU(41),o.qZA(),o._UZ(42,"input",25),o.qZA(),o.TgZ(43,"div",14)(44,"label",26),o._uU(45),o.qZA(),o._UZ(46,"input",27),o.qZA()(),o.TgZ(47,"div",28)(48,"div",29)(49,"button",30),o._uU(50,"Filter"),o.qZA(),o.TgZ(51,"button",31),o.NdJ("click",function(){return u.resetFilterForm(u.current_chart_type)}),o._uU(52,"Reset"),o.qZA()()()()()()()()(),o.TgZ(53,"div",32)(54,"div",33)(55,"div",34)(56,"h5",35),o._uU(57,"Scatter Plot: "),o.TgZ(58,"small"),o._uU(59),o.qZA()()(),o.TgZ(60,"div",36),o._UZ(61,"div",37),o.qZA()()()()),2&l&&(o.xp6(9),o.Q6J("ngIf",u.homework),o.xp6(4),o.Q6J("ngClass",o.VKq(9,no,0==u.current_chart_type)),o.xp6(2),o.Q6J("ngClass",o.VKq(11,no,1==u.current_chart_type)),o.xp6(2),o.Q6J("ngClass",o.VKq(13,no,2==u.current_chart_type)),o.xp6(2),o.Q6J("formGroup",u.homeworkFilterForm),o.xp6(22),o.hij("",u.getChartTypeLabel(u.current_chart_type)," Min:"),o.xp6(4),o.hij("",u.getChartTypeLabel(u.current_chart_type)," Max:"),o.xp6(8),o.Q6J("ngClass",o.VKq(15,al,u.loading)),o.xp6(6),o.Oqu(u.getChartTypeLabel(u.current_chart_type)))},dependencies:[k.mk,k.O5,I._Y,I.Fj,I.JJ,I.JL,I.sg,I.u],encapsulation:2});var ds=f(4349),ll=f(1718);function Pr(a,l){if(1&a&&(o.TgZ(0,"h4",12),o._uU(1),o.qZA()),2&a){const u=o.oxw(2);o.xp6(1),o.hij("Status: ",u.statusLabel,"")}}function Qu(a,l){if(1&a){const u=o.EpF();o.TgZ(0,"div",5)(1,"div",6),o.YNc(2,Pr,2,1,"h4",7),o.qZA(),o.TgZ(3,"div",8)(4,"button",9),o.NdJ("click",function(){o.CHM(u);const M=o.oxw();return o.KtG(M.notImplemented())}),o._uU(5,"Enable Delete Mode"),o.qZA()(),o.TgZ(6,"div",8)(7,"button",10),o.NdJ("click",function(){o.CHM(u);const M=o.oxw();return o.KtG(M.notImplemented())}),o._uU(8,"Enable Edit Mode"),o.qZA()(),o.TgZ(9,"div",8)(10,"button",11),o.NdJ("click",function(){o.CHM(u);const M=o.oxw(),D=o.MAs(5);return o.KtG(M.askHomeworkName(D))}),o._uU(11,"Submit"),o.qZA()()()}if(2&a){const u=o.oxw();o.xp6(2),o.Q6J("ngIf",""!=u.statusLabel),o.xp6(8),o.Q6J("disabled",!u.isValidGraph)}}function Fc(a,l){if(1&a&&(o.TgZ(0,"div",24)(1,"div",25)(2,"div",18)(3,"strong"),o._uU(4,"Map Name:"),o.qZA(),o._uU(5),o._UZ(6,"br"),o.TgZ(7,"strong"),o._uU(8,"Submitted at:"),o.qZA(),o._uU(9),o.ALo(10,"dateLabel"),o._UZ(11,"br")(12,"br"),o.TgZ(13,"strong"),o._uU(14,"Entropy (H):"),o.qZA(),o._uU(15),o._UZ(16,"br"),o.TgZ(17,"strong"),o._uU(18,"Entropy Percent (Hr):"),o.qZA(),o._uU(19),o._UZ(20,"br"),o.TgZ(21,"strong"),o._uU(22,"Effort (M):"),o.qZA(),o._uU(23),o._UZ(24,"br"),o.qZA()()()),2&a){const u=o.oxw(2);o.xp6(5),o.hij(" ",u.homework.student_map.map_name,""),o.xp6(4),o.hij(" ",o.lcZ(10,5,u.homework.student_map.created_at),""),o.xp6(6),o.hij(" ",u.homework.student_map.entropy.toFixed(2),""),o.xp6(4),o.hij(" ",u.homework.student_map.entropy_percent.toFixed(2),""),o.xp6(4),o.hij(" ",u.homework.student_map.effort.toFixed(2),"")}}function gi(a,l){if(1&a){const u=o.EpF();o.TgZ(0,"div",26)(1,"div",17)(2,"div",18)(3,"form",27),o.NdJ("ngSubmit",function(){o.CHM(u);const M=o.oxw(2);return o.KtG(M.onSubmitNode())}),o.TgZ(4,"div",28)(5,"label",29),o._uU(6,"Node Name:"),o.qZA(),o._UZ(7,"input",30),o.qZA(),o.TgZ(8,"div",31)(9,"button",32),o._uU(10,"Add"),o.qZA()()(),o.TgZ(11,"form",33),o.NdJ("ngSubmit",function(){o.CHM(u);const M=o.oxw(2);return o.KtG(M.linkNodes())}),o.TgZ(12,"div",34)(13,"label",35),o._uU(14,"Source Node:"),o.qZA(),o.TgZ(15,"ng-select",36),o.NdJ("ngModelChange",function(M){o.CHM(u);const D=o.oxw(2);return o.KtG(D.sourceLinkNodeId=M)}),o.qZA()(),o.TgZ(16,"div",28)(17,"label",37),o._uU(18,"Target Node:"),o.qZA(),o.TgZ(19,"ng-select",38),o.NdJ("ngModelChange",function(M){o.CHM(u);const D=o.oxw(2);return o.KtG(D.targetLinkNodeId=M)}),o.qZA()(),o.TgZ(20,"div",28)(21,"label",39),o._uU(22,"Label:"),o.qZA(),o.TgZ(23,"input",40),o.NdJ("ngModelChange",function(M){o.CHM(u);const D=o.oxw(2);return o.KtG(D.labelLink=M)}),o.qZA()(),o.TgZ(24,"div",31)(25,"button",32),o._uU(26,"Link"),o.qZA()()()()()()}if(2&a){const u=o.oxw(2);o.xp6(3),o.Q6J("formGroup",u.nodeCreateForm),o.xp6(6),o.Q6J("disabled",!u.nodeCreateForm.valid),o.xp6(6),o.Q6J("items",u.nodes)("ngModel",u.sourceLinkNodeId),o.xp6(4),o.Q6J("items",u.nodes)("ngModel",u.targetLinkNodeId),o.xp6(4),o.Q6J("ngModel",u.labelLink),o.xp6(2),o.Q6J("disabled",!u.sourceLinkNodeId||!u.targetLinkNodeId||!u.labelLink)}}function fs(a,l){1&a&&(o.O4$(),o.TgZ(0,"marker",41),o._UZ(1,"path",42),o.qZA())}function ul(a,l){if(1&a&&(o.O4$(),o.TgZ(0,"g",43),o._UZ(1,"rect",44),o.TgZ(2,"text",45),o._uU(3),o.qZA()()),2&a){const u=l.$implicit;o.xp6(1),o.uIk("width",u.dimension.width)("height",u.dimension.height)("fill",u.data.color),o.xp6(1),o.uIk("x",10)("y",u.dimension.height/2),o.xp6(1),o.hij(" ",u.label," ")}}function bn(a,l){if(1&a&&(o.O4$(),o.TgZ(0,"g",46),o._UZ(1,"path",47),o.TgZ(2,"text",48)(3,"textPath",49),o._uU(4),o.qZA()()()),2&a){const u=l.$implicit;o.xp6(3),o.Udp("dominant-baseline",u.dominantBaseline),o.uIk("href","#"+u.id),o.xp6(1),o.hij(" ",u.label," ")}}function cl(a,l){if(1&a&&(o.TgZ(0,"div",13),o.YNc(1,Fc,25,7,"div",14),o.YNc(2,gi,27,8,"div",15),o.TgZ(3,"div",16)(4,"div",17)(5,"div",18)(6,"div",19)(7,"ngx-graph",20),o.YNc(8,fs,2,0,"ng-template",null,21,o.W1O),o.YNc(10,ul,4,6,"ng-template",null,22,o.W1O),o.YNc(12,bn,5,4,"ng-template",null,23,o.W1O),o.qZA()()()()()()),2&a){const u=o.oxw();o.xp6(1),o.Q6J("ngIf",u.homework.student_map),o.xp6(1),o.Q6J("ngIf",!u.homework.student_map),o.xp6(5),o.Q6J("showMiniMap",!1)("layoutSettings",u.layoutSettings)("links",u.links)("nodes",u.nodes)("autoCenter",!0)}}function Rc(a,l){if(1&a){const u=o.EpF();o.TgZ(0,"div",50)(1,"h4",51),o._uU(2,"Submit Homework"),o.qZA(),o.TgZ(3,"button",52),o.NdJ("click",function(){o.CHM(u);const M=o.oxw();return o.KtG(M.hideSubmitHomeworkModal())}),o.TgZ(4,"span",53),o._uU(5,"\xd7"),o.qZA()()(),o.TgZ(6,"div",54)(7,"form",27),o.NdJ("ngSubmit",function(){o.CHM(u);const M=o.oxw();return o.KtG(M.submitHomework())}),o.TgZ(8,"div",28)(9,"label",29),o._uU(10,"Map Name:"),o.qZA(),o._UZ(11,"input",55),o.qZA(),o.TgZ(12,"div",31)(13,"button",32),o._uU(14,"Submit"),o.qZA()()()()}if(2&a){const u=o.oxw();o.xp6(7),o.Q6J("formGroup",u.homeworkCreateForm),o.xp6(6),o.Q6J("disabled",!u.homeworkCreateForm.valid)}}class vi{constructor(l,u,v,M,D){this._route=l,this._classroomHomeworkService=u,this._router=v,this._alertService=M,this._modalService=D,this.layoutSettings={orientation:Ir.TOP_TO_BOTTOM},this.nodeCreateForm=new I.cw({name:new I.NI(null,I.kI.required)}),this.homeworkCreateForm=new I.cw({name:new I.NI(null,I.kI.required)}),this.statusLabel="",this.loading=!1,this.nodesCount=0,this.linksCount=0,this.nodes=[],this.links=[],this.sourceLinkNodeId=null,this.targetLinkNodeId=null,this.labelLink=null,this.isValidGraph=!1;let R=JSON.parse(localStorage.getItem("currentUserData"));R||this._router.navigate(["/users/auth"]),this.user=R}ngOnInit(){this.classroom_id=this._route.snapshot.paramMap.get("classroom_id"),this.homework_id=this._route.snapshot.paramMap.get("homework_id"),this.getClassroomHomework()}getClassroomHomework(){this.loading=!0,this._classroomHomeworkService.getClassroomHomework(this.classroom_id,this.homework_id).subscribe(l=>{if(l.hasOwnProperty("error"))this._router.navigate(["/"]);else if(this.homework=l,this.homework.student_map){for(let u of this.homework.student_map.nodes_labels)this.nodes=[...this.nodes,{id:"node"+this.nodesCount.toString(),label:u}],this.nodesCount++;for(let u=0;u<this.homework.student_map.adjacency_matrix.length;u++)for(let v=0;v<this.homework.student_map.adjacency_matrix[u].length;v++)this.homework.student_map.adjacency_matrix[u][v]&&(this.links=[...this.links,{id:"link"+this.linksCount.toString(),source:"node"+u,target:"node"+v,label:this.homework.student_map.adjacency_matrix_labels[u][v]}],this.linksCount++)}this.loading=!1})}onSubmitNode(){if(this.nodes.length==this.homework.node_max)return this._alertService.error("You have reached the maximum amount of nodes.");this.nodes=[...this.nodes,{id:"node"+this.nodesCount.toString(),label:this.nodeCreateForm.value.name}],this.nodesCount++,this.nodeCreateForm.reset(),this.isValidGraph=this.checkDAG()}linkNodes(){this.links=[...this.links,{id:"link"+this.linksCount.toString(),source:this.sourceLinkNodeId,target:this.targetLinkNodeId,label:this.labelLink}],this.linksCount++,this.sourceLinkNodeId=null,this.targetLinkNodeId=null,this.labelLink=null,this.isValidGraph=this.checkDAG()}hideSubmitHomeworkModal(){this._modalRef?.hide()}askHomeworkName(l){this._modalRef=this._modalService.show(l)}submitHomework(){let l=[],u=Array.from(Array(this.nodes.length),M=>Array(this.nodes.length).fill(""));for(let M of this.links){let D=parseInt(M.source.replace("node","")),R=parseInt(M.target.replace("node",""));u[D][R]=M.label}for(let M of this.nodes)l.push(M.label);let v={homework_id:this.homework_id,nodes_count:this.nodes.length,edges_count:this.links.length,nodes_labels:l,adjacency_matrix:this.adjacencyMatrix,adjacency_matrix_labels:u,map_name:this.homeworkCreateForm.value.name?this.homeworkCreateForm.value.name:""};this._classroomHomeworkService.createClassroomHomeworkMap(this.classroom_id,this.homework_id,v).subscribe(M=>{M.hasOwnProperty("error")||(window.location.reload(),this._alertService.success("Homework submitted."))})}isValidConceptualMap(l){let u=0;if(this.hasCycle(l))return this.statusLabel="The graph has cycles",!1;for(let v=0;v<l.length;v++){if(u>1)return this.statusLabel="The graph has multiple roots",!1;if(l[v].every(D=>0===D)){let D=!1;for(let R=0;R<l.length;R++)if(l[R][v]){D=!0;break}if(!D)return this.statusLabel="The graph has a leaf that is not connected to any node",!1}else!l.some(R=>R[v])&&u++}return this.statusLabel="The graph is valid",!0}hasCycle(l){const u=Array(l.length).fill(!1),v=[],M=D=>{if(v.includes(D))return!0;if(u[D])return!1;u[D]=!0,v.push(D);for(let R=0;R<l.length;R++)if(l[D][R]&&M(R))return!0;return v.pop(),!1};for(let D=0;D<l.length;D++)if(!u[D]&&M(D))return!0;return!1}checkDAG(){if(this.nodes.length<this.homework.node_min)return this.statusLabel="The graph has less nodes than the minimum required",!1;if(this.nodes.length>this.homework.node_max)return this.statusLabel="The graph has more nodes than the maximum allowed",!1;this.adjacencyMatrix=Array.from(Array(this.nodes.length),()=>Array(this.nodes.length).fill(0));for(const l of this.links){const u=parseInt(l.source.replace("node","")),v=parseInt(l.target.replace("node",""));this.adjacencyMatrix[u][v]=1}return console.log(this.adjacencyMatrix),this.isValidConceptualMap(this.adjacencyMatrix)}notImplemented(){this._alertService.error("Not implemented yet")}}vi.\u0275fac=function(l){return new(l||vi)(o.Y36(g.gz),o.Y36(d.c),o.Y36(g.F0),o.Y36(C.c),o.Y36(cs.tT))},vi.\u0275cmp=o.Xpm({type:vi,selectors:[["app-classroom-homework-map-create"]],decls:6,vars:2,consts:[[1,"card","mx-2","pb-2","h-85"],[1,"card-body","h-100"],["class","row px-2 mb-3",4,"ngIf"],["class","row px-2 h-90",4,"ngIf"],["submitHomeworkModal",""],[1,"row","px-2","mb-3"],[1,"col-6"],["class","h5",4,"ngIf"],[1,"col-2","align-items-right"],[1,"btn","btn-danger","d-grid","w-100",3,"click"],[1,"btn","btn-warning","d-grid","w-100",3,"click"],[1,"btn","btn-success","d-grid","w-100",3,"disabled","click"],[1,"h5"],[1,"row","px-2","h-90"],["class","col-3",4,"ngIf"],["class","col-3 h-100",4,"ngIf"],[1,"col-9","h-100"],[1,"card","h-100"],[1,"card-body"],[1,"h-100"],[3,"showMiniMap","layoutSettings","links","nodes","autoCenter"],["defsTemplate",""],["nodeTemplate",""],["linkTemplate",""],[1,"col-3"],[1,"card","mb-4"],[1,"col-3","h-100"],[3,"formGroup","ngSubmit"],[1,"mb-3"],["for","title",1,"form-label"],["type","text","id","node_name","name","node_name","formControlName","name",1,"form-control"],[1,"text-center"],["type","submit",1,"btn","btn-primary","d-grid","w-100",3,"disabled"],[3,"ngSubmit"],[1,"my-3"],["for","source_node",1,"form-label"],["id","source_node","name","source_node","bindLabel","label","bindValue","id",3,"items","ngModel","ngModelChange"],["for","target_node",1,"form-label"],["id","target_node","name","target_node","bindLabel","label","bindValue","id",3,"items","ngModel","ngModelChange"],["for","link_label",1,"form-label"],["type","text","id","link_label","name","link_label",1,"form-control",3,"ngModel","ngModelChange"],["id","arrow","viewBox","0 -5 10 10","refX","8","refY","0","markerWidth","4","markerHeight","4","orient","auto"],["d","M0,-5L10,0L0,5",1,"arrow-head"],[1,"node"],["rx","15"],["alignment-baseline","central"],[1,"edge"],["stroke-width","2","marker-end","url(#arrow)",1,"line"],["text-anchor","middle",1,"edge-label"],["startOffset","50%",1,"text-path"],[1,"modal-header"],[1,"modal-title","pull-left"],["type","button","aria-label","Close",1,"btn-close","close","pull-right",3,"click"],["aria-hidden","true",1,"visually-hidden"],[1,"modal-body"],["type","text","id","map_name","name","map_name","formControlName","name",1,"form-control"]],template:function(l,u){1&l&&(o.TgZ(0,"div",0)(1,"div",1),o.YNc(2,Qu,12,2,"div",2),o.YNc(3,cl,14,7,"div",3),o.qZA()(),o.YNc(4,Rc,15,2,"ng-template",null,4,o.W1O)),2&l&&(o.xp6(2),o.Q6J("ngIf",!u.homework.student_map),o.xp6(1),o.Q6J("ngIf",u.homework))},dependencies:[k.O5,I._Y,I.Fj,I.JJ,I.JL,I.On,I.F,I.sg,I.u,ds.w9,Hn,ll.$],encapsulation:2});var Cn=f(1481);class yi{constructor(l){this.sanitizer=l}transform(l){return this.sanitizer.bypassSecurityTrustHtml(l)}}function Xu(a,l){1&a&&(o.TgZ(0,"div",4),o._UZ(1,"div",5),o.TgZ(2,"div",6),o._UZ(3,"div",7),o.qZA()())}function qu(a,l){if(1&a){const u=o.EpF();o.TgZ(0,"div",22),o._UZ(1,"div",20),o.TgZ(2,"div",23)(3,"button",24),o.NdJ("click",function(){o.CHM(u);const M=o.oxw(2);return o.KtG(M.showEditHomeworkModal())}),o._uU(4,"Edit Homework"),o.qZA()(),o.TgZ(5,"div",23)(6,"button",25),o.NdJ("click",function(){o.CHM(u);const M=o.oxw(2);return o.KtG(M.toggleMapCreation())}),o._uU(7),o.qZA()()()}if(2&a){const u=o.oxw(2);o.xp6(7),o.Oqu(u.getMapCreationButtonLabel())}}function hl(a,l){if(1&a&&(o.TgZ(0,"div",8)(1,"div",9)(2,"div",10)(3,"div",11),o.YNc(4,qu,8,1,"div",12),o.TgZ(5,"div",13)(6,"div",14)(7,"div",10)(8,"div",11)(9,"div"),o._UZ(10,"i",15),o.TgZ(11,"strong"),o._uU(12,"Title:"),o.qZA(),o._uU(13),o.qZA(),o.TgZ(14,"div"),o._UZ(15,"i",16),o.TgZ(16,"strong"),o._uU(17,"Start:"),o.qZA(),o._uU(18),o.ALo(19,"dateLabel"),o.qZA(),o.TgZ(20,"div"),o._UZ(21,"i",17),o.TgZ(22,"strong"),o._uU(23,"Expire:"),o.qZA(),o._uU(24),o.ALo(25,"dateLabel"),o.qZA(),o.TgZ(26,"div"),o._UZ(27,"i",18),o.TgZ(28,"strong"),o._uU(29,"Node Min:"),o.qZA(),o._uU(30),o.qZA(),o.TgZ(31,"div"),o._UZ(32,"i",19),o.TgZ(33,"strong"),o._uU(34,"Node Max:"),o.qZA(),o._uU(35),o.qZA()()()(),o.TgZ(36,"div",20)(37,"div",10)(38,"div",11),o._UZ(39,"div",21),o.ALo(40,"safeHtml"),o.qZA()()()()()()()()),2&a){const u=o.oxw();o.xp6(4),o.Q6J("ngIf",1==u.user.role),o.xp6(9),o.hij(" ",u.homework.title," "),o.xp6(5),o.hij(" ",o.lcZ(19,7,u.homework.start_datetime)," "),o.xp6(6),o.hij(" ",o.lcZ(25,9,u.homework.expire_datetime)," "),o.xp6(6),o.hij(" ",u.homework.node_min," "),o.xp6(5),o.hij(" ",u.homework.node_max," "),o.xp6(4),o.Q6J("innerHTML",o.lcZ(40,11,u.homework.body),o.oJD)}}function Bc(a,l){1&a&&o._UZ(0,"app-classroom-homework-map-create")}function tc(a,l){1&a&&o._UZ(0,"app-classroom-homework-teacher-view")}yi.\u0275fac=function(l){return new(l||yi)(o.Y36(Cn.H7,16))},yi.\u0275pipe=o.Yjl({name:"safeHtml",type:yi,pure:!0});class xi{constructor(l,u,v,M){this._route=l,this._classroomHomeworkService=u,this._router=v,this._alertService=M,this.loading=!1,this._hasEnabledMapCreation=!1,this._mapCreationButtonLabel="Create Map";let D=JSON.parse(localStorage.getItem("currentUserData"));D||this._router.navigate(["/users/auth"]),this.user=D}ngOnInit(){this.classroom_id=this._route.snapshot.paramMap.get("classroom_id"),this.homework_id=this._route.snapshot.paramMap.get("homework_id"),this.getClassroomHomework()}getClassroomHomework(){this.loading=!0,this._classroomHomeworkService.getClassroomHomework(this.classroom_id,this.homework_id).subscribe(l=>{l.hasOwnProperty("error")?this._router.navigate(["/"]):(this.homework=l,this.homework.body=(0,w.io)(JSON.parse(this.homework.body))),this.loading=!1})}toggleMapCreation(){this._hasEnabledMapCreation=!this._hasEnabledMapCreation,this._mapCreationButtonLabel=this._hasEnabledMapCreation?"Hide Map Creation":"Create Map"}getMapCreationButtonLabel(){return this._mapCreationButtonLabel}get hasEnabledMapCreation(){return this._hasEnabledMapCreation}showEditHomeworkModal(){this._alertService.error("Not implemented yet!")}}xi.\u0275fac=function(l){return new(l||xi)(o.Y36(g.gz),o.Y36(d.c),o.Y36(g.F0),o.Y36(C.c))},xi.\u0275cmp=o.Xpm({type:xi,selectors:[["app-classroom-homework-view"]],decls:6,vars:4,consts:[["class","row mt-5 g-0",4,"ngIf"],[1,"mt-4","h-80","container-fluid"],["class","row px-2 mb-4",4,"ngIf"],[4,"ngIf"],[1,"row","mt-5","g-0"],[1,"col-5"],[1,"col-2","ms-5","mt-5"],[1,"ms-3","custom-big-loader","mt-5"],[1,"row","px-2","mb-4"],[1,"col-12"],[1,"card"],[1,"card-body"],["class","row mb-3",4,"ngIf"],[1,"row"],[1,"col-4"],[1,"fa-solid","fa-fw","fa-sheet-plastic","me-1"],[1,"fa-solid","fa-fw","fa-hourglass-start","me-1"],[1,"fa-solid","fa-fw","fa-hourglass-end","me-1"],[1,"fa-regular","fa-fw","fa-circle","me-1"],[1,"fa-solid","fa-fw","fa-circle-nodes","me-1"],[1,"col-8"],[3,"innerHTML"],[1,"row","mb-3"],[1,"col-2"],[1,"btn","btn-warning","d-grid","w-100",3,"click"],[1,"btn","btn-success","d-grid","w-100",3,"click"]],template:function(l,u){1&l&&(o._UZ(0,"app-navbar"),o.YNc(1,Xu,4,0,"div",0),o.TgZ(2,"div",1),o.YNc(3,hl,41,13,"div",2),o.YNc(4,Bc,1,0,"app-classroom-homework-map-create",3),o.YNc(5,tc,1,0,"app-classroom-homework-teacher-view",3),o.qZA()),2&l&&(o.xp6(1),o.Q6J("ngIf",u.loading),o.xp6(2),o.Q6J("ngIf",u.homework),o.xp6(1),o.Q6J("ngIf",0==u.user.role||1==u.user.role&&u.hasEnabledMapCreation),o.xp6(1),o.Q6J("ngIf",1==u.user.role))},dependencies:[k.O5,N.S,Dr,vi,ll.$,yi],styles:["\n  p {\n    margin-bottom: 0;\n  }\n"],encapsulation:2});const ec=[{path:"",pathMatch:"full",redirectTo:"/dashboard"},{path:":homework_id",component:xi,canActivate:[y.a]},{path:":homework_id/teacher",component:Dr,canActivate:[y.a]}];class Lr{}Lr.\u0275fac=function(l){return new(l||Lr)},Lr.\u0275mod=o.oAB({type:Lr}),Lr.\u0275inj=o.cJS({imports:[g.Bz.forChild(ec),g.Bz]});class Fr{}Fr.\u0275fac=function(l){return new(l||Fr)},Fr.\u0275mod=o.oAB({type:Fr}),Fr.\u0275inj=o.cJS({providers:[d.c],imports:[k.ez,x.m,_.UserModule,Lr,ar,w.FP]})},4937:(T,A,f)=>{"use strict";f.d(A,{c:()=>_});var m=f(1571),E=f(2340),h=f(5059),k=f(529),x=f(9985);class _{constructor(g,y){this._http=g,this._httpErrorHandler=y,this._classroomEndpointUrl=E.N.apiEndpointUrl+"classrooms/",this.updatedClassroomHomeworks$=new m.vpe,this._handleError=this._httpErrorHandler.createHandleError("UserService")}createClassroomHomework(g){let y=g.classroom_id;return this._http.post(this._classroomEndpointUrl+y+"/homeworks/",{title:g.title,body:g.body,node_min:g.node_min,node_max:g.node_max,start_datetime:g.start_datetime,expire_datetime:g.expire_datetime}).pipe((0,h.K)(this._handleError("createClassroomHomework",{error:!0})))}getClassroomHomeworks(g){return this._http.get(this._classroomEndpointUrl+g+"/homeworks").pipe((0,h.K)(this._handleError("getClassroomHomeworks",{error:!0})))}getClassroomHomework(g,y){return this._http.get(this._classroomEndpointUrl+g+"/homeworks/"+y).pipe((0,h.K)(this._handleError("getClassroomHomework",{error:!0})))}createClassroomHomeworkMap(g,y,w){return this._http.post(this._classroomEndpointUrl+g+"/homeworks/"+y,w).pipe((0,h.K)(this._handleError("createClassroomHomeworkMap",{error:!0})))}}_.\u0275fac=function(g){return new(g||_)(m.LFG(k.eN),m.LFG(x.G))},_.\u0275prov=m.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"})},7315:(T,A,f)=>{"use strict";f.d(A,{u:()=>_});var m=f(1571),E=f(2340),h=f(5059),k=f(529),x=f(9985);class _{constructor(g,y){this._http=g,this._httpErrorHandler=y,this._classroomEndpointUrl=E.N.apiEndpointUrl+"classrooms/",this.updatedClassrooms$=new m.vpe,this._handleError=this._httpErrorHandler.createHandleError("UserService")}getClassrooms(){return this._http.get(this._classroomEndpointUrl).pipe((0,h.K)(this._handleError("getClassrooms",{error:!0})))}getClassroom(g){return this._http.get(this._classroomEndpointUrl+g).pipe((0,h.K)(this._handleError("getClassroom",{error:!0})))}joinStudentClassroom(g){return this._http.get(this._classroomEndpointUrl+"invite/"+g).pipe((0,h.K)(this._handleError("joinStudentClassroom",{error:!0})))}createClassroom(g){return this._http.post(this._classroomEndpointUrl,g).pipe((0,h.K)(this._handleError("createClassroom",{error:!0})))}getClassroomStudents(g){return this._http.get(this._classroomEndpointUrl+g+"/students").pipe((0,h.K)(this._handleError("getClassroomStudents",{error:!0})))}}_.\u0275fac=function(g){return new(g||_)(m.LFG(k.eN),m.LFG(x.G))},_.\u0275prov=m.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"})},9695:(T,A,f)=>{T.exports={graphlib:f(6456),layout:f(4850),debug:f(1914),util:{time:f(1510).time,notime:f(1510).notime},version:f(8126)}},2234:(T,A,f)=>{"use strict";var m=f(5760),E=f(7365);T.exports={run:function h(_){var d="greedy"===_.graph().acyclicer?E(_,function g(y){return function(w){return y.edge(w).weight}}(_)):function k(_){var d=[],g={},y={};function w(o){m.has(y,o)||(y[o]=!0,g[o]=!0,m.forEach(_.outEdges(o),function(C){m.has(g,C.w)?d.push(C):w(C.w)}),delete g[o])}return m.forEach(_.nodes(),w),d}(_);m.forEach(d,function(y){var w=_.edge(y);_.removeEdge(y),w.forwardName=y.name,w.reversed=!0,_.setEdge(y.w,y.v,w,m.uniqueId("rev"))})},undo:function x(_){m.forEach(_.edges(),function(d){var g=_.edge(d);if(g.reversed){_.removeEdge(d);var y=g.forwardName;delete g.reversed,delete g.forwardName,_.setEdge(d.w,d.v,g,y)}})}}},9999:(T,A,f)=>{var m=f(5760),E=f(1510);function k(x,_,d,g,y,w){var o={width:0,height:0,rank:w,borderType:_},C=y[_][w-1],N=E.addDummyNode(x,"border",o,d);y[_][w]=N,x.setParent(N,g),C&&x.setEdge(C,N,{weight:1})}T.exports=function h(x){m.forEach(x.children(),function _(d){var g=x.children(d),y=x.node(d);if(g.length&&m.forEach(g,_),m.has(y,"minRank")){y.borderLeft=[],y.borderRight=[];for(var w=y.minRank,o=y.maxRank+1;w<o;++w)k(x,"borderLeft","_bl",d,y,w),k(x,"borderRight","_br",d,y,w)}})}},3870:(T,A,f)=>{"use strict";var m=f(5760);function k(w){m.forEach(w.nodes(),function(o){x(w.node(o))}),m.forEach(w.edges(),function(o){x(w.edge(o))})}function x(w){var o=w.width;w.width=w.height,w.height=o}function d(w){w.y=-w.y}function y(w){var o=w.x;w.x=w.y,w.y=o}T.exports={adjust:function E(w){var o=w.graph().rankdir.toLowerCase();("lr"===o||"rl"===o)&&k(w)},undo:function h(w){var o=w.graph().rankdir.toLowerCase();("bt"===o||"rl"===o)&&function _(w){m.forEach(w.nodes(),function(o){d(w.node(o))}),m.forEach(w.edges(),function(o){var C=w.edge(o);m.forEach(C.points,d),m.has(C,"y")&&d(C)})}(w),("lr"===o||"rl"===o)&&(function g(w){m.forEach(w.nodes(),function(o){y(w.node(o))}),m.forEach(w.edges(),function(o){var C=w.edge(o);m.forEach(C.points,y),m.has(C,"x")&&y(C)})}(w),k(w))}}},3226:T=>{function A(){var E={};E._next=E._prev=E,this._sentinel=E}function f(E){E._prev._next=E._next,E._next._prev=E._prev,delete E._next,delete E._prev}function m(E,h){if("_next"!==E&&"_prev"!==E)return h}T.exports=A,A.prototype.dequeue=function(){var E=this._sentinel,h=E._prev;if(h!==E)return f(h),h},A.prototype.enqueue=function(E){var h=this._sentinel;E._prev&&E._next&&f(E),E._next=h._next,h._next._prev=E,h._next=E,E._prev=h},A.prototype.toString=function(){for(var E=[],h=this._sentinel,k=h._prev;k!==h;)E.push(JSON.stringify(k,m)),k=k._prev;return"["+E.join(", ")+"]"}},1914:(T,A,f)=>{var m=f(5760),E=f(1510),h=f(6456).Graph;T.exports={debugOrdering:function k(x){var _=E.buildLayerMatrix(x),d=new h({compound:!0,multigraph:!0}).setGraph({});return m.forEach(x.nodes(),function(g){d.setNode(g,{label:g}),d.setParent(g,"layer"+x.node(g).rank)}),m.forEach(x.edges(),function(g){d.setEdge(g.v,g.w,{},g.name)}),m.forEach(_,function(g,y){var w="layer"+y;d.setNode(w,{rank:"same"}),m.reduce(g,function(o,C){return d.setEdge(o,C,{style:"invis"}),C})}),d}}},6456:(T,A,f)=>{var m;try{m=f(5510)}catch{}m||(m=window.graphlib),T.exports=m},7365:(T,A,f)=>{var m=f(5760),E=f(6456).Graph,h=f(3226);T.exports=function x(w,o){if(w.nodeCount()<=1)return[];var C=function g(w,o){var C=new E,N=0,I=0;m.forEach(w.nodes(),function(H){C.setNode(H,{v:H,in:0,out:0})}),m.forEach(w.edges(),function(H){var Z=C.edge(H.v,H.w)||0,V=o(H),K=Z+V;C.setEdge(H.v,H.w,K),I=Math.max(I,C.node(H.v).out+=V),N=Math.max(N,C.node(H.w).in+=V)});var L=m.range(I+N+3).map(function(){return new h}),z=N+1;return m.forEach(C.nodes(),function(H){y(L,z,C.node(H))}),{graph:C,buckets:L,zeroIdx:z}}(w,o||k),N=function _(w,o,C){for(var z,N=[],I=o[o.length-1],L=o[0];w.nodeCount();){for(;z=L.dequeue();)d(w,o,C,z);for(;z=I.dequeue();)d(w,o,C,z);if(w.nodeCount())for(var H=o.length-2;H>0;--H)if(z=o[H].dequeue()){N=N.concat(d(w,o,C,z,!0));break}}return N}(C.graph,C.buckets,C.zeroIdx);return m.flatten(m.map(N,function(I){return w.outEdges(I.v,I.w)}),!0)};var k=m.constant(1);function d(w,o,C,N,I){var L=I?[]:void 0;return m.forEach(w.inEdges(N.v),function(z){var H=w.edge(z),Z=w.node(z.v);I&&L.push({v:z.v,w:z.w}),Z.out-=H,y(o,C,Z)}),m.forEach(w.outEdges(N.v),function(z){var H=w.edge(z),Z=z.w,V=w.node(Z);V.in-=H,y(o,C,V)}),w.removeNode(N.v),L}function y(w,o,C){C.out?C.in?w[C.out-C.in+o].enqueue(C):w[w.length-1].enqueue(C):w[0].enqueue(C)}},4850:(T,A,f)=>{"use strict";var m=f(5760),E=f(2234),h=f(1496),k=f(4124),x=f(1510).normalizeRanks,_=f(162),d=f(1510).removeEmptyRanks,g=f(1230),y=f(9999),w=f(3870),o=f(2974),C=f(8226),N=f(1510),I=f(6456).Graph;T.exports=function L(ht,mt){var _t=mt&&mt.debugTiming?N.time:N.notime;_t("layout",function(){var Tt=_t("  buildLayoutGraph",function(){return function $(ht){var mt=new I({multigraph:!0,compound:!0}),_t=Ft(ht.graph());return mt.setGraph(m.merge({},V,Nt(_t,Z),m.pick(_t,K))),m.forEach(ht.nodes(),function(Tt){var Pt=Ft(ht.node(Tt));mt.setNode(Tt,m.defaults(Nt(Pt,q),st)),mt.setParent(Tt,ht.parent(Tt))}),m.forEach(ht.edges(),function(Tt){var Pt=Ft(ht.edge(Tt));mt.setEdge(Tt,m.merge({},lt,Nt(Pt,it),m.pick(Pt,F)))}),mt}(ht)});_t("  runLayout",function(){!function z(ht,mt){mt("    makeSpaceForEdgeLabels",function(){!function Y(ht){var mt=ht.graph();mt.ranksep/=2,m.forEach(ht.edges(),function(_t){var Tt=ht.edge(_t);Tt.minlen*=2,"c"!==Tt.labelpos.toLowerCase()&&("TB"===mt.rankdir||"BT"===mt.rankdir?Tt.width+=Tt.labeloffset:Tt.height+=Tt.labeloffset)})}(ht)}),mt("    removeSelfEdges",function(){!function bt(ht){m.forEach(ht.edges(),function(mt){if(mt.v===mt.w){var _t=ht.node(mt.v);_t.selfEdges||(_t.selfEdges=[]),_t.selfEdges.push({e:mt,label:ht.edge(mt)}),ht.removeEdge(mt)}})}(ht)}),mt("    acyclic",function(){E.run(ht)}),mt("    nestingGraph.run",function(){g.run(ht)}),mt("    rank",function(){k(N.asNonCompoundGraph(ht))}),mt("    injectEdgeLabelProxies",function(){!function j(ht){m.forEach(ht.edges(),function(mt){var _t=ht.edge(mt);if(_t.width&&_t.height){var Tt=ht.node(mt.v),At={rank:(ht.node(mt.w).rank-Tt.rank)/2+Tt.rank,e:mt};N.addDummyNode(ht,"edge-proxy",At,"_ep")}})}(ht)}),mt("    removeEmptyRanks",function(){d(ht)}),mt("    nestingGraph.cleanup",function(){g.cleanup(ht)}),mt("    normalizeRanks",function(){x(ht)}),mt("    assignRankMinMax",function(){!function W(ht){var mt=0;m.forEach(ht.nodes(),function(_t){var Tt=ht.node(_t);Tt.borderTop&&(Tt.minRank=ht.node(Tt.borderTop).rank,Tt.maxRank=ht.node(Tt.borderBottom).rank,mt=m.max(mt,Tt.maxRank))}),ht.graph().maxRank=mt}(ht)}),mt("    removeEdgeLabelProxies",function(){!function at(ht){m.forEach(ht.nodes(),function(mt){var _t=ht.node(mt);"edge-proxy"===_t.dummy&&(ht.edge(_t.e).labelRank=_t.rank,ht.removeNode(mt))})}(ht)}),mt("    normalize.run",function(){h.run(ht)}),mt("    parentDummyChains",function(){_(ht)}),mt("    addBorderSegments",function(){y(ht)}),mt("    order",function(){o(ht)}),mt("    insertSelfEdges",function(){!function yt(ht){var mt=N.buildLayerMatrix(ht);m.forEach(mt,function(_t){var Tt=0;m.forEach(_t,function(Pt,At){var Ht=ht.node(Pt);Ht.order=At+Tt,m.forEach(Ht.selfEdges,function($t){N.addDummyNode(ht,"selfedge",{width:$t.label.width,height:$t.label.height,rank:Ht.rank,order:At+ ++Tt,e:$t.e,label:$t.label},"_se")}),delete Ht.selfEdges})})}(ht)}),mt("    adjustCoordinateSystem",function(){w.adjust(ht)}),mt("    position",function(){C(ht)}),mt("    positionSelfEdges",function(){!function kt(ht){m.forEach(ht.nodes(),function(mt){var _t=ht.node(mt);if("selfedge"===_t.dummy){var Tt=ht.node(_t.e.v),Pt=Tt.x+Tt.width/2,At=Tt.y,Ht=_t.x-Pt,$t=Tt.height/2;ht.setEdge(_t.e,_t.label),ht.removeNode(mt),_t.label.points=[{x:Pt+2*Ht/3,y:At-$t},{x:Pt+5*Ht/6,y:At-$t},{x:Pt+Ht,y:At},{x:Pt+5*Ht/6,y:At+$t},{x:Pt+2*Ht/3,y:At+$t}],_t.label.x=_t.x,_t.label.y=_t.y}})}(ht)}),mt("    removeBorderNodes",function(){!function pt(ht){m.forEach(ht.nodes(),function(mt){if(ht.children(mt).length){var _t=ht.node(mt),Tt=ht.node(_t.borderTop),Pt=ht.node(_t.borderBottom),At=ht.node(m.last(_t.borderLeft)),Ht=ht.node(m.last(_t.borderRight));_t.width=Math.abs(Ht.x-At.x),_t.height=Math.abs(Pt.y-Tt.y),_t.x=At.x+_t.width/2,_t.y=Tt.y+_t.height/2}}),m.forEach(ht.nodes(),function(mt){"border"===ht.node(mt).dummy&&ht.removeNode(mt)})}(ht)}),mt("    normalize.undo",function(){h.undo(ht)}),mt("    fixupEdgeLabelCoords",function(){!function X(ht){m.forEach(ht.edges(),function(mt){var _t=ht.edge(mt);if(m.has(_t,"x"))switch(("l"===_t.labelpos||"r"===_t.labelpos)&&(_t.width-=_t.labeloffset),_t.labelpos){case"l":_t.x-=_t.width/2+_t.labeloffset;break;case"r":_t.x+=_t.width/2+_t.labeloffset}})}(ht)}),mt("    undoCoordinateSystem",function(){w.undo(ht)}),mt("    translateGraph",function(){!function ot(ht){var mt=Number.POSITIVE_INFINITY,_t=0,Tt=Number.POSITIVE_INFINITY,Pt=0,At=ht.graph(),Ht=At.marginx||0,$t=At.marginy||0;function fe(Wt){var Qt=Wt.x,gt=Wt.y,Et=Wt.width,ft=Wt.height;mt=Math.min(mt,Qt-Et/2),_t=Math.max(_t,Qt+Et/2),Tt=Math.min(Tt,gt-ft/2),Pt=Math.max(Pt,gt+ft/2)}m.forEach(ht.nodes(),function(Wt){fe(ht.node(Wt))}),m.forEach(ht.edges(),function(Wt){var Qt=ht.edge(Wt);m.has(Qt,"x")&&fe(Qt)}),mt-=Ht,Tt-=$t,m.forEach(ht.nodes(),function(Wt){var Qt=ht.node(Wt);Qt.x-=mt,Qt.y-=Tt}),m.forEach(ht.edges(),function(Wt){var Qt=ht.edge(Wt);m.forEach(Qt.points,function(gt){gt.x-=mt,gt.y-=Tt}),m.has(Qt,"x")&&(Qt.x-=mt),m.has(Qt,"y")&&(Qt.y-=Tt)}),At.width=_t-mt+Ht,At.height=Pt-Tt+$t}(ht)}),mt("    assignNodeIntersects",function(){!function et(ht){m.forEach(ht.edges(),function(mt){var At,Ht,_t=ht.edge(mt),Tt=ht.node(mt.v),Pt=ht.node(mt.w);_t.points?(At=_t.points[0],Ht=_t.points[_t.points.length-1]):(_t.points=[],At=Pt,Ht=Tt),_t.points.unshift(N.intersectRect(Tt,At)),_t.points.push(N.intersectRect(Pt,Ht))})}(ht)}),mt("    reversePoints",function(){!function dt(ht){m.forEach(ht.edges(),function(mt){var _t=ht.edge(mt);_t.reversed&&_t.points.reverse()})}(ht)}),mt("    acyclic.undo",function(){E.undo(ht)})}(Tt,_t)}),_t("  updateInputGraph",function(){!function H(ht,mt){m.forEach(ht.nodes(),function(_t){var Tt=ht.node(_t),Pt=mt.node(_t);Tt&&(Tt.x=Pt.x,Tt.y=Pt.y,mt.children(_t).length&&(Tt.width=Pt.width,Tt.height=Pt.height))}),m.forEach(ht.edges(),function(_t){var Tt=ht.edge(_t),Pt=mt.edge(_t);Tt.points=Pt.points,m.has(Pt,"x")&&(Tt.x=Pt.x,Tt.y=Pt.y)}),ht.graph().width=mt.graph().width,ht.graph().height=mt.graph().height}(ht,Tt)})})};var Z=["nodesep","edgesep","ranksep","marginx","marginy"],V={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},K=["acyclicer","ranker","rankdir","align"],q=["width","height"],st={width:0,height:0},it=["minlen","weight","width","height","labeloffset"],lt={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},F=["labelpos"];function Nt(ht,mt){return m.mapValues(m.pick(ht,mt),Number)}function Ft(ht){var mt={};return m.forEach(ht,function(_t,Tt){mt[Tt.toLowerCase()]=_t}),mt}},5760:(T,A,f)=>{var m;try{m={cloneDeep:f(733),constant:f(6684),defaults:f(8800),each:f(5474),filter:f(5281),find:f(2516),flatten:f(2274),forEach:f(9851),forIn:f(1176),has:f(4842),isUndefined:f(4235),last:f(5809),map:f(9984),mapValues:f(203),max:f(8176),merge:f(567),min:f(9439),minBy:f(9525),now:f(1710),pick:f(6372),range:f(361),reduce:f(1337),sortBy:f(2906),uniqueId:f(1541),values:f(377),zipObject:f(1617)}}catch{}m||(m=window._),T.exports=m},1230:(T,A,f)=>{var m=f(5760),E=f(1510);function k(g,y,w,o,C,N,I){var L=g.children(I);if(L.length){var z=E.addBorderNode(g,"_bt"),H=E.addBorderNode(g,"_bb"),Z=g.node(I);g.setParent(z,I),Z.borderTop=z,g.setParent(H,I),Z.borderBottom=H,m.forEach(L,function(V){k(g,y,w,o,C,N,V);var K=g.node(V),q=K.borderTop?K.borderTop:V,st=K.borderBottom?K.borderBottom:V,it=K.borderTop?o:2*o,lt=q!==st?1:C-N[I]+1;g.setEdge(z,q,{weight:it,minlen:lt,nestingEdge:!0}),g.setEdge(st,H,{weight:it,minlen:lt,nestingEdge:!0})}),g.parent(I)||g.setEdge(y,z,{weight:0,minlen:C+N[I]})}else I!==y&&g.setEdge(y,I,{weight:0,minlen:w})}T.exports={run:function h(g){var y=E.addDummyNode(g,"root",{},"_root"),w=function x(g){var y={};function w(o,C){var N=g.children(o);N&&N.length&&m.forEach(N,function(I){w(I,C+1)}),y[o]=C}return m.forEach(g.children(),function(o){w(o,1)}),y}(g),o=m.max(m.values(w))-1,C=2*o+1;g.graph().nestingRoot=y,m.forEach(g.edges(),function(I){g.edge(I).minlen*=C});var N=function _(g){return m.reduce(g.edges(),function(y,w){return y+g.edge(w).weight},0)}(g)+1;m.forEach(g.children(),function(I){k(g,y,C,N,o,w,I)}),g.graph().nodeRankFactor=C},cleanup:function d(g){var y=g.graph();g.removeNode(y.nestingRoot),delete y.nestingRoot,m.forEach(g.edges(),function(w){g.edge(w).nestingEdge&&g.removeEdge(w)})}}},1496:(T,A,f)=>{"use strict";var m=f(5760),E=f(1510);T.exports={run:function h(_){_.graph().dummyChains=[],m.forEach(_.edges(),function(d){!function k(_,d){var g=d.v,y=_.node(g).rank,w=d.w,o=_.node(w).rank,C=d.name,N=_.edge(d),I=N.labelRank;if(o!==y+1){var L,z,H;for(_.removeEdge(d),H=0,++y;y<o;++H,++y)N.points=[],z={width:0,height:0,edgeLabel:N,edgeObj:d,rank:y},L=E.addDummyNode(_,"edge",z,"_d"),y===I&&(z.width=N.width,z.height=N.height,z.dummy="edge-label",z.labelpos=N.labelpos),_.setEdge(g,L,{weight:N.weight},C),0===H&&_.graph().dummyChains.push(L),g=L;_.setEdge(g,w,{weight:N.weight},C)}}(_,d)})},undo:function x(_){m.forEach(_.graph().dummyChains,function(d){var w,g=_.node(d),y=g.edgeLabel;for(_.setEdge(g.edgeObj,y);g.dummy;)w=_.successors(d)[0],_.removeNode(d),y.points.push({x:g.x,y:g.y}),"edge-label"===g.dummy&&(y.x=g.x,y.y=g.y,y.width=g.width,y.height=g.height),d=w,g=_.node(d)})}}},3034:(T,A,f)=>{var m=f(5760);T.exports=function E(h,k,x){var d,_={};m.forEach(x,function(g){for(var w,o,y=h.parent(g);y;){if((w=h.parent(y))?(o=_[w],_[w]=y):(o=d,d=y),o&&o!==y)return void k.setEdge(o,y);y=w}})}},1323:(T,A,f)=>{var m=f(5760);T.exports=function E(h,k){return m.map(k,function(x){var _=h.inEdges(x);if(_.length){var d=m.reduce(_,function(g,y){var w=h.edge(y),o=h.node(y.v);return{sum:g.sum+w.weight*o.order,weight:g.weight+w.weight}},{sum:0,weight:0});return{v:x,barycenter:d.sum/d.weight,weight:d.weight}}return{v:x}})}},1686:(T,A,f)=>{var m=f(5760),E=f(6456).Graph;T.exports=function h(x,_,d){var g=function k(x){for(var _;x.hasNode(_=m.uniqueId("_root")););return _}(x),y=new E({compound:!0}).setGraph({root:g}).setDefaultNodeLabel(function(w){return x.node(w)});return m.forEach(x.nodes(),function(w){var o=x.node(w),C=x.parent(w);(o.rank===_||o.minRank<=_&&_<=o.maxRank)&&(y.setNode(w),y.setParent(w,C||g),m.forEach(x[d](w),function(N){var I=N.v===w?N.w:N.v,L=y.edge(I,w),z=m.isUndefined(L)?0:L.weight;y.setEdge(I,w,{weight:x.edge(N).weight+z})}),m.has(o,"minRank")&&y.setNode(w,{borderLeft:o.borderLeft[_],borderRight:o.borderRight[_]}))}),y}},8796:(T,A,f)=>{"use strict";var m=f(5760);function h(k,x,_){for(var d=m.zipObject(_,m.map(_,function(N,I){return I})),g=m.flatten(m.map(x,function(N){return m.sortBy(m.map(k.outEdges(N),function(I){return{pos:d[I.w],weight:k.edge(I).weight}}),"pos")}),!0),y=1;y<_.length;)y<<=1;var w=2*y-1;y-=1;var o=m.map(new Array(w),function(){return 0}),C=0;return m.forEach(g.forEach(function(N){var I=N.pos+y;o[I]+=N.weight;for(var L=0;I>0;)I%2&&(L+=o[I+1]),o[I=I-1>>1]+=N.weight;C+=N.weight*L})),C}T.exports=function E(k,x){for(var _=0,d=1;d<x.length;++d)_+=h(k,x[d-1],x[d]);return _}},2974:(T,A,f)=>{"use strict";var m=f(5760),E=f(9402),h=f(8796),k=f(1057),x=f(1686),_=f(3034),d=f(6456).Graph,g=f(1510);function w(N,I,L){return m.map(I,function(z){return x(N,z,L)})}function o(N,I){var L=new d;m.forEach(N,function(z){var H=z.graph().root,Z=k(z,H,L,I);m.forEach(Z.vs,function(V,K){z.node(V).order=K}),_(z,L,Z.vs)})}function C(N,I){m.forEach(I,function(L){m.forEach(L,function(z,H){N.node(z).order=H})})}T.exports=function y(N){var I=g.maxRank(N),L=w(N,m.range(1,I+1),"inEdges"),z=w(N,m.range(I-1,-1,-1),"outEdges"),H=E(N);C(N,H);for(var V,Z=Number.POSITIVE_INFINITY,K=0,q=0;q<4;++K,++q){o(K%2?L:z,K%4>=2),H=g.buildLayerMatrix(N);var st=h(N,H);st<Z&&(q=0,V=m.cloneDeep(H),Z=st)}C(N,V)}},9402:(T,A,f)=>{"use strict";var m=f(5760);T.exports=function E(h){var k={},x=m.filter(h.nodes(),function(w){return!h.children(w).length}),_=m.max(m.map(x,function(w){return h.node(w).rank})),d=m.map(m.range(_+1),function(){return[]});var y=m.sortBy(x,function(w){return h.node(w).rank});return m.forEach(y,function g(w){if(!m.has(k,w)){k[w]=!0;var o=h.node(w);d[o.rank].push(w),m.forEach(h.successors(w),g)}}),d}},3826:(T,A,f)=>{"use strict";var m=f(5760);T.exports=function E(x,_){var d={};return m.forEach(x,function(y,w){var o=d[y.v]={indegree:0,in:[],out:[],vs:[y.v],i:w};m.isUndefined(y.barycenter)||(o.barycenter=y.barycenter,o.weight=y.weight)}),m.forEach(_.edges(),function(y){var w=d[y.v],o=d[y.w];!m.isUndefined(w)&&!m.isUndefined(o)&&(o.indegree++,w.out.push(d[y.w]))}),function h(x){var _=[];function d(w){return function(o){o.merged||(m.isUndefined(o.barycenter)||m.isUndefined(w.barycenter)||o.barycenter>=w.barycenter)&&function k(x,_){var d=0,g=0;x.weight&&(d+=x.barycenter*x.weight,g+=x.weight),_.weight&&(d+=_.barycenter*_.weight,g+=_.weight),x.vs=_.vs.concat(x.vs),x.barycenter=d/g,x.weight=g,x.i=Math.min(_.i,x.i),_.merged=!0}(w,o)}}function g(w){return function(o){o.in.push(w),0==--o.indegree&&x.push(o)}}for(;x.length;){var y=x.pop();_.push(y),m.forEach(y.in.reverse(),d(y)),m.forEach(y.out,g(y))}return m.map(m.filter(_,function(w){return!w.merged}),function(w){return m.pick(w,["vs","i","barycenter","weight"])})}(m.filter(d,function(y){return!y.indegree}))}},1057:(T,A,f)=>{var m=f(5760),E=f(1323),h=f(3826),k=f(3803);T.exports=function x(g,y,w,o){var C=g.children(y),N=g.node(y),I=N?N.borderLeft:void 0,L=N?N.borderRight:void 0,z={};I&&(C=m.filter(C,function(st){return st!==I&&st!==L}));var H=E(g,C);m.forEach(H,function(st){if(g.children(st.v).length){var it=x(g,st.v,w,o);z[st.v]=it,m.has(it,"barycenter")&&function d(g,y){m.isUndefined(g.barycenter)?(g.barycenter=y.barycenter,g.weight=y.weight):(g.barycenter=(g.barycenter*g.weight+y.barycenter*y.weight)/(g.weight+y.weight),g.weight+=y.weight)}(st,it)}});var Z=h(H,w);!function _(g,y){m.forEach(g,function(w){w.vs=m.flatten(w.vs.map(function(o){return y[o]?y[o].vs:o}),!0)})}(Z,z);var V=k(Z,o);if(I&&(V.vs=m.flatten([I,V.vs,L],!0),g.predecessors(I).length)){var K=g.node(g.predecessors(I)[0]),q=g.node(g.predecessors(L)[0]);m.has(V,"barycenter")||(V.barycenter=0,V.weight=0),V.barycenter=(V.barycenter*V.weight+K.order+q.order)/(V.weight+2),V.weight+=2}return V}},3803:(T,A,f)=>{var m=f(5760),E=f(1510);function k(_,d,g){for(var y;d.length&&(y=m.last(d)).i<=g;)d.pop(),_.push(y.vs),g++;return g}T.exports=function h(_,d){var g=E.partition(_,function(z){return m.has(z,"barycenter")}),y=g.lhs,w=m.sortBy(g.rhs,function(z){return-z.i}),o=[],C=0,N=0,I=0;y.sort(function x(_){return function(d,g){return d.barycenter<g.barycenter?-1:d.barycenter>g.barycenter?1:_?g.i-d.i:d.i-g.i}}(!!d)),I=k(o,w,I),m.forEach(y,function(z){I+=z.vs.length,o.push(z.vs),C+=z.barycenter*z.weight,N+=z.weight,I=k(o,w,I)});var L={vs:m.flatten(o,!0)};return N&&(L.barycenter=C/N,L.weight=N),L}},162:(T,A,f)=>{var m=f(5760);T.exports=function E(x){var _=function k(x){var _={},d=0;function g(y){var w=d;m.forEach(x.children(y),g),_[y]={low:w,lim:d++}}return m.forEach(x.children(),g),_}(x);m.forEach(x.graph().dummyChains,function(d){for(var g=x.node(d),y=g.edgeObj,w=function h(x,_,d,g){var N,I,y=[],w=[],o=Math.min(_[d].low,_[g].low),C=Math.max(_[d].lim,_[g].lim);N=d;do{N=x.parent(N),y.push(N)}while(N&&(_[N].low>o||C>_[N].lim));for(I=N,N=g;(N=x.parent(N))!==I;)w.push(N);return{path:y.concat(w.reverse()),lca:I}}(x,_,y.v,y.w),o=w.path,C=w.lca,N=0,I=o[N],L=!0;d!==y.w;){if(g=x.node(d),L){for(;(I=o[N])!==C&&x.node(I).maxRank<g.rank;)N++;I===C&&(L=!1)}if(!L){for(;N<o.length-1&&x.node(I=o[N+1]).minRank<=g.rank;)N++;I=o[N]}x.setParent(d,I),d=x.successors(d)[0]}})}},4058:(T,A,f)=>{"use strict";var m=f(5760),E=f(6456).Graph,h=f(1510);function k(Z,V){var K={};return m.reduce(V,function q(st,it){var lt=0,F=0,$=st.length,Y=m.last(it);return m.forEach(it,function(j,W){var at=function _(Z,V){if(Z.node(V).dummy)return m.find(Z.predecessors(V),function(K){return Z.node(K).dummy})}(Z,j),ot=at?Z.node(at).order:$;(at||j===Y)&&(m.forEach(it.slice(F,W+1),function(et){m.forEach(Z.predecessors(et),function(X){var dt=Z.node(X),pt=dt.order;(pt<lt||ot<pt)&&(!dt.dummy||!Z.node(et).dummy)&&d(K,X,et)})}),F=W+1,lt=ot)}),it}),K}function x(Z,V){var K={};function q(it,lt,F,$,Y){var j;m.forEach(m.range(lt,F),function(W){j=it[W],Z.node(j).dummy&&m.forEach(Z.predecessors(j),function(at){var ot=Z.node(at);ot.dummy&&(ot.order<$||ot.order>Y)&&d(K,at,j)})})}return m.reduce(V,function st(it,lt){var $,F=-1,Y=0;return m.forEach(lt,function(j,W){if("border"===Z.node(j).dummy){var at=Z.predecessors(j);at.length&&($=Z.node(at[0]).order,q(lt,Y,W,F,$),Y=W,F=$)}q(lt,Y,lt.length,$,it.length)}),lt}),K}function d(Z,V,K){if(V>K){var q=V;V=K,K=q}var st=Z[V];st||(Z[V]=st={}),st[K]=!0}function g(Z,V,K){if(V>K){var q=V;V=K,K=q}return m.has(Z[V],K)}function y(Z,V,K,q){var st={},it={},lt={};return m.forEach(V,function(F){m.forEach(F,function($,Y){st[$]=$,it[$]=$,lt[$]=Y})}),m.forEach(V,function(F){var $=-1;m.forEach(F,function(Y){var j=q(Y);if(j.length)for(var W=((j=m.sortBy(j,function(X){return lt[X]})).length-1)/2,at=Math.floor(W),ot=Math.ceil(W);at<=ot;++at){var et=j[at];it[Y]===Y&&$<lt[et]&&!g(K,Y,et)&&(it[et]=Y,it[Y]=st[Y]=st[et],$=lt[et])}})}),{root:st,align:it}}function w(Z,V,K,q,st){var it={},lt=function o(Z,V,K,q){var st=new E,it=Z.graph(),lt=function z(Z,V,K){return function(q,st,it){var Y,lt=q.node(st),F=q.node(it),$=0;if($+=lt.width/2,m.has(lt,"labelpos"))switch(lt.labelpos.toLowerCase()){case"l":Y=-lt.width/2;break;case"r":Y=lt.width/2}if(Y&&($+=K?Y:-Y),Y=0,$+=(lt.dummy?V:Z)/2,$+=(F.dummy?V:Z)/2,$+=F.width/2,m.has(F,"labelpos"))switch(F.labelpos.toLowerCase()){case"l":Y=F.width/2;break;case"r":Y=-F.width/2}return Y&&($+=K?Y:-Y),Y=0,$}}(it.nodesep,it.edgesep,q);return m.forEach(V,function(F){var $;m.forEach(F,function(Y){var j=K[Y];if(st.setNode(j),$){var W=K[$],at=st.edge(W,j);st.setEdge(W,j,Math.max(lt(Z,Y,$),at||0))}$=Y})}),st}(Z,V,K,st),F=st?"borderLeft":"borderRight";function $(W,at){for(var ot=lt.nodes(),et=ot.pop(),X={};et;)X[et]?W(et):(X[et]=!0,ot.push(et),ot=ot.concat(at(et))),et=ot.pop()}return $(function Y(W){it[W]=lt.inEdges(W).reduce(function(at,ot){return Math.max(at,it[ot.v]+lt.edge(ot))},0)},lt.predecessors.bind(lt)),$(function j(W){var at=lt.outEdges(W).reduce(function(et,X){return Math.min(et,it[X.w]-lt.edge(X))},Number.POSITIVE_INFINITY),ot=Z.node(W);at!==Number.POSITIVE_INFINITY&&ot.borderType!==F&&(it[W]=Math.max(it[W],at))},lt.successors.bind(lt)),m.forEach(q,function(W){it[W]=it[K[W]]}),it}function C(Z,V){return m.minBy(m.values(V),function(K){var q=Number.NEGATIVE_INFINITY,st=Number.POSITIVE_INFINITY;return m.forIn(K,function(it,lt){var F=function H(Z,V){return Z.node(V).width}(Z,lt)/2;q=Math.max(it+F,q),st=Math.min(it-F,st)}),q-st})}function N(Z,V){var K=m.values(V),q=m.min(K),st=m.max(K);m.forEach(["u","d"],function(it){m.forEach(["l","r"],function(lt){var Y,F=it+lt,$=Z[F];if($!==V){var j=m.values($);(Y="l"===lt?q-m.min(j):st-m.max(j))&&(Z[F]=m.mapValues($,function(W){return W+Y}))}})})}function I(Z,V){return m.mapValues(Z.ul,function(K,q){if(V)return Z[V.toLowerCase()][q];var st=m.sortBy(m.map(Z,q));return(st[1]+st[2])/2})}T.exports={positionX:function L(Z){var st,V=h.buildLayerMatrix(Z),K=m.merge(k(Z,V),x(Z,V)),q={};m.forEach(["u","d"],function(lt){st="u"===lt?V:m.values(V).reverse(),m.forEach(["l","r"],function(F){"r"===F&&(st=m.map(st,function(W){return m.values(W).reverse()}));var $=("u"===lt?Z.predecessors:Z.successors).bind(Z),Y=y(Z,st,K,$),j=w(Z,st,Y.root,Y.align,"r"===F);"r"===F&&(j=m.mapValues(j,function(W){return-W})),q[lt+F]=j})});var it=C(Z,q);return N(q,it),I(q,Z.graph().align)},findType1Conflicts:k,findType2Conflicts:x,addConflict:d,hasConflict:g,verticalAlignment:y,horizontalCompaction:w,alignCoordinates:N,findSmallestWidthAlignment:C,balance:I}},8226:(T,A,f)=>{"use strict";var m=f(5760),E=f(1510),h=f(4058).positionX;T.exports=function k(_){(function x(_){var d=E.buildLayerMatrix(_),g=_.graph().ranksep,y=0;m.forEach(d,function(w){var o=m.max(m.map(w,function(C){return _.node(C).height}));m.forEach(w,function(C){_.node(C).y=y+o/2}),y+=o+g})})(_=E.asNonCompoundGraph(_)),m.forEach(h(_),function(d,g){_.node(g).x=d})}},6632:(T,A,f)=>{"use strict";var m=f(5760),E=f(6456).Graph,h=f(1916).slack;function x(g,y){return m.forEach(g.nodes(),function w(o){m.forEach(y.nodeEdges(o),function(C){var N=C.v,I=o===N?C.w:N;!g.hasNode(I)&&!h(y,C)&&(g.setNode(I,{}),g.setEdge(o,I,{}),w(I))})}),g.nodeCount()}function _(g,y){return m.minBy(y.edges(),function(w){if(g.hasNode(w.v)!==g.hasNode(w.w))return h(y,w)})}function d(g,y,w){m.forEach(g.nodes(),function(o){y.node(o).rank+=w})}T.exports=function k(g){var C,N,y=new E({directed:!1}),w=g.nodes()[0],o=g.nodeCount();for(y.setNode(w,{});x(y,g)<o;)C=_(y,g),N=y.hasNode(C.v)?h(g,C):-h(g,C),d(y,g,N);return y}},4124:(T,A,f)=>{"use strict";var E=f(1916).longestPath,h=f(6632),k=f(3804);T.exports=function x(y){switch(y.graph().ranker){case"network-simplex":default:g(y);break;case"tight-tree":!function d(y){E(y),h(y)}(y);break;case"longest-path":_(y)}};var _=E;function g(y){k(y)}},3804:(T,A,f)=>{"use strict";var m=f(5760),E=f(6632),h=f(1916).slack,k=f(1916).longestPath,x=f(6456).alg.preorder,_=f(6456).alg.postorder,d=f(1510).simplify;function g(K){K=d(K),k(K);var st,q=E(K);for(C(q),y(q,K);st=I(q);)z(q,K,st,L(q,K,st))}function y(K,q){var st=_(K,K.nodes());st=st.slice(0,st.length-1),m.forEach(st,function(it){!function w(K,q,st){var it=K.node(st),lt=it.parent;K.edge(st,lt).cutvalue=o(K,q,st)}(K,q,it)})}function o(K,q,st){var lt=K.node(st).parent,F=!0,$=q.edge(st,lt),Y=0;return $||(F=!1,$=q.edge(lt,st)),Y=$.weight,m.forEach(q.nodeEdges(st),function(j){var W=j.v===st,at=W?j.w:j.v;if(at!==lt){var ot=W===F,et=q.edge(j).weight;if(Y+=ot?et:-et,function Z(K,q,st){return K.hasEdge(q,st)}(K,st,at)){var X=K.edge(st,at).cutvalue;Y+=ot?-X:X}}}),Y}function C(K,q){arguments.length<2&&(q=K.nodes()[0]),N(K,{},1,q)}function N(K,q,st,it,lt){var F=st,$=K.node(it);return q[it]=!0,m.forEach(K.neighbors(it),function(Y){m.has(q,Y)||(st=N(K,q,st,Y,it))}),$.low=F,$.lim=st++,lt?$.parent=lt:delete $.parent,st}function I(K){return m.find(K.edges(),function(q){return K.edge(q).cutvalue<0})}function L(K,q,st){var it=st.v,lt=st.w;q.hasEdge(it,lt)||(it=st.w,lt=st.v);var F=K.node(it),$=K.node(lt),Y=F,j=!1;F.lim>$.lim&&(Y=$,j=!0);var W=m.filter(q.edges(),function(at){return j===V(K,K.node(at.v),Y)&&j!==V(K,K.node(at.w),Y)});return m.minBy(W,function(at){return h(q,at)})}function z(K,q,st,it){var lt=st.v,F=st.w;K.removeEdge(lt,F),K.setEdge(it.v,it.w,{}),C(K),y(K,q),function H(K,q){var st=m.find(K.nodes(),function(lt){return!q.node(lt).parent}),it=x(K,st);it=it.slice(1),m.forEach(it,function(lt){var F=K.node(lt).parent,$=q.edge(lt,F),Y=!1;$||($=q.edge(F,lt),Y=!0),q.node(lt).rank=q.node(F).rank+(Y?$.minlen:-$.minlen)})}(K,q)}function V(K,q,st){return st.low<=q.lim&&q.lim<=st.lim}T.exports=g,g.initLowLimValues=C,g.initCutValues=y,g.calcCutValue=o,g.leaveEdge=I,g.enterEdge=L,g.exchangeEdges=z},1916:(T,A,f)=>{"use strict";var m=f(5760);T.exports={longestPath:function E(k){var x={};m.forEach(k.sources(),function _(d){var g=k.node(d);if(m.has(x,d))return g.rank;x[d]=!0;var y=m.min(m.map(k.outEdges(d),function(w){return _(w.w)-k.edge(w).minlen}));return(y===Number.POSITIVE_INFINITY||null==y)&&(y=0),g.rank=y})},slack:function h(k,x){return k.node(x.w).rank-k.node(x.v).rank-k.edge(x).minlen}}},1510:(T,A,f)=>{"use strict";var m=f(5760),E=f(6456).Graph;function h(H,Z,V,K){var q;do{q=m.uniqueId(K)}while(H.hasNode(q));return V.dummy=Z,H.setNode(q,V),q}function N(H){return m.max(m.map(H.nodes(),function(Z){var V=H.node(Z).rank;if(!m.isUndefined(V))return V}))}T.exports={addDummyNode:h,simplify:function k(H){var Z=(new E).setGraph(H.graph());return m.forEach(H.nodes(),function(V){Z.setNode(V,H.node(V))}),m.forEach(H.edges(),function(V){var K=Z.edge(V.v,V.w)||{weight:0,minlen:1},q=H.edge(V);Z.setEdge(V.v,V.w,{weight:K.weight+q.weight,minlen:Math.max(K.minlen,q.minlen)})}),Z},asNonCompoundGraph:function x(H){var Z=new E({multigraph:H.isMultigraph()}).setGraph(H.graph());return m.forEach(H.nodes(),function(V){H.children(V).length||Z.setNode(V,H.node(V))}),m.forEach(H.edges(),function(V){Z.setEdge(V,H.edge(V))}),Z},successorWeights:function _(H){var Z=m.map(H.nodes(),function(V){var K={};return m.forEach(H.outEdges(V),function(q){K[q.w]=(K[q.w]||0)+H.edge(q).weight}),K});return m.zipObject(H.nodes(),Z)},predecessorWeights:function d(H){var Z=m.map(H.nodes(),function(V){var K={};return m.forEach(H.inEdges(V),function(q){K[q.v]=(K[q.v]||0)+H.edge(q).weight}),K});return m.zipObject(H.nodes(),Z)},intersectRect:function g(H,Z){var F,$,V=H.x,K=H.y,q=Z.x-V,st=Z.y-K,it=H.width/2,lt=H.height/2;if(!q&&!st)throw new Error("Not possible to find intersection inside of the rectangle");return Math.abs(st)*it>Math.abs(q)*lt?(st<0&&(lt=-lt),F=lt*q/st,$=lt):(q<0&&(it=-it),F=it,$=it*st/q),{x:V+F,y:K+$}},buildLayerMatrix:function y(H){var Z=m.map(m.range(N(H)+1),function(){return[]});return m.forEach(H.nodes(),function(V){var K=H.node(V),q=K.rank;m.isUndefined(q)||(Z[q][K.order]=V)}),Z},normalizeRanks:function w(H){var Z=m.min(m.map(H.nodes(),function(V){return H.node(V).rank}));m.forEach(H.nodes(),function(V){var K=H.node(V);m.has(K,"rank")&&(K.rank-=Z)})},removeEmptyRanks:function o(H){var Z=m.min(m.map(H.nodes(),function(st){return H.node(st).rank})),V=[];m.forEach(H.nodes(),function(st){var it=H.node(st).rank-Z;V[it]||(V[it]=[]),V[it].push(st)});var K=0,q=H.graph().nodeRankFactor;m.forEach(V,function(st,it){m.isUndefined(st)&&it%q!=0?--K:K&&m.forEach(st,function(lt){H.node(lt).rank+=K})})},addBorderNode:function C(H,Z,V,K){var q={width:0,height:0};return arguments.length>=4&&(q.rank=V,q.order=K),h(H,"border",q,Z)},maxRank:N,partition:function I(H,Z){var V={lhs:[],rhs:[]};return m.forEach(H,function(K){Z(K)?V.lhs.push(K):V.rhs.push(K)}),V},time:function L(H,Z){var V=m.now();try{return Z()}finally{console.log(H+" time: "+(m.now()-V)+"ms")}},notime:function z(H,Z){return Z()}}},8126:T=>{T.exports="0.8.5"},5510:(T,A,f)=>{var m=f(1838);T.exports={Graph:m.Graph,json:f(1088),alg:f(3430),version:m.version}},6730:(T,A,f)=>{var m=f(9138);T.exports=function E(h){var _,k={},x=[];function d(g){m.has(k,g)||(k[g]=!0,_.push(g),m.each(h.successors(g),d),m.each(h.predecessors(g),d))}return m.each(h.nodes(),function(g){_=[],d(g),_.length&&x.push(_)}),x}},2163:(T,A,f)=>{var m=f(9138);function h(k,x,_,d,g,y){m.has(d,x)||(d[x]=!0,_||y.push(x),m.each(g(x),function(w){h(k,w,_,d,g,y)}),_&&y.push(x))}T.exports=function E(k,x,_){m.isArray(x)||(x=[x]);var d=(k.isDirected()?k.successors:k.neighbors).bind(k),g=[],y={};return m.each(x,function(w){if(!k.hasNode(w))throw new Error("Graph does not have node: "+w);h(k,w,"post"===_,y,d,g)}),g}},5668:(T,A,f)=>{var m=f(8969),E=f(9138);T.exports=function h(k,x,_){return E.transform(k.nodes(),function(d,g){d[g]=m(k,g,x,_)},{})}},8969:(T,A,f)=>{var m=f(9138),E=f(1919);T.exports=function k(_,d,g,y){return function x(_,d,g,y){var C,N,w={},o=new E,I=function(L){var z=L.v!==C?L.v:L.w,H=w[z],Z=g(L),V=N.distance+Z;if(Z<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+L+" Weight: "+Z);V<H.distance&&(H.distance=V,H.predecessor=C,o.decrease(z,V))};for(_.nodes().forEach(function(L){var z=L===d?0:Number.POSITIVE_INFINITY;w[L]={distance:z},o.add(L,z)});o.size()>0&&(C=o.removeMin(),(N=w[C]).distance!==Number.POSITIVE_INFINITY);)y(C).forEach(I);return w}(_,String(d),g||h,y||function(w){return _.outEdges(w)})};var h=m.constant(1)},9611:(T,A,f)=>{var m=f(9138),E=f(3585);T.exports=function h(k){return m.filter(E(k),function(x){return x.length>1||1===x.length&&k.hasEdge(x[0],x[0])})}},2881:(T,A,f)=>{var m=f(9138);T.exports=function h(x,_,d){return function k(x,_,d){var g={},y=x.nodes();return y.forEach(function(w){g[w]={},g[w][w]={distance:0},y.forEach(function(o){w!==o&&(g[w][o]={distance:Number.POSITIVE_INFINITY})}),d(w).forEach(function(o){var C=o.v===w?o.w:o.v,N=_(o);g[w][C]={distance:N,predecessor:w}})}),y.forEach(function(w){var o=g[w];y.forEach(function(C){var N=g[C];y.forEach(function(I){var L=N[w],z=o[I],H=N[I],Z=L.distance+z.distance;Z<H.distance&&(H.distance=Z,H.predecessor=z.predecessor)})})}),g}(x,_||E,d||function(g){return x.outEdges(g)})};var E=m.constant(1)},3430:(T,A,f)=>{T.exports={components:f(6730),dijkstra:f(8969),dijkstraAll:f(5668),findCycles:f(9611),floydWarshall:f(2881),isAcyclic:f(6693),postorder:f(6694),preorder:f(5330),prim:f(6823),tarjan:f(3585),topsort:f(2180)}},6693:(T,A,f)=>{var m=f(2180);T.exports=function E(h){try{m(h)}catch(k){if(k instanceof m.CycleException)return!1;throw k}return!0}},6694:(T,A,f)=>{var m=f(2163);T.exports=function E(h,k){return m(h,k,"post")}},5330:(T,A,f)=>{var m=f(2163);T.exports=function E(h,k){return m(h,k,"pre")}},6823:(T,A,f)=>{var m=f(9138),E=f(6568),h=f(1919);T.exports=function k(x,_){var w,d=new E,g={},y=new h;function o(N){var I=N.v===w?N.w:N.v,L=y.priority(I);if(void 0!==L){var z=_(N);z<L&&(g[I]=w,y.decrease(I,z))}}if(0===x.nodeCount())return d;m.each(x.nodes(),function(N){y.add(N,Number.POSITIVE_INFINITY),d.setNode(N)}),y.decrease(x.nodes()[0],0);for(var C=!1;y.size()>0;){if(w=y.removeMin(),m.has(g,w))d.setEdge(w,g[w]);else{if(C)throw new Error("Input graph is not connected: "+x);C=!0}x.nodeEdges(w).forEach(o)}return d}},3585:(T,A,f)=>{var m=f(9138);T.exports=function E(h){var k=0,x=[],_={},d=[];function g(y){var w=_[y]={onStack:!0,lowlink:k,index:k++};if(x.push(y),h.successors(y).forEach(function(N){m.has(_,N)?_[N].onStack&&(w.lowlink=Math.min(w.lowlink,_[N].index)):(g(N),w.lowlink=Math.min(w.lowlink,_[N].lowlink))}),w.lowlink===w.index){var C,o=[];do{C=x.pop(),_[C].onStack=!1,o.push(C)}while(y!==C);d.push(o)}}return h.nodes().forEach(function(y){m.has(_,y)||g(y)}),d}},2180:(T,A,f)=>{var m=f(9138);function E(k){var x={},_={},d=[];if(m.each(k.sinks(),function g(y){if(m.has(_,y))throw new h;m.has(x,y)||(_[y]=!0,x[y]=!0,m.each(k.predecessors(y),g),delete _[y],d.push(y))}),m.size(x)!==k.nodeCount())throw new h;return d}function h(){}T.exports=E,E.CycleException=h,h.prototype=new Error},1919:(T,A,f)=>{var m=f(9138);function E(){this._arr=[],this._keyIndices={}}T.exports=E,E.prototype.size=function(){return this._arr.length},E.prototype.keys=function(){return this._arr.map(function(h){return h.key})},E.prototype.has=function(h){return m.has(this._keyIndices,h)},E.prototype.priority=function(h){var k=this._keyIndices[h];if(void 0!==k)return this._arr[k].priority},E.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},E.prototype.add=function(h,k){var x=this._keyIndices;if(h=String(h),!m.has(x,h)){var _=this._arr,d=_.length;return x[h]=d,_.push({key:h,priority:k}),this._decrease(d),!0}return!1},E.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var h=this._arr.pop();return delete this._keyIndices[h.key],this._heapify(0),h.key},E.prototype.decrease=function(h,k){var x=this._keyIndices[h];if(k>this._arr[x].priority)throw new Error("New priority is greater than current priority. Key: "+h+" Old: "+this._arr[x].priority+" New: "+k);this._arr[x].priority=k,this._decrease(x)},E.prototype._heapify=function(h){var k=this._arr,x=2*h,_=x+1,d=h;x<k.length&&(d=k[x].priority<k[d].priority?x:d,_<k.length&&(d=k[_].priority<k[d].priority?_:d),d!==h&&(this._swap(h,d),this._heapify(d)))},E.prototype._decrease=function(h){for(var _,k=this._arr,x=k[h].priority;0!==h&&!(k[_=h>>1].priority<x);)this._swap(h,_),h=_},E.prototype._swap=function(h,k){var x=this._arr,_=this._keyIndices,d=x[h],g=x[k];x[h]=g,x[k]=d,_[g.key]=h,_[d.key]=k}},6568:(T,A,f)=>{"use strict";var m=f(9138);T.exports=x;var h="\0";function x(o){this._isDirected=!m.has(o,"directed")||o.directed,this._isMultigraph=!!m.has(o,"multigraph")&&o.multigraph,this._isCompound=!!m.has(o,"compound")&&o.compound,this._label=void 0,this._defaultNodeLabelFn=m.constant(void 0),this._defaultEdgeLabelFn=m.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[h]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function _(o,C){o[C]?o[C]++:o[C]=1}function d(o,C){--o[C]||delete o[C]}function g(o,C,N,I){var L=""+C,z=""+N;if(!o&&L>z){var H=L;L=z,z=H}return L+"\x01"+z+"\x01"+(m.isUndefined(I)?"\0":I)}function y(o,C,N,I){var L=""+C,z=""+N;if(!o&&L>z){var H=L;L=z,z=H}var Z={v:L,w:z};return I&&(Z.name=I),Z}function w(o,C){return g(o,C.v,C.w,C.name)}x.prototype._nodeCount=0,x.prototype._edgeCount=0,x.prototype.isDirected=function(){return this._isDirected},x.prototype.isMultigraph=function(){return this._isMultigraph},x.prototype.isCompound=function(){return this._isCompound},x.prototype.setGraph=function(o){return this._label=o,this},x.prototype.graph=function(){return this._label},x.prototype.setDefaultNodeLabel=function(o){return m.isFunction(o)||(o=m.constant(o)),this._defaultNodeLabelFn=o,this},x.prototype.nodeCount=function(){return this._nodeCount},x.prototype.nodes=function(){return m.keys(this._nodes)},x.prototype.sources=function(){var o=this;return m.filter(this.nodes(),function(C){return m.isEmpty(o._in[C])})},x.prototype.sinks=function(){var o=this;return m.filter(this.nodes(),function(C){return m.isEmpty(o._out[C])})},x.prototype.setNodes=function(o,C){var N=arguments,I=this;return m.each(o,function(L){N.length>1?I.setNode(L,C):I.setNode(L)}),this},x.prototype.setNode=function(o,C){return m.has(this._nodes,o)?(arguments.length>1&&(this._nodes[o]=C),this):(this._nodes[o]=arguments.length>1?C:this._defaultNodeLabelFn(o),this._isCompound&&(this._parent[o]=h,this._children[o]={},this._children[h][o]=!0),this._in[o]={},this._preds[o]={},this._out[o]={},this._sucs[o]={},++this._nodeCount,this)},x.prototype.node=function(o){return this._nodes[o]},x.prototype.hasNode=function(o){return m.has(this._nodes,o)},x.prototype.removeNode=function(o){var C=this;if(m.has(this._nodes,o)){var N=function(I){C.removeEdge(C._edgeObjs[I])};delete this._nodes[o],this._isCompound&&(this._removeFromParentsChildList(o),delete this._parent[o],m.each(this.children(o),function(I){C.setParent(I)}),delete this._children[o]),m.each(m.keys(this._in[o]),N),delete this._in[o],delete this._preds[o],m.each(m.keys(this._out[o]),N),delete this._out[o],delete this._sucs[o],--this._nodeCount}return this},x.prototype.setParent=function(o,C){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(m.isUndefined(C))C=h;else{for(var N=C+="";!m.isUndefined(N);N=this.parent(N))if(N===o)throw new Error("Setting "+C+" as parent of "+o+" would create a cycle");this.setNode(C)}return this.setNode(o),this._removeFromParentsChildList(o),this._parent[o]=C,this._children[C][o]=!0,this},x.prototype._removeFromParentsChildList=function(o){delete this._children[this._parent[o]][o]},x.prototype.parent=function(o){if(this._isCompound){var C=this._parent[o];if(C!==h)return C}},x.prototype.children=function(o){if(m.isUndefined(o)&&(o=h),this._isCompound){var C=this._children[o];if(C)return m.keys(C)}else{if(o===h)return this.nodes();if(this.hasNode(o))return[]}},x.prototype.predecessors=function(o){var C=this._preds[o];if(C)return m.keys(C)},x.prototype.successors=function(o){var C=this._sucs[o];if(C)return m.keys(C)},x.prototype.neighbors=function(o){var C=this.predecessors(o);if(C)return m.union(C,this.successors(o))},x.prototype.isLeaf=function(o){return 0===(this.isDirected()?this.successors(o):this.neighbors(o)).length},x.prototype.filterNodes=function(o){var C=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});C.setGraph(this.graph());var N=this;m.each(this._nodes,function(z,H){o(H)&&C.setNode(H,z)}),m.each(this._edgeObjs,function(z){C.hasNode(z.v)&&C.hasNode(z.w)&&C.setEdge(z,N.edge(z))});var I={};function L(z){var H=N.parent(z);return void 0===H||C.hasNode(H)?(I[z]=H,H):H in I?I[H]:L(H)}return this._isCompound&&m.each(C.nodes(),function(z){C.setParent(z,L(z))}),C},x.prototype.setDefaultEdgeLabel=function(o){return m.isFunction(o)||(o=m.constant(o)),this._defaultEdgeLabelFn=o,this},x.prototype.edgeCount=function(){return this._edgeCount},x.prototype.edges=function(){return m.values(this._edgeObjs)},x.prototype.setPath=function(o,C){var N=this,I=arguments;return m.reduce(o,function(L,z){return I.length>1?N.setEdge(L,z,C):N.setEdge(L,z),z}),this},x.prototype.setEdge=function(){var o,C,N,I,L=!1,z=arguments[0];"object"==typeof z&&null!==z&&"v"in z?(o=z.v,C=z.w,N=z.name,2===arguments.length&&(I=arguments[1],L=!0)):(o=z,C=arguments[1],N=arguments[3],arguments.length>2&&(I=arguments[2],L=!0)),o=""+o,C=""+C,m.isUndefined(N)||(N=""+N);var H=g(this._isDirected,o,C,N);if(m.has(this._edgeLabels,H))return L&&(this._edgeLabels[H]=I),this;if(!m.isUndefined(N)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(o),this.setNode(C),this._edgeLabels[H]=L?I:this._defaultEdgeLabelFn(o,C,N);var Z=y(this._isDirected,o,C,N);return o=Z.v,C=Z.w,Object.freeze(Z),this._edgeObjs[H]=Z,_(this._preds[C],o),_(this._sucs[o],C),this._in[C][H]=Z,this._out[o][H]=Z,this._edgeCount++,this},x.prototype.edge=function(o,C,N){var I=1===arguments.length?w(this._isDirected,arguments[0]):g(this._isDirected,o,C,N);return this._edgeLabels[I]},x.prototype.hasEdge=function(o,C,N){var I=1===arguments.length?w(this._isDirected,arguments[0]):g(this._isDirected,o,C,N);return m.has(this._edgeLabels,I)},x.prototype.removeEdge=function(o,C,N){var I=1===arguments.length?w(this._isDirected,arguments[0]):g(this._isDirected,o,C,N),L=this._edgeObjs[I];return L&&(o=L.v,C=L.w,delete this._edgeLabels[I],delete this._edgeObjs[I],d(this._preds[C],o),d(this._sucs[o],C),delete this._in[C][I],delete this._out[o][I],this._edgeCount--),this},x.prototype.inEdges=function(o,C){var N=this._in[o];if(N){var I=m.values(N);return C?m.filter(I,function(L){return L.v===C}):I}},x.prototype.outEdges=function(o,C){var N=this._out[o];if(N){var I=m.values(N);return C?m.filter(I,function(L){return L.w===C}):I}},x.prototype.nodeEdges=function(o,C){var N=this.inEdges(o,C);if(N)return N.concat(this.outEdges(o,C))}},1838:(T,A,f)=>{T.exports={Graph:f(6568),version:f(5089)}},1088:(T,A,f)=>{var m=f(9138),E=f(6568);function k(d){return m.map(d.nodes(),function(g){var y=d.node(g),w=d.parent(g),o={v:g};return m.isUndefined(y)||(o.value=y),m.isUndefined(w)||(o.parent=w),o})}function x(d){return m.map(d.edges(),function(g){var y=d.edge(g),w={v:g.v,w:g.w};return m.isUndefined(g.name)||(w.name=g.name),m.isUndefined(y)||(w.value=y),w})}T.exports={write:function h(d){var g={options:{directed:d.isDirected(),multigraph:d.isMultigraph(),compound:d.isCompound()},nodes:k(d),edges:x(d)};return m.isUndefined(d.graph())||(g.value=m.clone(d.graph())),g},read:function _(d){var g=new E(d.options).setGraph(d.value);return m.each(d.nodes,function(y){g.setNode(y.v,y.value),y.parent&&g.setParent(y.v,y.parent)}),m.each(d.edges,function(y){g.setEdge({v:y.v,w:y.w,name:y.name},y.value)}),g}}},9138:(T,A,f)=>{var m;try{m={clone:f(1094),constant:f(6684),each:f(5474),filter:f(5281),has:f(4842),isArray:f(1503),isEmpty:f(1973),isFunction:f(5946),isUndefined:f(4235),keys:f(118),map:f(9984),reduce:f(1337),size:f(5637),transform:f(9416),union:f(8921),values:f(377)}}catch{}m||(m=window._),T.exports=m},5089:T=>{T.exports="2.1.8"},7244:(T,A,f)=>{var h=f(3436)(f(2119),"DataView");T.exports=h},4994:(T,A,f)=>{var m=f(4312),E=f(6421),h=f(5764),k=f(8685),x=f(6676);function _(d){var g=-1,y=null==d?0:d.length;for(this.clear();++g<y;){var w=d[g];this.set(w[0],w[1])}}_.prototype.clear=m,_.prototype.delete=E,_.prototype.get=h,_.prototype.has=k,_.prototype.set=x,T.exports=_},9215:(T,A,f)=>{var m=f(1840),E=f(4378),h=f(4981),k=f(7343),x=f(8895);function _(d){var g=-1,y=null==d?0:d.length;for(this.clear();++g<y;){var w=d[g];this.set(w[0],w[1])}}_.prototype.clear=m,_.prototype.delete=E,_.prototype.get=h,_.prototype.has=k,_.prototype.set=x,T.exports=_},1501:(T,A,f)=>{var h=f(3436)(f(2119),"Map");T.exports=h},9850:(T,A,f)=>{var m=f(638),E=f(1184),h=f(866),k=f(3771),x=f(1772);function _(d){var g=-1,y=null==d?0:d.length;for(this.clear();++g<y;){var w=d[g];this.set(w[0],w[1])}}_.prototype.clear=m,_.prototype.delete=E,_.prototype.get=h,_.prototype.has=k,_.prototype.set=x,T.exports=_},4267:(T,A,f)=>{var h=f(3436)(f(2119),"Promise");T.exports=h},6323:(T,A,f)=>{var h=f(3436)(f(2119),"Set");T.exports=h},8849:(T,A,f)=>{var m=f(9850),E=f(4600),h=f(1387);function k(x){var _=-1,d=null==x?0:x.length;for(this.__data__=new m;++_<d;)this.add(x[_])}k.prototype.add=k.prototype.push=E,k.prototype.has=h,T.exports=k},2858:(T,A,f)=>{var m=f(9215),E=f(3720),h=f(4410),k=f(5576),x=f(2247),_=f(1585);function d(g){var y=this.__data__=new m(g);this.size=y.size}d.prototype.clear=E,d.prototype.delete=h,d.prototype.get=k,d.prototype.has=x,d.prototype.set=_,T.exports=d},443:(T,A,f)=>{var E=f(2119).Symbol;T.exports=E},3457:(T,A,f)=>{var E=f(2119).Uint8Array;T.exports=E},4243:(T,A,f)=>{var h=f(3436)(f(2119),"WeakMap");T.exports=h},6999:T=>{T.exports=function A(f,m,E){switch(E.length){case 0:return f.call(m);case 1:return f.call(m,E[0]);case 2:return f.call(m,E[0],E[1]);case 3:return f.call(m,E[0],E[1],E[2])}return f.apply(m,E)}},6837:T=>{T.exports=function A(f,m){for(var E=-1,h=null==f?0:f.length;++E<h&&!1!==m(f[E],E,f););return f}},9779:T=>{T.exports=function A(f,m){for(var E=-1,h=null==f?0:f.length,k=0,x=[];++E<h;){var _=f[E];m(_,E,f)&&(x[k++]=_)}return x}},1253:(T,A,f)=>{var m=f(4164);T.exports=function E(h,k){return!!(null==h?0:h.length)&&m(h,k,0)>-1}},177:T=>{T.exports=function A(f,m,E){for(var h=-1,k=null==f?0:f.length;++h<k;)if(E(m,f[h]))return!0;return!1}},2271:(T,A,f)=>{var m=f(5334),E=f(7151),h=f(1503),k=f(891),x=f(8442),_=f(8159),g=Object.prototype.hasOwnProperty;T.exports=function y(w,o){var C=h(w),N=!C&&E(w),I=!C&&!N&&k(w),L=!C&&!N&&!I&&_(w),z=C||N||I||L,H=z?m(w.length,String):[],Z=H.length;for(var V in w)(o||g.call(w,V))&&(!z||!("length"==V||I&&("offset"==V||"parent"==V)||L&&("buffer"==V||"byteLength"==V||"byteOffset"==V)||x(V,Z)))&&H.push(V);return H}},4633:T=>{T.exports=function A(f,m){for(var E=-1,h=null==f?0:f.length,k=Array(h);++E<h;)k[E]=m(f[E],E,f);return k}},4883:T=>{T.exports=function A(f,m){for(var E=-1,h=m.length,k=f.length;++E<h;)f[k+E]=m[E];return f}},8745:T=>{T.exports=function A(f,m,E,h){var k=-1,x=null==f?0:f.length;for(h&&x&&(E=f[++k]);++k<x;)E=m(E,f[k],k,f);return E}},9503:T=>{T.exports=function A(f,m){for(var E=-1,h=null==f?0:f.length;++E<h;)if(m(f[E],E,f))return!0;return!1}},5481:(T,A,f)=>{var E=f(1384)("length");T.exports=E},9276:(T,A,f)=>{var m=f(5683),E=f(217);T.exports=function h(k,x,_){(void 0!==_&&!E(k[x],_)||void 0===_&&!(x in k))&&m(k,x,_)}},9719:(T,A,f)=>{var m=f(5683),E=f(217),k=Object.prototype.hasOwnProperty;T.exports=function x(_,d,g){var y=_[d];(!k.call(_,d)||!E(y,g)||void 0===g&&!(d in _))&&m(_,d,g)}},3503:(T,A,f)=>{var m=f(217);T.exports=function E(h,k){for(var x=h.length;x--;)if(m(h[x][0],k))return x;return-1}},4121:(T,A,f)=>{var m=f(1989),E=f(118);T.exports=function h(k,x){return k&&m(x,E(x),k)}},9287:(T,A,f)=>{var m=f(1989),E=f(6555);T.exports=function h(k,x){return k&&m(x,E(x),k)}},5683:(T,A,f)=>{var m=f(6713);T.exports=function E(h,k,x){"__proto__"==k&&m?m(h,k,{configurable:!0,enumerable:!0,value:x,writable:!0}):h[k]=x}},4462:(T,A,f)=>{var m=f(2858),E=f(6837),h=f(9719),k=f(4121),x=f(9287),_=f(9292),d=f(9454),g=f(4444),y=f(9905),w=f(7597),o=f(6967),C=f(8794),N=f(6782),I=f(7878),L=f(4264),z=f(1503),H=f(891),Z=f(3222),V=f(5940),K=f(799),q=f(118),st=f(6555),$="[object Arguments]",ot="[object Function]",pt="[object Object]",gt={};gt[$]=gt["[object Array]"]=gt["[object ArrayBuffer]"]=gt["[object DataView]"]=gt["[object Boolean]"]=gt["[object Date]"]=gt["[object Float32Array]"]=gt["[object Float64Array]"]=gt["[object Int8Array]"]=gt["[object Int16Array]"]=gt["[object Int32Array]"]=gt["[object Map]"]=gt["[object Number]"]=gt[pt]=gt["[object RegExp]"]=gt["[object Set]"]=gt["[object String]"]=gt["[object Symbol]"]=gt["[object Uint8Array]"]=gt["[object Uint8ClampedArray]"]=gt["[object Uint16Array]"]=gt["[object Uint32Array]"]=!0,gt["[object Error]"]=gt[ot]=gt["[object WeakMap]"]=!1,T.exports=function Et(ft,Rt,Jt,fn,Ge,Oe){var xe,Ue=1&Rt,cr=2&Rt,bi=4&Rt;if(Jt&&(xe=Ge?Jt(ft,fn,Ge,Oe):Jt(ft)),void 0!==xe)return xe;if(!V(ft))return ft;var Gr=z(ft);if(Gr){if(xe=N(ft),!Ue)return d(ft,xe)}else{var Tn=C(ft),Ur=Tn==ot||"[object GeneratorFunction]"==Tn;if(H(ft))return _(ft,Ue);if(Tn==pt||Tn==$||Ur&&!Ge){if(xe=cr||Ur?{}:L(ft),!Ue)return cr?y(ft,x(xe,ft)):g(ft,k(xe,ft))}else{if(!gt[Tn])return Ge?ft:{};xe=I(ft,Tn,Ue)}}Oe||(Oe=new m);var Jn=Oe.get(ft);if(Jn)return Jn;Oe.set(ft,xe),K(ft)?ft.forEach(function(Ae){xe.add(Et(Ae,Rt,Jt,Ae,ft,Oe))}):Z(ft)&&ft.forEach(function(Ae,pn){xe.set(pn,Et(Ae,Rt,Jt,pn,ft,Oe))});var hr=Gr?void 0:(bi?cr?o:w:cr?st:q)(ft);return E(hr||ft,function(Ae,pn){hr&&(Ae=ft[pn=Ae]),h(xe,pn,Et(Ae,Rt,Jt,pn,ft,Oe))}),xe}},8858:(T,A,f)=>{var m=f(5940),E=Object.create,h=function(){function k(){}return function(x){if(!m(x))return{};if(E)return E(x);k.prototype=x;var _=new k;return k.prototype=void 0,_}}();T.exports=h},3132:(T,A,f)=>{var m=f(5184),h=f(6539)(m);T.exports=h},7308:(T,A,f)=>{var m=f(4129);T.exports=function E(h,k,x){for(var _=-1,d=h.length;++_<d;){var g=h[_],y=k(g);if(null!=y&&(void 0===w?y==y&&!m(y):x(y,w)))var w=y,o=g}return o}},3609:(T,A,f)=>{var m=f(3132);T.exports=function E(h,k){var x=[];return m(h,function(_,d,g){k(_,d,g)&&x.push(_)}),x}},5317:T=>{T.exports=function A(f,m,E,h){for(var k=f.length,x=E+(h?1:-1);h?x--:++x<k;)if(m(f[x],x,f))return x;return-1}},686:(T,A,f)=>{var m=f(4883),E=f(5039);T.exports=function h(k,x,_,d,g){var y=-1,w=k.length;for(_||(_=E),g||(g=[]);++y<w;){var o=k[y];x>0&&_(o)?x>1?h(o,x-1,_,d,g):m(g,o):d||(g[g.length]=o)}return g}},755:(T,A,f)=>{var E=f(456)();T.exports=E},5184:(T,A,f)=>{var m=f(755),E=f(118);T.exports=function h(k,x){return k&&m(k,x,E)}},5456:(T,A,f)=>{var m=f(6884),E=f(8533);T.exports=function h(k,x){for(var _=0,d=(x=m(x,k)).length;null!=k&&_<d;)k=k[E(x[_++])];return _&&_==d?k:void 0}},8247:(T,A,f)=>{var m=f(4883),E=f(1503);T.exports=function h(k,x,_){var d=x(k);return E(k)?d:m(d,_(k))}},3337:(T,A,f)=>{var m=f(443),E=f(1318),h=f(2902),_=m?m.toStringTag:void 0;T.exports=function d(g){return null==g?void 0===g?"[object Undefined]":"[object Null]":_&&_ in Object(g)?E(g):h(g)}},1100:T=>{T.exports=function A(f,m){return f>m}},4781:T=>{var f=Object.prototype.hasOwnProperty;T.exports=function m(E,h){return null!=E&&f.call(E,h)}},9989:T=>{T.exports=function A(f,m){return null!=f&&m in Object(f)}},4164:(T,A,f)=>{var m=f(5317),E=f(968),h=f(4977);T.exports=function k(x,_,d){return _==_?h(x,_,d):m(x,E,d)}},186:(T,A,f)=>{var m=f(3337),E=f(2671);T.exports=function k(x){return E(x)&&"[object Arguments]"==m(x)}},5740:(T,A,f)=>{var m=f(8325),E=f(2671);T.exports=function h(k,x,_,d,g){return k===x||(null==k||null==x||!E(k)&&!E(x)?k!=k&&x!=x:m(k,x,_,d,h,g))}},8325:(T,A,f)=>{var m=f(2858),E=f(3914),h=f(7058),k=f(2286),x=f(8794),_=f(1503),d=f(891),g=f(8159),w="[object Arguments]",o="[object Array]",C="[object Object]",I=Object.prototype.hasOwnProperty;T.exports=function L(z,H,Z,V,K,q){var st=_(z),it=_(H),lt=st?o:x(z),F=it?o:x(H),$=(lt=lt==w?C:lt)==C,Y=(F=F==w?C:F)==C,j=lt==F;if(j&&d(z)){if(!d(H))return!1;st=!0,$=!1}if(j&&!$)return q||(q=new m),st||g(z)?E(z,H,Z,V,K,q):h(z,H,lt,Z,V,K,q);if(!(1&Z)){var W=$&&I.call(z,"__wrapped__"),at=Y&&I.call(H,"__wrapped__");if(W||at){var ot=W?z.value():z,et=at?H.value():H;return q||(q=new m),K(ot,et,Z,V,q)}}return!!j&&(q||(q=new m),k(z,H,Z,V,K,q))}},7021:(T,A,f)=>{var m=f(8794),E=f(2671);T.exports=function k(x){return E(x)&&"[object Map]"==m(x)}},431:(T,A,f)=>{var m=f(2858),E=f(5740);T.exports=function x(_,d,g,y){var w=g.length,o=w,C=!y;if(null==_)return!o;for(_=Object(_);w--;){var N=g[w];if(C&&N[2]?N[1]!==_[N[0]]:!(N[0]in _))return!1}for(;++w<o;){var I=(N=g[w])[0],L=_[I],z=N[1];if(C&&N[2]){if(void 0===L&&!(I in _))return!1}else{var H=new m;if(y)var Z=y(L,z,I,_,d,H);if(!(void 0===Z?E(z,L,3,y,H):Z))return!1}}return!0}},968:T=>{T.exports=function A(f){return f!=f}},7304:(T,A,f)=>{var m=f(5946),E=f(1943),h=f(5940),k=f(2827),_=/^\[object .+?Constructor\]$/,d=Function.prototype,g=Object.prototype,y=d.toString,w=g.hasOwnProperty,o=RegExp("^"+y.call(w).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");T.exports=function C(N){return!(!h(N)||E(N))&&(m(N)?o:_).test(k(N))}},771:(T,A,f)=>{var m=f(8794),E=f(2671);T.exports=function k(x){return E(x)&&"[object Set]"==m(x)}},1083:(T,A,f)=>{var m=f(3337),E=f(6231),h=f(2671),j={};j["[object Float32Array]"]=j["[object Float64Array]"]=j["[object Int8Array]"]=j["[object Int16Array]"]=j["[object Int32Array]"]=j["[object Uint8Array]"]=j["[object Uint8ClampedArray]"]=j["[object Uint16Array]"]=j["[object Uint32Array]"]=!0,j["[object Arguments]"]=j["[object Array]"]=j["[object ArrayBuffer]"]=j["[object Boolean]"]=j["[object DataView]"]=j["[object Date]"]=j["[object Error]"]=j["[object Function]"]=j["[object Map]"]=j["[object Number]"]=j["[object Object]"]=j["[object RegExp]"]=j["[object Set]"]=j["[object String]"]=j["[object WeakMap]"]=!1,T.exports=function W(at){return h(at)&&E(at.length)&&!!j[m(at)]}},6517:(T,A,f)=>{var m=f(8133),E=f(9458),h=f(2608),k=f(1503),x=f(7495);T.exports=function _(d){return"function"==typeof d?d:null==d?h:"object"==typeof d?k(d)?E(d[0],d[1]):m(d):x(d)}},1172:(T,A,f)=>{var m=f(5488),E=f(5491),k=Object.prototype.hasOwnProperty;T.exports=function x(_){if(!m(_))return E(_);var d=[];for(var g in Object(_))k.call(_,g)&&"constructor"!=g&&d.push(g);return d}},2809:(T,A,f)=>{var m=f(5940),E=f(5488),h=f(2158),x=Object.prototype.hasOwnProperty;T.exports=function _(d){if(!m(d))return h(d);var g=E(d),y=[];for(var w in d)"constructor"==w&&(g||!x.call(d,w))||y.push(w);return y}},9069:T=>{T.exports=function A(f,m){return f<m}},2046:(T,A,f)=>{var m=f(3132),E=f(6507);T.exports=function h(k,x){var _=-1,d=E(k)?Array(k.length):[];return m(k,function(g,y,w){d[++_]=x(g,y,w)}),d}},8133:(T,A,f)=>{var m=f(431),E=f(2379),h=f(642);T.exports=function k(x){var _=E(x);return 1==_.length&&_[0][2]?h(_[0][0],_[0][1]):function(d){return d===x||m(d,x,_)}}},9458:(T,A,f)=>{var m=f(5740),E=f(8817),h=f(8492),k=f(5352),x=f(2442),_=f(642),d=f(8533);T.exports=function w(o,C){return k(o)&&x(C)?_(d(o),C):function(N){var I=E(N,o);return void 0===I&&I===C?h(N,o):m(C,I,3)}}},3842:(T,A,f)=>{var m=f(2858),E=f(9276),h=f(755),k=f(3675),x=f(5940),_=f(6555),d=f(9351);T.exports=function g(y,w,o,C,N){y!==w&&h(w,function(I,L){if(N||(N=new m),x(I))k(y,w,L,o,g,C,N);else{var z=C?C(d(y,L),I,L+"",y,w,N):void 0;void 0===z&&(z=I),E(y,L,z)}},_)}},3675:(T,A,f)=>{var m=f(9276),E=f(9292),h=f(5208),k=f(9454),x=f(4264),_=f(7151),d=f(1503),g=f(1330),y=f(891),w=f(5946),o=f(5940),C=f(7614),N=f(8159),I=f(9351),L=f(8067);T.exports=function z(H,Z,V,K,q,st,it){var lt=I(H,V),F=I(Z,V),$=it.get(F);if($)m(H,V,$);else{var Y=st?st(lt,F,V+"",H,Z,it):void 0,j=void 0===Y;if(j){var W=d(F),at=!W&&y(F),ot=!W&&!at&&N(F);Y=F,W||at||ot?d(lt)?Y=lt:g(lt)?Y=k(lt):at?(j=!1,Y=E(F,!0)):ot?(j=!1,Y=h(F,!0)):Y=[]:C(F)||_(F)?(Y=lt,_(lt)?Y=L(lt):(!o(lt)||w(lt))&&(Y=x(F))):j=!1}j&&(it.set(F,Y),q(Y,F,K,st,it),it.delete(F)),m(H,V,Y)}}},6119:(T,A,f)=>{var m=f(4633),E=f(5456),h=f(6517),k=f(2046),x=f(8750),_=f(5647),d=f(1215),g=f(2608),y=f(1503);T.exports=function w(o,C,N){C=C.length?m(C,function(z){return y(z)?function(H){return E(H,1===z.length?z[0]:z)}:z}):[g];var I=-1;C=m(C,_(h));var L=k(o,function(z,H,Z){return{criteria:m(C,function(K){return K(z)}),index:++I,value:z}});return x(L,function(z,H){return d(z,H,N)})}},3021:(T,A,f)=>{var m=f(5495),E=f(8492);T.exports=function h(k,x){return m(k,x,function(_,d){return E(k,d)})}},5495:(T,A,f)=>{var m=f(5456),E=f(6600),h=f(6884);T.exports=function k(x,_,d){for(var g=-1,y=_.length,w={};++g<y;){var o=_[g],C=m(x,o);d(C,o)&&E(w,h(o,x),C)}return w}},1384:T=>{T.exports=function A(f){return function(m){return m?.[f]}}},9222:(T,A,f)=>{var m=f(5456);T.exports=function E(h){return function(k){return m(k,h)}}},6307:T=>{var A=Math.ceil,f=Math.max;T.exports=function m(E,h,k,x){for(var _=-1,d=f(A((h-E)/(k||1)),0),g=Array(d);d--;)g[x?d:++_]=E,E+=k;return g}},3570:T=>{T.exports=function A(f,m,E,h,k){return k(f,function(x,_,d){E=h?(h=!1,x):m(E,x,_,d)}),E}},6652:(T,A,f)=>{var m=f(2608),E=f(3983),h=f(2185);T.exports=function k(x,_){return h(E(x,_,m),x+"")}},6600:(T,A,f)=>{var m=f(9719),E=f(6884),h=f(8442),k=f(5940),x=f(8533);T.exports=function _(d,g,y,w){if(!k(d))return d;for(var o=-1,C=(g=E(g,d)).length,N=C-1,I=d;null!=I&&++o<C;){var L=x(g[o]),z=y;if("__proto__"===L||"constructor"===L||"prototype"===L)return d;if(o!=N){var H=I[L];void 0===(z=w?w(H,L,I):void 0)&&(z=k(H)?H:h(g[o+1])?[]:{})}m(I,L,z),I=I[L]}return d}},9510:(T,A,f)=>{var m=f(6684),E=f(6713),h=f(2608),k=E?function(x,_){return E(x,"toString",{configurable:!0,enumerable:!1,value:m(_),writable:!0})}:h;T.exports=k},8750:T=>{T.exports=function A(f,m){var E=f.length;for(f.sort(m);E--;)f[E]=f[E].value;return f}},5334:T=>{T.exports=function A(f,m){for(var E=-1,h=Array(f);++E<f;)h[E]=m(E);return h}},3935:(T,A,f)=>{var m=f(443),E=f(4633),h=f(1503),k=f(4129),_=m?m.prototype:void 0,d=_?_.toString:void 0;T.exports=function g(y){if("string"==typeof y)return y;if(h(y))return E(y,g)+"";if(k(y))return d?d.call(y):"";var w=y+"";return"0"==w&&1/y==-Infinity?"-0":w}},3348:(T,A,f)=>{var m=f(2760),E=/^\s+/;T.exports=function h(k){return k&&k.slice(0,m(k)+1).replace(E,"")}},5647:T=>{T.exports=function A(f){return function(m){return f(m)}}},707:(T,A,f)=>{var m=f(8849),E=f(1253),h=f(177),k=f(5972),x=f(4575),_=f(4174);T.exports=function g(y,w,o){var C=-1,N=E,I=y.length,L=!0,z=[],H=z;if(o)L=!1,N=h;else if(I>=200){var Z=w?null:x(y);if(Z)return _(Z);L=!1,N=k,H=new m}else H=w?[]:z;t:for(;++C<I;){var V=y[C],K=w?w(V):V;if(V=o||0!==V?V:0,L&&K==K){for(var q=H.length;q--;)if(H[q]===K)continue t;w&&H.push(K),z.push(V)}else N(H,K,o)||(H!==z&&H.push(K),z.push(V))}return z}},9179:(T,A,f)=>{var m=f(4633);T.exports=function E(h,k){return m(k,function(x){return h[x]})}},8645:T=>{T.exports=function A(f,m,E){for(var h=-1,k=f.length,x=m.length,_={};++h<k;){var d=h<x?m[h]:void 0;E(_,f[h],d)}return _}},5972:T=>{T.exports=function A(f,m){return f.has(m)}},2132:(T,A,f)=>{var m=f(2608);T.exports=function E(h){return"function"==typeof h?h:m}},6884:(T,A,f)=>{var m=f(1503),E=f(5352),h=f(2855),k=f(3943);T.exports=function x(_,d){return m(_)?_:E(_,d)?[_]:h(k(_))}},3362:(T,A,f)=>{var m=f(3457);T.exports=function E(h){var k=new h.constructor(h.byteLength);return new m(k).set(new m(h)),k}},9292:(T,A,f)=>{T=f.nmd(T);var m=f(2119),E=A&&!A.nodeType&&A,h=E&&T&&!T.nodeType&&T,x=h&&h.exports===E?m.Buffer:void 0,_=x?x.allocUnsafe:void 0;T.exports=function d(g,y){if(y)return g.slice();var w=g.length,o=_?_(w):new g.constructor(w);return g.copy(o),o}},7e3:(T,A,f)=>{var m=f(3362);T.exports=function E(h,k){var x=k?m(h.buffer):h.buffer;return new h.constructor(x,h.byteOffset,h.byteLength)}},4098:T=>{var A=/\w*$/;T.exports=function f(m){var E=new m.constructor(m.source,A.exec(m));return E.lastIndex=m.lastIndex,E}},2533:(T,A,f)=>{var m=f(443),E=m?m.prototype:void 0,h=E?E.valueOf:void 0;T.exports=function k(x){return h?Object(h.call(x)):{}}},5208:(T,A,f)=>{var m=f(3362);T.exports=function E(h,k){var x=k?m(h.buffer):h.buffer;return new h.constructor(x,h.byteOffset,h.length)}},3443:(T,A,f)=>{var m=f(4129);T.exports=function E(h,k){if(h!==k){var x=void 0!==h,_=null===h,d=h==h,g=m(h),y=void 0!==k,w=null===k,o=k==k,C=m(k);if(!w&&!C&&!g&&h>k||g&&y&&o&&!w&&!C||_&&y&&o||!x&&o||!d)return 1;if(!_&&!g&&!C&&h<k||C&&x&&d&&!_&&!g||w&&x&&d||!y&&d||!o)return-1}return 0}},1215:(T,A,f)=>{var m=f(3443);T.exports=function E(h,k,x){for(var _=-1,d=h.criteria,g=k.criteria,y=d.length,w=x.length;++_<y;){var o=m(d[_],g[_]);if(o)return _>=w?o:o*("desc"==x[_]?-1:1)}return h.index-k.index}},9454:T=>{T.exports=function A(f,m){var E=-1,h=f.length;for(m||(m=Array(h));++E<h;)m[E]=f[E];return m}},1989:(T,A,f)=>{var m=f(9719),E=f(5683);T.exports=function h(k,x,_,d){var g=!_;_||(_={});for(var y=-1,w=x.length;++y<w;){var o=x[y],C=d?d(_[o],k[o],o,_,k):void 0;void 0===C&&(C=k[o]),g?E(_,o,C):m(_,o,C)}return _}},4444:(T,A,f)=>{var m=f(1989),E=f(9383);T.exports=function h(k,x){return m(k,E(k),x)}},9905:(T,A,f)=>{var m=f(1989),E=f(3051);T.exports=function h(k,x){return m(k,E(k),x)}},4610:(T,A,f)=>{var E=f(2119)["__core-js_shared__"];T.exports=E},4944:(T,A,f)=>{var m=f(6652),E=f(3342);T.exports=function h(k){return m(function(x,_){var d=-1,g=_.length,y=g>1?_[g-1]:void 0,w=g>2?_[2]:void 0;for(y=k.length>3&&"function"==typeof y?(g--,y):void 0,w&&E(_[0],_[1],w)&&(y=g<3?void 0:y,g=1),x=Object(x);++d<g;){var o=_[d];o&&k(x,o,d,y)}return x})}},6539:(T,A,f)=>{var m=f(6507);T.exports=function E(h,k){return function(x,_){if(null==x)return x;if(!m(x))return h(x,_);for(var d=x.length,g=k?d:-1,y=Object(x);(k?g--:++g<d)&&!1!==_(y[g],g,y););return x}}},456:T=>{T.exports=function A(f){return function(m,E,h){for(var k=-1,x=Object(m),_=h(m),d=_.length;d--;){var g=_[f?d:++k];if(!1===E(x[g],g,x))break}return m}}},4653:(T,A,f)=>{var m=f(6517),E=f(6507),h=f(118);T.exports=function k(x){return function(_,d,g){var y=Object(_);if(!E(_)){var w=m(d,3);_=h(_),d=function(C){return w(y[C],C,y)}}var o=x(_,d,g);return o>-1?y[w?_[o]:o]:void 0}}},7509:(T,A,f)=>{var m=f(6307),E=f(3342),h=f(2232);T.exports=function k(x){return function(_,d,g){return g&&"number"!=typeof g&&E(_,d,g)&&(d=g=void 0),_=h(_),void 0===d?(d=_,_=0):d=h(d),g=void 0===g?_<d?1:-1:h(g),m(_,d,g,x)}}},4575:(T,A,f)=>{var m=f(6323),E=f(2552),h=f(4174),x=m&&1/h(new m([,-0]))[1]==1/0?function(_){return new m(_)}:E;T.exports=x},6713:(T,A,f)=>{var m=f(3436),E=function(){try{var h=m(Object,"defineProperty");return h({},"",{}),h}catch{}}();T.exports=E},3914:(T,A,f)=>{var m=f(8849),E=f(9503),h=f(5972);T.exports=function _(d,g,y,w,o,C){var N=1&y,I=d.length,L=g.length;if(I!=L&&!(N&&L>I))return!1;var z=C.get(d),H=C.get(g);if(z&&H)return z==g&&H==d;var Z=-1,V=!0,K=2&y?new m:void 0;for(C.set(d,g),C.set(g,d);++Z<I;){var q=d[Z],st=g[Z];if(w)var it=N?w(st,q,Z,g,d,C):w(q,st,Z,d,g,C);if(void 0!==it){if(it)continue;V=!1;break}if(K){if(!E(g,function(lt,F){if(!h(K,F)&&(q===lt||o(q,lt,y,w,C)))return K.push(F)})){V=!1;break}}else if(q!==st&&!o(q,st,y,w,C)){V=!1;break}}return C.delete(d),C.delete(g),V}},7058:(T,A,f)=>{var m=f(443),E=f(3457),h=f(217),k=f(3914),x=f(3205),_=f(4174),K=m?m.prototype:void 0,q=K?K.valueOf:void 0;T.exports=function st(it,lt,F,$,Y,j,W){switch(F){case"[object DataView]":if(it.byteLength!=lt.byteLength||it.byteOffset!=lt.byteOffset)return!1;it=it.buffer,lt=lt.buffer;case"[object ArrayBuffer]":return!(it.byteLength!=lt.byteLength||!j(new E(it),new E(lt)));case"[object Boolean]":case"[object Date]":case"[object Number]":return h(+it,+lt);case"[object Error]":return it.name==lt.name&&it.message==lt.message;case"[object RegExp]":case"[object String]":return it==lt+"";case"[object Map]":var at=x;case"[object Set]":var ot=1&$;if(at||(at=_),it.size!=lt.size&&!ot)return!1;var et=W.get(it);if(et)return et==lt;$|=2,W.set(it,lt);var X=k(at(it),at(lt),$,Y,j,W);return W.delete(it),X;case"[object Symbol]":if(q)return q.call(it)==q.call(lt)}return!1}},2286:(T,A,f)=>{var m=f(7597),k=Object.prototype.hasOwnProperty;T.exports=function x(_,d,g,y,w,o){var C=1&g,N=m(_),I=N.length;if(I!=m(d).length&&!C)return!1;for(var H=I;H--;){var Z=N[H];if(!(C?Z in d:k.call(d,Z)))return!1}var V=o.get(_),K=o.get(d);if(V&&K)return V==d&&K==_;var q=!0;o.set(_,d),o.set(d,_);for(var st=C;++H<I;){var it=_[Z=N[H]],lt=d[Z];if(y)var F=C?y(lt,it,Z,d,_,o):y(it,lt,Z,_,d,o);if(!(void 0===F?it===lt||w(it,lt,g,y,o):F)){q=!1;break}st||(st="constructor"==Z)}if(q&&!st){var $=_.constructor,Y=d.constructor;$!=Y&&"constructor"in _&&"constructor"in d&&!("function"==typeof $&&$ instanceof $&&"function"==typeof Y&&Y instanceof Y)&&(q=!1)}return o.delete(_),o.delete(d),q}},3975:(T,A,f)=>{var m=f(2274),E=f(3983),h=f(2185);T.exports=function k(x){return h(E(x,void 0,m),x+"")}},9122:T=>{var A="object"==typeof global&&global&&global.Object===Object&&global;T.exports=A},7597:(T,A,f)=>{var m=f(8247),E=f(9383),h=f(118);T.exports=function k(x){return m(x,h,E)}},6967:(T,A,f)=>{var m=f(8247),E=f(3051),h=f(6555);T.exports=function k(x){return m(x,h,E)}},4537:(T,A,f)=>{var m=f(3819);T.exports=function E(h,k){var x=h.__data__;return m(k)?x["string"==typeof k?"string":"hash"]:x.map}},2379:(T,A,f)=>{var m=f(2442),E=f(118);T.exports=function h(k){for(var x=E(k),_=x.length;_--;){var d=x[_],g=k[d];x[_]=[d,g,m(g)]}return x}},3436:(T,A,f)=>{var m=f(7304),E=f(1990);T.exports=function h(k,x){var _=E(k,x);return m(_)?_:void 0}},9519:(T,A,f)=>{var E=f(9385)(Object.getPrototypeOf,Object);T.exports=E},1318:(T,A,f)=>{var m=f(443),E=Object.prototype,h=E.hasOwnProperty,k=E.toString,x=m?m.toStringTag:void 0;T.exports=function _(d){var g=h.call(d,x),y=d[x];try{d[x]=void 0;var w=!0}catch{}var o=k.call(d);return w&&(g?d[x]=y:delete d[x]),o}},9383:(T,A,f)=>{var m=f(9779),E=f(9975),k=Object.prototype.propertyIsEnumerable,x=Object.getOwnPropertySymbols,_=x?function(d){return null==d?[]:(d=Object(d),m(x(d),function(g){return k.call(d,g)}))}:E;T.exports=_},3051:(T,A,f)=>{var m=f(4883),E=f(9519),h=f(9383),k=f(9975),_=Object.getOwnPropertySymbols?function(d){for(var g=[];d;)m(g,h(d)),d=E(d);return g}:k;T.exports=_},8794:(T,A,f)=>{var m=f(7244),E=f(1501),h=f(4267),k=f(6323),x=f(4243),_=f(3337),d=f(2827),g="[object Map]",w="[object Promise]",o="[object Set]",C="[object WeakMap]",N="[object DataView]",I=d(m),L=d(E),z=d(h),H=d(k),Z=d(x),V=_;(m&&V(new m(new ArrayBuffer(1)))!=N||E&&V(new E)!=g||h&&V(h.resolve())!=w||k&&V(new k)!=o||x&&V(new x)!=C)&&(V=function(K){var q=_(K),st="[object Object]"==q?K.constructor:void 0,it=st?d(st):"";if(it)switch(it){case I:return N;case L:return g;case z:return w;case H:return o;case Z:return C}return q}),T.exports=V},1990:T=>{T.exports=function A(f,m){return f?.[m]}},7283:(T,A,f)=>{var m=f(6884),E=f(7151),h=f(1503),k=f(8442),x=f(6231),_=f(8533);T.exports=function d(g,y,w){for(var o=-1,C=(y=m(y,g)).length,N=!1;++o<C;){var I=_(y[o]);if(!(N=null!=g&&w(g,I)))break;g=g[I]}return N||++o!=C?N:!!(C=null==g?0:g.length)&&x(C)&&k(I,C)&&(h(g)||E(g))}},7609:T=>{var _=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");T.exports=function d(g){return _.test(g)}},4312:(T,A,f)=>{var m=f(862);T.exports=function E(){this.__data__=m?m(null):{},this.size=0}},6421:T=>{T.exports=function A(f){var m=this.has(f)&&delete this.__data__[f];return this.size-=m?1:0,m}},5764:(T,A,f)=>{var m=f(862),k=Object.prototype.hasOwnProperty;T.exports=function x(_){var d=this.__data__;if(m){var g=d[_];return"__lodash_hash_undefined__"===g?void 0:g}return k.call(d,_)?d[_]:void 0}},8685:(T,A,f)=>{var m=f(862),h=Object.prototype.hasOwnProperty;T.exports=function k(x){var _=this.__data__;return m?void 0!==_[x]:h.call(_,x)}},6676:(T,A,f)=>{var m=f(862);T.exports=function h(k,x){var _=this.__data__;return this.size+=this.has(k)?0:1,_[k]=m&&void 0===x?"__lodash_hash_undefined__":x,this}},6782:T=>{var f=Object.prototype.hasOwnProperty;T.exports=function m(E){var h=E.length,k=new E.constructor(h);return h&&"string"==typeof E[0]&&f.call(E,"index")&&(k.index=E.index,k.input=E.input),k}},7878:(T,A,f)=>{var m=f(3362),E=f(7e3),h=f(4098),k=f(2533),x=f(5208);T.exports=function F($,Y,j){var W=$.constructor;switch(Y){case"[object ArrayBuffer]":return m($);case"[object Boolean]":case"[object Date]":return new W(+$);case"[object DataView]":return E($,j);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return x($,j);case"[object Map]":case"[object Set]":return new W;case"[object Number]":case"[object String]":return new W($);case"[object RegExp]":return h($);case"[object Symbol]":return k($)}}},4264:(T,A,f)=>{var m=f(8858),E=f(9519),h=f(5488);T.exports=function k(x){return"function"!=typeof x.constructor||h(x)?{}:m(E(x))}},5039:(T,A,f)=>{var m=f(443),E=f(7151),h=f(1503),k=m?m.isConcatSpreadable:void 0;T.exports=function x(_){return h(_)||E(_)||!!(k&&_&&_[k])}},8442:T=>{var f=/^(?:0|[1-9]\d*)$/;T.exports=function m(E,h){var k=typeof E;return!!(h=h??9007199254740991)&&("number"==k||"symbol"!=k&&f.test(E))&&E>-1&&E%1==0&&E<h}},3342:(T,A,f)=>{var m=f(217),E=f(6507),h=f(8442),k=f(5940);T.exports=function x(_,d,g){if(!k(g))return!1;var y=typeof d;return!!("number"==y?E(g)&&h(d,g.length):"string"==y&&d in g)&&m(g[d],_)}},5352:(T,A,f)=>{var m=f(1503),E=f(4129),h=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,k=/^\w*$/;T.exports=function x(_,d){if(m(_))return!1;var g=typeof _;return!("number"!=g&&"symbol"!=g&&"boolean"!=g&&null!=_&&!E(_))||(k.test(_)||!h.test(_)||null!=d&&_ in Object(d))}},3819:T=>{T.exports=function A(f){var m=typeof f;return"string"==m||"number"==m||"symbol"==m||"boolean"==m?"__proto__"!==f:null===f}},1943:(T,A,f)=>{var k,m=f(4610),E=(k=/[^.]+$/.exec(m&&m.keys&&m.keys.IE_PROTO||""))?"Symbol(src)_1."+k:"";T.exports=function h(k){return!!E&&E in k}},5488:T=>{var A=Object.prototype;T.exports=function f(m){var E=m&&m.constructor;return m===("function"==typeof E&&E.prototype||A)}},2442:(T,A,f)=>{var m=f(5940);T.exports=function E(h){return h==h&&!m(h)}},1840:T=>{T.exports=function A(){this.__data__=[],this.size=0}},4378:(T,A,f)=>{var m=f(3503),h=Array.prototype.splice;T.exports=function k(x){var _=this.__data__,d=m(_,x);return!(d<0)&&(d==_.length-1?_.pop():h.call(_,d,1),--this.size,!0)}},4981:(T,A,f)=>{var m=f(3503);T.exports=function E(h){var k=this.__data__,x=m(k,h);return x<0?void 0:k[x][1]}},7343:(T,A,f)=>{var m=f(3503);T.exports=function E(h){return m(this.__data__,h)>-1}},8895:(T,A,f)=>{var m=f(3503);T.exports=function E(h,k){var x=this.__data__,_=m(x,h);return _<0?(++this.size,x.push([h,k])):x[_][1]=k,this}},638:(T,A,f)=>{var m=f(4994),E=f(9215),h=f(1501);T.exports=function k(){this.size=0,this.__data__={hash:new m,map:new(h||E),string:new m}}},1184:(T,A,f)=>{var m=f(4537);T.exports=function E(h){var k=m(this,h).delete(h);return this.size-=k?1:0,k}},866:(T,A,f)=>{var m=f(4537);T.exports=function E(h){return m(this,h).get(h)}},3771:(T,A,f)=>{var m=f(4537);T.exports=function E(h){return m(this,h).has(h)}},1772:(T,A,f)=>{var m=f(4537);T.exports=function E(h,k){var x=m(this,h),_=x.size;return x.set(h,k),this.size+=x.size==_?0:1,this}},3205:T=>{T.exports=function A(f){var m=-1,E=Array(f.size);return f.forEach(function(h,k){E[++m]=[k,h]}),E}},642:T=>{T.exports=function A(f,m){return function(E){return null!=E&&(E[f]===m&&(void 0!==m||f in Object(E)))}}},719:(T,A,f)=>{var m=f(535);T.exports=function h(k){var x=m(k,function(d){return 500===_.size&&_.clear(),d}),_=x.cache;return x}},862:(T,A,f)=>{var E=f(3436)(Object,"create");T.exports=E},5491:(T,A,f)=>{var E=f(9385)(Object.keys,Object);T.exports=E},2158:T=>{T.exports=function A(f){var m=[];if(null!=f)for(var E in Object(f))m.push(E);return m}},3597:(T,A,f)=>{T=f.nmd(T);var m=f(9122),E=A&&!A.nodeType&&A,h=E&&T&&!T.nodeType&&T,x=h&&h.exports===E&&m.process,_=function(){try{return h&&h.require&&h.require("util").types||x&&x.binding&&x.binding("util")}catch{}}();T.exports=_},2902:T=>{var f=Object.prototype.toString;T.exports=function m(E){return f.call(E)}},9385:T=>{T.exports=function A(f,m){return function(E){return f(m(E))}}},3983:(T,A,f)=>{var m=f(6999),E=Math.max;T.exports=function h(k,x,_){return x=E(void 0===x?k.length-1:x,0),function(){for(var d=arguments,g=-1,y=E(d.length-x,0),w=Array(y);++g<y;)w[g]=d[x+g];g=-1;for(var o=Array(x+1);++g<x;)o[g]=d[g];return o[x]=_(w),m(k,this,o)}}},2119:(T,A,f)=>{var m=f(9122),E="object"==typeof self&&self&&self.Object===Object&&self,h=m||E||Function("return this")();T.exports=h},9351:T=>{T.exports=function A(f,m){if(("constructor"!==m||"function"!=typeof f[m])&&"__proto__"!=m)return f[m]}},4600:T=>{T.exports=function f(m){return this.__data__.set(m,"__lodash_hash_undefined__"),this}},1387:T=>{T.exports=function A(f){return this.__data__.has(f)}},4174:T=>{T.exports=function A(f){var m=-1,E=Array(f.size);return f.forEach(function(h){E[++m]=h}),E}},2185:(T,A,f)=>{var m=f(9510),h=f(29)(m);T.exports=h},29:T=>{var m=Date.now;T.exports=function E(h){var k=0,x=0;return function(){var _=m(),d=16-(_-x);if(x=_,d>0){if(++k>=800)return arguments[0]}else k=0;return h.apply(void 0,arguments)}}},3720:(T,A,f)=>{var m=f(9215);T.exports=function E(){this.__data__=new m,this.size=0}},4410:T=>{T.exports=function A(f){var m=this.__data__,E=m.delete(f);return this.size=m.size,E}},5576:T=>{T.exports=function A(f){return this.__data__.get(f)}},2247:T=>{T.exports=function A(f){return this.__data__.has(f)}},1585:(T,A,f)=>{var m=f(9215),E=f(1501),h=f(9850);T.exports=function x(_,d){var g=this.__data__;if(g instanceof m){var y=g.__data__;if(!E||y.length<199)return y.push([_,d]),this.size=++g.size,this;g=this.__data__=new h(y)}return g.set(_,d),this.size=g.size,this}},4977:T=>{T.exports=function A(f,m,E){for(var h=E-1,k=f.length;++h<k;)if(f[h]===m)return h;return-1}},2315:(T,A,f)=>{var m=f(5481),E=f(7609),h=f(1149);T.exports=function k(x){return E(x)?h(x):m(x)}},2855:(T,A,f)=>{var m=f(719),E=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,h=/\\(\\)?/g,k=m(function(x){var _=[];return 46===x.charCodeAt(0)&&_.push(""),x.replace(E,function(d,g,y,w){_.push(y?w.replace(h,"$1"):g||d)}),_});T.exports=k},8533:(T,A,f)=>{var m=f(4129);T.exports=function h(k){if("string"==typeof k||m(k))return k;var x=k+"";return"0"==x&&1/k==-Infinity?"-0":x}},2827:T=>{var f=Function.prototype.toString;T.exports=function m(E){if(null!=E){try{return f.call(E)}catch{}try{return E+""}catch{}}return""}},2760:T=>{var A=/\s/;T.exports=function f(m){for(var E=m.length;E--&&A.test(m.charAt(E)););return E}},1149:T=>{var A="\\ud800-\\udfff",x="["+A+"]",_="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",d="\\ud83c[\\udffb-\\udfff]",y="[^"+A+"]",w="(?:\\ud83c[\\udde6-\\uddff]){2}",o="[\\ud800-\\udbff][\\udc00-\\udfff]",N="(?:"+_+"|"+d+")"+"?",I="[\\ufe0e\\ufe0f]?",z=I+N+("(?:\\u200d(?:"+[y,w,o].join("|")+")"+I+N+")*"),H="(?:"+[y+_+"?",_,w,o,x].join("|")+")",Z=RegExp(d+"(?="+d+")|"+H+z,"g");T.exports=function V(K){for(var q=Z.lastIndex=0;Z.test(K);)++q;return q}},1094:(T,A,f)=>{var m=f(4462);T.exports=function h(k){return m(k,4)}},733:(T,A,f)=>{var m=f(4462);T.exports=function k(x){return m(x,5)}},6684:T=>{T.exports=function A(f){return function(){return f}}},8800:(T,A,f)=>{var m=f(6652),E=f(217),h=f(3342),k=f(6555),x=Object.prototype,_=x.hasOwnProperty,d=m(function(g,y){g=Object(g);var w=-1,o=y.length,C=o>2?y[2]:void 0;for(C&&h(y[0],y[1],C)&&(o=1);++w<o;)for(var N=y[w],I=k(N),L=-1,z=I.length;++L<z;){var H=I[L],Z=g[H];(void 0===Z||E(Z,x[H])&&!_.call(g,H))&&(g[H]=N[H])}return g});T.exports=d},5474:(T,A,f)=>{T.exports=f(9851)},217:T=>{T.exports=function A(f,m){return f===m||f!=f&&m!=m}},5281:(T,A,f)=>{var m=f(9779),E=f(3609),h=f(6517),k=f(1503);T.exports=function x(_,d){return(k(_)?m:E)(_,h(d,3))}},2516:(T,A,f)=>{var h=f(4653)(f(6397));T.exports=h},6397:(T,A,f)=>{var m=f(5317),E=f(6517),h=f(4401),k=Math.max;T.exports=function x(_,d,g){var y=null==_?0:_.length;if(!y)return-1;var w=null==g?0:h(g);return w<0&&(w=k(y+w,0)),m(_,E(d,3),w)}},2274:(T,A,f)=>{var m=f(686);T.exports=function E(h){return(null==h?0:h.length)?m(h,1):[]}},9851:(T,A,f)=>{var m=f(6837),E=f(3132),h=f(2132),k=f(1503);T.exports=function x(_,d){return(k(_)?m:E)(_,h(d))}},1176:(T,A,f)=>{var m=f(755),E=f(2132),h=f(6555);T.exports=function k(x,_){return null==x?x:m(x,E(_),h)}},8817:(T,A,f)=>{var m=f(5456);T.exports=function E(h,k,x){var _=null==h?void 0:m(h,k);return void 0===_?x:_}},4842:(T,A,f)=>{var m=f(4781),E=f(7283);T.exports=function h(k,x){return null!=k&&E(k,x,m)}},8492:(T,A,f)=>{var m=f(9989),E=f(7283);T.exports=function h(k,x){return null!=k&&E(k,x,m)}},2608:T=>{T.exports=function A(f){return f}},7151:(T,A,f)=>{var m=f(186),E=f(2671),h=Object.prototype,k=h.hasOwnProperty,x=h.propertyIsEnumerable,_=m(function(){return arguments}())?m:function(d){return E(d)&&k.call(d,"callee")&&!x.call(d,"callee")};T.exports=_},1503:T=>{var A=Array.isArray;T.exports=A},6507:(T,A,f)=>{var m=f(5946),E=f(6231);T.exports=function h(k){return null!=k&&E(k.length)&&!m(k)}},1330:(T,A,f)=>{var m=f(6507),E=f(2671);T.exports=function h(k){return E(k)&&m(k)}},891:(T,A,f)=>{T=f.nmd(T);var m=f(2119),E=f(3580),h=A&&!A.nodeType&&A,k=h&&T&&!T.nodeType&&T,_=k&&k.exports===h?m.Buffer:void 0,g=(_?_.isBuffer:void 0)||E;T.exports=g},1973:(T,A,f)=>{var m=f(1172),E=f(8794),h=f(7151),k=f(1503),x=f(6507),_=f(891),d=f(5488),g=f(8159),C=Object.prototype.hasOwnProperty;T.exports=function N(I){if(null==I)return!0;if(x(I)&&(k(I)||"string"==typeof I||"function"==typeof I.splice||_(I)||g(I)||h(I)))return!I.length;var L=E(I);if("[object Map]"==L||"[object Set]"==L)return!I.size;if(d(I))return!m(I).length;for(var z in I)if(C.call(I,z))return!1;return!0}},5946:(T,A,f)=>{var m=f(3337),E=f(5940);T.exports=function d(g){if(!E(g))return!1;var y=m(g);return"[object Function]"==y||"[object GeneratorFunction]"==y||"[object AsyncFunction]"==y||"[object Proxy]"==y}},6231:T=>{T.exports=function f(m){return"number"==typeof m&&m>-1&&m%1==0&&m<=9007199254740991}},3222:(T,A,f)=>{var m=f(7021),E=f(5647),h=f(3597),k=h&&h.isMap,x=k?E(k):m;T.exports=x},5940:T=>{T.exports=function A(f){var m=typeof f;return null!=f&&("object"==m||"function"==m)}},2671:T=>{T.exports=function A(f){return null!=f&&"object"==typeof f}},7614:(T,A,f)=>{var m=f(3337),E=f(9519),h=f(2671),x=Function.prototype,_=Object.prototype,d=x.toString,g=_.hasOwnProperty,y=d.call(Object);T.exports=function w(o){if(!h(o)||"[object Object]"!=m(o))return!1;var C=E(o);if(null===C)return!0;var N=g.call(C,"constructor")&&C.constructor;return"function"==typeof N&&N instanceof N&&d.call(N)==y}},799:(T,A,f)=>{var m=f(771),E=f(5647),h=f(3597),k=h&&h.isSet,x=k?E(k):m;T.exports=x},248:(T,A,f)=>{var m=f(3337),E=f(1503),h=f(2671);T.exports=function x(_){return"string"==typeof _||!E(_)&&h(_)&&"[object String]"==m(_)}},4129:(T,A,f)=>{var m=f(3337),E=f(2671);T.exports=function k(x){return"symbol"==typeof x||E(x)&&"[object Symbol]"==m(x)}},8159:(T,A,f)=>{var m=f(1083),E=f(5647),h=f(3597),k=h&&h.isTypedArray,x=k?E(k):m;T.exports=x},4235:T=>{T.exports=function A(f){return void 0===f}},118:(T,A,f)=>{var m=f(2271),E=f(1172),h=f(6507);T.exports=function k(x){return h(x)?m(x):E(x)}},6555:(T,A,f)=>{var m=f(2271),E=f(2809),h=f(6507);T.exports=function k(x){return h(x)?m(x,!0):E(x)}},5809:T=>{T.exports=function A(f){var m=null==f?0:f.length;return m?f[m-1]:void 0}},9984:(T,A,f)=>{var m=f(4633),E=f(6517),h=f(2046),k=f(1503);T.exports=function x(_,d){return(k(_)?m:h)(_,E(d,3))}},203:(T,A,f)=>{var m=f(5683),E=f(5184),h=f(6517);T.exports=function k(x,_){var d={};return _=h(_,3),E(x,function(g,y,w){m(d,y,_(g,y,w))}),d}},8176:(T,A,f)=>{var m=f(7308),E=f(1100),h=f(2608);T.exports=function k(x){return x&&x.length?m(x,h,E):void 0}},535:(T,A,f)=>{var m=f(9850);function h(k,x){if("function"!=typeof k||null!=x&&"function"!=typeof x)throw new TypeError("Expected a function");var _=function(){var d=arguments,g=x?x.apply(this,d):d[0],y=_.cache;if(y.has(g))return y.get(g);var w=k.apply(this,d);return _.cache=y.set(g,w)||y,w};return _.cache=new(h.Cache||m),_}h.Cache=m,T.exports=h},567:(T,A,f)=>{var m=f(3842),h=f(4944)(function(k,x,_){m(k,x,_)});T.exports=h},9439:(T,A,f)=>{var m=f(7308),E=f(9069),h=f(2608);T.exports=function k(x){return x&&x.length?m(x,h,E):void 0}},9525:(T,A,f)=>{var m=f(7308),E=f(6517),h=f(9069);T.exports=function k(x,_){return x&&x.length?m(x,E(_,2),h):void 0}},2552:T=>{T.exports=function A(){}},1710:(T,A,f)=>{var m=f(2119);T.exports=function(){return m.Date.now()}},6372:(T,A,f)=>{var m=f(3021),h=f(3975)(function(k,x){return null==k?{}:m(k,x)});T.exports=h},7495:(T,A,f)=>{var m=f(1384),E=f(9222),h=f(5352),k=f(8533);T.exports=function x(_){return h(_)?m(k(_)):E(_)}},361:(T,A,f)=>{var E=f(7509)();T.exports=E},1337:(T,A,f)=>{var m=f(8745),E=f(3132),h=f(6517),k=f(3570),x=f(1503);T.exports=function _(d,g,y){var w=x(d)?m:k,o=arguments.length<3;return w(d,h(g,4),y,o,E)}},5637:(T,A,f)=>{var m=f(1172),E=f(8794),h=f(6507),k=f(248),x=f(2315);T.exports=function g(y){if(null==y)return 0;if(h(y))return k(y)?x(y):y.length;var w=E(y);return"[object Map]"==w||"[object Set]"==w?y.size:m(y).length}},2906:(T,A,f)=>{var m=f(686),E=f(6119),h=f(6652),k=f(3342),x=h(function(_,d){if(null==_)return[];var g=d.length;return g>1&&k(_,d[0],d[1])?d=[]:g>2&&k(d[0],d[1],d[2])&&(d=[d[0]]),E(_,m(d,1),[])});T.exports=x},9975:T=>{T.exports=function A(){return[]}},3580:T=>{T.exports=function A(){return!1}},2232:(T,A,f)=>{var m=f(1467),E=1/0;T.exports=function k(x){return x?(x=m(x))===E||x===-E?17976931348623157e292*(x<0?-1:1):x==x?x:0:0===x?x:0}},4401:(T,A,f)=>{var m=f(2232);T.exports=function E(h){var k=m(h),x=k%1;return k==k?x?k-x:k:0}},1467:(T,A,f)=>{var m=f(3348),E=f(5940),h=f(4129),x=/^[-+]0x[0-9a-f]+$/i,_=/^0b[01]+$/i,d=/^0o[0-7]+$/i,g=parseInt;T.exports=function y(w){if("number"==typeof w)return w;if(h(w))return NaN;if(E(w)){var o="function"==typeof w.valueOf?w.valueOf():w;w=E(o)?o+"":o}if("string"!=typeof w)return 0===w?w:+w;w=m(w);var C=_.test(w);return C||d.test(w)?g(w.slice(2),C?2:8):x.test(w)?NaN:+w}},8067:(T,A,f)=>{var m=f(1989),E=f(6555);T.exports=function h(k){return m(k,E(k))}},3943:(T,A,f)=>{var m=f(3935);T.exports=function E(h){return null==h?"":m(h)}},9416:(T,A,f)=>{var m=f(6837),E=f(8858),h=f(5184),k=f(6517),x=f(9519),_=f(1503),d=f(891),g=f(5946),y=f(5940),w=f(8159);T.exports=function o(C,N,I){var L=_(C),z=L||d(C)||w(C);if(N=k(N,4),null==I){var H=C&&C.constructor;I=z?L?new H:[]:y(C)&&g(H)?E(x(C)):{}}return(z?m:h)(C,function(Z,V,K){return N(I,Z,V,K)}),I}},8921:(T,A,f)=>{var m=f(686),E=f(6652),h=f(707),k=f(1330),x=E(function(_){return h(m(_,1,k,!0))});T.exports=x},1541:(T,A,f)=>{var m=f(3943),E=0;T.exports=function h(k){var x=++E;return m(k)+x}},377:(T,A,f)=>{var m=f(9179),E=f(118);T.exports=function h(k){return null==k?[]:m(k,E(k))}},1617:(T,A,f)=>{var m=f(9719),E=f(8645);T.exports=function h(k,x){return E(k||[],x||[],m)}},7824:(T,A,f)=>{"use strict";function m(E){for(var h in E)A.hasOwnProperty(h)||(A[h]=E[h])}Object.defineProperty(A,"__esModule",{value:!0}),m(f(5085)),m(f(6243)),m(f(1786)),m(f(225)),m(f(6767)),m(f(345)),m(f(5675)),m(f(6461)),m(f(8802)),m(f(3900)),m(f(8866)),m(f(4655)),m(f(4068)),m(f(3858)),m(f(8237)),m(f(3292))},5085:function(T,A,f){"use strict";var x,m=this&&this.__extends||(x=function(_,d){return(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,y){g.__proto__=y}||function(g,y){for(var w in y)y.hasOwnProperty(w)&&(g[w]=y[w])})(_,d)},function(_,d){function g(){this.constructor=_}x(_,d),_.prototype=null===d?Object.create(d):(g.prototype=d.prototype,new g)});Object.defineProperty(A,"__esModule",{value:!0});var E=f(5675),h=function(x){function _(d){var g=x.call(this)||this,w=d;return w.trigger&&(g.trigger=w.trigger),w.kick&&(g.kick=w.kick),w.drag&&(g.drag=w.drag),w.on&&(g.on=w.on),g.dragstart=g.dragStart=E.Layout.dragStart,g.dragend=g.dragEnd=E.Layout.dragEnd,g}return m(_,x),_.prototype.trigger=function(d){},_.prototype.kick=function(){},_.prototype.drag=function(){},_.prototype.on=function(d,g){return this},_}(E.Layout);A.LayoutAdaptor=h,A.adaptor=function k(x){return new h(x)}},3292:(T,A,f)=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0});var m=f(5675),E=f(6767);A.gridify=function h(_,d,g,y){return _.cola.start(0,0,0,10,!1),function k(_,d,g,y){_.forEach(function(o){o.routerNode={name:o.name,bounds:o.bounds.inflate(-g)}}),d.forEach(function(o){o.routerNode={bounds:o.bounds.inflate(-y),children:(typeof o.groups<"u"?o.groups.map(function(C){return _.length+C.id}):[]).concat(typeof o.leaves<"u"?o.leaves.map(function(C){return C.index}):[])}});var w=_.concat(d).map(function(o,C){return o.routerNode.id=C,o.routerNode});return new E.GridRouter(w,{getChildren:function(o){return o.children},getBounds:function(o){return o.bounds}},g-y)}(_.cola.nodes(),_.cola.groups(),g,y).routeEdges(_.powerGraph.powerEdges,d,function(o){return o.source.routerNode.id},function(o){return o.target.routerNode.id})},A.powerGraphGridLayout=function x(_,d,g){var y;_.nodes.forEach(function(N,I){return N.index=I}),(new m.Layout).avoidOverlaps(!1).nodes(_.nodes).links(_.links).powerGraphGroups(function(N){(y=N).groups.forEach(function(I){return I.padding=g})});var w=_.nodes.length,o=[],C=_.nodes.slice(0);return C.forEach(function(N,I){return N.index=I}),y.groups.forEach(function(N){var I=N.index=N.id+w;C.push(N),typeof N.leaves<"u"&&N.leaves.forEach(function(L){return o.push({source:I,target:L.index})}),typeof N.groups<"u"&&N.groups.forEach(function(L){return o.push({source:I,target:L.id+w})})}),y.powerEdges.forEach(function(N){o.push({source:N.source.index,target:N.target.index})}),(new m.Layout).size(d).nodes(C).links(o).avoidOverlaps(!1).linkDistance(30).symmetricDiffLinkLengths(5).convergenceThreshold(1e-4).start(100,0,0,0,!1),{cola:(new m.Layout).convergenceThreshold(.001).size(d).avoidOverlaps(!0).nodes(_.nodes).links(_.links).groupCompactness(1e-4).linkDistance(30).symmetricDiffLinkLengths(5).powerGraphGroups(function(N){(y=N).groups.forEach(function(I){I.padding=g})}).start(50,0,100,0,!1),powerGraph:y}}},6243:(T,A,f)=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0});var m=f(9346),E=f(2487);A.d3adaptor=function h(x){return!x||function k(x){var _=/^3\./;return x.version&&null!==x.version.match(_)}(x)?new m.D3StyleLayoutAdaptor:new E.D3StyleLayoutAdaptor(x)}},9346:function(T,A,f){"use strict";var x,m=this&&this.__extends||(x=function(_,d){return(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,y){g.__proto__=y}||function(g,y){for(var w in y)y.hasOwnProperty(w)&&(g[w]=y[w])})(_,d)},function(_,d){function g(){this.constructor=_}x(_,d),_.prototype=null===d?Object.create(d):(g.prototype=d.prototype,new g)});Object.defineProperty(A,"__esModule",{value:!0});var E=f(5675),h=function(x){function _(){var d=x.call(this)||this;d.event=d3.dispatch(E.EventType[E.EventType.start],E.EventType[E.EventType.tick],E.EventType[E.EventType.end]);var g=d;return d.drag=function(){if(!w)var w=d3.behavior.drag().origin(E.Layout.dragOrigin).on("dragstart.d3adaptor",E.Layout.dragStart).on("drag.d3adaptor",function(o){E.Layout.drag(o,d3.event),g.resume()}).on("dragend.d3adaptor",E.Layout.dragEnd);if(!arguments.length)return w;this.call(w)},d}return m(_,x),_.prototype.trigger=function(d){var g={type:E.EventType[d.type],alpha:d.alpha,stress:d.stress};this.event[g.type](g)},_.prototype.kick=function(){var d=this;d3.timer(function(){return x.prototype.tick.call(d)})},_.prototype.on=function(d,g){return"string"==typeof d?this.event.on(d,g):this.event.on(E.EventType[d],g),this},_}(E.Layout);A.D3StyleLayoutAdaptor=h,A.d3adaptor=function k(){return new h}},2487:function(T,A,f){"use strict";var k,m=this&&this.__extends||(k=function(x,_){return(k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,g){d.__proto__=g}||function(d,g){for(var y in g)g.hasOwnProperty(y)&&(d[y]=g[y])})(x,_)},function(x,_){function d(){this.constructor=x}k(x,_),x.prototype=null===_?Object.create(_):(d.prototype=_.prototype,new d)});Object.defineProperty(A,"__esModule",{value:!0});var E=f(5675),h=function(k){function x(_){var d=k.call(this)||this;d.d3Context=_,d.event=_.dispatch(E.EventType[E.EventType.start],E.EventType[E.EventType.tick],E.EventType[E.EventType.end]);var g=d;return d.drag=function(){if(!w)var w=_.drag().subject(E.Layout.dragOrigin).on("start.d3adaptor",E.Layout.dragStart).on("drag.d3adaptor",function(o){E.Layout.drag(o,_.event),g.resume()}).on("end.d3adaptor",E.Layout.dragEnd);if(!arguments.length)return w;arguments[0].call(w)},d}return m(x,k),x.prototype.trigger=function(_){var d={type:E.EventType[_.type],alpha:_.alpha,stress:_.stress};this.event.call(d.type,d)},x.prototype.kick=function(){var _=this,d=this.d3Context.timer(function(){return k.prototype.tick.call(_)&&d.stop()})},x.prototype.on=function(_,d){return"string"==typeof _?this.event.on(_,d):this.event.on(E.EventType[_],d),this},x}(E.Layout);A.D3StyleLayoutAdaptor=h},1786:(T,A)=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0});var f=function(){function h(){this.locks={}}return h.prototype.add=function(k,x){this.locks[k]=x},h.prototype.clear=function(){this.locks={}},h.prototype.isEmpty=function(){for(var k in this.locks)return!1;return!0},h.prototype.apply=function(k){for(var x in this.locks)k(Number(x),this.locks[x])},h}();A.Locks=f;var m=function(){function h(k,x,_){void 0===_&&(_=null),this.D=x,this.G=_,this.threshold=1e-4,this.numGridSnapNodes=0,this.snapGridSize=100,this.snapStrength=1e3,this.scaleSnapByMaxH=!1,this.random=new E,this.project=null,this.x=k,this.k=k.length;var d=this.n=k[0].length;this.H=new Array(this.k),this.g=new Array(this.k),this.Hd=new Array(this.k),this.a=new Array(this.k),this.b=new Array(this.k),this.c=new Array(this.k),this.d=new Array(this.k),this.e=new Array(this.k),this.ia=new Array(this.k),this.ib=new Array(this.k),this.xtmp=new Array(this.k),this.locks=new f,this.minD=Number.MAX_VALUE;for(var y,g=d;g--;)for(y=d;--y>g;){var w=x[g][y];w>0&&w<this.minD&&(this.minD=w)}for(this.minD===Number.MAX_VALUE&&(this.minD=1),g=this.k;g--;){for(this.g[g]=new Array(d),this.H[g]=new Array(d),y=d;y--;)this.H[g][y]=new Array(d);this.Hd[g]=new Array(d),this.a[g]=new Array(d),this.b[g]=new Array(d),this.c[g]=new Array(d),this.d[g]=new Array(d),this.e[g]=new Array(d),this.ia[g]=new Array(d),this.ib[g]=new Array(d),this.xtmp[g]=new Array(d)}}return h.createSquareMatrix=function(k,x){for(var _=new Array(k),d=0;d<k;++d){_[d]=new Array(k);for(var g=0;g<k;++g)_[d][g]=x(d,g)}return _},h.prototype.offsetDir=function(){for(var k=this,x=new Array(this.k),_=0,d=0;d<this.k;++d){var g=x[d]=this.random.getNextBetween(.01,1)-.5;_+=g*g}return _=Math.sqrt(_),x.map(function(y){return y*(k.minD/_)})},h.prototype.computeDerivatives=function(k){var x=this,_=this.n;if(!(_<1)){for(var d,g=new Array(this.k),y=new Array(this.k),w=new Array(this.k),o=0,C=0;C<_;++C){for(d=0;d<this.k;++d)w[d]=this.g[d][C]=0;for(var N=0;N<_;++N)if(C!==N){for(var I=_;I--;){var L=0;for(d=0;d<this.k;++d){var z=g[d]=k[d][C]-k[d][N];L+=y[d]=z*z}if(L>1e-9)break;var H=this.offsetDir();for(d=0;d<this.k;++d)k[d][N]+=H[d]}var Z=Math.sqrt(L),V=this.D[C][N],K=null!=this.G?this.G[C][N]:1;if(K>1&&Z>V||!isFinite(V)){for(d=0;d<this.k;++d)this.H[d][C][N]=0;continue}K>1&&(K=1);var q=V*V,st=2*K*(Z-V)/(q*Z),it=Z*Z*Z,lt=2*-K/(q*it);for(isFinite(st)||console.log(st),d=0;d<this.k;++d)this.g[d][C]+=g[d]*st,w[d]-=this.H[d][C][N]=lt*(it+V*(y[d]-L)+Z*L)}for(d=0;d<this.k;++d)o=Math.max(o,this.H[d][C][C]=w[d])}var F=this.snapGridSize/2,$=this.snapGridSize,j=this.snapStrength/(F*F),W=this.numGridSnapNodes;for(C=0;C<W;++C)for(d=0;d<this.k;++d){var at=this.x[d][C],ot=at/$,et=ot%1,X=ot-et;-F<(z=Math.abs(et)<=.5?at-X*$:at>0?at-(X+1)*$:at-(X-1)*$)&&z<=F&&(this.scaleSnapByMaxH?(this.g[d][C]+=o*j*z,this.H[d][C][C]+=o*j):(this.g[d][C]+=j*z,this.H[d][C][C]+=j))}this.locks.isEmpty()||this.locks.apply(function(pt,bt){for(d=0;d<x.k;++d)x.H[d][pt][pt]+=o,x.g[d][pt]-=o*(bt[d]-k[d][pt])})}},h.dotProd=function(k,x){for(var _=0,d=k.length;d--;)_+=k[d]*x[d];return _},h.rightMultiply=function(k,x,_){for(var d=k.length;d--;)_[d]=h.dotProd(k[d],x)},h.prototype.computeStepSize=function(k){for(var x=0,_=0,d=0;d<this.k;++d)x+=h.dotProd(this.g[d],k[d]),h.rightMultiply(this.H[d],k[d],this.Hd[d]),_+=h.dotProd(k[d],this.Hd[d]);return 0!==_&&isFinite(_)?1*x/_:0},h.prototype.reduceStress=function(){this.computeDerivatives(this.x);for(var k=this.computeStepSize(this.g),x=0;x<this.k;++x)this.takeDescentStep(this.x[x],this.g[x],k);return this.computeStress()},h.copy=function(k,x){for(var _=k.length,d=x[0].length,g=0;g<_;++g)for(var y=0;y<d;++y)x[g][y]=k[g][y]},h.prototype.stepAndProject=function(k,x,_,d){h.copy(k,x),this.takeDescentStep(x[0],_[0],d),this.project&&this.project[0](k[0],k[1],x[0]),this.takeDescentStep(x[1],_[1],d),this.project&&this.project[1](x[0],k[1],x[1]);for(var g=2;g<this.k;g++)this.takeDescentStep(x[g],_[g],d)},h.mApply=function(k,x,_){for(var d=k;d-- >0;)for(var g=x;g-- >0;)_(d,g)},h.prototype.matrixApply=function(k){h.mApply(this.k,this.n,k)},h.prototype.computeNextPosition=function(k,x){var _=this;this.computeDerivatives(k);var d=this.computeStepSize(this.g);if(this.stepAndProject(k,x,this.g,d),this.project){this.matrixApply(function(y,w){return _.e[y][w]=k[y][w]-x[y][w]});var g=this.computeStepSize(this.e);g=Math.max(.2,Math.min(g,1)),this.stepAndProject(k,x,this.e,g)}},h.prototype.run=function(k){for(var x=Number.MAX_VALUE,_=!1;!_&&k-- >0;){var d=this.rungeKutta();_=Math.abs(x/d-1)<this.threshold,x=d}return x},h.prototype.rungeKutta=function(){var k=this;this.computeNextPosition(this.x,this.a),h.mid(this.x,this.a,this.ia),this.computeNextPosition(this.ia,this.b),h.mid(this.x,this.b,this.ib),this.computeNextPosition(this.ib,this.c),this.computeNextPosition(this.c,this.d);var x=0;return this.matrixApply(function(_,d){var g=(k.a[_][d]+2*k.b[_][d]+2*k.c[_][d]+k.d[_][d])/6,y=k.x[_][d]-g;x+=y*y,k.x[_][d]=g}),x},h.mid=function(k,x,_){h.mApply(k.length,k[0].length,function(d,g){return _[d][g]=k[d][g]+(x[d][g]-k[d][g])/2})},h.prototype.takeDescentStep=function(k,x,_){for(var d=0;d<this.n;++d)k[d]=k[d]-_*x[d]},h.prototype.computeStress=function(){for(var k=0,x=0,_=this.n-1;x<_;++x)for(var d=x+1,g=this.n;d<g;++d){for(var y=0,w=0;w<this.k;++w){var o=this.x[w][x]-this.x[w][d];y+=o*o}y=Math.sqrt(y);var C=this.D[x][d];if(isFinite(C)){var N=C-y;k+=N*N/(C*C)}}return k},h.zeroDistance=1e-10,h}();A.Descent=m;var E=function(){function h(k){void 0===k&&(k=1),this.seed=k,this.a=214013,this.c=2531011,this.m=2147483648,this.range=32767}return h.prototype.getNext=function(){return this.seed=(this.seed*this.a+this.c)%this.m,(this.seed>>16)/this.range},h.prototype.getNextBetween=function(k,x){return k+this.getNext()*(x-k)},h}();A.PseudoRandom=E},225:function(T,A,f){"use strict";var et,m=this&&this.__extends||(et=function(X,dt){return(et=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(pt,bt){pt.__proto__=bt}||function(pt,bt){for(var yt in bt)bt.hasOwnProperty(yt)&&(pt[yt]=bt[yt])})(X,dt)},function(X,dt){function pt(){this.constructor=X}et(X,dt),X.prototype=null===dt?Object.create(dt):(pt.prototype=dt.prototype,new pt)});Object.defineProperty(A,"__esModule",{value:!0});var E=f(4068),h=function et(){};A.Point=h;var k=function et(X,dt,pt,bt){this.x1=X,this.y1=dt,this.x2=pt,this.y2=bt};A.LineSegment=k;var x=function(et){function X(){return null!==et&&et.apply(this,arguments)||this}return m(X,et),X}(h);function _(et,X,dt){return(X.x-et.x)*(dt.y-et.y)-(dt.x-et.x)*(X.y-et.y)}function d(et,X,dt){return _(et,X,dt)>0}function g(et,X,dt){return _(et,X,dt)<0}function N(et,X){var dt=X.slice(0);return dt.push(X[0]),{rtan:I(et,dt),ltan:L(et,dt)}}function I(et,X){var pt,bt,yt,Nt,dt=X.length-1;if(g(et,X[1],X[0])&&!d(et,X[dt-1],X[0]))return 0;for(pt=0,bt=dt;;){if(bt-pt==1)return d(et,X[pt],X[bt])?pt:bt;if((Nt=g(et,X[(yt=Math.floor((pt+bt)/2))+1],X[yt]))&&!d(et,X[yt-1],X[yt]))return yt;d(et,X[pt+1],X[pt])?Nt||d(et,X[pt],X[yt])?bt=yt:pt=yt:Nt&&g(et,X[pt],X[yt])?bt=yt:pt=yt}}function L(et,X){var pt,bt,yt,Nt,dt=X.length-1;if(d(et,X[dt-1],X[0])&&!g(et,X[1],X[0]))return 0;for(pt=0,bt=dt;;){if(bt-pt==1)return g(et,X[pt],X[bt])?pt:bt;if(Nt=g(et,X[(yt=Math.floor((pt+bt)/2))+1],X[yt]),d(et,X[yt-1],X[yt])&&!Nt)return yt;g(et,X[pt+1],X[pt])?Nt?g(et,X[pt],X[yt])?bt=yt:pt=yt:bt=yt:Nt?pt=yt:d(et,X[pt],X[yt])?bt=yt:pt=yt}}function z(et,X,dt,pt,bt,yt){var kt,Nt;Nt=pt(et[kt=dt(X[0],et)],X);for(var Ft=!1;!Ft;){for(Ft=!0;kt===et.length-1&&(kt=0),!bt(X[Nt],et[kt],et[kt+1]);)++kt;for(;0===Nt&&(Nt=X.length-1),!yt(et[kt],X[Nt],X[Nt-1]);)--Nt,Ft=!1}return{t1:kt,t2:Nt}}function Z(et,X){return z(et,X,I,L,d,g)}A.PolyPoint=x,A.isLeft=_,A.ConvexHull=function y(et){var pt,X=et.slice(0).sort(function(Tt,Pt){return Tt.x!==Pt.x?Pt.x-Tt.x:Pt.y-Tt.y}),dt=et.length,yt=X[0].x;for(pt=1;pt<dt&&X[pt].x===yt;++pt);var kt=pt-1,Nt=[];if(Nt.push(X[0]),kt===dt-1)X[kt].y!==X[0].y&&Nt.push(X[kt]);else{var Ft,ht=dt-1,mt=X[dt-1].x;for(pt=dt-2;pt>=0&&X[pt].x===mt;pt--);for(Ft=pt+1,pt=kt;++pt<=Ft;)if(!(_(X[0],X[Ft],X[pt])>=0&&pt<Ft)){for(;Nt.length>1&&!(_(Nt[Nt.length-2],Nt[Nt.length-1],X[pt])>0);)Nt.length-=1;0!=pt&&Nt.push(X[pt])}ht!=Ft&&Nt.push(X[ht]);var _t=Nt.length;for(pt=Ft;--pt>=kt;)if(!(_(X[ht],X[kt],X[pt])>=0&&pt>kt)){for(;Nt.length>_t&&!(_(Nt[Nt.length-2],Nt[Nt.length-1],X[pt])>0);)Nt.length-=1;0!=pt&&Nt.push(X[pt])}}return Nt},A.clockwiseRadialSweep=function w(et,X,dt){X.slice(0).sort(function(pt,bt){return Math.atan2(pt.y-et.y,pt.x-et.x)-Math.atan2(bt.y-et.y,bt.x-et.x)}).forEach(dt)},A.tangent_PolyPolyC=z,A.LRtangent_PolyPolyC=function H(et,X){var dt=Z(X,et);return{t1:dt.t2,t2:dt.t1}},A.RLtangent_PolyPolyC=Z,A.LLtangent_PolyPolyC=function V(et,X){return z(et,X,L,L,g,g)},A.RRtangent_PolyPolyC=function K(et,X){return z(et,X,I,I,d,d)};var q=function et(X,dt){this.t1=X,this.t2=dt};A.BiTangent=q;var st=function et(){};A.BiTangents=st;var it=function(et){function X(){return null!==et&&et.apply(this,arguments)||this}return m(X,et),X}(h);A.TVGPoint=it;var lt=function et(X,dt,pt,bt){this.id=X,this.polyid=dt,this.polyvertid=pt,this.p=bt,bt.vv=this};A.VisibilityVertex=lt;var F=function(){function et(X,dt){this.source=X,this.target=dt}return et.prototype.length=function(){var X=this.source.p.x-this.target.p.x,dt=this.source.p.y-this.target.p.y;return Math.sqrt(X*X+dt*dt)},et}();A.VisibilityEdge=F;var $=function(){function et(X,dt){if(this.P=X,this.V=[],this.E=[],dt)this.V=dt.V.slice(0),this.E=dt.E.slice(0);else{for(var pt=X.length,bt=0;bt<pt;bt++){for(var yt=X[bt],kt=0;kt<yt.length;++kt){var Nt=yt[kt],Ft=new lt(this.V.length,bt,kt,Nt);this.V.push(Ft),kt>0&&this.E.push(new F(yt[kt-1].vv,Ft))}yt.length>1&&this.E.push(new F(yt[0].vv,yt[yt.length-1].vv))}for(bt=0;bt<pt-1;bt++){var ht=X[bt];for(kt=bt+1;kt<pt;kt++){var mt=X[kt],_t=j(ht,mt);for(var Tt in _t){var Pt=_t[Tt],At=ht[Pt.t1],Ht=mt[Pt.t2];this.addEdgeIfVisible(At,Ht,bt,kt)}}}}}return et.prototype.addEdgeIfVisible=function(X,dt,pt,bt){this.intersectsPolys(new k(X.x,X.y,dt.x,dt.y),pt,bt)||this.E.push(new F(X.vv,dt.vv))},et.prototype.addPoint=function(X,dt){var pt=this.P.length;this.V.push(new lt(this.V.length,pt,0,X));for(var bt=0;bt<pt;++bt)if(bt!==dt){var yt=this.P[bt],kt=N(X,yt);this.addEdgeIfVisible(X,yt[kt.ltan],dt,bt),this.addEdgeIfVisible(X,yt[kt.rtan],dt,bt)}return X.vv},et.prototype.intersectsPolys=function(X,dt,pt){for(var bt=0,yt=this.P.length;bt<yt;++bt)if(bt!=dt&&bt!=pt&&Y(X,this.P[bt]).length>0)return!0;return!1},et}();function Y(et,X){for(var dt=[],pt=1,bt=X.length;pt<bt;++pt){var yt=E.Rectangle.lineIntersection(et.x1,et.y1,et.x2,et.y2,X[pt-1].x,X[pt-1].y,X[pt].x,X[pt].y);yt&&dt.push(yt)}return dt}function j(et,X){for(var dt=et.length-1,pt=X.length-1,bt=new st,yt=0;yt<dt;++yt)for(var kt=0;kt<pt;++kt){var Nt=et[0==yt?dt-1:yt-1],Ft=et[yt],ht=et[yt+1],mt=X[0==kt?pt-1:kt-1],_t=X[kt],Tt=X[kt+1],Pt=_(Nt,Ft,_t),At=_(Ft,mt,_t),Ht=_(Ft,_t,Tt),$t=_(mt,_t,Ft),fe=_(_t,Nt,Ft),Wt=_(_t,Ft,ht);Pt>=0&&At>=0&&Ht<0&&$t>=0&&fe>=0&&Wt<0?bt.ll=new q(yt,kt):Pt<=0&&At<=0&&Ht>0&&$t<=0&&fe<=0&&Wt>0?bt.rr=new q(yt,kt):Pt<=0&&At>0&&Ht<=0&&$t>=0&&fe<0&&Wt>=0?bt.rl=new q(yt,kt):Pt>=0&&At<0&&Ht>=0&&$t<=0&&fe>0&&Wt<=0&&(bt.lr=new q(yt,kt))}return bt}function at(et,X){return!et.every(function(dt){return!function W(et,X){for(var dt=1,pt=X.length;dt<pt;++dt)if(g(X[dt-1],X[dt],et))return!1;return!0}(dt,X)})}A.TangentVisibilityGraph=$,A.tangents=j,A.polysOverlap=function ot(et,X){if(at(et,X)||at(X,et))return!0;for(var dt=1,pt=et.length;dt<pt;++dt){var bt=et[dt],yt=et[dt-1];if(Y(new k(yt.x,yt.y,bt.x,bt.y),X).length>0)return!0}return!1}},6767:(T,A,f)=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0});var m=f(4068),E=f(8237),h=f(3858),k=function g(y,w,o){this.id=y,this.rect=w,this.children=o,this.leaf=typeof o>"u"||0===o.length};A.NodeWrapper=k;var x=function g(y,w,o,C,N){void 0===C&&(C=null),void 0===N&&(N=null),this.id=y,this.x=w,this.y=o,this.node=C,this.line=N};A.Vert=x;var _=function(){function g(y,w){this.s=y,this.t=w;var o=g.findMatch(y,w),C=w.slice(0).reverse(),N=g.findMatch(y,C);o.length>=N.length?(this.length=o.length,this.si=o.si,this.ti=o.ti,this.reversed=!1):(this.length=N.length,this.si=N.si,this.ti=w.length-N.ti-N.length,this.reversed=!0)}return g.findMatch=function(y,w){for(var o=y.length,C=w.length,N={length:0,si:-1,ti:-1},I=new Array(o),L=0;L<o;L++){I[L]=new Array(C);for(var z=0;z<C;z++)if(y[L]===w[z]){var H=I[L][z]=0===L||0===z?1:I[L-1][z-1]+1;H>N.length&&(N.length=H,N.si=L-H+1,N.ti=z-H+1)}else I[L][z]=0}return N},g.prototype.getSequence=function(){return this.length>=0?this.s.slice(this.si,this.si+this.length):[]},g}();A.LongestCommonSubsequence=_;var d=function(){function g(y,w,o){var C=this;void 0===o&&(o=12),this.originalnodes=y,this.groupPadding=o,this.leaves=null,this.nodes=y.map(function(it,lt){return new k(lt,w.getBounds(it),w.getChildren(it))}),this.leaves=this.nodes.filter(function(it){return it.leaf}),this.groups=this.nodes.filter(function(it){return!it.leaf}),this.cols=this.getGridLines("x"),this.rows=this.getGridLines("y"),this.groups.forEach(function(it){return it.children.forEach(function(lt){return C.nodes[lt].parent=it})}),this.root={children:[]},this.nodes.forEach(function(it){typeof it.parent>"u"&&(it.parent=C.root,C.root.children.push(it.id)),it.ports=[]}),this.backToFront=this.nodes.slice(0),this.backToFront.sort(function(it,lt){return C.getDepth(it)-C.getDepth(lt)}),this.backToFront.slice(0).reverse().filter(function(it){return!it.leaf}).forEach(function(it){var lt=m.Rectangle.empty();it.children.forEach(function(F){return lt=lt.union(C.nodes[F].rect)}),it.rect=lt.inflate(C.groupPadding)});var I=this.midPoints(this.cols.map(function(it){return it.pos})),L=this.midPoints(this.rows.map(function(it){return it.pos})),z=I[0],H=I[I.length-1],Z=L[0],V=L[L.length-1],K=this.rows.map(function(it){return{x1:z,x2:H,y1:it.pos,y2:it.pos}}).concat(L.map(function(it){return{x1:z,x2:H,y1:it,y2:it}})),q=this.cols.map(function(it){return{x1:it.pos,x2:it.pos,y1:Z,y2:V}}).concat(I.map(function(it){return{x1:it,x2:it,y1:Z,y2:V}})),st=K.concat(q);st.forEach(function(it){return it.verts=[]}),this.verts=[],this.edges=[],K.forEach(function(it){return q.forEach(function(lt){var F=new x(C.verts.length,lt.x1,it.y1);it.verts.push(F),lt.verts.push(F),C.verts.push(F);for(var $=C.backToFront.length;$-- >0;){var Y=C.backToFront[$],j=Y.rect,W=Math.abs(F.x-j.cx()),at=Math.abs(F.y-j.cy());if(W<j.width()/2&&at<j.height()/2){F.node=Y;break}}})}),st.forEach(function(it,lt){C.nodes.forEach(function(at,ot){at.rect.lineIntersections(it.x1,it.y1,it.x2,it.y2).forEach(function(et,X){var dt=new x(C.verts.length,et.x,et.y,at,it);C.verts.push(dt),it.verts.push(dt),at.ports.push(dt)})});var F=Math.abs(it.y1-it.y2)<.1,$=function(at,ot){return F?ot.x-at.x:ot.y-at.y};it.verts.sort($);for(var Y=1;Y<it.verts.length;Y++){var j=it.verts[Y-1],W=it.verts[Y];j.node&&j.node===W.node&&j.node.leaf||C.edges.push({source:j.id,target:W.id,length:Math.abs($(j,W))})}})}return g.prototype.avg=function(y){return y.reduce(function(w,o){return w+o})/y.length},g.prototype.getGridLines=function(y){for(var w=[],o=this.leaves.slice(0,this.leaves.length);o.length>0;){var C=o.filter(function(I){return I.rect["overlap"+y.toUpperCase()](o[0].rect)}),N={nodes:C,pos:this.avg(C.map(function(I){return I.rect["c"+y]()}))};w.push(N),N.nodes.forEach(function(I){return o.splice(o.indexOf(I),1)})}return w.sort(function(I,L){return I.pos-L.pos}),w},g.prototype.getDepth=function(y){for(var w=0;y.parent!==this.root;)w++,y=y.parent;return w},g.prototype.midPoints=function(y){for(var w=y[1]-y[0],o=[y[0]-w/2],C=1;C<y.length;C++)o.push((y[C]+y[C-1])/2);return o.push(y[y.length-1]+w/2),o},g.prototype.findLineage=function(y){var w=[y];do{y=y.parent,w.push(y)}while(y!==this.root);return w.reverse()},g.prototype.findAncestorPathBetween=function(y,w){for(var o=this.findLineage(y),C=this.findLineage(w),N=0;o[N]===C[N];)N++;return{commonAncestor:o[N-1],lineages:o.slice(N).concat(C.slice(N))}},g.prototype.siblingObstacles=function(y,w){var o=this,C=this.findAncestorPathBetween(y,w),N={};C.lineages.forEach(function(L){return N[L.id]={}});var I=C.commonAncestor.children.filter(function(L){return!(L in N)});return C.lineages.filter(function(L){return L.parent!==C.commonAncestor}).forEach(function(L){return I=I.concat(L.parent.children.filter(function(z){return z!==L.id}))}),I.map(function(L){return o.nodes[L]})},g.getSegmentSets=function(y,w,o){for(var C=[],N=0;N<y.length;N++)for(var I=y[N],L=0;L<I.length;L++){(z=I[L]).edgeid=N,z.i=L;var H=z[1][w]-z[0][w];Math.abs(H)<.1&&C.push(z)}C.sort(function(q,st){return q[0][w]-st[0][w]});for(var Z=[],V=null,K=0;K<C.length;K++){var z=C[K];(!V||Math.abs(z[0][w]-V.pos)>.1)&&(V={pos:z[0][w],segments:[]},Z.push(V)),V.segments.push(z)}return Z},g.nudgeSegs=function(y,w,o,C,N,I){var L=C.length;if(!(L<=1)){for(var z=C.map(function(Y){return new E.Variable(Y[0][y])}),H=[],Z=0;Z<L;Z++)for(var V=0;V<L;V++)if(Z!==V){var K=C[Z],q=C[V],st=K.edgeid,it=q.edgeid,lt=-1,F=-1;"x"==y?N(st,it)&&(K[0][w]<K[1][w]?(lt=V,F=Z):(lt=Z,F=V)):N(st,it)&&(K[0][w]<K[1][w]?(lt=Z,F=V):(lt=V,F=Z)),lt>=0&&H.push(new E.Constraint(z[lt],z[F],I))}new E.Solver(z,H).solve(),z.forEach(function(Y,j){var W=C[j],at=Y.position();W[0][y]=W[1][y]=at;var ot=o[W.edgeid];W.i>0&&(ot[W.i-1][1][y]=at),W.i<ot.length-1&&(ot[W.i+1][0][y]=at)})}},g.nudgeSegments=function(y,w,o,C,N){for(var I=g.getSegmentSets(y,w,o),L=0;L<I.length;L++){for(var z=I[L],H=[],Z=0;Z<z.segments.length;Z++){var V=z.segments[Z];H.push({type:0,s:V,pos:Math.min(V[0][o],V[1][o])}),H.push({type:1,s:V,pos:Math.max(V[0][o],V[1][o])})}H.sort(function(st,it){return st.pos-it.pos+st.type-it.type});var K=[],q=0;H.forEach(function(st){0===st.type?(K.push(st.s),q++):q--,0==q&&(g.nudgeSegs(w,o,y,K,C,N),K=[])})}},g.prototype.routeEdges=function(y,w,o,C){var N=this,I=y.map(function(H){return N.route(o(H),C(H))}),L=g.orderEdges(I),z=I.map(function(H){return g.makeSegments(H)});return g.nudgeSegments(z,"x","y",L,w),g.nudgeSegments(z,"y","x",L,w),g.unreverseEdges(z,I),z},g.unreverseEdges=function(y,w){y.forEach(function(o,C){w[C].reversed&&(o.reverse(),o.forEach(function(I){I.reverse()}))})},g.angleBetween2Lines=function(y,w){var o=Math.atan2(y[0].y-y[1].y,y[0].x-y[1].x),C=Math.atan2(w[0].y-w[1].y,w[0].x-w[1].x),N=o-C;return(N>Math.PI||N<-Math.PI)&&(N=C-o),N},g.isLeft=function(y,w,o){return(w.x-y.x)*(o.y-y.y)-(w.y-y.y)*(o.x-y.x)<=0},g.getOrder=function(y){for(var w={},o=0;o<y.length;o++){var C=y[o];typeof w[C.l]>"u"&&(w[C.l]={}),w[C.l][C.r]=!0}return function(N,I){return typeof w[N]<"u"&&w[N][I]}},g.orderEdges=function(y){for(var w=[],o=0;o<y.length-1;o++)for(var C=o+1;C<y.length;C++){var z,H,Z,N=y[o],I=y[C],L=new _(N,I);if(0!==L.length){if(L.reversed&&(I.reverse(),I.reversed=!0,L=new _(N,I)),(L.si<=0||L.ti<=0)&&(L.si+L.length>=N.length||L.ti+L.length>=I.length)){w.push({l:o,r:C});continue}L.si+L.length>=N.length||L.ti+L.length>=I.length?(z=N[L.si+1],Z=N[L.si-1],H=I[L.ti-1]):(z=N[L.si+L.length-2],H=N[L.si+L.length],Z=I[L.ti+L.length]),g.isLeft(z,H,Z)?w.push({l:C,r:o}):w.push({l:o,r:C})}}return g.getOrder(w)},g.makeSegments=function(y){function w(H){return{x:H.x,y:H.y}}for(var C=[],N=w(y[0]),I=1;I<y.length;I++){var L=w(y[I]),z=I<y.length-1?y[I+1]:null;(!z||(H=N,Z=L,V=z,!(Math.abs((Z.x-H.x)*(V.y-H.y)-(Z.y-H.y)*(V.x-H.x))<.001)))&&(C.push([N,L]),N=L)}var H,Z,V;return C},g.prototype.route=function(y,w){var o=this,C=this.nodes[y],N=this.nodes[w];this.obstacles=this.siblingObstacles(C,N);var I={};this.obstacles.forEach(function(F){return I[F.id]=F}),this.passableEdges=this.edges.filter(function(F){var $=o.verts[F.source],Y=o.verts[F.target];return!($.node&&$.node.id in I||Y.node&&Y.node.id in I)});for(var L=1;L<C.ports.length;L++){var z=C.ports[0].id,H=C.ports[L].id;this.passableEdges.push({source:z,target:H,length:0})}for(L=1;L<N.ports.length;L++){z=N.ports[0].id,H=N.ports[L].id;this.passableEdges.push({source:z,target:H,length:0})}var lt=new h.Calculator(this.verts.length,this.passableEdges,function(F){return F.source},function(F){return F.target},function(F){return F.length}).PathFromNodeToNodeWithPrevCost(C.ports[0].id,N.ports[0].id,function(F,$,Y){var j=o.verts[F],W=o.verts[$],at=o.verts[Y],ot=Math.abs(at.x-j.x),et=Math.abs(at.y-j.y);return j.node===C&&j.node===W.node||W.node===N&&W.node===at.node?0:ot>1&&et>1?1e3:0}).reverse().map(function(F){return o.verts[F]});return lt.push(this.nodes[N.id].ports[0]),lt.filter(function(F,$){return!($<lt.length-1&&lt[$+1].node===C&&F.node===C||$>0&&F.node===N&&lt[$-1].node===N)})},g.getRoutePath=function(y,w,o,C){var N={routepath:"M "+y[0][0].x+" "+y[0][0].y+" ",arrowpath:""};if(y.length>1)for(var I=0;I<y.length;I++){var z=(L=y[I])[1].x,H=L[1].y,Z=z-L[0].x,V=H-L[0].y;if(I<y.length-1){Math.abs(Z)>0?z-=Z/Math.abs(Z)*w:H-=V/Math.abs(V)*w,N.routepath+="L "+z+" "+H+" ";var K=y[I+1],q=K[0].x,st=K[0].y;Z=K[1].x-q,V=K[1].y-st;var $,Y,F=g.angleBetween2Lines(L,K)<0?1:0;Math.abs(Z)>0?($=q+Z/Math.abs(Z)*w,Y=st):($=q,Y=st+V/Math.abs(V)*w);var j=Math.abs($-z),W=Math.abs(Y-H);N.routepath+="A "+j+" "+W+" 0 0 "+F+" "+$+" "+Y+" "}else{var at=[z,H];Math.abs(Z)>0?(ot=[z-=Z/Math.abs(Z)*C,H+o],et=[z,H-o]):(ot=[z+o,H-=V/Math.abs(V)*C],et=[z-o,H]),N.routepath+="L "+z+" "+H+" ",C>0&&(N.arrowpath="M "+at[0]+" "+at[1]+" L "+ot[0]+" "+ot[1]+" L "+et[0]+" "+et[1])}}else{var L,ot,et;z=(L=y[0])[1].x,H=L[1].y,Z=z-L[0].x,V=H-L[0].y,at=[z,H];Math.abs(Z)>0?(ot=[z-=Z/Math.abs(Z)*C,H+o],et=[z,H-o]):(ot=[z+o,H-=V/Math.abs(V)*C],et=[z-o,H]),N.routepath+="L "+z+" "+H+" ",C>0&&(N.arrowpath="M "+at[0]+" "+at[1]+" L "+ot[0]+" "+ot[1]+" L "+et[0]+" "+et[1])}return N},g}();A.GridRouter=d},345:(T,A)=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0});var f_PADDING=10,f_GOLDEN_SECTION=(1+Math.sqrt(5))/2,f_FLOAT_EPSILON=1e-4;A.applyPacking=function m(h,k,x,I,N,g){void 0===N&&(N=1),void 0===g&&(g=!0);var o=k,C=x,L=(N=typeof N<"u"?N:1,I=typeof I<"u"?I:0,0),z=0,H=0,Z=0,V=[];function it(Y,j){V=[],L=0,z=0,Z=0;for(var W=0;W<Y.length;W++){lt(Y[W],j)}return Math.abs(function $(){return L/z}()-N)}function lt(Y,j){for(var W=void 0,at=0;at<V.length;at++)if(V[at].space_left>=Y.height&&V[at].x+V[at].width+Y.width+f_PADDING-j<=f_FLOAT_EPSILON){W=V[at];break}V.push(Y),void 0!==W?(Y.x=W.x+W.width+f_PADDING,Y.y=W.bottom,Y.space_left=Y.height,Y.bottom=Y.y,W.space_left-=Y.height+f_PADDING,W.bottom+=Y.height+f_PADDING):(Y.y=Z,Z+=Y.height+f_PADDING,Y.x=0,Y.bottom=Y.y,Y.space_left=Y.height),Y.y+Y.height-z>-f_FLOAT_EPSILON&&(z=Y.y+Y.height-0),Y.x+Y.width-L>-f_FLOAT_EPSILON&&(L=Y.x+Y.width-0)}0!=h.length&&(function K(Y){Y.forEach(function(W){!function j(W){var at=Number.MAX_VALUE,ot=Number.MAX_VALUE,et=0,X=0;W.array.forEach(function(dt){var pt=typeof dt.width<"u"?dt.width:I,bt=typeof dt.height<"u"?dt.height:I;pt/=2,bt/=2,et=Math.max(dt.x+pt,et),at=Math.min(dt.x-pt,at),X=Math.max(dt.y+bt,X),ot=Math.min(dt.y-bt,ot)}),W.width=et-at,W.height=X-ot}(W)})}(h),function st(Y,j){var W=Number.POSITIVE_INFINITY,at=0;Y.sort(function(ht,mt){return mt.height-ht.height}),H=Y.reduce(function(ht,mt){return ht.width<mt.width?ht.width:mt.width});for(var ot=Nt=H,et=Ft=function F(Y){var j=0;return Y.forEach(function(W){return j+=W.width+f_PADDING}),j}(Y),X=0,dt=Number.MAX_VALUE,pt=Number.MAX_VALUE,bt=-1,yt=Number.MAX_VALUE,kt=Number.MAX_VALUE;yt>H||kt>f_FLOAT_EPSILON;){if(1!=bt){var Nt=et-(et-ot)/f_GOLDEN_SECTION;dt=it(Y,Nt)}if(0!=bt){var Ft=ot+(et-ot)/f_GOLDEN_SECTION;pt=it(Y,Ft)}if(yt=Math.abs(Nt-Ft),kt=Math.abs(dt-pt),dt<W&&(W=dt,at=Nt),pt<W&&(W=pt,at=Ft),dt>pt?(ot=Nt,Nt=Ft,dt=pt,bt=1):(et=Ft,Ft=Nt,pt=dt,bt=0),X++>100)break}it(Y,at)}(h),g&&function q(Y){Y.forEach(function(j){var W={x:0,y:0};j.array.forEach(function(et){W.x+=et.x,W.y+=et.y}),W.x/=j.array.length,W.y/=j.array.length;var at_x=W.x-j.width/2,at_y=W.y-j.height/2,ot_x=j.x-at_x+o/2-L/2,ot_y=j.y-at_y+C/2-z/2;j.array.forEach(function(et){et.x+=ot_x,et.y+=ot_y})})}(h))},A.separateGraphs=function E(h,k){for(var x={},_={},d=[],g=0,y=0;y<k.length;y++){var w=k[y],o=w.source,C=w.target;_[o.index]?_[o.index].push(C):_[o.index]=[C],_[C.index]?_[C.index].push(o):_[C.index]=[o]}for(y=0;y<h.length;y++){var N=h[y];x[N.index]||I(N,!0)}function I(L,z){if(void 0===x[L.index]){z&&(g++,d.push({array:[]})),x[L.index]=g,d[g-1].array.push(L);var H=_[L.index];if(H)for(var Z=0;Z<H.length;Z++)I(H[Z],!1)}}return d}},5675:(T,A,f)=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0});var g,o,m=f(3900),E=f(8802),h=f(1786),k=f(4068),x=f(3858),_=f(225),d=f(345);function y(o){return typeof o.leaves<"u"||typeof o.groups<"u"}(o=g=A.EventType||(A.EventType={}))[o.start=0]="start",o[o.tick=1]="tick",o[o.end=2]="end";var w=function(){function o(){var C=this;this._canvasSize=[1,1],this._linkDistance=20,this._defaultNodeSize=10,this._linkLengthCalculator=null,this._linkType=null,this._avoidOverlaps=!1,this._handleDisconnected=!0,this._running=!1,this._nodes=[],this._groups=[],this._rootGroup=null,this._links=[],this._constraints=[],this._distanceMatrix=null,this._descent=null,this._directedLinkConstraints=null,this._threshold=.01,this._visibilityGraph=null,this._groupCompactness=1e-6,this.event=null,this.linkAccessor={getSourceIndex:o.getSourceIndex,getTargetIndex:o.getTargetIndex,setLength:o.setLinkLength,getType:function(N){return"function"==typeof C._linkType?C._linkType(N):0}}}return o.prototype.on=function(C,N){return this.event||(this.event={}),"string"==typeof C?this.event[g[C]]=N:this.event[C]=N,this},o.prototype.trigger=function(C){this.event&&typeof this.event[C.type]<"u"&&this.event[C.type](C)},o.prototype.kick=function(){for(;!this.tick(););},o.prototype.tick=function(){if(this._alpha<this._threshold)return this._running=!1,this.trigger({type:g.end,alpha:this._alpha=0,stress:this._lastStress}),!0;var I,L,C=this._nodes.length;this._links.length;for(this._descent.locks.clear(),L=0;L<C;++L)if((I=this._nodes[L]).fixed){(typeof I.px>"u"||typeof I.py>"u")&&(I.px=I.x,I.py=I.y);var z=[I.px,I.py];this._descent.locks.add(L,z)}var H=this._descent.rungeKutta();return 0===H?this._alpha=0:typeof this._lastStress<"u"&&(this._alpha=H),this._lastStress=H,this.updateNodePositions(),this.trigger({type:g.tick,alpha:this._alpha,stress:this._lastStress}),!1},o.prototype.updateNodePositions=function(){for(var I,C=this._descent.x[0],N=this._descent.x[1],L=this._nodes.length;L--;)(I=this._nodes[L]).x=C[L],I.y=N[L]},o.prototype.nodes=function(C){if(!C){if(0===this._nodes.length&&this._links.length>0){var N=0;this._links.forEach(function(L){N=Math.max(N,L.source,L.target)}),this._nodes=new Array(++N);for(var I=0;I<N;++I)this._nodes[I]={}}return this._nodes}return this._nodes=C,this},o.prototype.groups=function(C){var N=this;return C?(this._groups=C,this._rootGroup={},this._groups.forEach(function(I){typeof I.padding>"u"&&(I.padding=1),typeof I.leaves<"u"&&I.leaves.forEach(function(L,z){"number"==typeof L&&((I.leaves[z]=N._nodes[L]).parent=I)}),typeof I.groups<"u"&&I.groups.forEach(function(L,z){"number"==typeof L&&((I.groups[z]=N._groups[L]).parent=I)})}),this._rootGroup.leaves=this._nodes.filter(function(I){return typeof I.parent>"u"}),this._rootGroup.groups=this._groups.filter(function(I){return typeof I.parent>"u"}),this):this._groups},o.prototype.powerGraphGroups=function(C){var N=m.getGroups(this._nodes,this._links,this.linkAccessor,this._rootGroup);return this.groups(N.groups),C(N),this},o.prototype.avoidOverlaps=function(C){return arguments.length?(this._avoidOverlaps=C,this):this._avoidOverlaps},o.prototype.handleDisconnected=function(C){return arguments.length?(this._handleDisconnected=C,this):this._handleDisconnected},o.prototype.flowLayout=function(C,N){return arguments.length||(C="y"),this._directedLinkConstraints={axis:C,getMinSeparation:"number"==typeof N?function(){return N}:N},this},o.prototype.links=function(C){return arguments.length?(this._links=C,this):this._links},o.prototype.constraints=function(C){return arguments.length?(this._constraints=C,this):this._constraints},o.prototype.distanceMatrix=function(C){return arguments.length?(this._distanceMatrix=C,this):this._distanceMatrix},o.prototype.size=function(C){return C?(this._canvasSize=C,this):this._canvasSize},o.prototype.defaultNodeSize=function(C){return C?(this._defaultNodeSize=C,this):this._defaultNodeSize},o.prototype.groupCompactness=function(C){return C?(this._groupCompactness=C,this):this._groupCompactness},o.prototype.linkDistance=function(C){return C?(this._linkDistance="function"==typeof C?C:+C,this._linkLengthCalculator=null,this):this._linkDistance},o.prototype.linkType=function(C){return this._linkType=C,this},o.prototype.convergenceThreshold=function(C){return C?(this._threshold="function"==typeof C?C:+C,this):this._threshold},o.prototype.alpha=function(C){return arguments.length?(C=+C,this._alpha?this._alpha=C>0?C:0:C>0&&(this._running||(this._running=!0,this.trigger({type:g.start,alpha:this._alpha=C}),this.kick())),this):this._alpha},o.prototype.getLinkLength=function(C){return"function"==typeof this._linkDistance?+this._linkDistance(C):this._linkDistance},o.setLinkLength=function(C,N){C.length=N},o.prototype.getLinkType=function(C){return"function"==typeof this._linkType?this._linkType(C):0},o.prototype.symmetricDiffLinkLengths=function(C,N){var I=this;return void 0===N&&(N=1),this.linkDistance(function(L){return C*L.length}),this._linkLengthCalculator=function(){return E.symmetricDiffLinkLengths(I._links,I.linkAccessor,N)},this},o.prototype.jaccardLinkLengths=function(C,N){var I=this;return void 0===N&&(N=1),this.linkDistance(function(L){return C*L.length}),this._linkLengthCalculator=function(){return E.jaccardLinkLengths(I._links,I.linkAccessor,N)},this},o.prototype.start=function(C,N,I,L,z,H){var Z=this;void 0===C&&(C=0),void 0===N&&(N=0),void 0===I&&(I=0),void 0===L&&(L=0),void 0===z&&(z=!0),void 0===H&&(H=!0);var at,q=this.nodes().length,st=q+2*this._groups.length,lt=(this._links.length,this._canvasSize[0]),F=this._canvasSize[1],$=new Array(st),Y=new Array(st),j=null,W=this._avoidOverlaps;this._nodes.forEach(function(yt,kt){yt.index=kt,typeof yt.x>"u"&&(yt.x=lt/2,yt.y=F/2),$[kt]=yt.x,Y[kt]=yt.y}),this._linkLengthCalculator&&this._linkLengthCalculator(),this._distanceMatrix?at=this._distanceMatrix:(at=new x.Calculator(st,this._links,o.getSourceIndex,o.getTargetIndex,function(yt){return Z.getLinkLength(yt)}).DistanceMatrix(),j=h.Descent.createSquareMatrix(st,function(){return 2}),this._links.forEach(function(yt){"number"==typeof yt.source&&(yt.source=Z._nodes[yt.source]),"number"==typeof yt.target&&(yt.target=Z._nodes[yt.target])}),this._links.forEach(function(yt){var kt=o.getSourceIndex(yt),Nt=o.getTargetIndex(yt);j[kt][Nt]=j[Nt][kt]=yt.weight||1}));var ot=h.Descent.createSquareMatrix(st,function(yt,kt){return at[yt][kt]});if(this._rootGroup&&typeof this._rootGroup.groups<"u"){var V=q;this._groups.forEach(function(kt){(function(kt,Nt,Ft,ht){j[kt][Nt]=j[Nt][kt]=Ft,ot[kt][Nt]=ot[Nt][kt]=ht})(V,V+1,Z._groupCompactness,.1),$[V]=0,Y[V++]=0,$[V]=0,Y[V++]=0})}else this._rootGroup={leaves:this._nodes,groups:[]};var X=this._constraints||[];this._directedLinkConstraints&&(this.linkAccessor.getMinSeparation=this._directedLinkConstraints.getMinSeparation,X=X.concat(E.generateDirectedEdgeConstraints(q,this._links,this._directedLinkConstraints.axis,this.linkAccessor))),this.avoidOverlaps(!1),this._descent=new h.Descent([$,Y],ot),this._descent.locks.clear();for(V=0;V<q;++V){var dt=this._nodes[V];if(dt.fixed){dt.px=dt.x,dt.py=dt.y;var pt=[dt.x,dt.y];this._descent.locks.add(V,pt)}}if(this._descent.threshold=this._threshold,this.initialLayout(C,$,Y),X.length>0&&(this._descent.project=new k.Projection(this._nodes,this._groups,this._rootGroup,X).projectFunctions()),this._descent.run(N),this.separateOverlappingComponents(lt,F,H),this.avoidOverlaps(W),W&&(this._nodes.forEach(function(yt,kt){yt.x=$[kt],yt.y=Y[kt]}),this._descent.project=new k.Projection(this._nodes,this._groups,this._rootGroup,X,!0).projectFunctions(),this._nodes.forEach(function(yt,kt){$[kt]=yt.x,Y[kt]=yt.y})),this._descent.G=j,this._descent.run(I),L){this._descent.snapStrength=1e3,this._descent.snapGridSize=this._nodes[0].width,this._descent.numGridSnapNodes=q,this._descent.scaleSnapByMaxH=q!=st;var bt=h.Descent.createSquareMatrix(st,function(yt,kt){return yt>=q||kt>=q?j[yt][kt]:0});this._descent.G=bt,this._descent.run(L)}return this.updateNodePositions(),this.separateOverlappingComponents(lt,F,H),z?this.resume():this},o.prototype.initialLayout=function(C,N,I){if(this._groups.length>0&&C>0){var L=this._nodes.length,z=this._links.map(function(Z){return{source:Z.source.index,target:Z.target.index}}),H=this._nodes.map(function(Z){return{index:Z.index}});this._groups.forEach(function(Z,V){H.push({index:Z.index=L+V})}),this._groups.forEach(function(Z,V){typeof Z.leaves<"u"&&Z.leaves.forEach(function(K){return z.push({source:Z.index,target:K.index})}),typeof Z.groups<"u"&&Z.groups.forEach(function(K){return z.push({source:Z.index,target:K.index})})}),(new o).size(this.size()).nodes(H).links(z).avoidOverlaps(!1).linkDistance(this.linkDistance()).symmetricDiffLinkLengths(5).convergenceThreshold(1e-4).start(C,0,0,0,!1),this._nodes.forEach(function(Z){N[Z.index]=H[Z.index].x,I[Z.index]=H[Z.index].y})}else this._descent.run(C)},o.prototype.separateOverlappingComponents=function(C,N,I){var L=this;if(void 0===I&&(I=!0),!this._distanceMatrix&&this._handleDisconnected){var z=this._descent.x[0],H=this._descent.x[1];this._nodes.forEach(function(V,K){V.x=z[K],V.y=H[K]});var Z=d.separateGraphs(this._nodes,this._links);d.applyPacking(Z,C,N,this._defaultNodeSize,1,I),this._nodes.forEach(function(V,K){L._descent.x[0][K]=V.x,L._descent.x[1][K]=V.y,V.bounds&&(V.bounds.setXCentre(V.x),V.bounds.setYCentre(V.y))})}},o.prototype.resume=function(){return this.alpha(.1)},o.prototype.stop=function(){return this.alpha(0)},o.prototype.prepareEdgeRouting=function(C){void 0===C&&(C=0),this._visibilityGraph=new _.TangentVisibilityGraph(this._nodes.map(function(N){return N.bounds.inflate(-C).vertices()}))},o.prototype.routeEdge=function(C,N,I){void 0===N&&(N=5);var L=[],z=new _.TangentVisibilityGraph(this._visibilityGraph.P,{V:this._visibilityGraph.V,E:this._visibilityGraph.E}),H={x:C.source.x,y:C.source.y},Z={x:C.target.x,y:C.target.y},V=z.addPoint(H,C.source.index),K=z.addPoint(Z,C.target.index);z.addEdgeIfVisible(H,Z,C.source.index,C.target.index),typeof I<"u"&&I(z);var F=new x.Calculator(z.V.length,z.E,function(ot){return ot.source.id},function(ot){return ot.target.id},function(ot){return ot.length()}).PathFromNodeToNode(V.id,K.id);if(1===F.length||F.length===z.V.length){var $=k.makeEdgeBetween(C.source.innerBounds,C.target.innerBounds,N);L=[$.sourceIntersection,$.arrowStart]}else{for(var Y=F.length-2,j=z.V[F[Y]].p,W=z.V[F[0]].p,at=(L=[C.source.innerBounds.rayIntersection(j.x,j.y)],Y);at>=0;--at)L.push(z.V[F[at]].p);L.push(k.makeEdgeTo(W,C.target.innerBounds,N))}return L},o.getSourceIndex=function(C){return"number"==typeof C.source?C.source:C.source.index},o.getTargetIndex=function(C){return"number"==typeof C.target?C.target:C.target.index},o.linkId=function(C){return o.getSourceIndex(C)+"-"+o.getTargetIndex(C)},o.dragStart=function(C){y(C)?o.storeOffset(C,o.dragOrigin(C)):(o.stopNode(C),C.fixed|=2)},o.stopNode=function(C){C.px=C.x,C.py=C.y},o.storeOffset=function(C,N){typeof C.leaves<"u"&&C.leaves.forEach(function(I){I.fixed|=2,o.stopNode(I),I._dragGroupOffsetX=I.x-N.x,I._dragGroupOffsetY=I.y-N.y}),typeof C.groups<"u"&&C.groups.forEach(function(I){return o.storeOffset(I,N)})},o.dragOrigin=function(C){return y(C)?{x:C.bounds.cx(),y:C.bounds.cy()}:C},o.drag=function(C,N){y(C)?(typeof C.leaves<"u"&&C.leaves.forEach(function(I){C.bounds.setXCentre(N.x),C.bounds.setYCentre(N.y),I.px=I._dragGroupOffsetX+N.x,I.py=I._dragGroupOffsetY+N.y}),typeof C.groups<"u"&&C.groups.forEach(function(I){return o.drag(I,N)})):(C.px=N.x,C.py=N.y)},o.dragEnd=function(C){y(C)?(typeof C.leaves<"u"&&C.leaves.forEach(function(N){o.dragEnd(N),delete N._dragGroupOffsetX,delete N._dragGroupOffsetY}),typeof C.groups<"u"&&C.groups.forEach(o.dragEnd)):C.fixed&=-7},o.mouseOver=function(C){C.fixed|=4,C.px=C.x,C.py=C.y},o.mouseOut=function(C){C.fixed&=-5},o}();A.Layout=w},6461:(T,A,f)=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0});var m=f(3858),E=f(1786),h=f(4068),k=f(8802),x=function(){function y(w,o){this.source=w,this.target=o}return y.prototype.actualLength=function(w){var o=this;return Math.sqrt(w.reduce(function(C,N){var I=N[o.target]-N[o.source];return C+I*I},0))},y}();A.Link3D=x;var _=function y(w,o,C){void 0===w&&(w=0),void 0===o&&(o=0),void 0===C&&(C=0),this.x=w,this.y=o,this.z=C};A.Node3D=_;var d=function(){function y(w,o,C){var N=this;void 0===C&&(C=1),this.nodes=w,this.links=o,this.idealLinkLength=C,this.constraints=null,this.useJaccardLinkLengths=!0,this.result=new Array(y.k);for(var I=0;I<y.k;++I)this.result[I]=new Array(w.length);w.forEach(function(L,z){for(var H=0,Z=y.dims;H<Z.length;H++){var V=Z[H];typeof L[V]>"u"&&(L[V]=Math.random())}N.result[0][z]=L.x,N.result[1][z]=L.y,N.result[2][z]=L.z})}return y.prototype.linkLength=function(w){return w.actualLength(this.result)},y.prototype.start=function(w){var o=this;void 0===w&&(w=100);var C=this.nodes.length,N=new g;this.useJaccardLinkLengths&&k.jaccardLinkLengths(this.links,N,1.5),this.links.forEach(function(V){return V.length*=o.idealLinkLength});var I=new m.Calculator(C,this.links,function(V){return V.source},function(V){return V.target},function(V){return V.length}).DistanceMatrix(),L=E.Descent.createSquareMatrix(C,function(V,K){return I[V][K]}),z=E.Descent.createSquareMatrix(C,function(){return 2});this.links.forEach(function(V){var K=V.source,q=V.target;return z[K][q]=z[q][K]=1}),this.descent=new E.Descent(this.result,L),this.descent.threshold=.001,this.descent.G=z,this.constraints&&(this.descent.project=new h.Projection(this.nodes,null,null,this.constraints).projectFunctions());for(var H=0;H<this.nodes.length;H++){var Z=this.nodes[H];Z.fixed&&this.descent.locks.add(H,[Z.x,Z.y,Z.z])}return this.descent.run(w),this},y.prototype.tick=function(){this.descent.locks.clear();for(var w=0;w<this.nodes.length;w++){var o=this.nodes[w];o.fixed&&this.descent.locks.add(w,[o.x,o.y,o.z])}return this.descent.rungeKutta()},y.dims=["x","y","z"],y.k=y.dims.length,y}();A.Layout3D=d;var g=function(){function y(){}return y.prototype.getSourceIndex=function(w){return w.source},y.prototype.getTargetIndex=function(w){return w.target},y.prototype.getLength=function(w){return w.length},y.prototype.setLength=function(w,o){w.length=o},y}()},8802:(T,A)=>{"use strict";function f(g,y){var w={};for(var o in g)w[o]={};for(var o in y)w[o]={};return Object.keys(w).length}function m(g,y){var w=0;for(var o in g)typeof y[o]<"u"&&++w;return w}function h(g,y,w,o){var C=function E(g,y){var w={},o=function(C,N){typeof w[C]>"u"&&(w[C]={}),w[C][N]={}};return g.forEach(function(C){var N=y.getSourceIndex(C),I=y.getTargetIndex(C);o(N,I),o(I,N)}),w}(g,o);g.forEach(function(N){var I=C[o.getSourceIndex(N)],L=C[o.getTargetIndex(N)];o.setLength(N,1+y*w(I,L))})}function d(g,y,w){var o=[],C=0,N=[],I=[];function L(F){F.index=F.lowlink=C++,N.push(F),F.onStack=!0;for(var $=0,Y=F.out;$<Y.length;$++){var j=Y[$];typeof j.index>"u"?(L(j),F.lowlink=Math.min(F.lowlink,j.lowlink)):j.onStack&&(F.lowlink=Math.min(F.lowlink,j.index))}if(F.lowlink===F.index){for(var W=[];N.length&&((j=N.pop()).onStack=!1,W.push(j),j!==F););I.push(W.map(function(at){return at.id}))}}for(var z=0;z<g;z++)o.push({id:z,out:[]});for(var H=0,Z=y;H<Z.length;H++){var V=Z[H],K=o[w.getSourceIndex(V)],q=o[w.getTargetIndex(V)];K.out.push(q)}for(var st=0,it=o;st<it.length;st++){var lt=it[st];typeof lt.index>"u"&&L(lt)}return I}Object.defineProperty(A,"__esModule",{value:!0}),A.symmetricDiffLinkLengths=function k(g,y,w){void 0===w&&(w=1),h(g,w,function(o,C){return Math.sqrt(f(o,C)-m(o,C))},y)},A.jaccardLinkLengths=function x(g,y,w){void 0===w&&(w=1),h(g,w,function(o,C){return Math.min(Object.keys(o).length,Object.keys(C).length)<1.1?0:m(o,C)/f(o,C)},y)},A.generateDirectedEdgeConstraints=function _(g,y,w,o){var C=d(g,y,o),N={};C.forEach(function(L,z){return L.forEach(function(H){return N[H]=z})});var I=[];return y.forEach(function(L){var z=o.getSourceIndex(L),H=o.getTargetIndex(L);N[z]!==N[H]&&I.push({axis:w,left:z,right:H,gap:o.getMinSeparation(L)})}),I},A.stronglyConnectedComponents=d},3900:(T,A)=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0});var f=function y(w,o,C){this.source=w,this.target=o,this.type=C};A.PowerEdge=f;var m=function(){function y(w,o,C,N){var I=this;if(this.linkAccessor=C,this.modules=new Array(w),this.roots=[],N)this.initModulesFromGroup(N);else{this.roots.push(new x);for(var L=0;L<w;++L)this.roots[0].add(this.modules[L]=new h(L))}this.R=o.length,o.forEach(function(z){var H=I.modules[C.getSourceIndex(z)],Z=I.modules[C.getTargetIndex(z)],V=C.getType(z);H.outgoing.add(V,Z),Z.incoming.add(V,H)})}return y.prototype.initModulesFromGroup=function(w){var o=new x;this.roots.push(o);for(var C=0;C<w.leaves.length;++C){var N=w.leaves[C],I=new h(N.id);this.modules[N.id]=I,o.add(I)}if(w.groups)for(var L=0;L<w.groups.length;++L){var z=w.groups[L],H={};for(var Z in z)"leaves"!==Z&&"groups"!==Z&&z.hasOwnProperty(Z)&&(H[Z]=z[Z]);o.add(new h(-1-L,new _,new _,this.initModulesFromGroup(z),H))}return o},y.prototype.merge=function(w,o,C){void 0===C&&(C=0);var N=w.incoming.intersection(o.incoming),I=w.outgoing.intersection(o.outgoing),L=new x;L.add(w),L.add(o);var z=new h(this.modules.length,I,N,L);this.modules.push(z);var H=function(Z,V,K){Z.forAll(function(q,st){q.forAll(function(it){var lt=it[V];lt.add(st,z),lt.remove(st,w),lt.remove(st,o),w[K].remove(st,it),o[K].remove(st,it)})})};return H(I,"incoming","outgoing"),H(N,"outgoing","incoming"),this.R-=N.count()+I.count(),this.roots[C].remove(w),this.roots[C].remove(o),this.roots[C].add(z),z},y.prototype.rootMerges=function(w){void 0===w&&(w=0);for(var o=this.roots[w].modules(),C=o.length,N=new Array(C*(C-1)),I=0,L=0,z=C-1;L<z;++L)for(var H=L+1;H<C;++H){var Z=o[L],V=o[H];N[I]={id:I,nEdges:this.nEdges(Z,V),a:Z,b:V},I++}return N},y.prototype.greedyMerge=function(){for(var w=0;w<this.roots.length;++w)if(!(this.roots[w].modules().length<2)){var C=this.rootMerges(w).sort(function(N,I){return N.nEdges==I.nEdges?N.id-I.id:N.nEdges-I.nEdges})[0];if(!(C.nEdges>=this.R))return this.merge(C.a,C.b,w),!0}},y.prototype.nEdges=function(w,o){var C=w.incoming.intersection(o.incoming),N=w.outgoing.intersection(o.outgoing);return this.R-C.count()-N.count()},y.prototype.getGroupHierarchy=function(w){var o=this,C=[];return E(this.roots[0],{},C),this.allEdges().forEach(function(L){var z=o.modules[L.source],H=o.modules[L.target];w.push(new f(typeof z.gid>"u"?L.source:C[z.gid],typeof H.gid>"u"?L.target:C[H.gid],L.type))}),C},y.prototype.allEdges=function(){var w=[];return y.getEdges(this.roots[0],w),w},y.getEdges=function(w,o){w.forAll(function(C){C.getEdges(o),y.getEdges(C.children,o)})},y}();function E(y,w,o){y.forAll(function(C){if(C.isLeaf())w.leaves||(w.leaves=[]),w.leaves.push(C.id);else{var N=w;if(C.gid=o.length,!C.isIsland()||C.isPredefined()){if(N={id:C.gid},C.isPredefined())for(var I in C.definition)N[I]=C.definition[I];w.groups||(w.groups=[]),w.groups.push(C.gid),o.push(N)}E(C.children,N,o)}})}A.Configuration=m;var h=function(){function y(w,o,C,N,I){void 0===o&&(o=new _),void 0===C&&(C=new _),void 0===N&&(N=new x),this.id=w,this.outgoing=o,this.incoming=C,this.children=N,this.definition=I}return y.prototype.getEdges=function(w){var o=this;this.outgoing.forAll(function(C,N){C.forAll(function(I){w.push(new f(o.id,I.id,N))})})},y.prototype.isLeaf=function(){return 0===this.children.count()},y.prototype.isIsland=function(){return 0===this.outgoing.count()&&0===this.incoming.count()},y.prototype.isPredefined=function(){return typeof this.definition<"u"},y}();function k(y,w){var o={};for(var C in y)C in w&&(o[C]=y[C]);return o}A.Module=h;var x=function(){function y(){this.table={}}return y.prototype.count=function(){return Object.keys(this.table).length},y.prototype.intersection=function(w){var o=new y;return o.table=k(this.table,w.table),o},y.prototype.intersectionCount=function(w){return this.intersection(w).count()},y.prototype.contains=function(w){return w in this.table},y.prototype.add=function(w){this.table[w.id]=w},y.prototype.remove=function(w){delete this.table[w.id]},y.prototype.forAll=function(w){for(var o in this.table)w(this.table[o])},y.prototype.modules=function(){var w=[];return this.forAll(function(o){o.isPredefined()||w.push(o)}),w},y}();A.ModuleSet=x;var _=function(){function y(){this.sets={},this.n=0}return y.prototype.count=function(){return this.n},y.prototype.contains=function(w){var o=!1;return this.forAllModules(function(C){!o&&C.id==w&&(o=!0)}),o},y.prototype.add=function(w,o){(w in this.sets?this.sets[w]:this.sets[w]=new x).add(o),++this.n},y.prototype.remove=function(w,o){var C=this.sets[w];C.remove(o),0===C.count()&&delete this.sets[w],--this.n},y.prototype.forAll=function(w){for(var o in this.sets)w(this.sets[o],Number(o))},y.prototype.forAllModules=function(w){this.forAll(function(o,C){return o.forAll(w)})},y.prototype.intersection=function(w){var o=new y;return this.forAll(function(C,N){if(N in w.sets){var I=C.intersection(w.sets[N]),L=I.count();L>0&&(o.sets[N]=I,o.n+=L)}}),o},y}();A.LinkSets=_,A.getGroups=function g(y,w,o,C){for(var N=y.length,I=new m(N,w,o,C);I.greedyMerge(););var L=[],z=I.getGroupHierarchy(L);return L.forEach(function(H){var Z=function(V){var K=H[V];"number"==typeof K&&(H[V]=y[K])};Z("source"),Z("target")}),{groups:z,powerEdges:L}}},8866:(T,A)=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0});var f=function(){function E(h){this.elem=h,this.subheaps=[]}return E.prototype.toString=function(h){for(var k="",x=!1,_=0;_<this.subheaps.length;++_){var d=this.subheaps[_];d.elem?(x&&(k+=","),k+=d.toString(h),x=!0):x=!1}return""!==k&&(k="("+k+")"),(this.elem?h(this.elem):"")+k},E.prototype.forEach=function(h){this.empty()||(h(this.elem,this),this.subheaps.forEach(function(k){return k.forEach(h)}))},E.prototype.count=function(){return this.empty()?0:1+this.subheaps.reduce(function(h,k){return h+k.count()},0)},E.prototype.min=function(){return this.elem},E.prototype.empty=function(){return null==this.elem},E.prototype.contains=function(h){if(this===h)return!0;for(var k=0;k<this.subheaps.length;k++)if(this.subheaps[k].contains(h))return!0;return!1},E.prototype.isHeap=function(h){var k=this;return this.subheaps.every(function(x){return h(k.elem,x.elem)&&x.isHeap(h)})},E.prototype.insert=function(h,k){return this.merge(new E(h),k)},E.prototype.merge=function(h,k){return this.empty()?h:h.empty()?this:k(this.elem,h.elem)?(this.subheaps.push(h),this):(h.subheaps.push(this),h)},E.prototype.removeMin=function(h){return this.empty()?null:this.mergePairs(h)},E.prototype.mergePairs=function(h){if(0==this.subheaps.length)return new E(null);if(1==this.subheaps.length)return this.subheaps[0];var k=this.subheaps.pop().merge(this.subheaps.pop(),h),x=this.mergePairs(h);return k.merge(x,h)},E.prototype.decreaseKey=function(h,k,x,_){var d=h.removeMin(_);h.elem=d.elem,h.subheaps=d.subheaps,null!==x&&null!==d.elem&&x(h.elem,h);var g=new E(k);return null!==x&&x(k,g),this.merge(g,_)},E}();A.PairingHeap=f;var m=function(){function E(h){this.lessThan=h}return E.prototype.top=function(){return this.empty()?null:this.root.elem},E.prototype.push=function(){for(var h=[],k=0;k<arguments.length;k++)h[k]=arguments[k];for(var x,d,_=0;d=h[_];++_)x=new f(d),this.root=this.empty()?x:this.root.merge(x,this.lessThan);return x},E.prototype.empty=function(){return!this.root||!this.root.elem},E.prototype.isHeap=function(){return this.root.isHeap(this.lessThan)},E.prototype.forEach=function(h){this.root.forEach(h)},E.prototype.pop=function(){if(this.empty())return null;var h=this.root.min();return this.root=this.root.removeMin(this.lessThan),h},E.prototype.reduceKey=function(h,k,x){void 0===x&&(x=null),this.root=this.root.decreaseKey(h,k,x,this.lessThan)},E.prototype.toString=function(h){return this.root.toString(h)},E.prototype.count=function(){return this.root.count()},E}();A.PriorityQueue=m},4655:function(T,A){"use strict";var x,f=this&&this.__extends||(x=function(_,d){return(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,y){g.__proto__=y}||function(g,y){for(var w in y)y.hasOwnProperty(w)&&(g[w]=y[w])})(_,d)},function(_,d){function g(){this.constructor=_}x(_,d),_.prototype=null===d?Object.create(d):(g.prototype=d.prototype,new g)});Object.defineProperty(A,"__esModule",{value:!0});var m=function(){function x(){this.findIter=function(_){for(var d=this._root,g=this.iterator();null!==d;){var y=this._comparator(_,d.data);if(0===y)return g._cursor=d,g;g._ancestors.push(d),d=d.get_child(y>0)}return null}}return x.prototype.clear=function(){this._root=null,this.size=0},x.prototype.find=function(_){for(var d=this._root;null!==d;){var g=this._comparator(_,d.data);if(0===g)return d.data;d=d.get_child(g>0)}return null},x.prototype.lowerBound=function(_){return this._bound(_,this._comparator)},x.prototype.upperBound=function(_){var d=this._comparator;return this._bound(_,function g(y,w){return d(w,y)})},x.prototype.min=function(){var _=this._root;if(null===_)return null;for(;null!==_.left;)_=_.left;return _.data},x.prototype.max=function(){var _=this._root;if(null===_)return null;for(;null!==_.right;)_=_.right;return _.data},x.prototype.iterator=function(){return new E(this)},x.prototype.each=function(_){for(var g,d=this.iterator();null!==(g=d.next());)_(g)},x.prototype.reach=function(_){for(var g,d=this.iterator();null!==(g=d.prev());)_(g)},x.prototype._bound=function(_,d){for(var g=this._root,y=this.iterator();null!==g;){var w=this._comparator(_,g.data);if(0===w)return y._cursor=g,y;y._ancestors.push(g),g=g.get_child(w>0)}for(var o=y._ancestors.length-1;o>=0;--o)if(d(_,(g=y._ancestors[o]).data)>0)return y._cursor=g,y._ancestors.length=o,y;return y._ancestors.length=0,y},x}();A.TreeBase=m;var E=function(){function x(_){this._tree=_,this._ancestors=[],this._cursor=null}return x.prototype.data=function(){return null!==this._cursor?this._cursor.data:null},x.prototype.next=function(){if(null===this._cursor){var _=this._tree._root;null!==_&&this._minNode(_)}else if(null===this._cursor.right){var d;do{if(d=this._cursor,!this._ancestors.length){this._cursor=null;break}this._cursor=this._ancestors.pop()}while(this._cursor.right===d)}else this._ancestors.push(this._cursor),this._minNode(this._cursor.right);return null!==this._cursor?this._cursor.data:null},x.prototype.prev=function(){if(null===this._cursor){var _=this._tree._root;null!==_&&this._maxNode(_)}else if(null===this._cursor.left){var d;do{if(d=this._cursor,!this._ancestors.length){this._cursor=null;break}this._cursor=this._ancestors.pop()}while(this._cursor.left===d)}else this._ancestors.push(this._cursor),this._maxNode(this._cursor.left);return null!==this._cursor?this._cursor.data:null},x.prototype._minNode=function(_){for(;null!==_.left;)this._ancestors.push(_),_=_.left;this._cursor=_},x.prototype._maxNode=function(_){for(;null!==_.right;)this._ancestors.push(_),_=_.right;this._cursor=_},x}();A.Iterator=E;var h=function(){function x(_){this.data=_,this.left=null,this.right=null,this.red=!0}return x.prototype.get_child=function(_){return _?this.right:this.left},x.prototype.set_child=function(_,d){_?this.right=d:this.left=d},x}(),k=function(x){function _(d){var g=x.call(this)||this;return g._root=null,g._comparator=d,g.size=0,g}return f(_,x),_.prototype.insert=function(d){var g=!1;if(null===this._root)this._root=new h(d),g=!0,this.size++;else{var y=new h(void 0),w=!1,o=!1,C=null,N=y,I=null,L=this._root;for(N.right=this._root;;){if(null===L?(L=new h(d),I.set_child(w,L),g=!0,this.size++):_.is_red(L.left)&&_.is_red(L.right)&&(L.red=!0,L.left.red=!1,L.right.red=!1),_.is_red(L)&&_.is_red(I)){var z=N.right===C;L===I.get_child(o)?N.set_child(z,_.single_rotate(C,!o)):N.set_child(z,_.double_rotate(C,!o))}var H=this._comparator(L.data,d);if(0===H)break;o=w,w=H<0,null!==C&&(N=C),C=I,I=L,L=L.get_child(w)}this._root=y.right}return this._root.red=!1,g},_.prototype.remove=function(d){if(null===this._root)return!1;var g=new h(void 0),y=g;y.right=this._root;for(var w=null,o=null,C=null,N=!0;null!==y.get_child(N);){var I=N;o=w,w=y,y=y.get_child(N);var L=this._comparator(d,y.data);if(N=L>0,0===L&&(C=y),!_.is_red(y)&&!_.is_red(y.get_child(N)))if(_.is_red(y.get_child(!N))){var z=_.single_rotate(y,N);w.set_child(I,z),w=z}else if(!_.is_red(y.get_child(!N))){var H=w.get_child(!I);if(null!==H)if(_.is_red(H.get_child(!I))||_.is_red(H.get_child(I))){var Z=o.right===w;_.is_red(H.get_child(I))?o.set_child(Z,_.double_rotate(w,I)):_.is_red(H.get_child(!I))&&o.set_child(Z,_.single_rotate(w,I));var V=o.get_child(Z);V.red=!0,y.red=!0,V.left.red=!1,V.right.red=!1}else w.red=!1,H.red=!0,y.red=!0}}return null!==C&&(C.data=y.data,w.set_child(w.right===y,y.get_child(null===y.left)),this.size--),this._root=g.right,null!==this._root&&(this._root.red=!1),null!==C},_.is_red=function(d){return null!==d&&d.red},_.single_rotate=function(d,g){var y=d.get_child(!g);return d.set_child(!g,y.get_child(g)),y.set_child(g,d),d.red=!0,y.red=!1,y},_.double_rotate=function(d,g){return d.set_child(!g,_.single_rotate(d.get_child(!g),!g)),_.single_rotate(d,g)},_}(m);A.RBTree=k},4068:function(T,A,f){"use strict";var F,m=this&&this.__extends||(F=function($,Y){return(F=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(j,W){j.__proto__=W}||function(j,W){for(var at in W)W.hasOwnProperty(at)&&(j[at]=W[at])})($,Y)},function($,Y){function j(){this.constructor=$}F($,Y),$.prototype=null===Y?Object.create(Y):(j.prototype=Y.prototype,new j)});Object.defineProperty(A,"__esModule",{value:!0});var E=f(8237),h=f(4655);function k(F){return F.bounds=typeof F.leaves<"u"?F.leaves.reduce(function($,Y){return Y.bounds.union($)},x.empty()):x.empty(),typeof F.groups<"u"&&(F.bounds=F.groups.reduce(function($,Y){return k(Y).union($)},F.bounds)),F.bounds=F.bounds.inflate(F.padding),F.bounds}A.computeGroupBounds=k;var x=function(){function F($,Y,j,W){this.x=$,this.X=Y,this.y=j,this.Y=W}return F.empty=function(){return new F(Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY)},F.prototype.cx=function(){return(this.x+this.X)/2},F.prototype.cy=function(){return(this.y+this.Y)/2},F.prototype.overlapX=function($){var Y=this.cx(),j=$.cx();return Y<=j&&$.x<this.X?this.X-$.x:j<=Y&&this.x<$.X?$.X-this.x:0},F.prototype.overlapY=function($){var Y=this.cy(),j=$.cy();return Y<=j&&$.y<this.Y?this.Y-$.y:j<=Y&&this.y<$.Y?$.Y-this.y:0},F.prototype.setXCentre=function($){var Y=$-this.cx();this.x+=Y,this.X+=Y},F.prototype.setYCentre=function($){var Y=$-this.cy();this.y+=Y,this.Y+=Y},F.prototype.width=function(){return this.X-this.x},F.prototype.height=function(){return this.Y-this.y},F.prototype.union=function($){return new F(Math.min(this.x,$.x),Math.max(this.X,$.X),Math.min(this.y,$.y),Math.max(this.Y,$.Y))},F.prototype.lineIntersections=function($,Y,j,W){for(var at=[[this.x,this.y,this.X,this.y],[this.X,this.y,this.X,this.Y],[this.X,this.Y,this.x,this.Y],[this.x,this.Y,this.x,this.y]],ot=[],et=0;et<4;++et){var X=F.lineIntersection($,Y,j,W,at[et][0],at[et][1],at[et][2],at[et][3]);null!==X&&ot.push({x:X.x,y:X.y})}return ot},F.prototype.rayIntersection=function($,Y){var j=this.lineIntersections(this.cx(),this.cy(),$,Y);return j.length>0?j[0]:null},F.prototype.vertices=function(){return[{x:this.x,y:this.y},{x:this.X,y:this.y},{x:this.X,y:this.Y},{x:this.x,y:this.Y}]},F.lineIntersection=function($,Y,j,W,at,ot,et,X){var dt=j-$,pt=et-at,bt=W-Y,yt=X-ot,kt=yt*dt-pt*bt;if(0==kt)return null;var Nt=$-at,Ft=Y-ot,mt=(pt*Ft-yt*Nt)/kt,Tt=(dt*Ft-bt*Nt)/kt;return mt>=0&&mt<=1&&Tt>=0&&Tt<=1?{x:$+mt*dt,y:Y+mt*bt}:null},F.prototype.inflate=function($){return new F(this.x-$,this.X+$,this.y-$,this.Y+$)},F}();A.Rectangle=x,A.makeEdgeBetween=function _(F,$,Y){var j=F.rayIntersection($.cx(),$.cy())||{x:F.cx(),y:F.cy()},W=$.rayIntersection(F.cx(),F.cy())||{x:$.cx(),y:$.cy()},at=W.x-j.x,ot=W.y-j.y,et=Math.sqrt(at*at+ot*ot),X=et-Y;return{sourceIntersection:j,targetIntersection:W,arrowStart:{x:j.x+X*at/et,y:j.y+X*ot/et}}},A.makeEdgeTo=function d(F,$,Y){var j=$.rayIntersection(F.x,F.y);j||(j={x:$.cx(),y:$.cy()});var W=j.x-F.x,at=j.y-F.y,ot=Math.sqrt(W*W+at*at);return{x:j.x-Y*W/ot,y:j.y-Y*at/ot}};var g=function F($,Y,j){this.v=$,this.r=Y,this.pos=j,this.prev=o(),this.next=o()},y=function F($,Y,j){this.isOpen=$,this.v=Y,this.pos=j};function w(F,$){return F.pos>$.pos?1:F.pos<$.pos||F.isOpen?-1:$.isOpen?1:0}function o(){return new h.RBTree(function(F,$){return F.pos-$.pos})}var C={getCentre:function(F){return F.cx()},getOpen:function(F){return F.y},getClose:function(F){return F.Y},getSize:function(F){return F.width()},makeRect:function(F,$,Y,j){return new x(Y-j/2,Y+j/2,F,$)},findNeighbours:function z(F,$){var Y=function(j,W){for(var ot,at=$.findIter(F);null!==(ot=at[j]());){var et=ot.r.overlapX(F.r);if((et<=0||et<=ot.r.overlapY(F.r))&&(F[j].insert(ot),ot[W].insert(F)),et<=0)break}};Y("next","prev"),Y("prev","next")}},N={getCentre:function(F){return F.cy()},getOpen:function(F){return F.x},getClose:function(F){return F.X},getSize:function(F){return F.height()},makeRect:function(F,$,Y,j){return new x(F,$,Y-j/2,Y+j/2)},findNeighbours:function H(F,$){var Y=function(j,W){var at=$.findIter(F)[j]();null!==at&&at.r.overlapX(F.r)>0&&(F[j].insert(at),at[W].insert(F))};Y("next","prev"),Y("prev","next")}};function I(F,$,Y,j){void 0===j&&(j=!1);var W=F.padding,at=typeof F.groups<"u"?F.groups.length:0,ot=typeof F.leaves<"u"?F.leaves.length:0,et=at?F.groups.reduce(function(At,Ht){return At.concat(I(Ht,$,Y,!0))},[]):[],X=(j?2:0)+ot+at,dt=new Array(X),pt=new Array(X),bt=0,yt=function(At,Ht){pt[bt]=At,dt[bt++]=Ht};if(j){var kt=F.bounds,Nt=$.getCentre(kt),Ft=$.getSize(kt)/2,ht=$.getOpen(kt),mt=$.getClose(kt),_t=Nt-Ft+W/2,Tt=Nt+Ft-W/2;F.minVar.desiredPosition=_t,yt($.makeRect(ht,mt,_t,W),F.minVar),F.maxVar.desiredPosition=Tt,yt($.makeRect(ht,mt,Tt,W),F.maxVar)}ot&&F.leaves.forEach(function(At){return yt(At.bounds,At.variable)}),at&&F.groups.forEach(function(At){var Ht=At.bounds;yt($.makeRect($.getOpen(Ht),$.getClose(Ht),$.getCentre(Ht),$.getSize(Ht)),At.minVar)});var Pt=L(pt,dt,$,Y);return at&&(dt.forEach(function(At){At.cOut=[],At.cIn=[]}),Pt.forEach(function(At){At.left.cOut.push(At),At.right.cIn.push(At)}),F.groups.forEach(function(At){var Ht=(At.padding-$.getSize(At.bounds))/2;At.minVar.cIn.forEach(function($t){return $t.gap+=Ht}),At.minVar.cOut.forEach(function($t){$t.left=At.maxVar,$t.gap+=Ht})})),et.concat(Pt)}function L(F,$,Y,j){var W,at=F.length,ot=2*at;console.assert($.length>=at);var et=new Array(ot);for(W=0;W<at;++W){var X=F[W],dt=new g($[W],X,Y.getCentre(X));et[W]=new y(!0,dt,Y.getOpen(X)),et[W+at]=new y(!1,dt,Y.getClose(X))}et.sort(w);var pt=new Array,bt=o();for(W=0;W<ot;++W){var yt=et[W];dt=yt.v;if(yt.isOpen)bt.insert(dt),Y.findNeighbours(dt,bt);else{bt.remove(dt);var kt=function(ht,mt){var _t=(Y.getSize(ht.r)+Y.getSize(mt.r))/2+j;pt.push(new E.Constraint(ht.v,mt.v,_t))},Nt=function(ht,mt,_t){for(var Tt,Pt=dt[ht].iterator();null!==(Tt=Pt[ht]());)_t(Tt,dt),Tt[mt].remove(dt)};Nt("prev","next",function(ht,mt){return kt(ht,mt)}),Nt("next","prev",function(ht,mt){return kt(mt,ht)})}}return console.assert(0===bt.size),pt}function Z(F,$){return L(F,$,C,1e-6)}function V(F,$){return L(F,$,N,1e-6)}function K(F){return I(F,C,1e-6)}function q(F){return I(F,N,1e-6)}A.generateXConstraints=Z,A.generateYConstraints=V,A.generateXGroupConstraints=K,A.generateYGroupConstraints=q,A.removeOverlaps=function st(F){var $=F.map(function(W){return new E.Variable(W.cx())}),Y=Z(F,$),j=new E.Solver($,Y);j.solve(),$.forEach(function(W,at){return F[at].setXCentre(W.position())}),$=F.map(function(W){return new E.Variable(W.cy())}),Y=V(F,$),(j=new E.Solver($,Y)).solve(),$.forEach(function(W,at){return F[at].setYCentre(W.position())})};var it=function(F){function $(Y,j){var W=F.call(this,0,j)||this;return W.index=Y,W}return m($,F),$}(E.Variable);A.IndexedVariable=it;var lt=function(){function F($,Y,j,W,at){var ot=this;if(void 0===j&&(j=null),void 0===W&&(W=null),void 0===at&&(at=!1),this.nodes=$,this.groups=Y,this.rootGroup=j,this.avoidOverlaps=at,this.variables=$.map(function(X,dt){return X.variable=new it(dt,1)}),W&&this.createConstraints(W),at&&j&&typeof j.groups<"u"){$.forEach(function(X){if(X.width&&X.height){var dt=X.width/2,pt=X.height/2;X.bounds=new x(X.x-dt,X.x+dt,X.y-pt,X.y+pt)}else X.bounds=new x(X.x,X.x,X.y,X.y)}),k(j);var et=$.length;Y.forEach(function(X){ot.variables[et]=X.minVar=new it(et++,typeof X.stiffness<"u"?X.stiffness:.01),ot.variables[et]=X.maxVar=new it(et++,typeof X.stiffness<"u"?X.stiffness:.01)})}}return F.prototype.createSeparation=function($){return new E.Constraint(this.nodes[$.left].variable,this.nodes[$.right].variable,$.gap,typeof $.equality<"u"&&$.equality)},F.prototype.makeFeasible=function($){var Y=this;if(this.avoidOverlaps){var j="x",W="width";"x"===$.axis&&(j="y",W="height");var at=$.offsets.map(function(et){return Y.nodes[et.node]}).sort(function(et,X){return et[j]-X[j]}),ot=null;at.forEach(function(et){if(ot){var X=ot[j]+ot[W];X>et[j]&&(et[j]=X)}ot=et})}},F.prototype.createAlignment=function($){var Y=this,j=this.nodes[$.offsets[0].node].variable;this.makeFeasible($);var W="x"===$.axis?this.xConstraints:this.yConstraints;$.offsets.slice(1).forEach(function(at){var ot=Y.nodes[at.node].variable;W.push(new E.Constraint(j,ot,at.offset,!0))})},F.prototype.createConstraints=function($){var Y=this,j=function(W){return typeof W.type>"u"||"separation"===W.type};this.xConstraints=$.filter(function(W){return"x"===W.axis&&j(W)}).map(function(W){return Y.createSeparation(W)}),this.yConstraints=$.filter(function(W){return"y"===W.axis&&j(W)}).map(function(W){return Y.createSeparation(W)}),$.filter(function(W){return"alignment"===W.type}).forEach(function(W){return Y.createAlignment(W)})},F.prototype.setupVariablesAndBounds=function($,Y,j,W){this.nodes.forEach(function(at,ot){at.fixed?(at.variable.weight=at.fixedWeight?at.fixedWeight:1e3,j[ot]=W(at)):at.variable.weight=1;var et=(at.width||0)/2,X=(at.height||0)/2,dt=$[ot],pt=Y[ot];at.bounds=new x(dt-et,dt+et,pt-X,pt+X)})},F.prototype.xProject=function($,Y,j){!this.rootGroup&&!this.avoidOverlaps&&!this.xConstraints||this.project($,Y,$,j,function(W){return W.px},this.xConstraints,K,function(W){return W.bounds.setXCentre(j[W.variable.index]=W.variable.position())},function(W){var at=j[W.minVar.index]=W.minVar.position(),ot=j[W.maxVar.index]=W.maxVar.position(),et=W.padding/2;W.bounds.x=at-et,W.bounds.X=ot+et})},F.prototype.yProject=function($,Y,j){!this.rootGroup&&!this.yConstraints||this.project($,Y,Y,j,function(W){return W.py},this.yConstraints,q,function(W){return W.bounds.setYCentre(j[W.variable.index]=W.variable.position())},function(W){var at=j[W.minVar.index]=W.minVar.position(),ot=j[W.maxVar.index]=W.maxVar.position(),et=W.padding/2;W.bounds.y=at-et,W.bounds.Y=ot+et})},F.prototype.projectFunctions=function(){var $=this;return[function(Y,j,W){return $.xProject(Y,j,W)},function(Y,j,W){return $.yProject(Y,j,W)}]},F.prototype.project=function($,Y,j,W,at,ot,et,X,dt){this.setupVariablesAndBounds($,Y,W,at),this.rootGroup&&this.avoidOverlaps&&(k(this.rootGroup),ot=ot.concat(et(this.rootGroup))),this.solve(this.variables,ot,j,W),this.nodes.forEach(X),this.rootGroup&&this.avoidOverlaps&&(this.groups.forEach(dt),k(this.rootGroup))},F.prototype.solve=function($,Y,j,W){var at=new E.Solver($,Y);at.setStartingPositions(j),at.setDesiredPositions(W),at.solve()},F}();A.Projection=lt},3858:(T,A,f)=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0});var m=f(8866),E=function _(d,g){this.id=d,this.distance=g},h=function _(d){this.id=d,this.neighbours=[]},k=function _(d,g,y){this.node=d,this.prev=g,this.d=y},x=function(){function _(d,g,y,w,o){this.n=d,this.es=g,this.neighbours=new Array(this.n);for(var C=this.n;C--;)this.neighbours[C]=new h(C);for(C=this.es.length;C--;){var N=this.es[C],I=y(N),L=w(N),z=o(N);this.neighbours[I].neighbours.push(new E(L,z)),this.neighbours[L].neighbours.push(new E(I,z))}}return _.prototype.DistanceMatrix=function(){for(var d=new Array(this.n),g=0;g<this.n;++g)d[g]=this.dijkstraNeighbours(g);return d},_.prototype.DistancesFromNode=function(d){return this.dijkstraNeighbours(d)},_.prototype.PathFromNodeToNode=function(d,g){return this.dijkstraNeighbours(d,g)},_.prototype.PathFromNodeToNodeWithPrevCost=function(d,g,y){var w=new m.PriorityQueue(function(q,st){return q.d<=st.d}),o=this.neighbours[d],C=new k(o,null,0),N={};for(w.push(C);!w.empty()&&(o=(C=w.pop()).node).id!==g;)for(var I=o.neighbours.length;I--;){var L=o.neighbours[I],z=this.neighbours[L.id];if(!C.prev||z.id!==C.prev.node.id){var H=z.id+","+o.id;if(!(H in N&&N[H]<=C.d)){var Z=C.prev?y(C.prev.node.id,o.id,z.id):0,V=C.d+L.distance+Z;N[H]=V,w.push(new k(z,C,V))}}}for(var K=[];C.prev;)C=C.prev,K.push(C.node.id);return K},_.prototype.dijkstraNeighbours=function(d,g){void 0===g&&(g=-1);for(var y=new m.PriorityQueue(function(Z,V){return Z.d<=V.d}),w=this.neighbours.length,o=new Array(w);w--;){var C=this.neighbours[w];C.d=w===d?0:Number.POSITIVE_INFINITY,C.q=y.push(C)}for(;!y.empty();){var N=y.pop();if(o[N.id]=N.d,N.id===g){for(var I=[],L=N;typeof L.prev<"u";)I.push(L.prev.id),L=L.prev;return I}for(w=N.neighbours.length;w--;){var z=N.neighbours[w],H=(L=this.neighbours[z.id],N.d+z.distance);N.d!==Number.MAX_VALUE&&L.d>H&&(L.d=H,L.prev=N,y.reduceKey(L.q,L,function(V,K){return V.q=K}))}}return o},_}();A.Calculator=x},8237:(T,A)=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0});var f=function(){function d(g){this.scale=g,this.AB=0,this.AD=0,this.A2=0}return d.prototype.addVariable=function(g){var y=this.scale/g.scale,w=g.offset/g.scale,o=g.weight;this.AB+=o*y*w,this.AD+=o*y*g.desiredPosition,this.A2+=o*y*y},d.prototype.getPosn=function(){return(this.AD-this.AB)/this.A2},d}();A.PositionStats=f;var m=function(){function d(g,y,w,o){void 0===o&&(o=!1),this.left=g,this.right=y,this.gap=w,this.equality=o,this.active=!1,this.unsatisfiable=!1,this.left=g,this.right=y,this.gap=w,this.equality=o}return d.prototype.slack=function(){return this.unsatisfiable?Number.MAX_VALUE:this.right.scale*this.right.position()-this.gap-this.left.scale*this.left.position()},d}();A.Constraint=m;var E=function(){function d(g,y,w){void 0===y&&(y=1),void 0===w&&(w=1),this.desiredPosition=g,this.weight=y,this.scale=w,this.offset=0}return d.prototype.dfdv=function(){return 2*this.weight*(this.position()-this.desiredPosition)},d.prototype.position=function(){return(this.block.ps.scale*this.block.posn+this.offset)/this.scale},d.prototype.visitNeighbours=function(g,y){var w=function(o,C){return o.active&&g!==C&&y(o,C)};this.cOut.forEach(function(o){return w(o,o.right)}),this.cIn.forEach(function(o){return w(o,o.left)})},d}();A.Variable=E;var h=function(){function d(g){this.vars=[],g.offset=0,this.ps=new f(g.scale),this.addVariable(g)}return d.prototype.addVariable=function(g){g.block=this,this.vars.push(g),this.ps.addVariable(g),this.posn=this.ps.getPosn()},d.prototype.updateWeightedPosition=function(){this.ps.AB=this.ps.AD=this.ps.A2=0;for(var g=0,y=this.vars.length;g<y;++g)this.ps.addVariable(this.vars[g]);this.posn=this.ps.getPosn()},d.prototype.compute_lm=function(g,y,w){var o=this,C=g.dfdv();return g.visitNeighbours(y,function(N,I){var L=o.compute_lm(I,g,w);I===N.right?(C+=L*N.left.scale,N.lm=L):(C+=L*N.right.scale,N.lm=-L),w(N)}),C/g.scale},d.prototype.populateSplitBlock=function(g,y){var w=this;g.visitNeighbours(y,function(o,C){C.offset=g.offset+(C===o.right?o.gap:-o.gap),w.addVariable(C),w.populateSplitBlock(C,g)})},d.prototype.traverse=function(g,y,w,o){var C=this;void 0===w&&(w=this.vars[0]),void 0===o&&(o=null),w.visitNeighbours(o,function(N,I){y.push(g(N)),C.traverse(g,y,I,w)})},d.prototype.findMinLM=function(){var g=null;return this.compute_lm(this.vars[0],null,function(y){!y.equality&&(null===g||y.lm<g.lm)&&(g=y)}),g},d.prototype.findMinLMBetween=function(g,y){this.compute_lm(g,null,function(){});var w=null;return this.findPath(g,null,y,function(o,C){!o.equality&&o.right===C&&(null===w||o.lm<w.lm)&&(w=o)}),w},d.prototype.findPath=function(g,y,w,o){var C=this,N=!1;return g.visitNeighbours(y,function(I,L){!N&&(L===w||C.findPath(L,g,w,o))&&(N=!0,o(I,L))}),N},d.prototype.isActiveDirectedPathBetween=function(g,y){if(g===y)return!0;for(var w=g.cOut.length;w--;){var o=g.cOut[w];if(o.active&&this.isActiveDirectedPathBetween(o.right,y))return!0}return!1},d.split=function(g){return g.active=!1,[d.createSplitBlock(g.left),d.createSplitBlock(g.right)]},d.createSplitBlock=function(g){var y=new d(g);return y.populateSplitBlock(g,null),y},d.prototype.splitBetween=function(g,y){var w=this.findMinLMBetween(g,y);if(null!==w){var o=d.split(w);return{constraint:w,lb:o[0],rb:o[1]}}return null},d.prototype.mergeAcross=function(g,y,w){y.active=!0;for(var o=0,C=g.vars.length;o<C;++o){var N=g.vars[o];N.offset+=w,this.addVariable(N)}this.posn=this.ps.getPosn()},d.prototype.cost=function(){for(var g=0,y=this.vars.length;y--;){var w=this.vars[y],o=w.position()-w.desiredPosition;g+=o*o*w.weight}return g},d}();A.Block=h;var k=function(){function d(g){this.vs=g;var y=g.length;for(this.list=new Array(y);y--;){var w=new h(g[y]);this.list[y]=w,w.blockInd=y}}return d.prototype.cost=function(){for(var g=0,y=this.list.length;y--;)g+=this.list[y].cost();return g},d.prototype.insert=function(g){g.blockInd=this.list.length,this.list.push(g)},d.prototype.remove=function(g){var y=this.list.length-1,w=this.list[y];this.list.length=y,g!==w&&(this.list[g.blockInd]=w,w.blockInd=g.blockInd)},d.prototype.merge=function(g){var y=g.left.block,w=g.right.block,o=g.right.offset-g.left.offset-g.gap;y.vars.length<w.vars.length?(w.mergeAcross(y,g,o),this.remove(y)):(y.mergeAcross(w,g,-o),this.remove(w))},d.prototype.forEach=function(g){this.list.forEach(g)},d.prototype.updateBlockPositions=function(){this.list.forEach(function(g){return g.updateWeightedPosition()})},d.prototype.split=function(g){var y=this;this.updateBlockPositions(),this.list.forEach(function(w){var o=w.findMinLM();null!==o&&o.lm<x.LAGRANGIAN_TOLERANCE&&(w=o.left.block,h.split(o).forEach(function(C){return y.insert(C)}),y.remove(w),g.push(o))})},d}();A.Blocks=k;var x=function(){function d(g,y){this.vs=g,this.cs=y,this.vs=g,g.forEach(function(w){w.cIn=[],w.cOut=[]}),this.cs=y,y.forEach(function(w){w.left.cOut.push(w),w.right.cIn.push(w)}),this.inactive=y.map(function(w){return w.active=!1,w}),this.bs=null}return d.prototype.cost=function(){return this.bs.cost()},d.prototype.setStartingPositions=function(g){this.inactive=this.cs.map(function(y){return y.active=!1,y}),this.bs=new k(this.vs),this.bs.forEach(function(y,w){return y.posn=g[w]})},d.prototype.setDesiredPositions=function(g){this.vs.forEach(function(y,w){return y.desiredPosition=g[w]})},d.prototype.mostViolated=function(){for(var g=Number.MAX_VALUE,y=null,w=this.inactive,o=w.length,C=o,N=0;N<o;++N){var I=w[N];if(!I.unsatisfiable){var L=I.slack();if((I.equality||L<g)&&(g=L,y=I,C=N,I.equality))break}}return C!==o&&(g<d.ZERO_UPPERBOUND&&!y.active||y.equality)&&(w[C]=w[o-1],w.length=o-1),y},d.prototype.satisfy=function(){null==this.bs&&(this.bs=new k(this.vs)),this.bs.split(this.inactive);for(var g=null;(g=this.mostViolated())&&(g.equality||g.slack()<d.ZERO_UPPERBOUND&&!g.active);){var y=g.left.block;if(y!==g.right.block)this.bs.merge(g);else{if(y.isActiveDirectedPathBetween(g.right,g.left)){g.unsatisfiable=!0;continue}var o=y.splitBetween(g.left,g.right);if(null===o){g.unsatisfiable=!0;continue}this.bs.insert(o.lb),this.bs.insert(o.rb),this.bs.remove(y),this.inactive.push(o.constraint),g.slack()>=0?this.inactive.push(g):this.bs.merge(g)}}},d.prototype.solve=function(){this.satisfy();for(var g=Number.MAX_VALUE,y=this.bs.cost();Math.abs(g-y)>1e-4;)this.satisfy(),g=y,y=this.bs.cost();return y},d.LAGRANGIAN_TOLERANCE=-1e-4,d.ZERO_UPPERBOUND=-1e-10,d}();A.Solver=x,A.removeOverlapInOneDimension=function _(d,g,y){for(var w=d.map(function(it){return new E(it.desiredCenter)}),o=[],C=d.length,N=0;N<C-1;N++){var I=d[N],L=d[N+1];o.push(new m(w[N],w[N+1],(I.size+L.size)/2))}var z=w[0],H=w[C-1],Z=d[0].size/2,V=d[C-1].size/2,K=null,q=null;return g&&(K=new E(g,1e3*z.weight),w.push(K),o.push(new m(K,z,Z))),y&&(q=new E(y,1e3*H.weight),w.push(q),o.push(new m(H,q,V))),new x(w,o).solve(),{newCenters:w.slice(0,d.length).map(function(it){return it.position()}),lowerBound:K?K.position():z.position()-Z,upperBound:q?q.position():H.position()+V}}},571:(T,A,f)=>{"use strict";function m(r,t,e,n,i,s,c){try{var p=r[s](c),b=p.value}catch(S){return void e(S)}p.done?t(b):Promise.resolve(b).then(n,i)}function E(r){return function(){var t=this,e=arguments;return new Promise(function(n,i){var s=r.apply(t,e);function c(b){m(s,n,i,c,p,"next",b)}function p(b){m(s,n,i,c,p,"throw",b)}c(void 0)})}}f.d(A,{ML:()=>op,Mn:()=>Ts,tP:()=>io,FP:()=>lr,io:()=>dh});var h=f(1571),k=f(433),x=f(7579),_=f(4968),d=f(4986),g=f(2722),y=f(4482),w=f(5403),o=f(8421);const C={leading:!0,trailing:!1};var I=f(5963);function L(r,t=d.z,e=C){const n=(0,I.H)(r,t);return function N(r,t=C){return(0,y.e)((e,n)=>{const{leading:i,trailing:s}=t;let c=!1,p=null,b=null,S=!1;const O=()=>{b?.unsubscribe(),b=null,s&&(J(),S&&n.complete())},B=()=>{b=null,S&&n.complete()},U=nt=>b=(0,o.Xf)(r(nt)).subscribe((0,w.x)(n,O,B)),J=()=>{if(c){c=!1;const nt=p;p=null,n.next(nt),!S&&U(nt)}};e.subscribe((0,w.x)(n,nt=>{c=!0,p=nt,(!b||b.closed)&&(i?J():U(nt))},()=>{S=!0,(!(s&&c&&b)||b.closed)&&n.complete()}))})}(()=>n,e)}const V=r=>{const t=(r=>{const t={};return Object.keys(r).forEach(e=>{r[e]&&(t[e]=r[e])}),t})(r);return Object.entries(t).map(([e,n])=>`${(r=>r.replace(/[A-Z]/g,t=>`-${t.toLowerCase()}`))(e)}:${n}`).join(";")};class K extends Error{constructor(t){super(t),this.name=this.constructor.name}}function q(r){this.content=r}q.prototype={constructor:q,find:function(r){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===r)return t;return-1},get:function(r){var t=this.find(r);return-1==t?void 0:this.content[t+1]},update:function(r,t,e){var n=e&&e!=r?this.remove(e):this,i=n.find(r),s=n.content.slice();return-1==i?s.push(e||r,t):(s[i+1]=t,e&&(s[i]=e)),new q(s)},remove:function(r){var t=this.find(r);if(-1==t)return this;var e=this.content.slice();return e.splice(t,2),new q(e)},addToStart:function(r,t){return new q([r,t].concat(this.remove(r).content))},addToEnd:function(r,t){var e=this.remove(r).content.slice();return e.push(r,t),new q(e)},addBefore:function(r,t,e){var n=this.remove(t),i=n.content.slice(),s=n.find(r);return i.splice(-1==s?i.length:s,0,t,e),new q(i)},forEach:function(r){for(var t=0;t<this.content.length;t+=2)r(this.content[t],this.content[t+1])},prepend:function(r){return(r=q.from(r)).size?new q(r.content.concat(this.subtract(r).content)):this},append:function(r){return(r=q.from(r)).size?new q(this.subtract(r).content.concat(r.content)):this},subtract:function(r){var t=this;r=q.from(r);for(var e=0;e<r.content.length;e+=2)t=t.remove(r.content[e]);return t},toObject:function(){var r={};return this.forEach(function(t,e){r[t]=e}),r},get size(){return this.content.length>>1}},q.from=function(r){if(r instanceof q)return r;var t=[];if(r)for(var e in r)t.push(e,r[e]);return new q(t)};const st=q;function it(r,t,e){for(let n=0;;n++){if(n==r.childCount||n==t.childCount)return r.childCount==t.childCount?null:e;let i=r.child(n),s=t.child(n);if(i!=s){if(!i.sameMarkup(s))return e;if(i.isText&&i.text!=s.text){for(let c=0;i.text[c]==s.text[c];c++)e++;return e}if(i.content.size||s.content.size){let c=it(i.content,s.content,e+1);if(null!=c)return c}e+=i.nodeSize}else e+=i.nodeSize}}function lt(r,t,e,n){for(let i=r.childCount,s=t.childCount;;){if(0==i||0==s)return i==s?null:{a:e,b:n};let c=r.child(--i),p=t.child(--s),b=c.nodeSize;if(c!=p){if(!c.sameMarkup(p))return{a:e,b:n};if(c.isText&&c.text!=p.text){let S=0,O=Math.min(c.text.length,p.text.length);for(;S<O&&c.text[c.text.length-S-1]==p.text[p.text.length-S-1];)S++,e--,n--;return{a:e,b:n}}if(c.content.size||p.content.size){let S=lt(c.content,p.content,e-1,n-1);if(S)return S}e-=b,n-=b}else e-=b,n-=b}}class F{constructor(t,e){if(this.content=t,this.size=e||0,null==e)for(let n=0;n<t.length;n++)this.size+=t[n].nodeSize}nodesBetween(t,e,n,i=0,s){for(let c=0,p=0;p<e;c++){let b=this.content[c],S=p+b.nodeSize;if(S>t&&!1!==n(b,i+p,s||null,c)&&b.content.size){let O=p+1;b.nodesBetween(Math.max(0,t-O),Math.min(b.content.size,e-O),n,i+O)}p=S}}descendants(t){this.nodesBetween(0,this.size,t)}textBetween(t,e,n,i){let s="",c=!0;return this.nodesBetween(t,e,(p,b)=>{p.isText?(s+=p.text.slice(Math.max(t,b)-b,e-b),c=!n):p.isLeaf?(i?s+="function"==typeof i?i(p):i:p.type.spec.leafText&&(s+=p.type.spec.leafText(p)),c=!n):!c&&p.isBlock&&(s+=n,c=!0)},0),s}append(t){if(!t.size)return this;if(!this.size)return t;let e=this.lastChild,n=t.firstChild,i=this.content.slice(),s=0;for(e.isText&&e.sameMarkup(n)&&(i[i.length-1]=e.withText(e.text+n.text),s=1);s<t.content.length;s++)i.push(t.content[s]);return new F(i,this.size+t.size)}cut(t,e=this.size){if(0==t&&e==this.size)return this;let n=[],i=0;if(e>t)for(let s=0,c=0;c<e;s++){let p=this.content[s],b=c+p.nodeSize;b>t&&((c<t||b>e)&&(p=p.isText?p.cut(Math.max(0,t-c),Math.min(p.text.length,e-c)):p.cut(Math.max(0,t-c-1),Math.min(p.content.size,e-c-1))),n.push(p),i+=p.nodeSize),c=b}return new F(n,i)}cutByIndex(t,e){return t==e?F.empty:0==t&&e==this.content.length?this:new F(this.content.slice(t,e))}replaceChild(t,e){let n=this.content[t];if(n==e)return this;let i=this.content.slice(),s=this.size+e.nodeSize-n.nodeSize;return i[t]=e,new F(i,s)}addToStart(t){return new F([t].concat(this.content),this.size+t.nodeSize)}addToEnd(t){return new F(this.content.concat(t),this.size+t.nodeSize)}eq(t){if(this.content.length!=t.content.length)return!1;for(let e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(t){let e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e}maybeChild(t){return this.content[t]||null}forEach(t){for(let e=0,n=0;e<this.content.length;e++){let i=this.content[e];t(i,n,e),n+=i.nodeSize}}findDiffStart(t,e=0){return it(this,t,e)}findDiffEnd(t,e=this.size,n=t.size){return lt(this,t,e,n)}findIndex(t,e=-1){if(0==t)return Y(0,t);if(t==this.size)return Y(this.content.length,t);if(t>this.size||t<0)throw new RangeError(`Position ${t} outside of fragment (${this})`);for(let n=0,i=0;;n++){let c=i+this.child(n).nodeSize;if(c>=t)return c==t||e>0?Y(n+1,c):Y(n,i);i=c}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(t=>t.toJSON()):null}static fromJSON(t,e){if(!e)return F.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new F(e.map(t.nodeFromJSON))}static fromArray(t){if(!t.length)return F.empty;let e,n=0;for(let i=0;i<t.length;i++){let s=t[i];n+=s.nodeSize,i&&s.isText&&t[i-1].sameMarkup(s)?(e||(e=t.slice(0,i)),e[e.length-1]=s.withText(e[e.length-1].text+s.text)):e&&e.push(s)}return new F(e||t,n)}static from(t){if(!t)return F.empty;if(t instanceof F)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new F([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}F.empty=new F([],0);const $={index:0,offset:0};function Y(r,t){return $.index=r,$.offset=t,$}function j(r,t){if(r===t)return!0;if(!r||"object"!=typeof r||!t||"object"!=typeof t)return!1;let e=Array.isArray(r);if(Array.isArray(t)!=e)return!1;if(e){if(r.length!=t.length)return!1;for(let n=0;n<r.length;n++)if(!j(r[n],t[n]))return!1}else{for(let n in r)if(!(n in t)||!j(r[n],t[n]))return!1;for(let n in t)if(!(n in r))return!1}return!0}class W{constructor(t,e){this.type=t,this.attrs=e}addToSet(t){let e,n=!1;for(let i=0;i<t.length;i++){let s=t[i];if(this.eq(s))return t;if(this.type.excludes(s.type))e||(e=t.slice(0,i));else{if(s.type.excludes(this.type))return t;!n&&s.type.rank>this.type.rank&&(e||(e=t.slice(0,i)),e.push(this),n=!0),e&&e.push(s)}}return e||(e=t.slice()),n||e.push(this),e}removeFromSet(t){for(let e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t}isInSet(t){for(let e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1}eq(t){return this==t||this.type==t.type&&j(this.attrs,t.attrs)}toJSON(){let t={type:this.type.name};for(let e in this.attrs){t.attrs=this.attrs;break}return t}static fromJSON(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");let n=t.marks[e.type];if(!n)throw new RangeError(`There is no mark type ${e.type} in this schema`);return n.create(e.attrs)}static sameSet(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].eq(e[n]))return!1;return!0}static setFrom(t){if(!t||Array.isArray(t)&&0==t.length)return W.none;if(t instanceof W)return[t];let e=t.slice();return e.sort((n,i)=>n.type.rank-i.type.rank),e}}W.none=[];class at extends Error{}class ot{constructor(t,e,n){this.content=t,this.openStart=e,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(t,e){let n=X(this.content,t+this.openStart,e);return n&&new ot(n,this.openStart,this.openEnd)}removeBetween(t,e){return new ot(et(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)}eq(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t}static fromJSON(t,e){if(!e)return ot.empty;let n=e.openStart||0,i=e.openEnd||0;if("number"!=typeof n||"number"!=typeof i)throw new RangeError("Invalid input for Slice.fromJSON");return new ot(F.fromJSON(t,e.content),n,i)}static maxOpen(t,e=!0){let n=0,i=0;for(let s=t.firstChild;s&&!s.isLeaf&&(e||!s.type.spec.isolating);s=s.firstChild)n++;for(let s=t.lastChild;s&&!s.isLeaf&&(e||!s.type.spec.isolating);s=s.lastChild)i++;return new ot(t,n,i)}}function et(r,t,e){let{index:n,offset:i}=r.findIndex(t),s=r.maybeChild(n),{index:c,offset:p}=r.findIndex(e);if(i==t||s.isText){if(p!=e&&!r.child(c).isText)throw new RangeError("Removing non-flat range");return r.cut(0,t).append(r.cut(e))}if(n!=c)throw new RangeError("Removing non-flat range");return r.replaceChild(n,s.copy(et(s.content,t-i-1,e-i-1)))}function X(r,t,e,n){let{index:i,offset:s}=r.findIndex(t),c=r.maybeChild(i);if(s==t||c.isText)return n&&!n.canReplace(i,i,e)?null:r.cut(0,t).append(e).append(r.cut(t));let p=X(c.content,t-s-1,e);return p&&r.replaceChild(i,c.copy(p))}function dt(r,t,e){if(e.openStart>r.depth)throw new at("Inserted content deeper than insertion position");if(r.depth-e.openStart!=t.depth-e.openEnd)throw new at("Inconsistent open depths");return pt(r,t,e,0)}function pt(r,t,e,n){let i=r.index(n),s=r.node(n);if(i==t.index(n)&&n<r.depth-e.openStart){let c=pt(r,t,e,n+1);return s.copy(s.content.replaceChild(i,c))}if(e.content.size){if(e.openStart||e.openEnd||r.depth!=n||t.depth!=n){let{start:c,end:p}=function _t(r,t){let e=t.depth-r.openStart,i=t.node(e).copy(r.content);for(let s=e-1;s>=0;s--)i=t.node(s).copy(F.from(i));return{start:i.resolveNoCache(r.openStart+e),end:i.resolveNoCache(i.content.size-r.openEnd-e)}}(e,r);return Ft(s,ht(r,c,p,t,n))}{let c=r.parent,p=c.content;return Ft(c,p.cut(0,r.parentOffset).append(e.content).append(p.cut(t.parentOffset)))}}return Ft(s,mt(r,t,n))}function bt(r,t){if(!t.type.compatibleContent(r.type))throw new at("Cannot join "+t.type.name+" onto "+r.type.name)}function yt(r,t,e){let n=r.node(e);return bt(n,t.node(e)),n}function kt(r,t){let e=t.length-1;e>=0&&r.isText&&r.sameMarkup(t[e])?t[e]=r.withText(t[e].text+r.text):t.push(r)}function Nt(r,t,e,n){let i=(t||r).node(e),s=0,c=t?t.index(e):i.childCount;r&&(s=r.index(e),r.depth>e?s++:r.textOffset&&(kt(r.nodeAfter,n),s++));for(let p=s;p<c;p++)kt(i.child(p),n);t&&t.depth==e&&t.textOffset&&kt(t.nodeBefore,n)}function Ft(r,t){return r.type.checkContent(t),r.copy(t)}function ht(r,t,e,n,i){let s=r.depth>i&&yt(r,t,i+1),c=n.depth>i&&yt(e,n,i+1),p=[];return Nt(null,r,i,p),s&&c&&t.index(i)==e.index(i)?(bt(s,c),kt(Ft(s,ht(r,t,e,n,i+1)),p)):(s&&kt(Ft(s,mt(r,t,i+1)),p),Nt(t,e,i,p),c&&kt(Ft(c,mt(e,n,i+1)),p)),Nt(n,null,i,p),new F(p)}function mt(r,t,e){let n=[];if(Nt(null,r,e,n),r.depth>e){kt(Ft(yt(r,t,e+1),mt(r,t,e+1)),n)}return Nt(t,null,e,n),new F(n)}ot.empty=new ot(F.empty,0,0);class Tt{constructor(t,e,n){this.pos=t,this.path=e,this.parentOffset=n,this.depth=e.length/3-1}resolveDepth(t){return null==t?this.depth:t<0?this.depth+t:t}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(t){return this.path[3*this.resolveDepth(t)]}index(t){return this.path[3*this.resolveDepth(t)+1]}indexAfter(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)}start(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1}end(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size}before(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]}after(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;let n=this.pos-this.path[this.path.length-1],i=t.child(e);return n?t.child(e).cut(n):i}get nodeBefore(){let t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)}posAtIndex(t,e){e=this.resolveDepth(e);let n=this.path[3*e],i=0==e?0:this.path[3*e-1]+1;for(let s=0;s<t;s++)i+=n.child(s).nodeSize;return i}marks(){let t=this.parent,e=this.index();if(0==t.content.size)return W.none;if(this.textOffset)return t.child(e).marks;let n=t.maybeChild(e-1),i=t.maybeChild(e);if(!n){let p=n;n=i,i=p}let s=n.marks;for(var c=0;c<s.length;c++)!1===s[c].type.spec.inclusive&&(!i||!s[c].isInSet(i.marks))&&(s=s[c--].removeFromSet(s));return s}marksAcross(t){let e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;let n=e.marks,i=t.parent.maybeChild(t.index());for(var s=0;s<n.length;s++)!1===n[s].type.spec.inclusive&&(!i||!n[s].isInSet(i.marks))&&(n=n[s--].removeFromSet(n));return n}sharedDepth(t){for(let e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0}blockRange(t=this,e){if(t.pos<this.pos)return t.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!e||e(this.node(n))))return new $t(this,t,n);return null}sameParent(t){return this.pos-this.parentOffset==t.pos-t.parentOffset}max(t){return t.pos>this.pos?t:this}min(t){return t.pos<this.pos?t:this}toString(){let t="";for(let e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset}static resolve(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");let n=[],i=0,s=e;for(let c=t;;){let{index:p,offset:b}=c.content.findIndex(s),S=s-b;if(n.push(c,p,i+b),!S||(c=c.child(p),c.isText))break;s=S-1,i+=b+1}return new Tt(e,n,s)}static resolveCached(t,e){for(let i=0;i<Pt.length;i++){let s=Pt[i];if(s.pos==e&&s.doc==t)return s}let n=Pt[At]=Tt.resolve(t,e);return At=(At+1)%Ht,n}}let Pt=[],At=0,Ht=12;class $t{constructor(t,e,n){this.$from=t,this.$to=e,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const fe=Object.create(null);class Wt{constructor(t,e,n,i=W.none){this.type=t,this.attrs=e,this.marks=i,this.content=n||F.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(t){return this.content.child(t)}maybeChild(t){return this.content.maybeChild(t)}forEach(t){this.content.forEach(t)}nodesBetween(t,e,n,i=0){this.content.nodesBetween(t,e,n,i,this)}descendants(t){this.nodesBetween(0,this.content.size,t)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(t,e,n,i){return this.content.textBetween(t,e,n,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)}sameMarkup(t){return this.hasMarkup(t.type,t.attrs,t.marks)}hasMarkup(t,e,n){return this.type==t&&j(this.attrs,e||t.defaultAttrs||fe)&&W.sameSet(this.marks,n||W.none)}copy(t=null){return t==this.content?this:new Wt(this.type,this.attrs,t,this.marks)}mark(t){return t==this.marks?this:new Wt(this.type,this.attrs,this.content,t)}cut(t,e=this.content.size){return 0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))}slice(t,e=this.content.size,n=!1){if(t==e)return ot.empty;let i=this.resolve(t),s=this.resolve(e),c=n?0:i.sharedDepth(e),p=i.start(c),S=i.node(c).content.cut(i.pos-p,s.pos-p);return new ot(S,i.depth-c,s.depth-c)}replace(t,e,n){return dt(this.resolve(t),this.resolve(e),n)}nodeAt(t){for(let e=this;;){let{index:n,offset:i}=e.content.findIndex(t);if(e=e.maybeChild(n),!e)return null;if(i==t||e.isText)return e;t-=i+1}}childAfter(t){let{index:e,offset:n}=this.content.findIndex(t);return{node:this.content.maybeChild(e),index:e,offset:n}}childBefore(t){if(0==t)return{node:null,index:0,offset:0};let{index:e,offset:n}=this.content.findIndex(t);if(n<t)return{node:this.content.child(e),index:e,offset:n};let i=this.content.child(e-1);return{node:i,index:e-1,offset:n-i.nodeSize}}resolve(t){return Tt.resolveCached(this,t)}resolveNoCache(t){return Tt.resolve(this,t)}rangeHasMark(t,e,n){let i=!1;return e>t&&this.nodesBetween(t,e,s=>(n.isInSet(s.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),gt(this.marks,t)}contentMatchAt(t){let e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e}canReplace(t,e,n=F.empty,i=0,s=n.childCount){let c=this.contentMatchAt(t).matchFragment(n,i,s),p=c&&c.matchFragment(this.content,e);if(!p||!p.validEnd)return!1;for(let b=i;b<s;b++)if(!this.type.allowsMarks(n.child(b).marks))return!1;return!0}canReplaceWith(t,e,n,i){if(i&&!this.type.allowsMarks(i))return!1;let s=this.contentMatchAt(t).matchType(n),c=s&&s.matchFragment(this.content,e);return!!c&&c.validEnd}canAppend(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)}check(){this.type.checkContent(this.content);let t=W.none;for(let e=0;e<this.marks.length;e++)t=this.marks[e].addToSet(t);if(!W.sameSet(t,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(e=>e.type.name)}`);this.content.forEach(e=>e.check())}toJSON(){let t={type:this.type.name};for(let e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map(e=>e.toJSON())),t}static fromJSON(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");let n=null;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw new RangeError("Invalid text node in JSON");return t.text(e.text,n)}let i=F.fromJSON(t,e.content);return t.nodeType(e.type).create(e.attrs,i,n)}}Wt.prototype.text=void 0;class Qt extends Wt{constructor(t,e,n,i){if(super(t,e,null,i),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):gt(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(t,e){return this.text.slice(t,e)}get nodeSize(){return this.text.length}mark(t){return t==this.marks?this:new Qt(this.type,this.attrs,this.text,t)}withText(t){return t==this.text?this:new Qt(this.type,this.attrs,t,this.marks)}cut(t=0,e=this.text.length){return 0==t&&e==this.text.length?this:this.withText(this.text.slice(t,e))}eq(t){return this.sameMarkup(t)&&this.text==t.text}toJSON(){let t=super.toJSON();return t.text=this.text,t}}function gt(r,t){for(let e=r.length-1;e>=0;e--)t=r[e].type.name+"("+t+")";return t}class Et{constructor(t){this.validEnd=t,this.next=[],this.wrapCache=[]}static parse(t,e){let n=new ft(t,e);if(null==n.next)return Et.empty;let i=Rt(n);n.next&&n.err("Unexpected trailing text");let s=function Tn(r){let t=Object.create(null);return e(Gr(r,0));function e(n){let i=[];n.forEach(c=>{r[c].forEach(({term:p,to:b})=>{if(!p)return;let S;for(let O=0;O<i.length;O++)i[O][0]==p&&(S=i[O][1]);Gr(r,b).forEach(O=>{S||i.push([p,S=[]]),-1==S.indexOf(O)&&S.push(O)})})});let s=t[n.join(",")]=new Et(n.indexOf(r.length-1)>-1);for(let c=0;c<i.length;c++){let p=i[c][1].sort(bi);s.next.push({type:i[c][0],next:t[p.join(",")]||e(p)})}return s}}(function cr(r){let t=[[]];return i(s(r,0),e()),t;function e(){return t.push([])-1}function n(c,p,b){let S={term:b,to:p};return t[c].push(S),S}function i(c,p){c.forEach(b=>b.to=p)}function s(c,p){if("choice"==c.type)return c.exprs.reduce((b,S)=>b.concat(s(S,p)),[]);if("seq"!=c.type){if("star"==c.type){let b=e();return n(p,b),i(s(c.expr,b),b),[n(b)]}if("plus"==c.type){let b=e();return i(s(c.expr,p),b),i(s(c.expr,b),b),[n(b)]}if("opt"==c.type)return[n(p)].concat(s(c.expr,p));if("range"==c.type){let b=p;for(let S=0;S<c.min;S++){let O=e();i(s(c.expr,b),O),b=O}if(-1==c.max)i(s(c.expr,b),b);else for(let S=c.min;S<c.max;S++){let O=e();n(b,O),i(s(c.expr,b),O),b=O}return[n(b)]}if("name"==c.type)return[n(p,void 0,c.value)];throw new Error("Unknown expr type")}for(let b=0;;b++){let S=s(c.exprs[b],p);if(b==c.exprs.length-1)return S;i(S,p=e())}}}(i));return function Ur(r,t){for(let e=0,n=[r];e<n.length;e++){let i=n[e],s=!i.validEnd,c=[];for(let p=0;p<i.next.length;p++){let{type:b,next:S}=i.next[p];c.push(b.name),s&&!(b.isText||b.hasRequiredAttrs())&&(s=!1),-1==n.indexOf(S)&&n.push(S)}s&&t.err("Only non-generatable nodes ("+c.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(s,n),s}matchType(t){for(let e=0;e<this.next.length;e++)if(this.next[e].type==t)return this.next[e].next;return null}matchFragment(t,e=0,n=t.childCount){let i=this;for(let s=e;i&&s<n;s++)i=i.matchType(t.child(s).type);return i}get inlineContent(){return 0!=this.next.length&&this.next[0].type.isInline}get defaultType(){for(let t=0;t<this.next.length;t++){let{type:e}=this.next[t];if(!e.isText&&!e.hasRequiredAttrs())return e}return null}compatible(t){for(let e=0;e<this.next.length;e++)for(let n=0;n<t.next.length;n++)if(this.next[e].type==t.next[n].type)return!0;return!1}fillBefore(t,e=!1,n=0){let i=[this];return function s(c,p){let b=c.matchFragment(t,n);if(b&&(!e||b.validEnd))return F.from(p.map(S=>S.createAndFill()));for(let S=0;S<c.next.length;S++){let{type:O,next:B}=c.next[S];if(!O.isText&&!O.hasRequiredAttrs()&&-1==i.indexOf(B)){i.push(B);let U=s(B,p.concat(O));if(U)return U}}return null}(this,[])}findWrapping(t){for(let n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==t)return this.wrapCache[n+1];let e=this.computeWrapping(t);return this.wrapCache.push(t,e),e}computeWrapping(t){let e=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let i=n.shift(),s=i.match;if(s.matchType(t)){let c=[];for(let p=i;p.type;p=p.via)c.push(p.type);return c.reverse()}for(let c=0;c<s.next.length;c++){let{type:p,next:b}=s.next[c];!p.isLeaf&&!p.hasRequiredAttrs()&&!(p.name in e)&&(!i.type||b.validEnd)&&(n.push({match:p.contentMatch,type:p,via:i}),e[p.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(t){if(t>=this.next.length)throw new RangeError(`There's no ${t}th edge in this content match`);return this.next[t]}toString(){let t=[];return function e(n){t.push(n);for(let i=0;i<n.next.length;i++)-1==t.indexOf(n.next[i].next)&&e(n.next[i].next)}(this),t.map((n,i)=>{let s=i+(n.validEnd?"*":" ")+" ";for(let c=0;c<n.next.length;c++)s+=(c?", ":"")+n.next[c].type.name+"->"+t.indexOf(n.next[c].next);return s}).join("\n")}}Et.empty=new Et(!0);class ft{constructor(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(t){return this.next==t&&(this.pos++||!0)}err(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")}}function Rt(r){let t=[];do{t.push(Jt(r))}while(r.eat("|"));return 1==t.length?t[0]:{type:"choice",exprs:t}}function Jt(r){let t=[];do{t.push(fn(r))}while(r.next&&")"!=r.next&&"|"!=r.next);return 1==t.length?t[0]:{type:"seq",exprs:t}}function fn(r){let t=function Ue(r){if(r.eat("(")){let t=Rt(r);return r.eat(")")||r.err("Missing closing paren"),t}if(!/\W/.test(r.next)){let t=function xe(r,t){let e=r.nodeTypes,n=e[t];if(n)return[n];let i=[];for(let s in e){let c=e[s];c.groups.indexOf(t)>-1&&i.push(c)}return 0==i.length&&r.err("No node type or group '"+t+"' found"),i}(r,r.next).map(e=>(null==r.inline?r.inline=e.isInline:r.inline!=e.isInline&&r.err("Mixing inline and block content"),{type:"name",value:e}));return r.pos++,1==t.length?t[0]:{type:"choice",exprs:t}}r.err("Unexpected token '"+r.next+"'")}(r);for(;;)if(r.eat("+"))t={type:"plus",expr:t};else if(r.eat("*"))t={type:"star",expr:t};else if(r.eat("?"))t={type:"opt",expr:t};else{if(!r.eat("{"))break;t=Oe(r,t)}return t}function Ge(r){/\D/.test(r.next)&&r.err("Expected number, got '"+r.next+"'");let t=Number(r.next);return r.pos++,t}function Oe(r,t){let e=Ge(r),n=e;return r.eat(",")&&(n="}"!=r.next?Ge(r):-1),r.eat("}")||r.err("Unclosed braced range"),{type:"range",min:e,max:n,expr:t}}function bi(r,t){return t-r}function Gr(r,t){let e=[];return function n(i){let s=r[i];if(1==s.length&&!s[0].term)return n(s[0].to);e.push(i);for(let c=0;c<s.length;c++){let{term:p,to:b}=s[c];!p&&-1==e.indexOf(b)&&n(b)}}(t),e.sort(bi)}function Jn(r){let t=Object.create(null);for(let e in r){let n=r[e];if(!n.hasDefault)return null;t[e]=n.default}return t}function Jr(r,t){let e=Object.create(null);for(let n in r){let i=t&&t[n];if(void 0===i){let s=r[n];if(!s.hasDefault)throw new RangeError("No value supplied for attribute "+n);i=s.default}e[n]=i}return e}function hr(r){let t=Object.create(null);if(r)for(let e in r)t[e]=new pn(r[e]);return t}class Ae{constructor(t,e,n){this.name=t,this.schema=e,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=hr(n.attrs),this.defaultAttrs=Jn(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==t),this.isText="text"==t}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Et.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1}compatibleContent(t){return this==t||this.contentMatch.compatible(t.contentMatch)}computeAttrs(t){return!t&&this.defaultAttrs?this.defaultAttrs:Jr(this.attrs,t)}create(t=null,e,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Wt(this,this.computeAttrs(t),F.from(e),W.setFrom(n))}createChecked(t=null,e,n){return e=F.from(e),this.checkContent(e),new Wt(this,this.computeAttrs(t),e,W.setFrom(n))}createAndFill(t=null,e,n){if(t=this.computeAttrs(t),(e=F.from(e)).size){let c=this.contentMatch.fillBefore(e);if(!c)return null;e=c.append(e)}let i=this.contentMatch.matchFragment(e),s=i&&i.fillBefore(F.empty,!0);return s?new Wt(this,t,e.append(s),W.setFrom(n)):null}validContent(t){let e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(let n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0}checkContent(t){if(!this.validContent(t))throw new RangeError(`Invalid content for node ${this.name}: ${t.toString().slice(0,50)}`)}allowsMarkType(t){return null==this.markSet||this.markSet.indexOf(t)>-1}allowsMarks(t){if(null==this.markSet)return!0;for(let e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0}allowedMarks(t){if(null==this.markSet)return t;let e;for(let n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?e&&e.push(t[n]):e||(e=t.slice(0,n));return e?e.length?e:W.none:t}static compile(t,e){let n=Object.create(null);t.forEach((s,c)=>n[s]=new Ae(s,e,c));let i=e.spec.topNode||"doc";if(!n[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(let s in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n}}class pn{constructor(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default}get isRequired(){return!this.hasDefault}}class Ci{constructor(t,e,n,i){this.name=t,this.rank=e,this.schema=n,this.spec=i,this.attrs=hr(i.attrs),this.excluded=null;let s=Jn(this.attrs);this.instance=s?new W(this,s):null}create(t=null){return!t&&this.instance?this.instance:new W(this,Jr(this.attrs,t))}static compile(t,e){let n=Object.create(null),i=0;return t.forEach((s,c)=>n[s]=new Ci(s,i++,e,c)),n}removeFromSet(t){for(var e=0;e<t.length;e++)t[e].type==this&&(t=t.slice(0,e).concat(t.slice(e+1)),e--);return t}isInSet(t){for(let e=0;e<t.length;e++)if(t[e].type==this)return t[e]}excludes(t){return this.excluded.indexOf(t)>-1}}function Is(r,t){let e=[];for(let n=0;n<t.length;n++){let i=t[n],s=r.marks[i],c=s;if(s)e.push(s);else for(let p in r.marks){let b=r.marks[p];("_"==i||b.spec.group&&b.spec.group.split(" ").indexOf(i)>-1)&&e.push(c=b)}if(!c)throw new SyntaxError("Unknown mark type: '"+t[n]+"'")}return e}class $n{constructor(t,e){this.schema=t,this.rules=e,this.tags=[],this.styles=[],e.forEach(n=>{n.tag?this.tags.push(n):n.style&&this.styles.push(n)}),this.normalizeLists=!this.tags.some(n=>{if(!/^(ul|ol)\b/.test(n.tag)||!n.node)return!1;let i=t.nodes[n.node];return i.contentMatch.matchType(i)})}parse(t,e={}){let n=new Ps(this,e,!1);return n.addAll(t,e.from,e.to),n.finish()}parseSlice(t,e={}){let n=new Ps(this,e,!0);return n.addAll(t,e.from,e.to),ot.maxOpen(n.finish())}matchTag(t,e,n){for(let i=n?this.tags.indexOf(n)+1:0;i<this.tags.length;i++){let s=this.tags[i];if(Nl(t,s.tag)&&(void 0===s.namespace||t.namespaceURI==s.namespace)&&(!s.context||e.matchesContext(s.context))){if(s.getAttrs){let c=s.getAttrs(t);if(!1===c)continue;s.attrs=c||void 0}return s}}}matchStyle(t,e,n,i){for(let s=i?this.styles.indexOf(i)+1:0;s<this.styles.length;s++){let c=this.styles[s],p=c.style;if(!(0!=p.indexOf(t)||c.context&&!n.matchesContext(c.context)||p.length>t.length&&(61!=p.charCodeAt(t.length)||p.slice(t.length+1)!=e))){if(c.getAttrs){let b=c.getAttrs(e);if(!1===b)continue;c.attrs=b||void 0}return c}}}static schemaRules(t){let e=[];function n(i){let s=null==i.priority?50:i.priority,c=0;for(;c<e.length;c++){let p=e[c];if((null==p.priority?50:p.priority)<s)break}e.splice(c,0,i)}for(let i in t.marks){let s=t.marks[i].spec.parseDOM;s&&s.forEach(c=>{n(c=Ls(c)),c.mark||c.ignore||c.clearMark||(c.mark=i)})}for(let i in t.nodes){let s=t.nodes[i].spec.parseDOM;s&&s.forEach(c=>{n(c=Ls(c)),c.node||c.ignore||c.mark||(c.node=i)})}return e}static fromSchema(t){return t.cached.domParser||(t.cached.domParser=new $n(t,$n.schemaRules(t)))}}const Os={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Ml={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},As={ol:!0,ul:!0};function Ds(r,t,e){return null!=t?(t?1:0)|("full"===t?2:0):r&&"pre"==r.whitespace?3:-5&e}class Mi{constructor(t,e,n,i,s,c,p){this.type=t,this.attrs=e,this.marks=n,this.pendingMarks=i,this.solid=s,this.options=p,this.content=[],this.activeMarks=W.none,this.stashMarks=[],this.match=c||(4&p?null:t.contentMatch)}findWrapping(t){if(!this.match){if(!this.type)return[];let e=this.type.contentMatch.fillBefore(F.from(t));if(!e){let i,n=this.type.contentMatch;return(i=n.findWrapping(t.type))?(this.match=n,i):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)}finish(t){if(!(1&this.options)){let i,n=this.content[this.content.length-1];if(n&&n.isText&&(i=/[ \t\r\n\u000c]+$/.exec(n.text))){let s=n;n.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-i[0].length))}}let e=F.from(this.content);return!t&&this.match&&(e=e.append(this.match.fillBefore(F.empty,!0))),this.type?this.type.create(this.attrs,e,this.marks):e}popFromStashMark(t){for(let e=this.stashMarks.length-1;e>=0;e--)if(t.eq(this.stashMarks[e]))return this.stashMarks.splice(e,1)[0]}applyPending(t){for(let e=0,n=this.pendingMarks;e<n.length;e++){let i=n[e];(this.type?this.type.allowsMarkType(i.type):Fs(i.type,t))&&!i.isInSet(this.activeMarks)&&(this.activeMarks=i.addToSet(this.activeMarks),this.pendingMarks=i.removeFromSet(this.pendingMarks))}}inlineContext(t){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:t.parentNode&&!Os.hasOwnProperty(t.parentNode.nodeName.toLowerCase())}}class Ps{constructor(t,e,n){this.parser=t,this.options=e,this.isOpen=n,this.open=0;let s,i=e.topNode,c=Ds(null,e.preserveWhitespace,0)|(n?4:0);s=i?new Mi(i.type,i.attrs,W.none,W.none,!0,e.topMatch||i.type.contentMatch,c):new Mi(n?null:t.schema.topNodeType,null,W.none,W.none,!0,null,c),this.nodes=[s],this.find=e.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(t){if(3==t.nodeType)this.addTextNode(t);else if(1==t.nodeType){let e=t.getAttribute("style");if(e){let n=this.readStyles(function Sl(r){let e,t=/\s*([\w-]+)\s*:\s*([^;]+)/g,n=[];for(;e=t.exec(r);)n.push(e[1],e[2].trim());return n}(e));if(!n)return;let[i,s]=n,c=this.top;for(let p=0;p<s.length;p++)this.removePendingMark(s[p],c);for(let p=0;p<i.length;p++)this.addPendingMark(i[p]);this.addElement(t);for(let p=0;p<i.length;p++)this.removePendingMark(i[p],c);for(let p=0;p<s.length;p++)this.addPendingMark(s[p])}else this.addElement(t)}}addTextNode(t){let e=t.nodeValue,n=this.top;if(2&n.options||n.inlineContext(t)||/[^ \t\r\n\u000c]/.test(e)){if(1&n.options)e=2&n.options?e.replace(/\r\n?/g,"\n"):e.replace(/\r?\n|\r/g," ");else if(e=e.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(e)&&this.open==this.nodes.length-1){let i=n.content[n.content.length-1],s=t.previousSibling;(!i||s&&"BR"==s.nodeName||i.isText&&/[ \t\r\n\u000c]$/.test(i.text))&&(e=e.slice(1))}e&&this.insertNode(this.parser.schema.text(e)),this.findInText(t)}else this.findInside(t)}addElement(t,e){let i,n=t.nodeName.toLowerCase();As.hasOwnProperty(n)&&this.parser.normalizeLists&&function Tl(r){for(let t=r.firstChild,e=null;t;t=t.nextSibling){let n=1==t.nodeType?t.nodeName.toLowerCase():null;n&&As.hasOwnProperty(n)&&e?(e.appendChild(t),t=e):"li"==n?e=t:n&&(e=null)}}(t);let s=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(i=this.parser.matchTag(t,this,e));if(s?s.ignore:Ml.hasOwnProperty(n))this.findInside(t),this.ignoreFallback(t);else if(!s||s.skip||s.closeParent){s&&s.closeParent?this.open=Math.max(0,this.open-1):s&&s.skip.nodeType&&(t=s.skip);let c,p=this.top,b=this.needsBlock;if(Os.hasOwnProperty(n))p.content.length&&p.content[0].isInline&&this.open&&(this.open--,p=this.top),c=!0,p.type||(this.needsBlock=!0);else if(!t.firstChild)return void this.leafFallback(t);this.addAll(t),c&&this.sync(p),this.needsBlock=b}else this.addElementByRule(t,s,!1===s.consuming?i:void 0)}leafFallback(t){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"))}ignoreFallback(t){"BR"==t.nodeName&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(t){let e=W.none,n=W.none;t:for(let i=0;i<t.length;i+=2)for(let s;;){let c=this.parser.matchStyle(t[i],t[i+1],this,s);if(!c)continue t;if(c.ignore)return null;if(c.clearMark?this.top.pendingMarks.forEach(p=>{c.clearMark(p)&&(n=p.addToSet(n))}):e=this.parser.schema.marks[c.mark].create(c.attrs).addToSet(e),!1!==c.consuming)break;s=c}return[e,n]}addElementByRule(t,e,n){let i,s,c;e.node?(s=this.parser.schema.nodes[e.node],s.isLeaf?this.insertNode(s.create(e.attrs))||this.leafFallback(t):i=this.enter(s,e.attrs||null,e.preserveWhitespace)):(c=this.parser.schema.marks[e.mark].create(e.attrs),this.addPendingMark(c));let p=this.top;if(s&&s.isLeaf)this.findInside(t);else if(n)this.addElement(t,n);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach(b=>this.insertNode(b));else{let b=t;"string"==typeof e.contentElement?b=t.querySelector(e.contentElement):"function"==typeof e.contentElement?b=e.contentElement(t):e.contentElement&&(b=e.contentElement),this.findAround(t,b,!0),this.addAll(b)}i&&this.sync(p)&&this.open--,c&&this.removePendingMark(c,p)}addAll(t,e,n){let i=e||0;for(let s=e?t.childNodes[e]:t.firstChild,c=null==n?null:t.childNodes[n];s!=c;s=s.nextSibling,++i)this.findAtPoint(t,i),this.addDOM(s);this.findAtPoint(t,i)}findPlace(t){let e,n;for(let i=this.open;i>=0;i--){let s=this.nodes[i],c=s.findWrapping(t);if(c&&(!e||e.length>c.length)&&(e=c,n=s,!c.length)||s.solid)break}if(!e)return!1;this.sync(n);for(let i=0;i<e.length;i++)this.enterInner(e[i],null,!1);return!0}insertNode(t){if(t.isInline&&this.needsBlock&&!this.top.type){let e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(t)){this.closeExtra();let e=this.top;e.applyPending(t.type),e.match&&(e.match=e.match.matchType(t.type));let n=e.activeMarks;for(let i=0;i<t.marks.length;i++)(!e.type||e.type.allowsMarkType(t.marks[i].type))&&(n=t.marks[i].addToSet(n));return e.content.push(t.mark(n)),!0}return!1}enter(t,e,n){let i=this.findPlace(t.create(e));return i&&this.enterInner(t,e,!0,n),i}enterInner(t,e=null,n=!1,i){this.closeExtra();let s=this.top;s.applyPending(t),s.match=s.match&&s.match.matchType(t);let c=Ds(t,i,s.options);4&s.options&&0==s.content.length&&(c|=4),this.nodes.push(new Mi(t,e,s.activeMarks,s.pendingMarks,n,null,c)),this.open++}closeExtra(t=!1){let e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(t){for(let e=this.open;e>=0;e--)if(this.nodes[e]==t)return this.open=e,!0;return!1}get currentPos(){this.closeExtra();let t=0;for(let e=this.open;e>=0;e--){let n=this.nodes[e].content;for(let i=n.length-1;i>=0;i--)t+=n[i].nodeSize;e&&t++}return t}findAtPoint(t,e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==e&&(this.find[n].pos=this.currentPos)}findInside(t){if(this.find)for(let e=0;e<this.find.length;e++)null==this.find[e].pos&&1==t.nodeType&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)}findAround(t,e,n){if(t!=e&&this.find)for(let i=0;i<this.find.length;i++)null==this.find[i].pos&&1==t.nodeType&&t.contains(this.find[i].node)&&e.compareDocumentPosition(this.find[i].node)&(n?2:4)&&(this.find[i].pos=this.currentPos)}findInText(t){if(this.find)for(let e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))}matchesContext(t){if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);let e=t.split("/"),n=this.options.context,i=!(this.isOpen||n&&n.parent.type!=this.nodes[0].type),s=-(n?n.depth+1:0)+(i?0:1),c=(p,b)=>{for(;p>=0;p--){let S=e[p];if(""==S){if(p==e.length-1||0==p)continue;for(;b>=s;b--)if(c(p-1,b))return!0;return!1}{let O=b>0||0==b&&i?this.nodes[b].type:n&&b>=s?n.node(b-s).type:null;if(!O||O.name!=S&&-1==O.groups.indexOf(S))return!1;b--}}return!0};return c(e.length-1,this.open)}textblockFromContext(){let t=this.options.context;if(t)for(let e=t.depth;e>=0;e--){let n=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let e in this.parser.schema.nodes){let n=this.parser.schema.nodes[e];if(n.isTextblock&&n.defaultAttrs)return n}}addPendingMark(t){let e=function Il(r,t){for(let e=0;e<t.length;e++)if(r.eq(t[e]))return t[e]}(t,this.top.pendingMarks);e&&this.top.stashMarks.push(e),this.top.pendingMarks=t.addToSet(this.top.pendingMarks)}removePendingMark(t,e){for(let n=this.open;n>=0;n--){let i=this.nodes[n];if(i.pendingMarks.lastIndexOf(t)>-1)i.pendingMarks=t.removeFromSet(i.pendingMarks);else{i.activeMarks=t.removeFromSet(i.activeMarks);let c=i.popFromStashMark(t);c&&i.type&&i.type.allowsMarkType(c.type)&&(i.activeMarks=c.addToSet(i.activeMarks))}if(i==e)break}}}function Nl(r,t){return(r.matches||r.msMatchesSelector||r.webkitMatchesSelector||r.mozMatchesSelector).call(r,t)}function Ls(r){let t={};for(let e in r)t[e]=r[e];return t}function Fs(r,t){let e=t.schema.nodes;for(let n in e){let i=e[n];if(!i.allowsMarkType(r))continue;let s=[],c=p=>{s.push(p);for(let b=0;b<p.edgeCount;b++){let{type:S,next:O}=p.edge(b);if(S==t||s.indexOf(O)<0&&c(O))return!0}};if(c(i.contentMatch))return!0}}class qe{constructor(t,e){this.nodes=t,this.marks=e}serializeFragment(t,e={},n){n||(n=uo(e).createDocumentFragment());let i=n,s=[];return t.forEach(c=>{if(s.length||c.marks.length){let p=0,b=0;for(;p<s.length&&b<c.marks.length;){let S=c.marks[b];if(this.marks[S.type.name]){if(!S.eq(s[p][0])||!1===S.type.spec.spanning)break;p++,b++}else b++}for(;p<s.length;)i=s.pop()[1];for(;b<c.marks.length;){let S=c.marks[b++],O=this.serializeMark(S,c.isInline,e);O&&(s.push([S,i]),i.appendChild(O.dom),i=O.contentDOM||O.dom)}}i.appendChild(this.serializeNodeInner(c,e))}),n}serializeNodeInner(t,e){let{dom:n,contentDOM:i}=qe.renderSpec(uo(e),this.nodes[t.type.name](t));if(i){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(t.content,e,i)}return n}serializeNode(t,e={}){let n=this.serializeNodeInner(t,e);for(let i=t.marks.length-1;i>=0;i--){let s=this.serializeMark(t.marks[i],t.isInline,e);s&&((s.contentDOM||s.dom).appendChild(n),n=s.dom)}return n}serializeMark(t,e,n={}){let i=this.marks[t.type.name];return i&&qe.renderSpec(uo(n),i(t,e))}static renderSpec(t,e,n=null){if("string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};if(e.dom&&null!=e.dom.nodeType)return e;let i=e[0],s=i.indexOf(" ");s>0&&(n=i.slice(0,s),i=i.slice(s+1));let c,p=n?t.createElementNS(n,i):t.createElement(i),b=e[1],S=1;if(b&&"object"==typeof b&&null==b.nodeType&&!Array.isArray(b)){S=2;for(let O in b)if(null!=b[O]){let B=O.indexOf(" ");B>0?p.setAttributeNS(O.slice(0,B),O.slice(B+1),b[O]):p.setAttribute(O,b[O])}}for(let O=S;O<e.length;O++){let B=e[O];if(0===B){if(O<e.length-1||O>S)throw new RangeError("Content hole must be the only child of its parent node");return{dom:p,contentDOM:p}}{let{dom:U,contentDOM:J}=qe.renderSpec(t,B,n);if(p.appendChild(U),J){if(c)throw new RangeError("Multiple content holes");c=J}}}return{dom:p,contentDOM:c}}static fromSchema(t){return t.cached.domSerializer||(t.cached.domSerializer=new qe(this.nodesFromSchema(t),this.marksFromSchema(t)))}static nodesFromSchema(t){let e=Rs(t.nodes);return e.text||(e.text=n=>n.text),e}static marksFromSchema(t){return Rs(t.marks)}}function Rs(r){let t={};for(let e in r){let n=r[e].spec.toDOM;n&&(t[e]=n)}return t}function uo(r){return r.document||window.document}const zs=Math.pow(2,16);function Ol(r,t){return r+t*zs}function Hs(r){return 65535&r}class Ni{constructor(t,e,n){this.pos=t,this.delInfo=e,this.recover=n}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class Le{constructor(t,e=!1){if(this.ranges=t,this.inverted=e,!t.length&&Le.empty)return Le.empty}recover(t){let e=0,n=Hs(t);if(!this.inverted)for(let i=0;i<n;i++)e+=this.ranges[3*i+2]-this.ranges[3*i+1];return this.ranges[3*n]+e+function Al(r){return(r-(65535&r))/zs}(t)}mapResult(t,e=1){return this._map(t,e,!1)}map(t,e=1){return this._map(t,e,!0)}_map(t,e,n){let i=0,s=this.inverted?2:1,c=this.inverted?1:2;for(let p=0;p<this.ranges.length;p+=3){let b=this.ranges[p]-(this.inverted?i:0);if(b>t)break;let S=this.ranges[p+s],O=this.ranges[p+c],B=b+S;if(t<=B){let J=b+i+((S?t==b?-1:t==B?1:e:e)<0?0:O);if(n)return J;let nt=t==(e<0?b:B)?null:Ol(p/3,t-b),ct=t==b?2:t==B?1:4;return(e<0?t!=b:t!=B)&&(ct|=8),new Ni(J,ct,nt)}i+=O-S}return n?t+i:new Ni(t+i,0,null)}touches(t,e){let n=0,i=Hs(e),s=this.inverted?2:1,c=this.inverted?1:2;for(let p=0;p<this.ranges.length;p+=3){let b=this.ranges[p]-(this.inverted?n:0);if(b>t)break;let S=this.ranges[p+s];if(t<=b+S&&p==3*i)return!0;n+=this.ranges[p+c]-S}return!1}forEach(t){let e=this.inverted?2:1,n=this.inverted?1:2;for(let i=0,s=0;i<this.ranges.length;i+=3){let c=this.ranges[i],p=c-(this.inverted?s:0),b=c+(this.inverted?0:s),S=this.ranges[i+e],O=this.ranges[i+n];t(p,p+S,b,b+O),s+=O-S}}invert(){return new Le(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(t){return 0==t?Le.empty:new Le(t<0?[0,-t,0]:[0,0,t])}}Le.empty=new Le([]);class dr{constructor(t=[],e,n=0,i=t.length){this.maps=t,this.mirror=e,this.from=n,this.to=i}slice(t=0,e=this.maps.length){return new dr(this.maps,this.mirror,t,e)}copy(){return new dr(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(t,e){this.to=this.maps.push(t),null!=e&&this.setMirror(this.maps.length-1,e)}appendMapping(t){for(let e=0,n=this.maps.length;e<t.maps.length;e++){let i=t.getMirror(e);this.appendMap(t.maps[e],null!=i&&i<e?n+i:void 0)}}getMirror(t){if(this.mirror)for(let e=0;e<this.mirror.length;e++)if(this.mirror[e]==t)return this.mirror[e+(e%2?-1:1)]}setMirror(t,e){this.mirror||(this.mirror=[]),this.mirror.push(t,e)}appendMappingInverted(t){for(let e=t.maps.length-1,n=this.maps.length+t.maps.length;e>=0;e--){let i=t.getMirror(e);this.appendMap(t.maps[e].invert(),null!=i&&i>e?n-i-1:void 0)}}invert(){let t=new dr;return t.appendMappingInverted(this),t}map(t,e=1){if(this.mirror)return this._map(t,e,!0);for(let n=this.from;n<this.to;n++)t=this.maps[n].map(t,e);return t}mapResult(t,e=1){return this._map(t,e,!1)}_map(t,e,n){let i=0;for(let s=this.from;s<this.to;s++){let p=this.maps[s].mapResult(t,e);if(null!=p.recover){let b=this.getMirror(s);if(null!=b&&b>s&&b<this.to){s=b,t=this.maps[b].recover(p.recover);continue}}i|=p.delInfo,t=p.pos}return n?t:new Ni(t,i,null)}}const ho=Object.create(null);class _e{getMap(){return Le.empty}merge(t){return null}static fromJSON(t,e){if(!e||!e.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=ho[e.stepType];if(!n)throw new RangeError(`No step type ${e.stepType} defined`);return n.fromJSON(t,e)}static jsonID(t,e){if(t in ho)throw new RangeError("Duplicate use of step JSON ID "+t);return ho[t]=e,e.prototype.jsonID=t,e}}class he{constructor(t,e){this.doc=t,this.failed=e}static ok(t){return new he(t,null)}static fail(t){return new he(null,t)}static fromReplace(t,e,n,i){try{return he.ok(t.replace(e,n,i))}catch(s){if(s instanceof at)return he.fail(s.message);throw s}}}function Si(r,t,e){let n=[];for(let i=0;i<r.childCount;i++){let s=r.child(i);s.content.size&&(s=s.copy(Si(s.content,t,s))),s.isInline&&(s=t(s,e,i)),n.push(s)}return F.fromArray(n)}class Sn extends _e{constructor(t,e,n){super(),this.from=t,this.to=e,this.mark=n}apply(t){let e=t.slice(this.from,this.to),n=t.resolve(this.from),i=n.node(n.sharedDepth(this.to)),s=new ot(Si(e.content,(c,p)=>c.isAtom&&p.type.allowsMarkType(this.mark.type)?c.mark(this.mark.addToSet(c.marks)):c,i),e.openStart,e.openEnd);return he.fromReplace(t,this.from,this.to,s)}invert(){return new tn(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return e.deleted&&n.deleted||e.pos>=n.pos?null:new Sn(e.pos,n.pos,this.mark)}merge(t){return t instanceof Sn&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new Sn(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if("number"!=typeof e.from||"number"!=typeof e.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Sn(e.from,e.to,t.markFromJSON(e.mark))}}_e.jsonID("addMark",Sn);class tn extends _e{constructor(t,e,n){super(),this.from=t,this.to=e,this.mark=n}apply(t){let e=t.slice(this.from,this.to),n=new ot(Si(e.content,i=>i.mark(this.mark.removeFromSet(i.marks)),t),e.openStart,e.openEnd);return he.fromReplace(t,this.from,this.to,n)}invert(){return new Sn(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return e.deleted&&n.deleted||e.pos>=n.pos?null:new tn(e.pos,n.pos,this.mark)}merge(t){return t instanceof tn&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new tn(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if("number"!=typeof e.from||"number"!=typeof e.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new tn(e.from,e.to,t.markFromJSON(e.mark))}}_e.jsonID("removeMark",tn);class In extends _e{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return he.fail("No node at mark step's position");let n=e.type.create(e.attrs,null,this.mark.addToSet(e.marks));return he.fromReplace(t,this.pos,this.pos+1,new ot(F.from(n),0,e.isLeaf?0:1))}invert(t){let e=t.nodeAt(this.pos);if(e){let n=this.mark.addToSet(e.marks);if(n.length==e.marks.length){for(let i=0;i<e.marks.length;i++)if(!e.marks[i].isInSet(n))return new In(this.pos,e.marks[i]);return new In(this.pos,this.mark)}}return new Yn(this.pos,this.mark)}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new In(e.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if("number"!=typeof e.pos)throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new In(e.pos,t.markFromJSON(e.mark))}}_e.jsonID("addNodeMark",In);class Yn extends _e{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return he.fail("No node at mark step's position");let n=e.type.create(e.attrs,null,this.mark.removeFromSet(e.marks));return he.fromReplace(t,this.pos,this.pos+1,new ot(F.from(n),0,e.isLeaf?0:1))}invert(t){let e=t.nodeAt(this.pos);return e&&this.mark.isInSet(e.marks)?new In(this.pos,this.mark):this}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new Yn(e.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if("number"!=typeof e.pos)throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Yn(e.pos,t.markFromJSON(e.mark))}}_e.jsonID("removeNodeMark",Yn);class Xt extends _e{constructor(t,e,n,i=!1){super(),this.from=t,this.to=e,this.slice=n,this.structure=i}apply(t){return this.structure&&Wn(t,this.from,this.to)?he.fail("Structure replace would overwrite content"):he.fromReplace(t,this.from,this.to,this.slice)}getMap(){return new Le([this.from,this.to-this.from,this.slice.size])}invert(t){return new Xt(this.from,this.from+this.slice.size,t.slice(this.from,this.to))}map(t){let e=t.mapResult(this.from,1),n=t.mapResult(this.to,-1);return e.deletedAcross&&n.deletedAcross?null:new Xt(e.pos,Math.max(e.pos,n.pos),this.slice)}merge(t){if(!(t instanceof Xt)||t.structure||this.structure)return null;if(this.from+this.slice.size!=t.from||this.slice.openEnd||t.slice.openStart){if(t.to!=this.from||this.slice.openStart||t.slice.openEnd)return null;{let e=this.slice.size+t.slice.size==0?ot.empty:new ot(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new Xt(t.from,this.to,e,this.structure)}}{let e=this.slice.size+t.slice.size==0?ot.empty:new ot(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new Xt(this.from,this.to+(t.to-t.from),e,this.structure)}}toJSON(){let t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if("number"!=typeof e.from||"number"!=typeof e.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Xt(e.from,e.to,ot.fromJSON(t,e.slice),!!e.structure)}}_e.jsonID("replace",Xt);class pe extends _e{constructor(t,e,n,i,s,c,p=!1){super(),this.from=t,this.to=e,this.gapFrom=n,this.gapTo=i,this.slice=s,this.insert=c,this.structure=p}apply(t){if(this.structure&&(Wn(t,this.from,this.gapFrom)||Wn(t,this.gapTo,this.to)))return he.fail("Structure gap-replace would overwrite content");let e=t.slice(this.gapFrom,this.gapTo);if(e.openStart||e.openEnd)return he.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,e.content);return n?he.fromReplace(t,this.from,this.to,n):he.fail("Content does not fit in gap")}getMap(){return new Le([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(t){let e=this.gapTo-this.gapFrom;return new pe(this.from,this.from+this.slice.size+e,this.from+this.insert,this.from+this.insert+e,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(t){let e=t.mapResult(this.from,1),n=t.mapResult(this.to,-1),i=t.map(this.gapFrom,-1),s=t.map(this.gapTo,1);return e.deletedAcross&&n.deletedAcross||i<e.pos||s>n.pos?null:new pe(e.pos,n.pos,i,s,this.slice,this.insert,this.structure)}toJSON(){let t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if("number"!=typeof e.from||"number"!=typeof e.to||"number"!=typeof e.gapFrom||"number"!=typeof e.gapTo||"number"!=typeof e.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new pe(e.from,e.to,e.gapFrom,e.gapTo,ot.fromJSON(t,e.slice),e.insert,!!e.structure)}}function Wn(r,t,e){let n=r.resolve(t),i=e-t,s=n.depth;for(;i>0&&s>0&&n.indexAfter(s)==n.node(s).childCount;)s--,i--;if(i>0){let c=n.node(s).maybeChild(n.indexAfter(s));for(;i>0;){if(!c||c.isLeaf)return!0;c=c.firstChild,i--}}return!1}function fc(r,t,e){return(0==t||r.canReplace(t,r.childCount))&&(e==r.childCount||r.canReplace(0,e))}function fr(r){let e=r.parent.content.cutByIndex(r.startIndex,r.endIndex);for(let n=r.depth;;--n){let i=r.$from.node(n),s=r.$from.index(n),c=r.$to.indexAfter(n);if(n<r.depth&&i.canReplace(s,c,e))return n;if(0==n||i.type.spec.isolating||!fc(i,s,c))break}return null}function Yr(r,t,e=null,n=r){let i=function jn(r,t){let{parent:e,startIndex:n,endIndex:i}=r,s=e.contentMatchAt(n).findWrapping(t);if(!s)return null;let c=s.length?s[0]:t;return e.canReplaceWith(n,i,c)?s:null}(r,t),s=i&&function Pl(r,t){let{parent:e,startIndex:n,endIndex:i}=r,s=e.child(n),c=t.contentMatch.findWrapping(s.type);if(!c)return null;let b=(c.length?c[c.length-1]:t).contentMatch;for(let S=n;b&&S<i;S++)b=b.matchType(e.child(S).type);return b&&b.validEnd?c:null}(n,t);return s?i.map(Oi).concat({type:t,attrs:e}).concat(s.map(Oi)):null}function Oi(r){return{type:r,attrs:null}}function Kn(r,t,e=1,n){let i=r.resolve(t),s=i.depth-e,c=n&&n[n.length-1]||i.parent;if(s<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!c.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let S=i.depth-1,O=e-2;S>s;S--,O--){let B=i.node(S),U=i.index(S);if(B.type.spec.isolating)return!1;let J=B.content.cutByIndex(U,B.childCount),nt=n&&n[O+1];nt&&(J=J.replaceChild(0,nt.type.create(nt.attrs)));let ct=n&&n[O]||B;if(!B.canReplace(U+1,B.childCount)||!ct.type.validContent(J))return!1}let p=i.indexAfter(s),b=n&&n[0];return i.node(s).canReplaceWith(p,p,b?b.type:i.node(s+1).type)}function Di(r,t){let e=r.resolve(t),n=e.index();return Js(e.nodeBefore,e.nodeAfter)&&e.parent.canReplace(n,n+1)}function Js(r,t){return!(!r||!t||r.isLeaf||!r.canAppend(t))}function Ws(r,t,e=t,n=ot.empty){if(t==e&&!n.size)return null;let i=r.resolve(t),s=r.resolve(e);return po(i,s,n)?new Xt(t,e,n):new Rl(i,s,n).fit()}function po(r,t,e){return!e.openStart&&!e.openEnd&&r.start()==t.start()&&r.parent.canReplace(r.index(),t.index(),e.content)}_e.jsonID("replaceAround",pe);class Rl{constructor(t,e,n){this.$from=t,this.$to=e,this.unplaced=n,this.frontier=[],this.placed=F.empty;for(let i=0;i<=t.depth;i++){let s=t.node(i);this.frontier.push({type:s.type,match:s.contentMatchAt(t.indexAfter(i))})}for(let i=t.depth;i>0;i--)this.placed=F.from(t.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let S=this.findFittable();S?this.placeNodes(S):this.openMore()||this.dropNode()}let t=this.mustMoveInline(),e=this.placed.size-this.depth-this.$from.depth,n=this.$from,i=this.close(t<0?this.$to:n.doc.resolve(t));if(!i)return null;let s=this.placed,c=n.depth,p=i.depth;for(;c&&p&&1==s.childCount;)s=s.firstChild.content,c--,p--;let b=new ot(s,c,p);return t>-1?new pe(n.pos,t,this.$to.pos,this.$to.end(),b,e):b.size||n.pos!=this.$to.pos?new Xt(n.pos,i.pos,b):null}findFittable(){let t=this.unplaced.openStart;for(let e=this.unplaced.content,n=0,i=this.unplaced.openEnd;n<t;n++){let s=e.firstChild;if(e.childCount>1&&(i=0),s.type.spec.isolating&&i<=n){t=n;break}e=s.content}for(let e=1;e<=2;e++)for(let n=1==e?t:this.unplaced.openStart;n>=0;n--){let i,s=null;n?(s=mo(this.unplaced.content,n-1).firstChild,i=s.content):i=this.unplaced.content;let c=i.firstChild;for(let p=this.depth;p>=0;p--){let O,{type:b,match:S}=this.frontier[p],B=null;if(1==e&&(c?S.matchType(c.type)||(B=S.fillBefore(F.from(c),!1)):s&&b.compatibleContent(s.type)))return{sliceDepth:n,frontierDepth:p,parent:s,inject:B};if(2==e&&c&&(O=S.findWrapping(c.type)))return{sliceDepth:n,frontierDepth:p,parent:s,wrap:O};if(s&&S.matchType(s.type))break}}}openMore(){let{content:t,openStart:e,openEnd:n}=this.unplaced,i=mo(t,e);return!(!i.childCount||i.firstChild.isLeaf)&&(this.unplaced=new ot(t,e+1,Math.max(n,i.size+e>=t.size-n?e+1:0)),!0)}dropNode(){let{content:t,openStart:e,openEnd:n}=this.unplaced,i=mo(t,e);if(i.childCount<=1&&e>0){let s=t.size-e<=e+i.size;this.unplaced=new ot(pr(t,e-1,1),e-1,s?e-1:n)}else this.unplaced=new ot(pr(t,e,1),e,n)}placeNodes({sliceDepth:t,frontierDepth:e,parent:n,inject:i,wrap:s}){for(;this.depth>e;)this.closeFrontierNode();if(s)for(let ct=0;ct<s.length;ct++)this.openFrontierNode(s[ct]);let c=this.unplaced,p=n?n.content:c.content,b=c.openStart-t,S=0,O=[],{match:B,type:U}=this.frontier[e];if(i){for(let ct=0;ct<i.childCount;ct++)O.push(i.child(ct));B=B.matchFragment(i)}let J=p.size+t-(c.content.size-c.openEnd);for(;S<p.childCount;){let ct=p.child(S),Ct=B.matchType(ct.type);if(!Ct)break;S++,(S>1||0==b||ct.content.size)&&(B=Ct,O.push(js(ct.mark(U.allowedMarks(ct.marks)),1==S?b:0,S==p.childCount?J:-1)))}let nt=S==p.childCount;nt||(J=-1),this.placed=On(this.placed,e,F.from(O)),this.frontier[e].match=B,nt&&J<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let ct=0,Ct=p;ct<J;ct++){let St=Ct.lastChild;this.frontier.push({type:St.type,match:St.contentMatchAt(St.childCount)}),Ct=St.content}this.unplaced=nt?0==t?ot.empty:new ot(pr(c.content,t-1,1),t-1,J<0?c.openEnd:t-1):new ot(pr(c.content,t,S),c.openStart,c.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e,t=this.frontier[this.depth];if(!t.type.isTextblock||!Pi(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(e=this.findCloseLevel(this.$to))&&e.depth==this.depth)return-1;let{depth:n}=this.$to,i=this.$to.after(n);for(;n>1&&i==this.$to.end(--n);)++i;return i}findCloseLevel(t){t:for(let e=Math.min(this.depth,t.depth);e>=0;e--){let{match:n,type:i}=this.frontier[e],s=e<t.depth&&t.end(e+1)==t.pos+(t.depth-(e+1)),c=Pi(t,e,i,n,s);if(c){for(let p=e-1;p>=0;p--){let{match:b,type:S}=this.frontier[p],O=Pi(t,p,S,b,!0);if(!O||O.childCount)continue t}return{depth:e,fit:c,move:s?t.doc.resolve(t.after(e+1)):t}}}}close(t){let e=this.findCloseLevel(t);if(!e)return null;for(;this.depth>e.depth;)this.closeFrontierNode();e.fit.childCount&&(this.placed=On(this.placed,e.depth,e.fit)),t=e.move;for(let n=e.depth+1;n<=t.depth;n++){let i=t.node(n),s=i.type.contentMatch.fillBefore(i.content,!0,t.index(n));this.openFrontierNode(i.type,i.attrs,s)}return t}openFrontierNode(t,e=null,n){let i=this.frontier[this.depth];i.match=i.match.matchType(t),this.placed=On(this.placed,this.depth,F.from(t.create(e,n))),this.frontier.push({type:t,match:t.contentMatch})}closeFrontierNode(){let e=this.frontier.pop().match.fillBefore(F.empty,!0);e.childCount&&(this.placed=On(this.placed,this.frontier.length,e))}}function pr(r,t,e){return 0==t?r.cutByIndex(e,r.childCount):r.replaceChild(0,r.firstChild.copy(pr(r.firstChild.content,t-1,e)))}function On(r,t,e){return 0==t?r.append(e):r.replaceChild(r.childCount-1,r.lastChild.copy(On(r.lastChild.content,t-1,e)))}function mo(r,t){for(let e=0;e<t;e++)r=r.firstChild.content;return r}function js(r,t,e){if(t<=0)return r;let n=r.content;return t>1&&(n=n.replaceChild(0,js(n.firstChild,t-1,1==n.childCount?e-1:0))),t>0&&(n=r.type.contentMatch.fillBefore(n).append(n),e<=0&&(n=n.append(r.type.contentMatch.matchFragment(n).fillBefore(F.empty,!0)))),r.copy(n)}function Pi(r,t,e,n,i){let s=r.node(t),c=i?r.indexAfter(t):r.index(t);if(c==s.childCount&&!e.compatibleContent(s.type))return null;let p=n.fillBefore(s.content,!0,c);return p&&!function go(r,t,e){for(let n=e;n<t.childCount;n++)if(!r.allowsMarks(t.child(n).marks))return!0;return!1}(e,s.content,c)?p:null}function mr(r){return r.spec.defining||r.spec.definingForContent}function gr(r,t,e,n,i){if(t<e){let s=r.firstChild;r=r.replaceChild(0,s.copy(gr(s.content,t+1,e,n,s)))}if(t>n){let s=i.contentMatchAt(0),c=s.fillBefore(r).append(r);r=c.append(s.matchFragment(c).fillBefore(F.empty,!0))}return r}function vr(r,t){let e=[];for(let i=Math.min(r.depth,t.depth);i>=0;i--){let s=r.start(i);if(s<r.pos-(r.depth-i)||t.end(i)>t.pos+(t.depth-i)||r.node(i).type.spec.isolating||t.node(i).type.spec.isolating)break;(s==t.start(i)||i==r.depth&&i==t.depth&&r.parent.inlineContent&&t.parent.inlineContent&&i&&t.start(i-1)==s-1)&&e.push(i)}return e}class mn extends _e{constructor(t,e,n){super(),this.pos=t,this.attr=e,this.value=n}apply(t){let e=t.nodeAt(this.pos);if(!e)return he.fail("No node at attribute step's position");let n=Object.create(null);for(let s in e.attrs)n[s]=e.attrs[s];n[this.attr]=this.value;let i=e.type.create(n,null,e.marks);return he.fromReplace(t,this.pos,this.pos+1,new ot(F.from(i),0,e.isLeaf?0:1))}getMap(){return Le.empty}invert(t){return new mn(this.pos,this.attr,t.nodeAt(this.pos).attrs[this.attr])}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new mn(e.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(t,e){if("number"!=typeof e.pos||"string"!=typeof e.attr)throw new RangeError("Invalid input for AttrStep.fromJSON");return new mn(e.pos,e.attr,e.value)}}_e.jsonID("attr",mn);class Je extends _e{constructor(t,e){super(),this.attr=t,this.value=e}apply(t){let e=Object.create(null);for(let i in t.attrs)e[i]=t.attrs[i];e[this.attr]=this.value;let n=t.type.create(e,t.content,t.marks);return he.ok(n)}getMap(){return Le.empty}invert(t){return new Je(this.attr,t.attrs[this.attr])}map(t){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(t,e){if("string"!=typeof e.attr)throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Je(e.attr,e.value)}}_e.jsonID("docAttr",Je);let gn=class extends Error{};gn=function r(t){let e=Error.call(this,t);return e.__proto__=r.prototype,e},gn.prototype=Object.create(Error.prototype),gn.prototype.constructor=gn,gn.prototype.name="TransformError";class jr{constructor(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new dr}get before(){return this.docs.length?this.docs[0]:this.doc}step(t){let e=this.maybeStep(t);if(e.failed)throw new gn(e.failed);return this}maybeStep(t){let e=t.apply(this.doc);return e.failed||this.addStep(t,e.doc),e}get docChanged(){return this.steps.length>0}addStep(t,e){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=e}replace(t,e=t,n=ot.empty){let i=Ws(this.doc,t,e,n);return i&&this.step(i),this}replaceWith(t,e,n){return this.replace(t,e,new ot(F.from(n),0,0))}delete(t,e){return this.replace(t,e,ot.empty)}insert(t,e){return this.replaceWith(t,t,e)}replaceRange(t,e,n){return function Wr(r,t,e,n){if(!n.size)return r.deleteRange(t,e);let i=r.doc.resolve(t),s=r.doc.resolve(e);if(po(i,s,n))return r.step(new Xt(t,e,n));let c=vr(i,r.doc.resolve(e));0==c[c.length-1]&&c.pop();let p=-(i.depth+1);c.unshift(p);for(let U=i.depth,J=i.pos-1;U>0;U--,J--){let nt=i.node(U).type.spec;if(nt.defining||nt.definingAsContext||nt.isolating)break;c.indexOf(U)>-1?p=U:i.before(U)==J&&c.splice(1,0,-U)}let b=c.indexOf(p),S=[],O=n.openStart;for(let U=n.content,J=0;;J++){let nt=U.firstChild;if(S.push(nt),J==n.openStart)break;U=nt.content}for(let U=O-1;U>=0;U--){let J=S[U],nt=mr(J.type);if(nt&&!J.sameMarkup(i.node(Math.abs(p)-1)))O=U;else if(nt||!J.type.isTextblock)break}for(let U=n.openStart;U>=0;U--){let J=(U+O+1)%(n.openStart+1),nt=S[J];if(nt)for(let ct=0;ct<c.length;ct++){let Ct=c[(ct+b)%c.length],St=!0;Ct<0&&(St=!1,Ct=-Ct);let Lt=i.node(Ct-1),Bt=i.index(Ct-1);if(Lt.canReplaceWith(Bt,Bt,nt.type,nt.marks))return r.replace(i.before(Ct),St?s.after(Ct):e,new ot(gr(n.content,0,n.openStart,J),J,n.openEnd))}}let B=r.steps.length;for(let U=c.length-1;U>=0&&(r.replace(t,e,n),!(r.steps.length>B));U--){let J=c[U];J<0||(t=i.before(J),e=s.after(J))}}(this,t,e,n),this}replaceRangeWith(t,e,n){return function Ks(r,t,e,n){if(!n.isInline&&t==e&&r.doc.resolve(t).parent.content.size){let i=function Ys(r,t,e){let n=r.resolve(t);if(n.parent.canReplaceWith(n.index(),n.index(),e))return t;if(0==n.parentOffset)for(let i=n.depth-1;i>=0;i--){let s=n.index(i);if(n.node(i).canReplaceWith(s,s,e))return n.before(i+1);if(s>0)return null}if(n.parentOffset==n.parent.content.size)for(let i=n.depth-1;i>=0;i--){let s=n.indexAfter(i);if(n.node(i).canReplaceWith(s,s,e))return n.after(i+1);if(s<n.node(i).childCount)return null}return null}(r.doc,t,n.type);null!=i&&(t=e=i)}r.replaceRange(t,e,new ot(F.from(n),0,0))}(this,t,e,n),this}deleteRange(t,e){return function Li(r,t,e){let n=r.doc.resolve(t),i=r.doc.resolve(e),s=vr(n,i);for(let c=0;c<s.length;c++){let p=s[c],b=c==s.length-1;if(b&&0==p||n.node(p).type.contentMatch.validEnd)return r.delete(n.start(p),i.end(p));if(p>0&&(b||n.node(p-1).canReplace(n.index(p-1),i.indexAfter(p-1))))return r.delete(n.before(p),i.after(p))}for(let c=1;c<=n.depth&&c<=i.depth;c++)if(t-n.start(c)==n.depth-c&&e>n.end(c)&&i.end(c)-e!=i.depth-c)return r.delete(n.before(c),e);r.delete(t,e)}(this,t,e),this}lift(t,e){return function Dl(r,t,e){let{$from:n,$to:i,depth:s}=t,c=n.before(s+1),p=i.after(s+1),b=c,S=p,O=F.empty,B=0;for(let nt=s,ct=!1;nt>e;nt--)ct||n.index(nt)>0?(ct=!0,O=F.from(n.node(nt).copy(O)),B++):b--;let U=F.empty,J=0;for(let nt=s,ct=!1;nt>e;nt--)ct||i.after(nt+1)<i.end(nt)?(ct=!0,U=F.from(i.node(nt).copy(U)),J++):S++;r.step(new pe(b,S,c,p,new ot(O.append(U),B,J),O.size-B,!0))}(this,t,e),this}join(t,e=1){return function $s(r,t,e){let n=new Xt(t-e,t+e,ot.empty,!0);r.step(n)}(this,t,e),this}wrap(t,e){return function fo(r,t,e){let n=F.empty;for(let c=e.length-1;c>=0;c--){if(n.size){let p=e[c].type.contentMatch.matchFragment(n);if(!p||!p.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}n=F.from(e[c].type.create(e[c].attrs,n))}let i=t.start,s=t.end;r.step(new pe(i,s,i,s,new ot(n,0,0),e.length,!0))}(this,t,e),this}setBlockType(t,e=t,n,i=null){return function Us(r,t,e,n,i){if(!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=r.steps.length;r.doc.nodesBetween(t,e,(c,p)=>{if(c.isTextblock&&!c.hasMarkup(n,i)&&function Ll(r,t,e){let n=r.resolve(t),i=n.index();return n.parent.canReplaceWith(i,i+1,e)}(r.doc,r.mapping.slice(s).map(p),n)){r.clearIncompatible(r.mapping.slice(s).map(p,1),n);let b=r.mapping.slice(s),S=b.map(p,1),O=b.map(p+c.nodeSize,1);return r.step(new pe(S,O,S+1,O-1,new ot(F.from(n.create(i,null,c.marks)),0,0),1,!0)),!1}})}(this,t,e,n,i),this}setNodeMarkup(t,e,n=null,i){return function Ai(r,t,e,n,i){let s=r.doc.nodeAt(t);if(!s)throw new RangeError("No node at given position");e||(e=s.type);let c=e.create(n,null,i||s.marks);if(s.isLeaf)return r.replaceWith(t,t+s.nodeSize,c);if(!e.validContent(s.content))throw new RangeError("Invalid content for node type "+e.name);r.step(new pe(t,t+s.nodeSize,t+1,t+s.nodeSize-1,new ot(F.from(c),0,0),1,!0))}(this,t,e,n,i),this}setNodeAttribute(t,e,n){return this.step(new mn(t,e,n)),this}setDocAttribute(t,e){return this.step(new Je(t,e)),this}addNodeMark(t,e){return this.step(new In(t,e)),this}removeNodeMark(t,e){if(!(e instanceof W)){let n=this.doc.nodeAt(t);if(!n)throw new RangeError("No node at position "+t);if(!(e=e.isInSet(n.marks)))return this}return this.step(new Yn(t,e)),this}split(t,e=1,n){return function Fl(r,t,e=1,n){let i=r.doc.resolve(t),s=F.empty,c=F.empty;for(let p=i.depth,b=i.depth-e,S=e-1;p>b;p--,S--){s=F.from(i.node(p).copy(s));let O=n&&n[S];c=F.from(O?O.type.create(O.attrs,c):i.node(p).copy(c))}r.step(new Xt(t,t,new ot(s.append(c),e,e),!0))}(this,t,e,n),this}addMark(t,e,n){return function Zs(r,t,e,n){let c,p,i=[],s=[];r.doc.nodesBetween(t,e,(b,S,O)=>{if(!b.isInline)return;let B=b.marks;if(!n.isInSet(B)&&O.type.allowsMarkType(n.type)){let U=Math.max(S,t),J=Math.min(S+b.nodeSize,e),nt=n.addToSet(B);for(let ct=0;ct<B.length;ct++)B[ct].isInSet(nt)||(c&&c.to==U&&c.mark.eq(B[ct])?c.to=J:i.push(c=new tn(U,J,B[ct])));p&&p.to==U?p.to=J:s.push(p=new Sn(U,J,n))}}),i.forEach(b=>r.step(b)),s.forEach(b=>r.step(b))}(this,t,e,n),this}removeMark(t,e,n){return function Gs(r,t,e,n){let i=[],s=0;r.doc.nodesBetween(t,e,(c,p)=>{if(!c.isInline)return;s++;let b=null;if(n instanceof Ci){let O,S=c.marks;for(;O=n.isInSet(S);)(b||(b=[])).push(O),S=O.removeFromSet(S)}else n?n.isInSet(c.marks)&&(b=[n]):b=c.marks;if(b&&b.length){let S=Math.min(p+c.nodeSize,e);for(let O=0;O<b.length;O++){let U,B=b[O];for(let J=0;J<i.length;J++){let nt=i[J];nt.step==s-1&&B.eq(i[J].style)&&(U=nt)}U?(U.to=S,U.step=s):i.push({style:B,from:Math.max(p,t),to:S,step:s})}}}),i.forEach(c=>r.step(new tn(c.from,c.to,c.style)))}(this,t,e,n),this}clearIncompatible(t,e,n){return function Ii(r,t,e,n=e.contentMatch){let i=r.doc.nodeAt(t),s=[],c=t+1;for(let p=0;p<i.childCount;p++){let b=i.child(p),S=c+b.nodeSize,O=n.matchType(b.type);if(O){n=O;for(let B=0;B<b.marks.length;B++)e.allowsMarkType(b.marks[B].type)||r.step(new tn(c,S,b.marks[B]));if(b.isText&&!e.spec.code){let B,J,U=/\r?\n|\r/g;for(;B=U.exec(b.text);)J||(J=new ot(F.from(e.schema.text(" ",e.allowedMarks(b.marks))),0,0)),s.push(new Xt(c+B.index,c+B.index+B[0].length,J))}}else s.push(new Xt(c,S,ot.empty));c=S}if(!n.validEnd){let p=n.fillBefore(F.empty,!0);r.replace(c,c,new ot(p,0,0))}for(let p=s.length-1;p>=0;p--)r.step(s[p])}(this,t,e,n),this}}const Fi=Object.create(null);class Gt{constructor(t,e,n){this.$anchor=t,this.$head=e,this.ranges=n||[new Bl(t.min(e),t.max(e))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let t=this.ranges;for(let e=0;e<t.length;e++)if(t[e].$from.pos!=t[e].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(t,e=ot.empty){let n=e.content.lastChild,i=null;for(let p=0;p<e.openEnd;p++)i=n,n=n.lastChild;let s=t.steps.length,c=this.ranges;for(let p=0;p<c.length;p++){let{$from:b,$to:S}=c[p],O=t.mapping.slice(s);t.replaceRange(O.map(b.pos),O.map(S.pos),p?ot.empty:e),0==p&&Qs(t,s,(n?n.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(t,e){let n=t.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){let{$from:c,$to:p}=i[s],b=t.mapping.slice(n),S=b.map(c.pos),O=b.map(p.pos);s?t.deleteRange(S,O):(t.replaceRangeWith(S,O,e),Qs(t,n,e.isInline?-1:1))}}static findFrom(t,e,n=!1){let i=t.parent.inlineContent?new Kt(t):xr(t.node(0),t.parent,t.pos,t.index(),e,n);if(i)return i;for(let s=t.depth-1;s>=0;s--){let c=e<0?xr(t.node(0),t.node(s),t.before(s+1),t.index(s),e,n):xr(t.node(0),t.node(s),t.after(s+1),t.index(s)+1,e,n);if(c)return c}return null}static near(t,e=1){return this.findFrom(t,e)||this.findFrom(t,-e)||new be(t.node(0))}static atStart(t){return xr(t,t,0,0,1)||new be(t)}static atEnd(t){return xr(t,t,t.content.size,t.childCount,-1)||new be(t)}static fromJSON(t,e){if(!e||!e.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=Fi[e.type];if(!n)throw new RangeError(`No selection type ${e.type} defined`);return n.fromJSON(t,e)}static jsonID(t,e){if(t in Fi)throw new RangeError("Duplicate use of selection JSON ID "+t);return Fi[t]=e,e.prototype.jsonID=t,e}getBookmark(){return Kt.between(this.$anchor,this.$head).getBookmark()}}Gt.prototype.visible=!0;class Bl{constructor(t,e){this.$from=t,this.$to=e}}let yr=!1;function Kr(r){!yr&&!r.parent.inlineContent&&(yr=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+r.parent.type.name+")"))}class Kt extends Gt{constructor(t,e=t){Kr(t),Kr(e),super(t,e)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(t,e){let n=t.resolve(e.map(this.head));if(!n.parent.inlineContent)return Gt.near(n);let i=t.resolve(e.map(this.anchor));return new Kt(i.parent.inlineContent?i:n,n)}replace(t,e=ot.empty){if(super.replace(t,e),e==ot.empty){let n=this.$from.marksAcross(this.$to);n&&t.ensureMarks(n)}}eq(t){return t instanceof Kt&&t.anchor==this.anchor&&t.head==this.head}getBookmark(){return new Qr(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(t,e){if("number"!=typeof e.anchor||"number"!=typeof e.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new Kt(t.resolve(e.anchor),t.resolve(e.head))}static create(t,e,n=e){let i=t.resolve(e);return new this(i,n==e?i:t.resolve(n))}static between(t,e,n){let i=t.pos-e.pos;if((!n||i)&&(n=i>=0?1:-1),!e.parent.inlineContent){let s=Gt.findFrom(e,n,!0)||Gt.findFrom(e,-n,!0);if(!s)return Gt.near(e,n);e=s.$head}return t.parent.inlineContent||(0==i?t=e:(t=(Gt.findFrom(t,-n,!0)||Gt.findFrom(t,n,!0)).$anchor).pos<e.pos!=i<0&&(t=e)),new Kt(t,e)}}Gt.jsonID("text",Kt);class Qr{constructor(t,e){this.anchor=t,this.head=e}map(t){return new Qr(t.map(this.anchor),t.map(this.head))}resolve(t){return Kt.between(t.resolve(this.anchor),t.resolve(this.head))}}class Vt extends Gt{constructor(t){let e=t.nodeAfter,n=t.node(0).resolve(t.pos+e.nodeSize);super(t,n),this.node=e}map(t,e){let{deleted:n,pos:i}=e.mapResult(this.anchor),s=t.resolve(i);return n?Gt.near(s):new Vt(s)}content(){return new ot(F.from(this.node),0,0)}eq(t){return t instanceof Vt&&t.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new vo(this.anchor)}static fromJSON(t,e){if("number"!=typeof e.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new Vt(t.resolve(e.anchor))}static create(t,e){return new Vt(t.resolve(e))}static isSelectable(t){return!t.isText&&!1!==t.type.spec.selectable}}Vt.prototype.visible=!1,Gt.jsonID("node",Vt);class vo{constructor(t){this.anchor=t}map(t){let{deleted:e,pos:n}=t.mapResult(this.anchor);return e?new Qr(n,n):new vo(n)}resolve(t){let e=t.resolve(this.anchor),n=e.nodeAfter;return n&&Vt.isSelectable(n)?new Vt(e):Gt.near(e)}}class be extends Gt{constructor(t){super(t.resolve(0),t.resolve(t.content.size))}replace(t,e=ot.empty){if(e==ot.empty){t.delete(0,t.doc.content.size);let n=Gt.atStart(t.doc);n.eq(t.selection)||t.setSelection(n)}else super.replace(t,e)}toJSON(){return{type:"all"}}static fromJSON(t){return new be(t)}map(t){return new be(t)}eq(t){return t instanceof be}getBookmark(){return yo}}Gt.jsonID("all",be);const yo={map(){return this},resolve:r=>new be(r)};function xr(r,t,e,n,i,s=!1){if(t.inlineContent)return Kt.create(r,e);for(let c=n-(i>0?0:1);i>0?c<t.childCount:c>=0;c+=i){let p=t.child(c);if(p.isAtom){if(!s&&Vt.isSelectable(p))return Vt.create(r,e-(i<0?p.nodeSize:0))}else{let b=xr(r,p,e+i,i<0?p.childCount:0,i,s);if(b)return b}e+=p.nodeSize*i}return null}function Qs(r,t,e){let n=r.steps.length-1;if(n<t)return;let c,i=r.steps[n];(i instanceof Xt||i instanceof pe)&&(r.mapping.maps[n].forEach((p,b,S,O)=>{null==c&&(c=O)}),r.setSelection(Gt.near(r.doc.resolve(c),e)))}class Bi extends jr{constructor(t){super(t.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=t.selection,this.storedMarks=t.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(t){return this.storedMarks=t,this.updated|=2,this}ensureMarks(t){return W.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this}addStoredMark(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(t,e){super.addStep(t,e),this.updated=-3&this.updated,this.storedMarks=null}setTime(t){return this.time=t,this}replaceSelection(t){return this.selection.replace(this,t),this}replaceSelectionWith(t,e=!0){let n=this.selection;return e&&(t=t.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||W.none))),n.replaceWith(this,t),this}deleteSelection(){return this.selection.replace(this),this}insertText(t,e,n){let i=this.doc.type.schema;if(null==e)return t?this.replaceSelectionWith(i.text(t),!0):this.deleteSelection();{if(null==n&&(n=e),n=n??e,!t)return this.deleteRange(e,n);let s=this.storedMarks;if(!s){let c=this.doc.resolve(e);s=n==e?c.marks():c.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(e,n,i.text(t,s)),this.selection.empty||this.setSelection(Gt.near(this.selection.$to)),this}}setMeta(t,e){return this.meta["string"==typeof t?t:t.key]=e,this}getMeta(t){return this.meta["string"==typeof t?t:t.key]}get isGeneric(){for(let t in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function _o(r,t){return t&&r?r.bind(t):r}class Qn{constructor(t,e,n){this.name=t,this.init=_o(e.init,n),this.apply=_o(e.apply,n)}}const zi=[new Qn("doc",{init:r=>r.doc||r.schema.topNodeType.createAndFill(),apply:r=>r.doc}),new Qn("selection",{init:(r,t)=>r.selection||Gt.atStart(t.doc),apply:r=>r.selection}),new Qn("storedMarks",{init:r=>r.storedMarks||null,apply:(r,t,e,n)=>n.selection.$cursor?r.storedMarks:null}),new Qn("scrollToSelection",{init:()=>0,apply:(r,t)=>r.scrolledIntoView?t+1:t})];class _r{constructor(t,e){this.schema=t,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=zi.slice(),e&&e.forEach(n=>{if(this.pluginsByKey[n.key])throw new RangeError("Adding different instances of a keyed plugin ("+n.key+")");this.plugins.push(n),this.pluginsByKey[n.key]=n,n.spec.state&&this.fields.push(new Qn(n.key,n.spec.state,n))})}}class An{constructor(t){this.config=t}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(t){return this.applyTransaction(t).state}filterTransaction(t,e=-1){for(let n=0;n<this.config.plugins.length;n++)if(n!=e){let i=this.config.plugins[n];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,t,this))return!1}return!0}applyTransaction(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};let e=[t],n=this.applyInner(t),i=null;for(;;){let s=!1;for(let c=0;c<this.config.plugins.length;c++){let p=this.config.plugins[c];if(p.spec.appendTransaction){let b=i?i[c].n:0,S=i?i[c].state:this,O=b<e.length&&p.spec.appendTransaction.call(p,b?e.slice(b):e,S,n);if(O&&n.filterTransaction(O,c)){if(O.setMeta("appendedTransaction",t),!i){i=[];for(let B=0;B<this.config.plugins.length;B++)i.push(B<c?{state:n,n:e.length}:{state:this,n:0})}e.push(O),n=n.applyInner(O),s=!0}i&&(i[c]={state:n,n:e.length})}}if(!s)return{state:n,transactions:e}}}applyInner(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let e=new An(this.config),n=this.config.fields;for(let i=0;i<n.length;i++){let s=n[i];e[s.name]=s.apply(t,this[s.name],this,e)}return e}get tr(){return new Bi(this)}static create(t){let e=new _r(t.doc?t.doc.type.schema:t.schema,t.plugins),n=new An(e);for(let i=0;i<e.fields.length;i++)n[e.fields[i].name]=e.fields[i].init(t,n);return n}reconfigure(t){let e=new _r(this.schema,t.plugins),n=e.fields,i=new An(e);for(let s=0;s<n.length;s++){let c=n[s].name;i[c]=this.hasOwnProperty(c)?this[c]:n[s].init(t,i)}return i}toJSON(t){let e={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(e.storedMarks=this.storedMarks.map(n=>n.toJSON())),t&&"object"==typeof t)for(let n in t){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=t[n],s=i.spec.state;s&&s.toJSON&&(e[n]=s.toJSON.call(i,this[i.key]))}return e}static fromJSON(t,e,n){if(!e)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");let i=new _r(t.schema,t.plugins),s=new An(i);return i.fields.forEach(c=>{if("doc"==c.name)s.doc=Wt.fromJSON(t.schema,e.doc);else if("selection"==c.name)s.selection=Gt.fromJSON(s.doc,e.selection);else if("storedMarks"==c.name)e.storedMarks&&(s.storedMarks=e.storedMarks.map(t.schema.markFromJSON));else{if(n)for(let p in n){let b=n[p],S=b.spec.state;if(b.key==c.name&&S&&S.fromJSON&&Object.prototype.hasOwnProperty.call(e,p))return void(s[c.name]=S.fromJSON.call(b,t,e[p],s))}s[c.name]=c.init(t,s)}}),s}}function en(r,t,e){for(let n in r){let i=r[n];i instanceof Function?i=i.bind(t):"handleDOMEvents"==n&&(i=en(i,t,{})),e[n]=i}return e}class oe{constructor(t){this.spec=t,this.props={},t.props&&en(t.props,this,this.props),this.key=t.key?t.key.key:Xs("plugin")}getState(t){return t[this.key]}}const wo=Object.create(null);function Xs(r){return r in wo?r+"$"+ ++wo[r]:(wo[r]=0,r+"$")}class vn{constructor(t="key"){this.key=Xs(t)}get(t){return t.config.pluginsByKey[this.key]}getState(t){return t[this.key]}}const se=function(r){for(var t=0;;t++)if(!(r=r.previousSibling))return t},wr=function(r){let t=r.assignedSlot||r.parentNode;return t&&11==t.nodeType?t.host:t};let Hi=null;const nn=function(r,t,e){let n=Hi||(Hi=document.createRange());return n.setEnd(r,e??r.nodeValue.length),n.setStart(r,t||0),n},$e=function(r,t,e,n){return e&&(Co(r,t,e,n,-1)||Co(r,t,e,n,1))},bo=/^(img|br|input|textarea|hr)$/i;function Co(r,t,e,n,i){for(;;){if(r==e&&t==n)return!0;if(t==(i<0?0:Fe(r))){let s=r.parentNode;if(!s||1!=s.nodeType||Hl(r)||bo.test(r.nodeName)||"false"==r.contentEditable)return!1;t=se(r)+(i<0?0:1),r=s}else{if(1!=r.nodeType)return!1;if("false"==(r=r.childNodes[t+(i<0?-1:0)]).contentEditable)return!1;t=i<0?Fe(r):0}}}function Fe(r){return 3==r.nodeType?r.nodeValue.length:r.childNodes.length}function Hl(r){let t;for(let e=r;e&&!(t=e.pmViewDesc);e=e.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==r||t.contentDOM==r)}const qr=function(r){return r.focusNode&&$e(r.focusNode,r.focusOffset,r.anchorNode,r.anchorOffset)};function Xn(r,t){let e=document.createEvent("Event");return e.initEvent("keydown",!0,!0),e.keyCode=r,e.key=e.code=t,e}const Dn=typeof navigator<"u"?navigator:null,qs=typeof document<"u"?document:null,Pn=Dn&&Dn.userAgent||"",ti=/Edge\/(\d+)/.exec(Pn),Vi=/MSIE \d/.exec(Pn),Zi=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Pn),me=!!(Vi||Zi||ti),Be=Vi?document.documentMode:Zi?+Zi[1]:ti?+ti[1]:0,De=!me&&/gecko\/(\d+)/i.test(Pn);De&&(/Firefox\/(\d+)/.exec(Pn)||[0,0])[1];const Ln=!me&&/Chrome\/(\d+)/.exec(Pn),de=!!Ln,rn=Ln?+Ln[1]:0,Ce=!me&&!!Dn&&/Apple Computer/.test(Dn.vendor),br=Ce&&(/Mobile\/\w+/.test(Pn)||!!Dn&&Dn.maxTouchPoints>2),ze=br||!!Dn&&/Mac/.test(Dn.platform),Ye=/Android \d/.test(Pn),Gi=!!qs&&"webkitFontSmoothing"in qs.documentElement.style,Zl=Gi?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function Gl(r){return{left:0,right:r.documentElement.clientWidth,top:0,bottom:r.documentElement.clientHeight}}function yn(r,t){return"number"==typeof r?r:r[t]}function ta(r){let t=r.getBoundingClientRect(),e=t.width/r.offsetWidth||1,n=t.height/r.offsetHeight||1;return{left:t.left,right:t.left+r.clientWidth*e,top:t.top,bottom:t.top+r.clientHeight*n}}function ea(r,t,e){let n=r.someProp("scrollThreshold")||0,i=r.someProp("scrollMargin")||5,s=r.dom.ownerDocument;for(let c=e||r.dom;c;c=wr(c)){if(1!=c.nodeType)continue;let p=c,b=p==s.body,S=b?Gl(s):ta(p),O=0,B=0;if(t.top<S.top+yn(n,"top")?B=-(S.top-t.top+yn(i,"top")):t.bottom>S.bottom-yn(n,"bottom")&&(B=t.bottom-S.bottom+yn(i,"bottom")),t.left<S.left+yn(n,"left")?O=-(S.left-t.left+yn(i,"left")):t.right>S.right-yn(n,"right")&&(O=t.right-S.right+yn(i,"right")),O||B)if(b)s.defaultView.scrollBy(O,B);else{let U=p.scrollLeft,J=p.scrollTop;B&&(p.scrollTop+=B),O&&(p.scrollLeft+=O);let nt=p.scrollLeft-U,ct=p.scrollTop-J;t={left:t.left-nt,top:t.top-ct,right:t.right-nt,bottom:t.bottom-ct}}if(b)break}}function Cr(r){let t=[],e=r.ownerDocument;for(let n=r;n&&(t.push({dom:n,top:n.scrollTop,left:n.scrollLeft}),r!=e);n=wr(n));return t}function ei(r,t){for(let e=0;e<r.length;e++){let{dom:n,top:i,left:s}=r[e];n.scrollTop!=i+t&&(n.scrollTop=i+t),n.scrollLeft!=s&&(n.scrollLeft=s)}}let kr=null;function Pe(r,t){let e,i,n=2e8,s=0,c=t.top,p=t.top;for(let b=r.firstChild,S=0;b;b=b.nextSibling,S++){let O;if(1==b.nodeType)O=b.getClientRects();else{if(3!=b.nodeType)continue;O=nn(b).getClientRects()}for(let B=0;B<O.length;B++){let U=O[B];if(U.top<=c&&U.bottom>=p){c=Math.max(U.bottom,c),p=Math.min(U.top,p);let J=U.left>t.left?U.left-t.left:U.right<t.left?t.left-U.right:0;if(J<n){e=b,n=J,i=J&&3==e.nodeType?{left:U.right<t.left?U.right:U.left,top:t.top}:t,1==b.nodeType&&J&&(s=S+(t.left>=(U.left+U.right)/2?1:0));continue}}!e&&(t.left>=U.right&&t.top>=U.top||t.left>=U.left&&t.top>=U.bottom)&&(s=S+1)}}return e&&3==e.nodeType?function ia(r,t){let e=r.nodeValue.length,n=document.createRange();for(let i=0;i<e;i++){n.setEnd(r,i+1),n.setStart(r,i);let s=sn(n,1);if(s.top!=s.bottom&&Ji(t,s))return{node:r,offset:i+(t.left>=(s.left+s.right)/2?1:0)}}return{node:r,offset:0}}(e,i):!e||n&&1==e.nodeType?{node:r,offset:s}:Pe(e,i)}function Ji(r,t){return r.left>=t.left-1&&r.left<=t.right+1&&r.top>=t.top-1&&r.top<=t.bottom+1}function aa(r,t,e){let n=r.childNodes.length;if(n&&e.top<e.bottom)for(let i=Math.max(0,Math.min(n-1,Math.floor(n*(t.top-e.top)/(e.bottom-e.top))-2)),s=i;;){let c=r.childNodes[s];if(1==c.nodeType){let p=c.getClientRects();for(let b=0;b<p.length;b++){let S=p[b];if(Ji(t,S))return aa(c,t,S)}}if((s=(s+1)%n)==i)break}return r}function on(r,t){let n,e=r.dom.ownerDocument,i=0;if(e.caretPositionFromPoint)try{let b=e.caretPositionFromPoint(t.left,t.top);b&&({offsetNode:n,offset:i}=b)}catch{}if(!n&&e.caretRangeFromPoint){let b=e.caretRangeFromPoint(t.left,t.top);b&&({startContainer:n,startOffset:i}=b)}let c,s=(r.root.elementFromPoint?r.root:e).elementFromPoint(t.left,t.top);if(!s||!r.dom.contains(1!=s.nodeType?s.parentNode:s)){let b=r.dom.getBoundingClientRect();if(!Ji(t,b)||(s=aa(r.dom,t,b),!s))return null}if(Ce)for(let b=s;n&&b;b=wr(b))b.draggable&&(n=void 0);if(s=function ko(r,t){let e=r.parentNode;return e&&/^li$/i.test(e.nodeName)&&t.left<r.getBoundingClientRect().left?e:r}(s,t),n){if(De&&1==n.nodeType&&(i=Math.min(i,n.childNodes.length),i<n.childNodes.length)){let S,b=n.childNodes[i];"IMG"==b.nodeName&&(S=b.getBoundingClientRect()).right<=t.left&&S.bottom>t.top&&i++}n==r.dom&&i==n.childNodes.length-1&&1==n.lastChild.nodeType&&t.top>n.lastChild.getBoundingClientRect().bottom?c=r.state.doc.content.size:(0==i||1!=n.nodeType||"BR"!=n.childNodes[i-1].nodeName)&&(c=function sa(r,t,e,n){let i=-1;for(let s=t;s!=r.dom;){let c=r.docView.nearestDesc(s,!0);if(!c)return null;if(1==c.dom.nodeType&&(c.node.isBlock&&c.parent||!c.contentDOM)){let p=c.dom.getBoundingClientRect();if(c.node.isBlock&&c.parent&&(p.left>n.left||p.top>n.top?i=c.posBefore:(p.right<n.left||p.bottom<n.top)&&(i=c.posAfter)),!c.contentDOM&&i<0)return(c.node.isBlock?n.top<(p.top+p.bottom)/2:n.left<(p.left+p.right)/2)?c.posBefore:c.posAfter}s=c.dom.parentNode}return i>-1?i:r.docView.posFromDOM(t,e,-1)}(r,n,i,t))}null==c&&(c=function oa(r,t,e){let{node:n,offset:i}=Pe(t,e),s=-1;if(1==n.nodeType&&!n.firstChild){let c=n.getBoundingClientRect();s=c.left!=c.right&&e.left>(c.left+c.right)/2?1:-1}return r.docView.posFromDOM(n,i,s)}(r,s,t));let p=r.docView.nearestDesc(s,!0);return{pos:c,inside:p?p.posAtStart-p.border:-1}}function sn(r,t){let e=r.getClientRects();return e.length?e[t<0?0:e.length-1]:r.getBoundingClientRect()}const la=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function ua(r,t,e){let{node:n,offset:i,atom:s}=r.docView.domFromPos(t,e<0?-1:1),c=Gi||De;if(3==n.nodeType){if(!c||!la.test(n.nodeValue)&&(e<0?i:i!=n.nodeValue.length)){let b=i,S=i,O=e<0?1:-1;return e<0&&!i?(S++,O=-1):e>=0&&i==n.nodeValue.length?(b--,O=1):e<0?b--:S++,ni(sn(nn(n,b,S),1),O<0)}{let b=sn(nn(n,i,i),e);if(De&&i&&/\s/.test(n.nodeValue[i-1])&&i<n.nodeValue.length){let S=sn(nn(n,i-1,i-1),-1);if(S.top==b.top){let O=sn(nn(n,i,i+1),-1);if(O.top!=b.top)return ni(O,O.left<S.left)}}return b}}if(!r.state.doc.resolve(t-(s||0)).parent.inlineContent){if(null==s&&i&&(e<0||i==Fe(n))){let b=n.childNodes[i-1];if(1==b.nodeType)return $i(b.getBoundingClientRect(),!1)}if(null==s&&i<Fe(n)){let b=n.childNodes[i];if(1==b.nodeType)return $i(b.getBoundingClientRect(),!0)}return $i(n.getBoundingClientRect(),e>=0)}if(null==s&&i&&(e<0||i==Fe(n))){let b=n.childNodes[i-1],S=3==b.nodeType?nn(b,Fe(b)-(c?0:1)):1!=b.nodeType||"BR"==b.nodeName&&b.nextSibling?null:b;if(S)return ni(sn(S,1),!1)}if(null==s&&i<Fe(n)){let b=n.childNodes[i];for(;b.pmViewDesc&&b.pmViewDesc.ignoreForCoords;)b=b.nextSibling;let S=b?3==b.nodeType?nn(b,0,c?0:1):1==b.nodeType?b:null:null;if(S)return ni(sn(S,-1),!0)}return ni(sn(3==n.nodeType?nn(n):n,-e),e>=0)}function ni(r,t){if(0==r.width)return r;let e=t?r.left:r.right;return{top:r.top,bottom:r.bottom,left:e,right:e}}function $i(r,t){if(0==r.height)return r;let e=t?r.top:r.bottom;return{top:e,bottom:e,left:r.left,right:r.right}}function Eo(r,t,e){let n=r.state,i=r.root.activeElement;n!=t&&r.updateState(t),i!=r.dom&&r.focus();try{return e()}finally{n!=t&&r.updateState(n),i!=r.dom&&i&&i.focus()}}const gc=/[\u0590-\u08ac]/;let Mo=null,To=null,No=!1;function vc(r,t,e){return Mo==t&&To==e?No:(Mo=t,To=e,No="up"==e||"down"==e?function Ul(r,t,e){let n=t.selection,i="up"==e?n.$from:n.$to;return Eo(r,t,()=>{let{node:s}=r.docView.domFromPos(i.pos,"up"==e?-1:1);for(;;){let p=r.docView.nearestDesc(s,!0);if(!p)break;if(p.node.isBlock){s=p.contentDOM||p.dom;break}s=p.dom.parentNode}let c=ua(r,i.pos,1);for(let p=s.firstChild;p;p=p.nextSibling){let b;if(1==p.nodeType)b=p.getClientRects();else{if(3!=p.nodeType)continue;b=nn(p,0,p.nodeValue.length).getClientRects()}for(let S=0;S<b.length;S++){let O=b[S];if(O.bottom>O.top+1&&("up"==e?c.top-O.top>2*(O.bottom-c.top):O.bottom-c.bottom>2*(c.bottom-O.top)))return!1}}return!0})}(r,t,e):function Jl(r,t,e){let{$head:n}=t.selection;if(!n.parent.isTextblock)return!1;let i=n.parentOffset,s=!i,c=i==n.parent.content.size,p=r.domSelection();return gc.test(n.parent.textContent)&&p.modify?Eo(r,t,()=>{let{focusNode:b,focusOffset:S,anchorNode:O,anchorOffset:B}=r.domSelectionRange(),U=p.caretBidiLevel;p.modify("move",e,"character");let J=n.depth?r.docView.domAfterPos(n.before()):r.dom,{focusNode:nt,focusOffset:ct}=r.domSelectionRange(),Ct=nt&&!J.contains(1==nt.nodeType?nt:nt.parentNode)||b==nt&&S==ct;try{p.collapse(O,B),b&&(b!=O||S!=B)&&p.extend&&p.extend(b,S)}catch{}return null!=U&&(p.caretBidiLevel=U),Ct}):"left"==e||"backward"==e?s:c}(r,t,e))}class ri{constructor(t,e,n,i){this.parent=t,this.children=e,this.dom=n,this.contentDOM=i,this.dirty=0,n.pmViewDesc=this}matchesWidget(t){return!1}matchesMark(t){return!1}matchesNode(t,e,n){return!1}matchesHack(t){return!1}parseRule(){return null}stopEvent(t){return!1}get size(){let t=0;for(let e=0;e<this.children.length;e++)t+=this.children[e].size;return t}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let t=0;t<this.children.length;t++)this.children[t].destroy()}posBeforeChild(t){for(let e=0,n=this.posAtStart;;e++){let i=this.children[e];if(i==t)return n;n+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(t,e,n){if(this.contentDOM&&this.contentDOM.contains(1==t.nodeType?t:t.parentNode)){if(n<0){let s,c;if(t==this.contentDOM)s=t.childNodes[e-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;s=t.previousSibling}for(;s&&(!(c=s.pmViewDesc)||c.parent!=this);)s=s.previousSibling;return s?this.posBeforeChild(c)+c.size:this.posAtStart}{let s,c;if(t==this.contentDOM)s=t.childNodes[e];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;s=t.nextSibling}for(;s&&(!(c=s.pmViewDesc)||c.parent!=this);)s=s.nextSibling;return s?this.posBeforeChild(c):this.posAtEnd}}let i;if(t==this.dom&&this.contentDOM)i=e>se(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=2&t.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==e)for(let s=t;;s=s.parentNode){if(s==this.dom){i=!1;break}if(s.previousSibling)break}if(null==i&&e==t.childNodes.length)for(let s=t;;s=s.parentNode){if(s==this.dom){i=!0;break}if(s.nextSibling)break}}return i??n>0?this.posAtEnd:this.posAtStart}nearestDesc(t,e=!1){for(let n=!0,i=t;i;i=i.parentNode){let c,s=this.getDesc(i);if(s&&(!e||s.node)){if(!n||!(c=s.nodeDOM)||(1==c.nodeType?c.contains(1==t.nodeType?t:t.parentNode):c==t))return s;n=!1}}}getDesc(t){let e=t.pmViewDesc;for(let n=e;n;n=n.parent)if(n==this)return e}posFromDOM(t,e,n){for(let i=t;i;i=i.parentNode){let s=this.getDesc(i);if(s)return s.localPosFromDOM(t,e,n)}return-1}descAt(t){for(let e=0,n=0;e<this.children.length;e++){let i=this.children[e],s=n+i.size;if(n==t&&s!=n){for(;!i.border&&i.children.length;)i=i.children[0];return i}if(t<s)return i.descAt(t-n-i.border);n=s}}domFromPos(t,e){if(!this.contentDOM)return{node:this.dom,offset:0,atom:t+1};let s,n=0,i=0;for(let s=0;n<this.children.length;n++){let c=this.children[n],p=s+c.size;if(p>t||c instanceof fa){i=t-s;break}s=p}if(i)return this.children[n].domFromPos(i-this.children[n].border,e);for(;n&&!(s=this.children[n-1]).size&&s instanceof ca&&s.side>=0;n--);if(e<=0){let s,c=!0;for(;s=n?this.children[n-1]:null,s&&s.dom.parentNode!=this.contentDOM;n--,c=!1);return s&&e&&c&&!s.border&&!s.domAtom?s.domFromPos(s.size,e):{node:this.contentDOM,offset:s?se(s.dom)+1:0}}{let s,c=!0;for(;s=n<this.children.length?this.children[n]:null,s&&s.dom.parentNode!=this.contentDOM;n++,c=!1);return s&&c&&!s.border&&!s.domAtom?s.domFromPos(0,e):{node:this.contentDOM,offset:s?se(s.dom):this.contentDOM.childNodes.length}}}parseRange(t,e,n=0){if(0==this.children.length)return{node:this.contentDOM,from:t,to:e,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,s=-1;for(let c=n,p=0;;p++){let b=this.children[p],S=c+b.size;if(-1==i&&t<=S){let O=c+b.border;if(t>=O&&e<=S-b.border&&b.node&&b.contentDOM&&this.contentDOM.contains(b.contentDOM))return b.parseRange(t,e,O);t=c;for(let B=p;B>0;B--){let U=this.children[B-1];if(U.size&&U.dom.parentNode==this.contentDOM&&!U.emptyChildAt(1)){i=se(U.dom)+1;break}t-=U.size}-1==i&&(i=0)}if(i>-1&&(S>e||p==this.children.length-1)){e=S;for(let O=p+1;O<this.children.length;O++){let B=this.children[O];if(B.size&&B.dom.parentNode==this.contentDOM&&!B.emptyChildAt(-1)){s=se(B.dom);break}e+=B.size}-1==s&&(s=this.contentDOM.childNodes.length);break}c=S}return{node:this.contentDOM,from:t,to:e,fromOffset:i,toOffset:s}}emptyChildAt(t){if(this.border||!this.contentDOM||!this.children.length)return!1;let e=this.children[t<0?0:this.children.length-1];return 0==e.size||e.emptyChildAt(t)}domAfterPos(t){let{node:e,offset:n}=this.domFromPos(t,0);if(1!=e.nodeType||n==e.childNodes.length)throw new RangeError("No node after pos "+t);return e.childNodes[n]}setSelection(t,e,n,i=!1){let s=Math.min(t,e),c=Math.max(t,e);for(let U=0,J=0;U<this.children.length;U++){let nt=this.children[U],ct=J+nt.size;if(s>J&&c<ct)return nt.setSelection(t-J-nt.border,e-J-nt.border,n,i);J=ct}let p=this.domFromPos(t,t?-1:1),b=e==t?p:this.domFromPos(e,e?-1:1),S=n.getSelection(),O=!1;if((De||Ce)&&t==e){let{node:U,offset:J}=p;if(3==U.nodeType){if(O=!(!J||"\n"!=U.nodeValue[J-1]),O&&J==U.nodeValue.length)for(let ct,nt=U;nt;nt=nt.parentNode){if(ct=nt.nextSibling){"BR"==ct.nodeName&&(p=b={node:ct.parentNode,offset:se(ct)+1});break}let Ct=nt.pmViewDesc;if(Ct&&Ct.node&&Ct.node.isBlock)break}}else{let nt=U.childNodes[J-1];O=nt&&("BR"==nt.nodeName||"false"==nt.contentEditable)}}if(De&&S.focusNode&&S.focusNode!=b.node&&1==S.focusNode.nodeType){let U=S.focusNode.childNodes[S.focusOffset];U&&"false"==U.contentEditable&&(i=!0)}if(!(i||O&&Ce)&&$e(p.node,p.offset,S.anchorNode,S.anchorOffset)&&$e(b.node,b.offset,S.focusNode,S.focusOffset))return;let B=!1;if((S.extend||t==e)&&!O){S.collapse(p.node,p.offset);try{t!=e&&S.extend(b.node,b.offset),B=!0}catch{}}if(!B){if(t>e){let J=p;p=b,b=J}let U=document.createRange();U.setEnd(b.node,b.offset),U.setStart(p.node,p.offset),S.removeAllRanges(),S.addRange(U)}}ignoreMutation(t){return!this.contentDOM&&"selection"!=t.type}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(t,e){for(let n=0,i=0;i<this.children.length;i++){let s=this.children[i],c=n+s.size;if(n==c?t<=c&&e>=n:t<c&&e>n){let p=n+s.border,b=c-s.border;if(t>=p&&e<=b)return this.dirty=t==n||e==c?2:1,void(t!=p||e!=b||!s.contentLost&&s.dom.parentNode==this.contentDOM?s.markDirty(t-p,e-p):s.dirty=3);s.dirty=s.dom!=s.contentDOM||s.dom.parentNode!=this.contentDOM||s.children.length?3:2}n=c}this.dirty=2}markParentsDirty(){let t=1;for(let e=this.parent;e;e=e.parent,t++){let n=1==t?2:1;e.dirty<n&&(e.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}}class ca extends ri{constructor(t,e,n,i){let s,c=e.type.toDOM;if("function"==typeof c&&(c=c(n,()=>s?s.parent?s.parent.posBeforeChild(s):void 0:i)),!e.type.spec.raw){if(1!=c.nodeType){let p=document.createElement("span");p.appendChild(c),c=p}c.contentEditable="false",c.classList.add("ProseMirror-widget")}super(t,[],c,null),this.widget=e,this.widget=e,s=this}matchesWidget(t){return 0==this.dirty&&t.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(t){let e=this.widget.spec.stopEvent;return!!e&&e(t)}ignoreMutation(t){return"selection"!=t.type||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class ha extends ri{constructor(t,e,n,i){super(t,[],e,null),this.textDOM=n,this.text=i}get size(){return this.text.length}localPosFromDOM(t,e){return t!=this.textDOM?this.posAtStart+(e?this.size:0):this.posAtStart+e}domFromPos(t){return{node:this.textDOM,offset:t}}ignoreMutation(t){return"characterData"===t.type&&t.target.nodeValue==t.oldValue}}class qn extends ri{constructor(t,e,n,i){super(t,[],n,i),this.mark=e}static create(t,e,n,i){let s=i.nodeViews[e.type.name],c=s&&s(e,i,n);return(!c||!c.dom)&&(c=qe.renderSpec(document,e.type.spec.toDOM(e,n))),new qn(t,e,c.dom,c.contentDOM||c.dom)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM||void 0}}matchesMark(t){return 3!=this.dirty&&this.mark.eq(t)}markDirty(t,e){if(super.markDirty(t,e),0!=this.dirty){let n=this.parent;for(;!n.node;)n=n.parent;n.dirty<this.dirty&&(n.dirty=this.dirty),this.dirty=0}}slice(t,e,n){let i=qn.create(this.parent,this.mark,!0,n),s=this.children,c=this.size;e<c&&(s=Oo(s,e,c,n)),t>0&&(s=Oo(s,0,t,n));for(let p=0;p<s.length;p++)s[p].parent=i;return i.children=s,i}}class tr extends ri{constructor(t,e,n,i,s,c,p,b,S){super(t,[],s,c),this.node=e,this.outerDeco=n,this.innerDeco=i,this.nodeDOM=p,c&&this.updateChildren(b,S)}static create(t,e,n,i,s,c){let b,p=s.nodeViews[e.type.name],S=p&&p(e,s,()=>b?b.parent?b.parent.posBeforeChild(b):void 0:c,n,i),O=S&&S.dom,B=S&&S.contentDOM;if(e.isText)if(O){if(3!=O.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else O=document.createTextNode(e.text);else O||({dom:O,contentDOM:B}=qe.renderSpec(document,e.type.spec.toDOM(e)));!B&&!e.isText&&"BR"!=O.nodeName&&(O.hasAttribute("contenteditable")||(O.contentEditable="false"),e.type.spec.draggable&&(O.draggable=!0));let U=O;return O=ga(O,n,e),S?b=new $l(t,e,n,i,O,B||null,U,S,s,c+1):e.isText?new Wi(t,e,n,i,O,U,s):new tr(t,e,n,i,O,B||null,U,s,c+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let t={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(t.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(let e=this.children.length-1;e>=0;e--){let n=this.children[e];if(this.dom.contains(n.dom.parentNode)){t.contentElement=n.dom.parentNode;break}}t.contentElement||(t.getContent=()=>F.empty)}else t.contentElement=this.contentDOM;else t.getContent=()=>this.node.content;return t}matchesNode(t,e,n){return 0==this.dirty&&t.eq(this.node)&&Io(e,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(t,e){let n=this.node.inlineContent,i=e,s=t.composing?this.localCompositionInfo(t,e):null,c=s&&s.pos>-1?s:null,p=s&&s.pos<0,b=new Wl(this,c&&c.node,t);(function Ql(r,t,e,n){let i=t.locals(r),s=0;if(0==i.length){for(let S=0;S<r.childCount;S++){let O=r.child(S);n(O,i,t.forChild(s,O),S),s+=O.nodeSize}return}let c=0,p=[],b=null;for(let S=0;;){if(c<i.length&&i[c].to==s){let ct,nt=i[c++];for(;c<i.length&&i[c].to==s;)(ct||(ct=[nt])).push(i[c++]);if(ct){ct.sort(Kl);for(let Ct=0;Ct<ct.length;Ct++)e(ct[Ct],S,!!b)}else e(nt,S,!!b)}let O,B;if(b)B=-1,O=b,b=null;else{if(!(S<r.childCount))break;B=S,O=r.child(S++)}for(let nt=0;nt<p.length;nt++)p[nt].to<=s&&p.splice(nt--,1);for(;c<i.length&&i[c].from<=s&&i[c].to>s;)p.push(i[c++]);let U=s+O.nodeSize;if(O.isText){let nt=U;c<i.length&&i[c].from<nt&&(nt=i[c].from);for(let ct=0;ct<p.length;ct++)p[ct].to<nt&&(nt=p[ct].to);nt<U&&(b=O.cut(nt-s),O=O.cut(0,nt-s),U=nt,B=-1)}n(O,O.isInline&&!O.isLeaf?p.filter(nt=>!nt.inline):p.slice(),t.forChild(s,O),B),s=U}})(this.node,this.innerDeco,(S,O,B)=>{S.spec.marks?b.syncToMarks(S.spec.marks,n,t):S.type.side>=0&&!B&&b.syncToMarks(O==this.node.childCount?W.none:this.node.child(O).marks,n,t),b.placeWidget(S,t,i)},(S,O,B,U)=>{let J;b.syncToMarks(S.marks,n,t),b.findNodeMatch(S,O,B,U)||p&&t.state.selection.from>i&&t.state.selection.to<i+S.nodeSize&&(J=b.findIndexWithChild(s.node))>-1&&b.updateNodeAt(S,O,B,J,t)||b.updateNextNode(S,O,B,t,U)||b.addNode(S,O,B,t,i),i+=S.nodeSize}),b.syncToMarks([],n,t),this.node.isTextblock&&b.addTextblockHacks(),b.destroyRest(),(b.changed||2==this.dirty)&&(c&&this.protectLocalComposition(t,c),pa(this.contentDOM,this.children,t),br&&function Xl(r){if("UL"==r.nodeName||"OL"==r.nodeName){let t=r.style.cssText;r.style.cssText=t+"; list-style: square !important",window.getComputedStyle(r).listStyle,r.style.cssText=t}}(this.dom))}localCompositionInfo(t,e){let{from:n,to:i}=t.state.selection;if(!(t.state.selection instanceof Kt)||n<e||i>e+this.node.content.size)return null;let s=t.domSelectionRange(),c=function ql(r,t){for(;;){if(3==r.nodeType)return r;if(1==r.nodeType&&t>0){if(r.childNodes.length>t&&3==r.childNodes[t].nodeType)return r.childNodes[t];t=Fe(r=r.childNodes[t-1])}else{if(!(1==r.nodeType&&t<r.childNodes.length))return null;r=r.childNodes[t],t=0}}}(s.focusNode,s.focusOffset);if(!c||!this.dom.contains(c.parentNode))return null;if(this.node.inlineContent){let p=c.nodeValue,b=function tu(r,t,e,n){for(let i=0,s=0;i<r.childCount&&s<=n;){let c=r.child(i++),p=s;if(s+=c.nodeSize,!c.isText)continue;let b=c.text;for(;i<r.childCount;){let S=r.child(i++);if(s+=S.nodeSize,!S.isText)break;b+=S.text}if(s>=e){let S=p<n?b.lastIndexOf(t,n-p-1):-1;if(S>=0&&S+t.length+p>=e)return p+S;if(e==n&&b.length>=n+t.length-p&&b.slice(n-p,n-p+t.length)==t)return n}}return-1}(this.node.content,p,n-e,i-e);return b<0?null:{node:c,pos:b,text:p}}return{node:c,pos:-1,text:""}}protectLocalComposition(t,{node:e,pos:n,text:i}){if(this.getDesc(e))return;let s=e;for(;s.parentNode!=this.contentDOM;s=s.parentNode){for(;s.previousSibling;)s.parentNode.removeChild(s.previousSibling);for(;s.nextSibling;)s.parentNode.removeChild(s.nextSibling);s.pmViewDesc&&(s.pmViewDesc=void 0)}let c=new ha(this,s,e,i);t.input.compositionNodes.push(c),this.children=Oo(this.children,n,n+i.length,t,c)}update(t,e,n,i){return!(3==this.dirty||!t.sameMarkup(this.node))&&(this.updateInner(t,e,n,i),!0)}updateInner(t,e,n,i){this.updateOuterDeco(e),this.node=t,this.innerDeco=n,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=0}updateOuterDeco(t){if(Io(t,this.outerDeco))return;let e=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=ma(this.dom,this.nodeDOM,So(this.outerDeco,this.node,e),So(t,this.node,e)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=t}selectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable")}get domAtom(){return this.node.isAtom}}function da(r,t,e,n,i){return ga(n,t,r),new tr(void 0,r,t,e,n,n,n,i,0)}class Wi extends tr{constructor(t,e,n,i,s,c,p){super(t,e,n,i,s,null,c,p,0)}parseRule(){let t=this.nodeDOM.parentNode;for(;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}}update(t,e,n,i){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!t.sameMarkup(this.node))&&(this.updateOuterDeco(e),(0!=this.dirty||t.text!=this.node.text)&&t.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=t.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=t,this.dirty=0,!0)}inParent(){let t=this.parent.contentDOM;for(let e=this.nodeDOM;e;e=e.parentNode)if(e==t)return!0;return!1}domFromPos(t){return{node:this.nodeDOM,offset:t}}localPosFromDOM(t,e,n){return t==this.nodeDOM?this.posAtStart+Math.min(e,this.node.text.length):super.localPosFromDOM(t,e,n)}ignoreMutation(t){return"characterData"!=t.type&&"selection"!=t.type}slice(t,e,n){let i=this.node.cut(t,e),s=document.createTextNode(i.text);return new Wi(this.parent,i,this.outerDeco,this.innerDeco,s,s,n)}markDirty(t,e){super.markDirty(t,e),this.dom!=this.nodeDOM&&(0==t||e==this.nodeDOM.nodeValue.length)&&(this.dirty=3)}get domAtom(){return!1}}class fa extends ri{parseRule(){return{ignore:!0}}matchesHack(t){return 0==this.dirty&&this.dom.nodeName==t}get domAtom(){return!0}get ignoreForCoords(){return"IMG"==this.dom.nodeName}}class $l extends tr{constructor(t,e,n,i,s,c,p,b,S,O){super(t,e,n,i,s,c,p,S,O),this.spec=b}update(t,e,n,i){if(3==this.dirty)return!1;if(this.spec.update){let s=this.spec.update(t,e,n);return s&&this.updateInner(t,e,n,i),s}return!(!this.contentDOM&&!t.isLeaf)&&super.update(t,e,n,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(t,e,n,i){this.spec.setSelection?this.spec.setSelection(t,e,n):super.setSelection(t,e,n,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(t){return!!this.spec.stopEvent&&this.spec.stopEvent(t)}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}}function pa(r,t,e){let n=r.firstChild,i=!1;for(let s=0;s<t.length;s++){let c=t[s],p=c.dom;if(p.parentNode==r){for(;p!=n;)n=va(n),i=!0;n=n.nextSibling}else i=!0,r.insertBefore(p,n);if(c instanceof qn){let b=n?n.previousSibling:r.lastChild;pa(c.contentDOM,c.children,e),n=b?b.nextSibling:r.firstChild}}for(;n;)n=va(n),i=!0;i&&e.trackWrites==r&&(e.trackWrites=null)}const ii=function(r){r&&(this.nodeName=r)};ii.prototype=Object.create(null);const er=[new ii];function So(r,t,e){if(0==r.length)return er;let n=e?er[0]:new ii,i=[n];for(let s=0;s<r.length;s++){let c=r[s].type.attrs;if(c){c.nodeName&&i.push(n=new ii(c.nodeName));for(let p in c){let b=c[p];null!=b&&(e&&1==i.length&&i.push(n=new ii(t.isInline?"span":"div")),"class"==p?n.class=(n.class?n.class+" ":"")+b:"style"==p?n.style=(n.style?n.style+";":"")+b:"nodeName"!=p&&(n[p]=b))}}}return i}function ma(r,t,e,n){if(e==er&&n==er)return t;let i=t;for(let s=0;s<n.length;s++){let c=n[s],p=e[s];if(s){let b;p&&p.nodeName==c.nodeName&&i!=r&&(b=i.parentNode)&&b.nodeName.toLowerCase()==c.nodeName||(b=document.createElement(c.nodeName),b.pmIsDeco=!0,b.appendChild(i),p=er[0]),i=b}Yl(i,p||er[0],c)}return i}function Yl(r,t,e){for(let n in t)"class"!=n&&"style"!=n&&"nodeName"!=n&&!(n in e)&&r.removeAttribute(n);for(let n in e)"class"!=n&&"style"!=n&&"nodeName"!=n&&e[n]!=t[n]&&r.setAttribute(n,e[n]);if(t.class!=e.class){let n=t.class?t.class.split(" ").filter(Boolean):[],i=e.class?e.class.split(" ").filter(Boolean):[];for(let s=0;s<n.length;s++)-1==i.indexOf(n[s])&&r.classList.remove(n[s]);for(let s=0;s<i.length;s++)-1==n.indexOf(i[s])&&r.classList.add(i[s]);0==r.classList.length&&r.removeAttribute("class")}if(t.style!=e.style){if(t.style){let i,n=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;for(;i=n.exec(t.style);)r.style.removeProperty(i[1])}e.style&&(r.style.cssText+=e.style)}}function ga(r,t,e){return ma(r,r,er,So(t,e,1!=r.nodeType))}function Io(r,t){if(r.length!=t.length)return!1;for(let e=0;e<r.length;e++)if(!r[e].type.eq(t[e].type))return!1;return!0}function va(r){let t=r.nextSibling;return r.parentNode.removeChild(r),t}class Wl{constructor(t,e,n){this.lock=e,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=t,this.preMatch=function jl(r,t){let e=t,n=e.children.length,i=r.childCount,s=new Map,c=[];t:for(;i>0;){let p;for(;;)if(n){let S=e.children[n-1];if(!(S instanceof qn)){p=S,n--;break}e=S,n=S.children.length}else{if(e==t)break t;n=e.parent.children.indexOf(e),e=e.parent}let b=p.node;if(b){if(b!=r.child(i-1))break;--i,s.set(p,i),c.push(p)}}return{index:i,matched:s,matches:c.reverse()}}(t.node.content,t)}destroyBetween(t,e){if(t!=e){for(let n=t;n<e;n++)this.top.children[n].destroy();this.top.children.splice(t,e-t),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(t,e,n){let i=0,s=this.stack.length>>1,c=Math.min(s,t.length);for(;i<c&&(i==s-1?this.top:this.stack[i+1<<1]).matchesMark(t[i])&&!1!==t[i].type.spec.spanning;)i++;for(;i<s;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),s--;for(;s<t.length;){this.stack.push(this.top,this.index+1);let p=-1;for(let b=this.index;b<Math.min(this.index+3,this.top.children.length);b++){let S=this.top.children[b];if(S.matchesMark(t[s])&&!this.isLocked(S.dom)){p=b;break}}if(p>-1)p>this.index&&(this.changed=!0,this.destroyBetween(this.index,p)),this.top=this.top.children[this.index];else{let b=qn.create(this.top,t[s],e,n);this.top.children.splice(this.index,0,b),this.top=b,this.changed=!0}this.index=0,s++}}findNodeMatch(t,e,n,i){let c,s=-1;if(i>=this.preMatch.index&&(c=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&c.matchesNode(t,e,n))s=this.top.children.indexOf(c,this.index);else for(let p=this.index,b=Math.min(this.top.children.length,p+5);p<b;p++){let S=this.top.children[p];if(S.matchesNode(t,e,n)&&!this.preMatch.matched.has(S)){s=p;break}}return!(s<0)&&(this.destroyBetween(this.index,s),this.index++,!0)}updateNodeAt(t,e,n,i,s){let c=this.top.children[i];return 3==c.dirty&&c.dom==c.contentDOM&&(c.dirty=2),!!c.update(t,e,n,s)&&(this.destroyBetween(this.index,i),this.index++,!0)}findIndexWithChild(t){for(;;){let e=t.parentNode;if(!e)return-1;if(e==this.top.contentDOM){let n=t.pmViewDesc;if(n)for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==n)return i;return-1}t=e}}updateNextNode(t,e,n,i,s){for(let c=this.index;c<this.top.children.length;c++){let p=this.top.children[c];if(p instanceof tr){let b=this.preMatch.matched.get(p);if(null!=b&&b!=s)return!1;let S=p.dom;if((!this.isLocked(S)||t.isText&&p.node&&p.node.isText&&p.nodeDOM.nodeValue==t.text&&3!=p.dirty&&Io(e,p.outerDeco))&&p.update(t,e,n,i))return this.destroyBetween(this.index,c),p.dom!=S&&(this.changed=!0),this.index++,!0;break}}return!1}addNode(t,e,n,i,s){this.top.children.splice(this.index++,0,tr.create(this.top,t,e,n,i,s)),this.changed=!0}placeWidget(t,e,n){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(!i||!i.matchesWidget(t)||t!=i.widget&&i.widget.type.toDOM.parentNode){let s=new ca(this.top,t,e,n);this.top.children.splice(this.index++,0,s),this.changed=!0}else this.index++}addTextblockHacks(){let t=this.top.children[this.index-1],e=this.top;for(;t instanceof qn;)e=t,t=e.children[e.children.length-1];(!t||!(t instanceof Wi)||/\n$/.test(t.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(t.node.text))&&((Ce||de)&&t&&"false"==t.dom.contentEditable&&this.addHackNode("IMG",e),this.addHackNode("BR",this.top))}addHackNode(t,e){if(e==this.top&&this.index<e.children.length&&e.children[this.index].matchesHack(t))this.index++;else{let n=document.createElement(t);"IMG"==t&&(n.className="ProseMirror-separator",n.alt=""),"BR"==t&&(n.className="ProseMirror-trailingBreak");let i=new fa(this.top,[],n,null);e!=this.top?e.children.push(i):e.children.splice(this.index++,0,i),this.changed=!0}}isLocked(t){return this.lock&&(t==this.lock||1==t.nodeType&&t.contains(this.lock.parentNode))}}function Kl(r,t){return r.type.side-t.type.side}function Oo(r,t,e,n,i){let s=[];for(let c=0,p=0;c<r.length;c++){let b=r[c],S=p,O=p+=b.size;S>=e||O<=t?s.push(b):(S<t&&s.push(b.slice(0,t-S,n)),i&&(s.push(i),i=void 0),O>e&&s.push(b.slice(e-S,b.size,n)))}return s}function Ao(r,t=null){let e=r.domSelectionRange(),n=r.state.doc;if(!e.focusNode)return null;let i=r.docView.nearestDesc(e.focusNode),s=i&&0==i.size,c=r.docView.posFromDOM(e.focusNode,e.focusOffset,1);if(c<0)return null;let b,S,p=n.resolve(c);if(qr(e)){for(b=p;i&&!i.node;)i=i.parent;let O=i.node;if(i&&O.isAtom&&Vt.isSelectable(O)&&i.parent&&(!O.isInline||!function zl(r,t,e){for(let n=0==t,i=t==Fe(r);n||i;){if(r==e)return!0;let s=se(r);if(!(r=r.parentNode))return!1;n=n&&0==s,i=i&&s==Fe(r)}}(e.focusNode,e.focusOffset,i.dom))){let B=i.posBefore;S=new Vt(c==B?p:n.resolve(B))}}else{let O=r.docView.posFromDOM(e.anchorNode,e.anchorOffset,1);if(O<0)return null;b=n.resolve(O)}if(!S){S=Lo(r,b,p,"pointer"==t||r.state.selection.head<p.pos&&!s?1:-1)}return S}function ya(r){return r.editable?r.hasFocus():ka(r)&&document.activeElement&&document.activeElement.contains(r.dom)}function xn(r,t=!1){let e=r.state.selection;if(Po(r,e),ya(r)){if(!t&&r.input.mouseDown&&r.input.mouseDown.allowDefault&&de){let n=r.domSelectionRange(),i=r.domObserver.currentSelection;if(n.anchorNode&&i.anchorNode&&$e(n.anchorNode,n.anchorOffset,i.anchorNode,i.anchorOffset))return r.input.mouseDown.delayedSelectionSync=!0,void r.domObserver.setCurSelection()}if(r.domObserver.disconnectSelection(),r.cursorWrapper)!function nu(r){let t=r.domSelection(),e=document.createRange(),n=r.cursorWrapper.dom,i="IMG"==n.nodeName;i?e.setEnd(n.parentNode,se(n)+1):e.setEnd(n,0),e.collapse(!1),t.removeAllRanges(),t.addRange(e),!i&&!r.state.selection.visible&&me&&Be<=11&&(n.disabled=!0,n.disabled=!1)}(r);else{let s,c,{anchor:n,head:i}=e;xa&&!(e instanceof Kt)&&(e.$from.parent.inlineContent||(s=_a(r,e.from)),!e.empty&&!e.$from.parent.inlineContent&&(c=_a(r,e.to))),r.docView.setSelection(n,i,r.root,t),xa&&(s&&wa(s),c&&wa(c)),e.visible?r.dom.classList.remove("ProseMirror-hideselection"):(r.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function eu(r){let t=r.dom.ownerDocument;t.removeEventListener("selectionchange",r.input.hideSelectionGuard);let e=r.domSelectionRange(),n=e.anchorNode,i=e.anchorOffset;t.addEventListener("selectionchange",r.input.hideSelectionGuard=()=>{(e.anchorNode!=n||e.anchorOffset!=i)&&(t.removeEventListener("selectionchange",r.input.hideSelectionGuard),setTimeout(()=>{(!ya(r)||r.state.selection.visible)&&r.dom.classList.remove("ProseMirror-hideselection")},20))})}(r))}r.domObserver.setCurSelection(),r.domObserver.connectSelection()}}const xa=Ce||de&&rn<63;function _a(r,t){let{node:e,offset:n}=r.docView.domFromPos(t,0),i=n<e.childNodes.length?e.childNodes[n]:null,s=n?e.childNodes[n-1]:null;if(Ce&&i&&"false"==i.contentEditable)return Do(i);if(!(i&&"false"!=i.contentEditable||s&&"false"!=s.contentEditable)){if(i)return Do(i);if(s)return Do(s)}}function Do(r){return r.contentEditable="true",Ce&&r.draggable&&(r.draggable=!1,r.wasDraggable=!0),r}function wa(r){r.contentEditable="false",r.wasDraggable&&(r.draggable=!0,r.wasDraggable=null)}function Po(r,t){if(t instanceof Vt){let e=r.docView.descAt(t.from);e!=r.lastSelectedViewDesc&&(ba(r),e&&e.selectNode(),r.lastSelectedViewDesc=e)}else ba(r)}function ba(r){r.lastSelectedViewDesc&&(r.lastSelectedViewDesc.parent&&r.lastSelectedViewDesc.deselectNode(),r.lastSelectedViewDesc=void 0)}function Lo(r,t,e,n){return r.someProp("createSelectionBetween",i=>i(r,t,e))||Kt.between(t,e,n)}function Ca(r){return!(r.editable&&!r.hasFocus())&&ka(r)}function ka(r){let t=r.domSelectionRange();if(!t.anchorNode)return!1;try{return r.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(r.editable||r.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch{return!1}}function Fo(r,t){let{$anchor:e,$head:n}=r.selection,i=t>0?e.max(n):e.min(n),s=i.parent.inlineContent?i.depth?r.doc.resolve(t>0?i.after():i.before()):null:i;return s&&Gt.findFrom(s,t)}function nr(r,t){return r.dispatch(r.state.tr.setSelection(t).scrollIntoView()),!0}function Ea(r,t,e){let n=r.state.selection;if(!(n instanceof Kt)){if(n instanceof Vt&&n.node.isInline)return nr(r,new Kt(t>0?n.$to:n.$from));{let i=Fo(r.state,t);return!!i&&nr(r,i)}}if(!n.empty||e.indexOf("s")>-1)return!1;if(r.endOfTextblock(t>0?"right":"left")){let i=Fo(r.state,t);return!!(i&&i instanceof Vt)&&nr(r,i)}if(!(ze&&e.indexOf("m")>-1)){let c,i=n.$head,s=i.textOffset?null:t<0?i.nodeBefore:i.nodeAfter;if(!s||s.isText)return!1;let p=t<0?i.pos-s.nodeSize:i.pos;return!!(s.isAtom||(c=r.docView.descAt(p))&&!c.contentDOM)&&(Vt.isSelectable(s)?nr(r,new Vt(t<0?r.state.doc.resolve(i.pos-s.nodeSize):i)):!!Gi&&nr(r,new Kt(r.state.doc.resolve(t<0?p:p+s.nodeSize))))}}function ji(r){return 3==r.nodeType?r.nodeValue.length:r.childNodes.length}function oi(r){let t=r.pmViewDesc;return t&&0==t.size&&(r.nextSibling||"BR"!=r.nodeName)}function Ro(r){let t=r.domSelectionRange(),e=t.focusNode,n=t.focusOffset;if(!e)return;let i,s,c=!1;for(De&&1==e.nodeType&&n<ji(e)&&oi(e.childNodes[n])&&(c=!0);;)if(n>0){if(1!=e.nodeType)break;{let p=e.childNodes[n-1];if(oi(p))i=e,s=--n;else{if(3!=p.nodeType)break;e=p,n=e.nodeValue.length}}}else{if(Ma(e))break;{let p=e.previousSibling;for(;p&&oi(p);)i=e.parentNode,s=se(p),p=p.previousSibling;if(p)e=p,n=ji(e);else{if(e=e.parentNode,e==r.dom)break;n=0}}}c?zo(r,e,n):i&&zo(r,i,s)}function Bo(r){let t=r.domSelectionRange(),e=t.focusNode,n=t.focusOffset;if(!e)return;let s,c,i=ji(e);for(;;)if(n<i){if(1!=e.nodeType)break;if(!oi(e.childNodes[n]))break;s=e,c=++n}else{if(Ma(e))break;{let p=e.nextSibling;for(;p&&oi(p);)s=p.parentNode,c=se(p)+1,p=p.nextSibling;if(p)e=p,n=0,i=ji(e);else{if(e=e.parentNode,e==r.dom)break;n=i=0}}}s&&zo(r,s,c)}function Ma(r){let t=r.pmViewDesc;return t&&t.node&&t.node.isBlock}function zo(r,t,e){let n=r.domSelection();if(qr(n)){let s=document.createRange();s.setEnd(t,e),s.setStart(t,e),n.removeAllRanges(),n.addRange(s)}else n.extend&&n.extend(t,e);r.domObserver.setCurSelection();let{state:i}=r;setTimeout(()=>{r.state==i&&xn(r)},50)}function Ta(r,t,e){let n=r.state.selection;if(n instanceof Kt&&!n.empty||e.indexOf("s")>-1||ze&&e.indexOf("m")>-1)return!1;let{$from:i,$to:s}=n;if(!i.parent.inlineContent||r.endOfTextblock(t<0?"up":"down")){let c=Fo(r.state,t);if(c&&c instanceof Vt)return nr(r,c)}if(!i.parent.inlineContent){let c=t<0?i:s,p=n instanceof be?Gt.near(c,t):Gt.findFrom(c,t);return!!p&&nr(r,p)}return!1}function Na(r,t){if(!(r.state.selection instanceof Kt))return!0;let{$head:e,$anchor:n,empty:i}=r.state.selection;if(!e.sameParent(n))return!0;if(!i)return!1;if(r.endOfTextblock(t>0?"forward":"backward"))return!0;let s=!e.textOffset&&(t<0?e.nodeBefore:e.nodeAfter);if(s&&!s.isText){let c=r.state.tr;return t<0?c.delete(e.pos-s.nodeSize,e.pos):c.delete(e.pos,e.pos+s.nodeSize),r.dispatch(c),!0}return!1}function un(r,t,e){r.domObserver.stop(),t.contentEditable=e,r.domObserver.start()}function Er(r,t){let e=t.keyCode,n=function Sa(r){let t="";return r.ctrlKey&&(t+="c"),r.metaKey&&(t+="m"),r.altKey&&(t+="a"),r.shiftKey&&(t+="s"),t}(t);return 8==e||ze&&72==e&&"c"==n?Na(r,-1)||Ro(r):46==e||ze&&68==e&&"c"==n?Na(r,1)||Bo(r):13==e||27==e||(37==e||ze&&66==e&&"c"==n?Ea(r,-1,n)||Ro(r):39==e||ze&&70==e&&"c"==n?Ea(r,1,n)||Bo(r):38==e||ze&&80==e&&"c"==n?Ta(r,-1,n)||Ro(r):40==e||ze&&78==e&&"c"==n?function iu(r){if(!Ce||r.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:e}=r.domSelectionRange();if(t&&1==t.nodeType&&0==e&&t.firstChild&&"false"==t.firstChild.contentEditable){let n=t.firstChild;un(r,n,"true"),setTimeout(()=>un(r,n,"false"),20)}return!1}(r)||Ta(r,1,n)||Bo(r):n==(ze?"m":"c")&&(66==e||73==e||89==e||90==e))}function ou(r,t){r.someProp("transformCopied",J=>{t=J(t,r)});let e=[],{content:n,openStart:i,openEnd:s}=t;for(;i>1&&s>1&&1==n.childCount&&1==n.firstChild.childCount;){i--,s--;let J=n.firstChild;e.push(J.type.name,J.attrs!=J.type.defaultAttrs?J.attrs:null),n=J.content}let c=r.someProp("clipboardSerializer")||qe.fromSchema(r.state.schema),p=Uo(),b=p.createElement("div");b.appendChild(c.serializeFragment(n,{document:p}));let O,S=b.firstChild,B=0;for(;S&&1==S.nodeType&&(O=Zo[S.nodeName.toLowerCase()]);){for(let J=O.length-1;J>=0;J--){let nt=p.createElement(O[J]);for(;b.firstChild;)nt.appendChild(b.firstChild);b.appendChild(nt),B++}S=b.firstChild}return S&&1==S.nodeType&&S.setAttribute("data-pm-slice",`${i} ${s}${B?` -${B}`:""} ${JSON.stringify(e)}`),{dom:b,text:r.someProp("clipboardTextSerializer",J=>J(t,r))||t.content.textBetween(0,t.content.size,"\n\n")}}function su(r,t,e,n,i){let c,p,s=i.parent.type.spec.code;if(!e&&!t)return null;let b=t&&(n||s||!e);if(b){if(r.someProp("transformPastedText",U=>{t=U(t,s||n,r)}),s)return t?new ot(F.from(r.state.schema.text(t.replace(/\r\n?/g,"\n"))),0,0):ot.empty;let B=r.someProp("clipboardTextParser",U=>U(t,i,n,r));if(B)p=B;else{let U=i.marks(),{schema:J}=r.state,nt=qe.fromSchema(J);c=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(ct=>{let Ct=c.appendChild(document.createElement("p"));ct&&Ct.appendChild(nt.serializeNode(J.text(ct,U)))})}}else r.someProp("transformPastedHTML",B=>{e=B(e,r)}),c=function lu(r){let t=/^(\s*<meta [^>]*>)*/.exec(r);t&&(r=r.slice(t[0].length));let i,e=Uo().createElement("div"),n=/<([a-z][^>\s]+)/i.exec(r);if((i=n&&Zo[n[1].toLowerCase()])&&(r=i.map(s=>"<"+s+">").join("")+r+i.map(s=>"</"+s+">").reverse().join("")),e.innerHTML=r,i)for(let s=0;s<i.length;s++)e=e.querySelector(i[s])||e;return e}(e),Gi&&function uu(r){let t=r.querySelectorAll(de?"span:not([class]):not([style])":"span.Apple-converted-space");for(let e=0;e<t.length;e++){let n=t[e];1==n.childNodes.length&&"\xa0"==n.textContent&&n.parentNode&&n.parentNode.replaceChild(r.ownerDocument.createTextNode(" "),n)}}(c);let S=c&&c.querySelector("[data-pm-slice]"),O=S&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(S.getAttribute("data-pm-slice")||"");if(O&&O[3])for(let B=+O[3];B>0;B--){let U=c.firstChild;for(;U&&1!=U.nodeType;)U=U.nextSibling;if(!U)break;c=U}if(p||(p=(r.someProp("clipboardParser")||r.someProp("domParser")||$n.fromSchema(r.state.schema)).parseSlice(c,{preserveWhitespace:!(!b&&!O),context:i,ruleFromNode:U=>"BR"!=U.nodeName||U.nextSibling||!U.parentNode||au.test(U.parentNode.nodeName)?null:{ignore:!0}})),O)p=function cu(r,t){if(!r.size)return r;let n,e=r.content.firstChild.type.schema;try{n=JSON.parse(t)}catch{return r}let{content:i,openStart:s,openEnd:c}=r;for(let p=n.length-2;p>=0;p-=2){let b=e.nodes[n[p]];if(!b||b.hasRequiredAttrs())break;i=F.from(b.create(n[p+1],i)),s++,c++}return new ot(i,s,c)}(Vo(p,+O[1],+O[2]),O[4]);else if(p=ot.maxOpen(function Ho(r,t){if(r.childCount<2)return r;for(let e=t.depth;e>=0;e--){let s,i=t.node(e).contentMatchAt(t.index(e)),c=[];if(r.forEach(p=>{if(!c)return;let S,b=i.findWrapping(p.type);if(!b)return c=null;if(S=c.length&&s.length&&Oa(b,s,p,c[c.length-1],0))c[c.length-1]=S;else{c.length&&(c[c.length-1]=Aa(c[c.length-1],s.length));let O=Ia(p,b);c.push(O),i=i.matchType(O.type),s=b}}),c)return F.from(c)}return r}(p.content,i),!0),p.openStart||p.openEnd){let B=0,U=0;for(let J=p.content.firstChild;B<p.openStart&&!J.type.spec.isolating;B++,J=J.firstChild);for(let J=p.content.lastChild;U<p.openEnd&&!J.type.spec.isolating;U++,J=J.lastChild);p=Vo(p,B,U)}return r.someProp("transformPasted",B=>{p=B(p,r)}),p}const au=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Ia(r,t,e=0){for(let n=t.length-1;n>=e;n--)r=t[n].create(null,F.from(r));return r}function Oa(r,t,e,n,i){if(i<r.length&&i<t.length&&r[i]==t[i]){let s=Oa(r,t,e,n.lastChild,i+1);if(s)return n.copy(n.content.replaceChild(n.childCount-1,s));if(n.contentMatchAt(n.childCount).matchType(i==r.length-1?e.type:r[i+1]))return n.copy(n.content.append(F.from(Ia(e,r,i+1))))}}function Aa(r,t){if(0==t)return r;let e=r.content.replaceChild(r.childCount-1,Aa(r.lastChild,t-1)),n=r.contentMatchAt(r.childCount).fillBefore(F.empty,!0);return r.copy(e.append(n))}function Da(r,t,e,n,i,s){let c=t<0?r.firstChild:r.lastChild,p=c.content;return i<n-1&&(p=Da(p,t,e,n,i+1,s)),i>=e&&(p=t<0?c.contentMatchAt(0).fillBefore(p,r.childCount>1||s<=i).append(p):p.append(c.contentMatchAt(c.childCount).fillBefore(F.empty,!0))),r.replaceChild(t<0?0:r.childCount-1,c.copy(p))}function Vo(r,t,e){return t<r.openStart&&(r=new ot(Da(r.content,-1,t,r.openStart,0,r.openEnd),t,r.openEnd)),e<r.openEnd&&(r=new ot(Da(r.content,1,e,r.openEnd,0,0),r.openStart,e)),r}const Zo={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Go=null;function Uo(){return Go||(Go=document.implementation.createHTMLDocument("title"))}const ke={},Ee={},Mr={touchstart:!0,touchmove:!0};class hu{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastAndroidDelete=0,this.composing=!1,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function Rn(r,t){r.input.lastSelectionOrigin=t,r.input.lastSelectionTime=Date.now()}function Jo(r){r.someProp("handleDOMEvents",t=>{for(let e in t)r.input.eventHandlers[e]||r.dom.addEventListener(e,r.input.eventHandlers[e]=n=>$o(r,n))})}function $o(r,t){return r.someProp("handleDOMEvents",e=>{let n=e[t.type];return!!n&&(n(r,t)||t.defaultPrevented)})}function xc(r,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let e=t.target;e!=r.dom;e=e.parentNode)if(!e||11==e.nodeType||e.pmViewDesc&&e.pmViewDesc.stopEvent(t))return!1;return!0}function Ki(r){return{left:r.clientX,top:r.clientY}}function Yo(r,t,e,n,i){if(-1==n)return!1;let s=r.state.doc.resolve(n);for(let c=s.depth+1;c>0;c--)if(r.someProp(t,p=>c>s.depth?p(r,e,s.nodeAfter,s.before(c),i,!0):p(r,e,s.node(c),s.before(c),i,!1)))return!0;return!1}function si(r,t,e){r.focused||r.focus();let n=r.state.tr.setSelection(t);"pointer"==e&&n.setMeta("pointer",!0),r.dispatch(n)}function La(r,t,e,n,i){return Yo(r,"handleClickOn",t,e,n)||r.someProp("handleClick",s=>s(r,t,n))||(i?function pu(r,t){if(-1==t)return!1;let n,i,e=r.state.selection;e instanceof Vt&&(n=e.node);let s=r.state.doc.resolve(t);for(let c=s.depth+1;c>0;c--){let p=c>s.depth?s.nodeAfter:s.node(c);if(Vt.isSelectable(p)){i=n&&e.$from.depth>0&&c>=e.$from.depth&&s.before(e.$from.depth+1)==e.$from.pos?s.before(e.$from.depth):s.before(c);break}}return null!=i&&(si(r,Vt.create(r.state.doc,i),"pointer"),!0)}(r,e):function _c(r,t){if(-1==t)return!1;let e=r.state.doc.resolve(t),n=e.nodeAfter;return!!(n&&n.isAtom&&Vt.isSelectable(n))&&(si(r,new Vt(e),"pointer"),!0)}(r,e))}function mu(r,t,e,n){return Yo(r,"handleDoubleClickOn",t,e,n)||r.someProp("handleDoubleClick",i=>i(r,t,n))}function gu(r,t,e,n){return Yo(r,"handleTripleClickOn",t,e,n)||r.someProp("handleTripleClick",i=>i(r,t,n))||function ai(r,t,e){if(0!=e.button)return!1;let n=r.state.doc;if(-1==t)return!!n.inlineContent&&(si(r,Kt.create(n,0,n.content.size),"pointer"),!0);let i=n.resolve(t);for(let s=i.depth+1;s>0;s--){let c=s>i.depth?i.nodeAfter:i.node(s),p=i.before(s);if(c.inlineContent)si(r,Kt.create(n,p+1,p+1+c.content.size),"pointer");else{if(!Vt.isSelectable(c))continue;si(r,Vt.create(n,p),"pointer")}return!0}}(r,e,n)}function Fa(r){return li(r)}Ee.keydown=(r,t)=>{let e=t;if(r.input.shiftKey=16==e.keyCode||e.shiftKey,!jo(r,e)&&(r.input.lastKeyCode=e.keyCode,r.input.lastKeyCodeTime=Date.now(),!Ye||!de||13!=e.keyCode))if(229!=e.keyCode&&r.domObserver.forceFlush(),!br||13!=e.keyCode||e.ctrlKey||e.altKey||e.metaKey)r.someProp("handleKeyDown",n=>n(r,e))||Er(r,e)?e.preventDefault():Rn(r,"key");else{let n=Date.now();r.input.lastIOSEnter=n,r.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{r.input.lastIOSEnter==n&&(r.someProp("handleKeyDown",i=>i(r,Xn(13,"Enter"))),r.input.lastIOSEnter=0)},200)}},Ee.keyup=(r,t)=>{16==t.keyCode&&(r.input.shiftKey=!1)},Ee.keypress=(r,t)=>{let e=t;if(jo(r,e)||!e.charCode||e.ctrlKey&&!e.altKey||ze&&e.metaKey)return;if(r.someProp("handleKeyPress",i=>i(r,e)))return void e.preventDefault();let n=r.state.selection;if(!(n instanceof Kt&&n.$from.sameParent(n.$to))){let i=String.fromCharCode(e.charCode);!/[\r\n]/.test(i)&&!r.someProp("handleTextInput",s=>s(r,n.$from.pos,n.$to.pos,i))&&r.dispatch(r.state.tr.insertText(i).scrollIntoView()),e.preventDefault()}};const Wo=ze?"metaKey":"ctrlKey";ke.mousedown=(r,t)=>{let e=t;r.input.shiftKey=e.shiftKey;let n=Fa(r),i=Date.now(),s="singleClick";i-r.input.lastClick.time<500&&function Pa(r,t){let e=t.x-r.clientX,n=t.y-r.clientY;return e*e+n*n<100}(e,r.input.lastClick)&&!e[Wo]&&("singleClick"==r.input.lastClick.type?s="doubleClick":"doubleClick"==r.input.lastClick.type&&(s="tripleClick")),r.input.lastClick={time:i,x:e.clientX,y:e.clientY,type:s};let c=r.posAtCoords(Ki(e));c&&("singleClick"==s?(r.input.mouseDown&&r.input.mouseDown.done(),r.input.mouseDown=new vu(r,c,e,!!n)):("doubleClick"==s?mu:gu)(r,c.pos,c.inside,e)?e.preventDefault():Rn(r,"pointer"))};class vu{constructor(t,e,n,i){let s,c;if(this.view=t,this.pos=e,this.event=n,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=t.state.doc,this.selectNode=!!n[Wo],this.allowDefault=n.shiftKey,e.inside>-1)s=t.state.doc.nodeAt(e.inside),c=e.inside;else{let O=t.state.doc.resolve(e.pos);s=O.parent,c=O.depth?O.before():0}const p=i?null:n.target,b=p?t.docView.nearestDesc(p,!0):null;this.target=b?b.dom:null;let{selection:S}=t.state;(0==n.button&&s.type.spec.draggable&&!1!==s.type.spec.selectable||S instanceof Vt&&S.from<=c&&S.to>c)&&(this.mightDrag={node:s,pos:c,addAttr:!(!this.target||this.target.draggable),setUneditable:!(!this.target||!De||this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),Rn(t,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>xn(this.view)),this.view.input.mouseDown=null}up(t){if(this.done(),!this.view.dom.contains(t.target))return;let e=this.pos;this.view.state.doc!=this.startDoc&&(e=this.view.posAtCoords(Ki(t))),this.updateAllowDefault(t),this.allowDefault||!e?Rn(this.view,"pointer"):La(this.view,e.pos,e.inside,t,this.selectNode)?t.preventDefault():0==t.button&&(this.flushed||Ce&&this.mightDrag&&!this.mightDrag.node.isAtom||de&&!this.view.state.selection.visible&&Math.min(Math.abs(e.pos-this.view.state.selection.from),Math.abs(e.pos-this.view.state.selection.to))<=2)?(si(this.view,Gt.near(this.view.state.doc.resolve(e.pos)),"pointer"),t.preventDefault()):Rn(this.view,"pointer")}move(t){this.updateAllowDefault(t),Rn(this.view,"pointer"),0==t.buttons&&this.done()}updateAllowDefault(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0)}}function jo(r,t){return!!r.composing||!!(Ce&&Math.abs(t.timeStamp-r.input.compositionEndedAt)<500)&&(r.input.compositionEndedAt=-2e8,!0)}ke.touchstart=r=>{r.input.lastTouch=Date.now(),Fa(r),Rn(r,"pointer")},ke.touchmove=r=>{r.input.lastTouch=Date.now(),Rn(r,"pointer")},ke.contextmenu=r=>Fa(r);const wc=Ye?5e3:-1;function Qi(r,t){clearTimeout(r.input.composingTimeout),t>-1&&(r.input.composingTimeout=setTimeout(()=>li(r),t))}function Ko(r){for(r.composing&&(r.input.composing=!1,r.input.compositionEndedAt=function Ra(){let r=document.createEvent("Event");return r.initEvent("event",!0,!0),r.timeStamp}());r.input.compositionNodes.length>0;)r.input.compositionNodes.pop().markParentsDirty()}function li(r,t=!1){if(!(Ye&&r.domObserver.flushingSoon>=0)){if(r.domObserver.forceFlush(),Ko(r),t||r.docView&&r.docView.dirty){let e=Ao(r);return e&&!e.eq(r.state.selection)?r.dispatch(r.state.tr.setSelection(e)):r.updateState(r.state),!0}return!1}}Ee.compositionstart=Ee.compositionupdate=r=>{if(!r.composing){r.domObserver.flush();let{state:t}=r,e=t.selection.$from;if(t.selection.empty&&(t.storedMarks||!e.textOffset&&e.parentOffset&&e.nodeBefore.marks.some(n=>!1===n.type.spec.inclusive)))r.markCursor=r.state.storedMarks||e.marks(),li(r,!0),r.markCursor=null;else if(li(r),De&&t.selection.empty&&e.parentOffset&&!e.textOffset&&e.nodeBefore.marks.length){let n=r.domSelectionRange();for(let i=n.focusNode,s=n.focusOffset;i&&1==i.nodeType&&0!=s;){let c=s<0?i.lastChild:i.childNodes[s-1];if(!c)break;if(3==c.nodeType){r.domSelection().collapse(c,c.nodeValue.length);break}i=c,s=-1}}r.input.composing=!0}Qi(r,wc)},Ee.compositionend=(r,t)=>{r.composing&&(r.input.composing=!1,r.input.compositionEndedAt=t.timeStamp,Qi(r,20))};const ui=me&&Be<15||br&&Zl<604;function cn(r,t,e,n,i){let s=su(r,t,e,n,r.state.selection.$from);if(r.someProp("handlePaste",b=>b(r,i,s||ot.empty)))return!0;if(!s)return!1;let c=function Ba(r){return 0==r.openStart&&0==r.openEnd&&1==r.content.childCount?r.content.firstChild:null}(s),p=c?r.state.tr.replaceSelectionWith(c,r.input.shiftKey):r.state.tr.replaceSelection(s);return r.dispatch(p.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}ke.copy=Ee.cut=(r,t)=>{let e=t,n=r.state.selection,i="cut"==e.type;if(n.empty)return;let s=ui?null:e.clipboardData,c=n.content(),{dom:p,text:b}=ou(r,c);s?(e.preventDefault(),s.clearData(),s.setData("text/html",p.innerHTML),s.setData("text/plain",b)):function yu(r,t){if(!r.dom.parentNode)return;let e=r.dom.parentNode.appendChild(document.createElement("div"));e.appendChild(t),e.style.cssText="position: fixed; left: -10000px; top: 10px";let n=getSelection(),i=document.createRange();i.selectNodeContents(t),r.dom.blur(),n.removeAllRanges(),n.addRange(i),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e),r.focus()},50)}(r,p),i&&r.dispatch(r.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},Ee.paste=(r,t)=>{let e=t;if(r.composing&&!Ye)return;let n=ui?null:e.clipboardData;n&&cn(r,n.getData("text/plain"),n.getData("text/html"),r.input.shiftKey,e)?e.preventDefault():function za(r,t){if(!r.dom.parentNode)return;let e=r.input.shiftKey||r.state.selection.$from.parent.type.spec.code,n=r.dom.parentNode.appendChild(document.createElement(e?"textarea":"div"));e||(n.contentEditable="true"),n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus(),setTimeout(()=>{r.focus(),n.parentNode&&n.parentNode.removeChild(n),e?cn(r,n.value,null,r.input.shiftKey,t):cn(r,n.textContent,n.innerHTML,r.input.shiftKey,t)},50)}(r,e)};class xu{constructor(t,e){this.slice=t,this.move=e}}const ae=ze?"altKey":"ctrlKey";ke.dragstart=(r,t)=>{let e=t,n=r.input.mouseDown;if(n&&n.done(),!e.dataTransfer)return;let i=r.state.selection,s=i.empty?null:r.posAtCoords(Ki(e));if(!(s&&s.pos>=i.from&&s.pos<=(i instanceof Vt?i.to-1:i.to)))if(n&&n.mightDrag)r.dispatch(r.state.tr.setSelection(Vt.create(r.state.doc,n.mightDrag.pos)));else if(e.target&&1==e.target.nodeType){let S=r.docView.nearestDesc(e.target,!0);S&&S.node.type.spec.draggable&&S!=r.docView&&r.dispatch(r.state.tr.setSelection(Vt.create(r.state.doc,S.posBefore)))}let c=r.state.selection.content(),{dom:p,text:b}=ou(r,c);e.dataTransfer.clearData(),e.dataTransfer.setData(ui?"Text":"text/html",p.innerHTML),e.dataTransfer.effectAllowed="copyMove",ui||e.dataTransfer.setData("text/plain",b),r.dragging=new xu(c,!e[ae])},ke.dragend=r=>{let t=r.dragging;window.setTimeout(()=>{r.dragging==t&&(r.dragging=null)},50)},Ee.dragover=Ee.dragenter=(r,t)=>t.preventDefault(),Ee.drop=(r,t)=>{let e=t,n=r.dragging;if(r.dragging=null,!e.dataTransfer)return;let i=r.posAtCoords(Ki(e));if(!i)return;let s=r.state.doc.resolve(i.pos),c=n&&n.slice;c?r.someProp("transformPasted",nt=>{c=nt(c,r)}):c=su(r,e.dataTransfer.getData(ui?"Text":"text/plain"),ui?null:e.dataTransfer.getData("text/html"),!1,s);let p=!(!n||e[ae]);if(r.someProp("handleDrop",nt=>nt(r,e,c||ot.empty,p)))return void e.preventDefault();if(!c)return;e.preventDefault();let b=c?function mc(r,t,e){let n=r.resolve(t);if(!e.content.size)return t;let i=e.content;for(let s=0;s<e.openStart;s++)i=i.firstChild.content;for(let s=1;s<=(0==e.openStart&&e.size?2:1);s++)for(let c=n.depth;c>=0;c--){let p=c==n.depth?0:n.pos<=(n.start(c+1)+n.end(c+1))/2?-1:1,b=n.index(c)+(p>0?1:0),S=n.node(c),O=!1;if(1==s)O=S.canReplace(b,b,i);else{let B=S.contentMatchAt(b).findWrapping(i.firstChild.type);O=B&&S.canReplaceWith(b,b,B[0])}if(O)return 0==p?n.pos:p<0?n.before(c+1):n.after(c+1)}return null}(r.state.doc,s.pos,c):s.pos;null==b&&(b=s.pos);let S=r.state.tr;p&&S.deleteSelection();let O=S.mapping.map(b),B=0==c.openStart&&0==c.openEnd&&1==c.content.childCount,U=S.doc;if(B?S.replaceRangeWith(O,O,c.content.firstChild):S.replaceRange(O,O,c),S.doc.eq(U))return;let J=S.doc.resolve(O);if(B&&Vt.isSelectable(c.content.firstChild)&&J.nodeAfter&&J.nodeAfter.sameMarkup(c.content.firstChild))S.setSelection(new Vt(J));else{let nt=S.mapping.map(b);S.mapping.maps[S.mapping.maps.length-1].forEach((ct,Ct,St,Lt)=>nt=Lt),S.setSelection(Lo(r,J,S.doc.resolve(nt)))}r.focus(),r.dispatch(S.setMeta("uiEvent","drop"))},ke.focus=r=>{r.input.lastFocus=Date.now(),r.focused||(r.domObserver.stop(),r.dom.classList.add("ProseMirror-focused"),r.domObserver.start(),r.focused=!0,setTimeout(()=>{r.docView&&r.hasFocus()&&!r.domObserver.currentSelection.eq(r.domSelectionRange())&&xn(r)},20))},ke.blur=(r,t)=>{let e=t;r.focused&&(r.domObserver.stop(),r.dom.classList.remove("ProseMirror-focused"),r.domObserver.start(),e.relatedTarget&&r.dom.contains(e.relatedTarget)&&r.domObserver.currentSelection.clear(),r.focused=!1)},ke.beforeinput=(r,t)=>{if(de&&Ye&&"deleteContentBackward"==t.inputType){r.domObserver.flushSoon();let{domChangeCount:n}=r.input;setTimeout(()=>{if(r.input.domChangeCount!=n||(r.dom.blur(),r.focus(),r.someProp("handleKeyDown",s=>s(r,Xn(8,"Backspace")))))return;let{$cursor:i}=r.state.selection;i&&i.pos>0&&r.dispatch(r.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let r in Ee)ke[r]=Ee[r];function He(r,t){if(r==t)return!0;for(let e in r)if(r[e]!==t[e])return!1;for(let e in t)if(!(e in r))return!1;return!0}class Qo{constructor(t,e){this.toDOM=t,this.spec=e||rr,this.side=this.spec.side||0}map(t,e,n,i){let{pos:s,deleted:c}=t.mapResult(e.from+i,this.side<0?-1:1);return c?null:new Ve(s-n,s-n,this)}valid(){return!0}eq(t){return this==t||t instanceof Qo&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&He(this.spec,t.spec))}destroy(t){this.spec.destroy&&this.spec.destroy(t)}}class _n{constructor(t,e){this.attrs=t,this.spec=e||rr}map(t,e,n,i){let s=t.map(e.from+i,this.spec.inclusiveStart?-1:1)-n,c=t.map(e.to+i,this.spec.inclusiveEnd?1:-1)-n;return s>=c?null:new Ve(s,c,this)}valid(t,e){return e.from<e.to}eq(t){return this==t||t instanceof _n&&He(this.attrs,t.attrs)&&He(this.spec,t.spec)}static is(t){return t.type instanceof _n}destroy(){}}class Xo{constructor(t,e){this.attrs=t,this.spec=e||rr}map(t,e,n,i){let s=t.mapResult(e.from+i,1);if(s.deleted)return null;let c=t.mapResult(e.to+i,-1);return c.deleted||c.pos<=s.pos?null:new Ve(s.pos-n,c.pos-n,this)}valid(t,e){let s,{index:n,offset:i}=t.content.findIndex(e.from);return i==e.from&&!(s=t.child(n)).isText&&i+s.nodeSize==e.to}eq(t){return this==t||t instanceof Xo&&He(this.attrs,t.attrs)&&He(this.spec,t.spec)}destroy(){}}class Ve{constructor(t,e,n){this.from=t,this.to=e,this.type=n}copy(t,e){return new Ve(t,e,this.type)}eq(t,e=0){return this.type.eq(t.type)&&this.from+e==t.from&&this.to+e==t.to}map(t,e,n){return this.type.map(t,this,e,n)}static widget(t,e,n){return new Ve(t,t,new Qo(e,n))}static inline(t,e,n,i){return new Ve(t,e,new _n(n,i))}static node(t,e,n,i){return new Ve(t,e,new Xo(n,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof _n}}const Tr=[],rr={};class Yt{constructor(t,e){this.local=t.length?t:Tr,this.children=e.length?e:Tr}static create(t,e){return e.length?Xi(e,t,0,rr):we}find(t,e,n){let i=[];return this.findInner(t??0,e??1e9,i,0,n),i}findInner(t,e,n,i,s){for(let c=0;c<this.local.length;c++){let p=this.local[c];p.from<=e&&p.to>=t&&(!s||s(p.spec))&&n.push(p.copy(p.from+i,p.to+i))}for(let c=0;c<this.children.length;c+=3)if(this.children[c]<e&&this.children[c+1]>t){let p=this.children[c]+1;this.children[c+2].findInner(t-p,e-p,n,i+p,s)}}map(t,e,n){return this==we||0==t.maps.length?this:this.mapInner(t,e,0,0,n||rr)}mapInner(t,e,n,i,s){let c;for(let p=0;p<this.local.length;p++){let b=this.local[p].map(t,n,i);b&&b.type.valid(e,b)?(c||(c=[])).push(b):s.onRemove&&s.onRemove(this.local[p].spec)}return this.children.length?function _u(r,t,e,n,i,s,c){let p=r.slice();for(let S=0,O=s;S<e.maps.length;S++){let B=0;e.maps[S].forEach((U,J,nt,ct)=>{let Ct=ct-nt-(J-U);for(let St=0;St<p.length;St+=3){let Lt=p[St+1];if(Lt<0||U>Lt+O-B)continue;let Bt=p[St]+O-B;J>=Bt?p[St+1]=U<=Bt?-2:-1:nt>=i&&Ct&&(p[St]+=Ct,p[St+1]+=Ct)}B+=Ct}),O=e.maps[S].map(O,-1)}let b=!1;for(let S=0;S<p.length;S+=3)if(p[S+1]<0){if(-2==p[S+1]){b=!0,p[S+1]=-1;continue}let O=e.map(r[S]+s),B=O-i;if(B<0||B>=n.content.size){b=!0;continue}let J=e.map(r[S+1]+s,-1)-i,{index:nt,offset:ct}=n.content.findIndex(B),Ct=n.maybeChild(nt);if(Ct&&ct==B&&ct+Ct.nodeSize==J){let St=p[S+2].mapInner(e,Ct,O+1,r[S]+s+1,c);St!=we?(p[S]=B,p[S+1]=J,p[S+2]=St):(p[S+1]=-2,b=!0)}else b=!0}if(b){let S=function wu(r,t,e,n,i,s,c){function p(b,S){for(let O=0;O<b.local.length;O++){let B=b.local[O].map(n,i,S);B?e.push(B):c.onRemove&&c.onRemove(b.local[O].spec)}for(let O=0;O<b.children.length;O+=3)p(b.children[O+2],b.children[O]+S+1)}for(let b=0;b<r.length;b+=3)-1==r[b+1]&&p(r[b+2],t[b]+s+1);return e}(p,r,t,e,i,s,c),O=Xi(S,n,0,c);t=O.local;for(let B=0;B<p.length;B+=3)p[B+1]<0&&(p.splice(B,3),B-=3);for(let B=0,U=0;B<O.children.length;B+=3){let J=O.children[B];for(;U<p.length&&p[U]<J;)U+=3;p.splice(U,0,O.children[B],O.children[B+1],O.children[B+2])}}return new Yt(t.sort(ir),p)}(this.children,c||[],t,e,n,i,s):c?new Yt(c.sort(ir),Tr):we}add(t,e){return e.length?this==we?Yt.create(t,e):this.addInner(t,e,0):this}addInner(t,e,n){let i,s=0;t.forEach((p,b)=>{let O,S=b+n;if(O=Va(e,p,S)){for(i||(i=this.children.slice());s<i.length&&i[s]<b;)s+=3;i[s]==b?i[s+2]=i[s+2].addInner(p,O,S+1):i.splice(s,0,b,b+p.nodeSize,Xi(O,p,S+1,rr)),s+=3}});let c=Ha(s?Za(e):e,-n);for(let p=0;p<c.length;p++)c[p].type.valid(t,c[p])||c.splice(p--,1);return new Yt(c.length?this.local.concat(c).sort(ir):this.local,i||this.children)}remove(t){return 0==t.length||this==we?this:this.removeInner(t,0)}removeInner(t,e){let n=this.children,i=this.local;for(let s=0;s<n.length;s+=3){let c,p=n[s]+e,b=n[s+1]+e;for(let B,O=0;O<t.length;O++)(B=t[O])&&B.from>p&&B.to<b&&(t[O]=null,(c||(c=[])).push(B));if(!c)continue;n==this.children&&(n=this.children.slice());let S=n[s+2].removeInner(c,p+1);S!=we?n[s+2]=S:(n.splice(s,3),s-=3)}if(i.length)for(let c,s=0;s<t.length;s++)if(c=t[s])for(let p=0;p<i.length;p++)i[p].eq(c,e)&&(i==this.local&&(i=this.local.slice()),i.splice(p--,1));return n==this.children&&i==this.local?this:i.length||n.length?new Yt(i,n):we}forChild(t,e){if(this==we)return this;if(e.isLeaf)return Yt.empty;let n,i;for(let p=0;p<this.children.length;p+=3)if(this.children[p]>=t){this.children[p]==t&&(n=this.children[p+2]);break}let s=t+1,c=s+e.content.size;for(let p=0;p<this.local.length;p++){let b=this.local[p];if(b.from<c&&b.to>s&&b.type instanceof _n){let S=Math.max(s,b.from)-s,O=Math.min(c,b.to)-s;S<O&&(i||(i=[])).push(b.copy(S,O))}}if(i){let p=new Yt(i.sort(ir),Tr);return n?new Bn([p,n]):p}return n||we}eq(t){if(this==t)return!0;if(!(t instanceof Yt)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(let e=0;e<this.local.length;e++)if(!this.local[e].eq(t.local[e]))return!1;for(let e=0;e<this.children.length;e+=3)if(this.children[e]!=t.children[e]||this.children[e+1]!=t.children[e+1]||!this.children[e+2].eq(t.children[e+2]))return!1;return!0}locals(t){return qo(this.localsInner(t))}localsInner(t){if(this==we)return Tr;if(t.inlineContent||!this.local.some(_n.is))return this.local;let e=[];for(let n=0;n<this.local.length;n++)this.local[n].type instanceof _n||e.push(this.local[n]);return e}}Yt.empty=new Yt([],[]),Yt.removeOverlap=qo;const we=Yt.empty;class Bn{constructor(t){this.members=t}map(t,e){const n=this.members.map(i=>i.map(t,e,rr));return Bn.from(n)}forChild(t,e){if(e.isLeaf)return Yt.empty;let n=[];for(let i=0;i<this.members.length;i++){let s=this.members[i].forChild(t,e);s!=we&&(s instanceof Bn?n=n.concat(s.members):n.push(s))}return Bn.from(n)}eq(t){if(!(t instanceof Bn)||t.members.length!=this.members.length)return!1;for(let e=0;e<this.members.length;e++)if(!this.members[e].eq(t.members[e]))return!1;return!0}locals(t){let e,n=!0;for(let i=0;i<this.members.length;i++){let s=this.members[i].localsInner(t);if(s.length)if(e){n&&(e=e.slice(),n=!1);for(let c=0;c<s.length;c++)e.push(s[c])}else e=s}return e?qo(n?e:e.sort(ir)):Tr}static from(t){switch(t.length){case 0:return we;case 1:return t[0];default:return new Bn(t.every(e=>e instanceof Yt)?t:t.reduce((e,n)=>e.concat(n instanceof Yt?n:n.members),[]))}}}function Ha(r,t){if(!t||!r.length)return r;let e=[];for(let n=0;n<r.length;n++){let i=r[n];e.push(new Ve(i.from+t,i.to+t,i.type))}return e}function Va(r,t,e){if(t.isLeaf)return null;let n=e+t.nodeSize,i=null;for(let c,s=0;s<r.length;s++)(c=r[s])&&c.from>e&&c.to<n&&((i||(i=[])).push(c),r[s]=null);return i}function Za(r){let t=[];for(let e=0;e<r.length;e++)null!=r[e]&&t.push(r[e]);return t}function Xi(r,t,e,n){let i=[],s=!1;t.forEach((p,b)=>{let S=Va(r,p,b+e);if(S){s=!0;let O=Xi(S,p,e+b+1,n);O!=we&&i.push(b,b+p.nodeSize,O)}});let c=Ha(s?Za(r):r,-e).sort(ir);for(let p=0;p<c.length;p++)c[p].type.valid(t,c[p])||(n.onRemove&&n.onRemove(c[p].spec),c.splice(p--,1));return c.length||i.length?new Yt(c,i):we}function ir(r,t){return r.from-t.from||r.to-t.to}function qo(r){let t=r;for(let e=0;e<t.length-1;e++){let n=t[e];if(n.from!=n.to)for(let i=e+1;i<t.length;i++){let s=t[i];if(s.from!=n.from){s.from<n.to&&(t==r&&(t=r.slice()),t[e]=n.copy(n.from,s.from),Ga(t,i,n.copy(s.from,n.to)));break}s.to!=n.to&&(t==r&&(t=r.slice()),t[i]=s.copy(s.from,n.to),Ga(t,i+1,s.copy(n.to,s.to)))}}return t}function Ga(r,t,e){for(;t<r.length&&ir(e,r[t])>0;)t++;r.splice(t,0,e)}function ci(r){let t=[];return r.someProp("decorations",e=>{let n=e(r.state);n&&n!=we&&t.push(n)}),r.cursorWrapper&&t.push(Yt.create(r.state.doc,[r.cursorWrapper.deco])),Bn.from(t)}const ts={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Ua=me&&Be<=11;class Me{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset}}class bu{constructor(t,e){this.view=t,this.handleDOMChange=e,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new Me,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver(n=>{for(let i=0;i<n.length;i++)this.queue.push(n[i]);me&&Be<=11&&n.some(i=>"childList"==i.type&&i.removedNodes.length||"characterData"==i.type&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),Ua&&(this.onCharData=n=>{this.queue.push({target:n.target,type:"characterData",oldValue:n.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,ts)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let t=this.observer.takeRecords();if(t.length){for(let e=0;e<t.length;e++)this.queue.push(t[e]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(Ca(this.view)){if(this.suppressingSelectionUpdates)return xn(this.view);if(me&&Be<=11&&!this.view.state.selection.empty){let t=this.view.domSelectionRange();if(t.focusNode&&$e(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(t){if(!t.focusNode)return!0;let n,e=new Set;for(let s=t.focusNode;s;s=wr(s))e.add(s);for(let s=t.anchorNode;s;s=wr(s))if(e.has(s)){n=s;break}let i=n&&this.view.docView.nearestDesc(n);return i&&i.ignoreMutation({type:"selection",target:3==n.nodeType?n.parentNode:n})?(this.setCurSelection(),!0):void 0}flush(){let{view:t}=this;if(!t.docView||this.flushingSoon>-1)return;let e=this.observer?this.observer.takeRecords():[];this.queue.length&&(e=this.queue.concat(e),this.queue.length=0);let n=t.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&Ca(t)&&!this.ignoreSelectionChange(n),s=-1,c=-1,p=!1,b=[];if(t.editable)for(let O=0;O<e.length;O++){let B=this.registerMutation(e[O],b);B&&(s=s<0?B.from:Math.min(B.from,s),c=c<0?B.to:Math.max(B.to,c),B.typeOver&&(p=!0))}if(De&&b.length>1){let O=b.filter(B=>"BR"==B.nodeName);if(2==O.length){let B=O[0],U=O[1];B.parentNode&&B.parentNode.parentNode==U.parentNode?U.remove():B.remove()}}let S=null;s<0&&i&&t.input.lastFocus>Date.now()-200&&Math.max(t.input.lastTouch,t.input.lastClick.time)<Date.now()-300&&qr(n)&&(S=Ao(t))&&S.eq(Gt.near(t.state.doc.resolve(0),1))?(t.input.lastFocus=0,xn(t),this.currentSelection.set(n),t.scrollToSelection()):(s>-1||i)&&(s>-1&&(t.docView.markDirty(s,c),function Ze(r){if(!Ja.has(r)&&(Ja.set(r,null),-1!==["normal","nowrap","pre-line"].indexOf(getComputedStyle(r.dom).whiteSpace))){if(r.requiresGeckoHackNode=De,es)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),es=!0}}(t)),this.handleDOMChange(s,c,p,b),t.docView&&t.docView.dirty?t.updateState(t.state):this.currentSelection.eq(n)||xn(t),this.currentSelection.set(n))}registerMutation(t,e){if(e.indexOf(t.target)>-1)return null;let n=this.view.docView.nearestDesc(t.target);if("attributes"==t.type&&(n==this.view.docView||"contenteditable"==t.attributeName||"style"==t.attributeName&&!t.oldValue&&!t.target.getAttribute("style"))||!n||n.ignoreMutation(t))return null;if("childList"==t.type){for(let O=0;O<t.addedNodes.length;O++)e.push(t.addedNodes[O]);if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(t.target))return{from:n.posBefore,to:n.posAfter};let i=t.previousSibling,s=t.nextSibling;if(me&&Be<=11&&t.addedNodes.length)for(let O=0;O<t.addedNodes.length;O++){let{previousSibling:B,nextSibling:U}=t.addedNodes[O];(!B||Array.prototype.indexOf.call(t.addedNodes,B)<0)&&(i=B),(!U||Array.prototype.indexOf.call(t.addedNodes,U)<0)&&(s=U)}let c=i&&i.parentNode==t.target?se(i)+1:0,p=n.localPosFromDOM(t.target,c,-1),b=s&&s.parentNode==t.target?se(s):t.target.childNodes.length;return{from:p,to:n.localPosFromDOM(t.target,b,1)}}return"attributes"==t.type?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:{from:n.posAtStart,to:n.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}}}let Ja=new WeakMap,es=!1;function ns(r){let t=r.pmViewDesc;if(t)return t.parseRule();if("BR"==r.nodeName&&r.parentNode){if(Ce&&/^(ul|ol)$/i.test(r.parentNode.nodeName)){let e=document.createElement("div");return e.appendChild(document.createElement("li")),{skip:e}}if(r.parentNode.lastChild==r||Ce&&/^(tr|table)$/i.test(r.parentNode.nodeName))return{ignore:!0}}else if("IMG"==r.nodeName&&r.getAttribute("mark-placeholder"))return{ignore:!0};return null}function bc(r,t,e,n,i){if(t<0){let zt=r.input.lastSelectionTime>Date.now()-50?r.input.lastSelectionOrigin:null,Ie=Ao(r,zt);if(Ie&&!r.state.selection.eq(Ie)){if(de&&Ye&&13===r.input.lastKeyCode&&Date.now()-100<r.input.lastKeyCodeTime&&r.someProp("handleKeyDown",ce=>ce(r,Xn(13,"Enter"))))return;let ee=r.state.tr.setSelection(Ie);"pointer"==zt?ee.setMeta("pointer",!0):"key"==zt&&ee.scrollIntoView(),r.dispatch(ee)}return}let s=r.state.doc.resolve(t),c=s.sharedDepth(e);t=s.before(c+1),e=r.state.doc.resolve(e).after(c+1);let B,U,p=r.state.selection,b=function $a(r,t,e){let S,{node:n,fromOffset:i,toOffset:s,from:c,to:p}=r.docView.parseRange(t,e),b=r.domSelectionRange(),O=b.anchorNode;if(O&&r.dom.contains(1==O.nodeType?O:O.parentNode)&&(S=[{node:O,offset:b.anchorOffset}],qr(b)||S.push({node:b.focusNode,offset:b.focusOffset})),de&&8===r.input.lastKeyCode)for(let Ct=s;Ct>i;Ct--){let St=n.childNodes[Ct-1],Lt=St.pmViewDesc;if("BR"==St.nodeName&&!Lt){s=Ct;break}if(!Lt||Lt.size)break}let B=r.state.doc,U=r.someProp("domParser")||$n.fromSchema(r.state.schema),J=B.resolve(c),nt=null,ct=U.parse(n,{topNode:J.parent,topMatch:J.parent.contentMatchAt(J.index()),topOpen:!0,from:i,to:s,preserveWhitespace:"pre"!=J.parent.type.whitespace||"full",findPositions:S,ruleFromNode:ns,context:J});if(S&&null!=S[0].pos){let Ct=S[0].pos,St=S[1]&&S[1].pos;null==St&&(St=Ct),nt={anchor:Ct+c,head:St+c}}return{doc:ct,sel:nt,from:c,to:p}}(r,t,e),S=r.state.doc,O=S.slice(b.from,b.to);8===r.input.lastKeyCode&&Date.now()-100<r.input.lastKeyCodeTime?(B=r.state.selection.to,U="end"):(B=r.state.selection.from,U="start"),r.input.lastKeyCode=null;let J=function eo(r,t,e,n,i){let s=r.findDiffStart(t,e);if(null==s)return null;let{a:c,b:p}=r.findDiffEnd(t,e+r.size,e+t.size);if("end"==i){n-=c+Math.max(0,s-Math.min(c,p))-s}if(c<s&&r.size<t.size){s-=n<=s&&n>=c?s-n:0,p=s+(p-c),c=s}else if(p<s){s-=n<=s&&n>=p?s-n:0,c=s+(c-p),p=s}return{start:s,endA:c,endB:p}}(O.content,b.doc.content,b.from,B,U);if((br&&r.input.lastIOSEnter>Date.now()-225||Ye)&&i.some(zt=>"DIV"==zt.nodeName||"P"==zt.nodeName||"LI"==zt.nodeName)&&(!J||J.endA>=J.endB)&&r.someProp("handleKeyDown",zt=>zt(r,Xn(13,"Enter"))))return void(r.input.lastIOSEnter=0);if(!J){if(!(n&&p instanceof Kt&&!p.empty&&p.$head.sameParent(p.$anchor))||r.composing||b.sel&&b.sel.anchor!=b.sel.head){if(b.sel){let zt=Ya(r,r.state.doc,b.sel);zt&&!zt.eq(r.state.selection)&&r.dispatch(r.state.tr.setSelection(zt))}return}J={start:p.from,endA:p.to,endB:p.to}}if(de&&r.cursorWrapper&&b.sel&&b.sel.anchor==r.cursorWrapper.deco.from&&b.sel.head==b.sel.anchor){let zt=J.endB-J.start;b.sel={anchor:b.sel.anchor+zt,head:b.sel.anchor+zt}}r.input.domChangeCount++,r.state.selection.from<r.state.selection.to&&J.start==J.endB&&r.state.selection instanceof Kt&&(J.start>r.state.selection.from&&J.start<=r.state.selection.from+2&&r.state.selection.from>=b.from?J.start=r.state.selection.from:J.endA<r.state.selection.to&&J.endA>=r.state.selection.to-2&&r.state.selection.to<=b.to&&(J.endB+=r.state.selection.to-J.endA,J.endA=r.state.selection.to)),me&&Be<=11&&J.endB==J.start+1&&J.endA==J.start&&J.start>b.from&&" \xa0"==b.doc.textBetween(J.start-b.from-1,J.start-b.from+1)&&(J.start--,J.endA--,J.endB--);let Lt,nt=b.doc.resolveNoCache(J.start-b.from),ct=b.doc.resolveNoCache(J.endB-b.from),Ct=S.resolve(J.start),St=nt.sameParent(ct)&&nt.parent.inlineContent&&Ct.end()>=J.endA;if((br&&r.input.lastIOSEnter>Date.now()-225&&(!St||i.some(zt=>"DIV"==zt.nodeName||"P"==zt.nodeName))||!St&&nt.pos<b.doc.content.size&&(Lt=Gt.findFrom(b.doc.resolve(nt.pos+1),1,!0))&&Lt.head==ct.pos)&&r.someProp("handleKeyDown",zt=>zt(r,Xn(13,"Enter"))))return void(r.input.lastIOSEnter=0);if(r.state.selection.anchor>J.start&&function Wa(r,t,e,n,i){if(!n.parent.isTextblock||e-t<=i.pos-n.pos||to(n,!0,!1)<i.pos)return!1;let s=r.resolve(t);if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let c=r.resolve(to(s,!0,!0));return!(!c.parent.isTextblock||c.pos>e||to(c,!0,!1)<e)&&n.parent.content.cut(n.parentOffset).eq(c.parent.content)}(S,J.start,J.endA,nt,ct)&&r.someProp("handleKeyDown",zt=>zt(r,Xn(8,"Backspace"))))return void(Ye&&de&&r.domObserver.suppressSelectionUpdates());de&&Ye&&J.endB==J.start&&(r.input.lastAndroidDelete=Date.now()),Ye&&!St&&nt.start()!=ct.start()&&0==ct.parentOffset&&nt.depth==ct.depth&&b.sel&&b.sel.anchor==b.sel.head&&b.sel.head==J.endA&&(J.endB-=2,ct=b.doc.resolveNoCache(J.endB-b.from),setTimeout(()=>{r.someProp("handleKeyDown",function(zt){return zt(r,Xn(13,"Enter"))})},20));let Ut,jt,qt,Bt=J.start,Zt=J.endA;if(St)if(nt.pos==ct.pos)me&&Be<=11&&0==nt.parentOffset&&(r.domObserver.suppressSelectionUpdates(),setTimeout(()=>xn(r),20)),Ut=r.state.tr.delete(Bt,Zt),jt=S.resolve(J.start).marksAcross(S.resolve(J.endA));else if(J.endA==J.endB&&(qt=function Cu(r,t){let c,p,b,e=r.firstChild.marks,n=t.firstChild.marks,i=e,s=n;for(let O=0;O<n.length;O++)i=n[O].removeFromSet(i);for(let O=0;O<e.length;O++)s=e[O].removeFromSet(s);if(1==i.length&&0==s.length)p=i[0],c="add",b=O=>O.mark(p.addToSet(O.marks));else{if(0!=i.length||1!=s.length)return null;p=s[0],c="remove",b=O=>O.mark(p.removeFromSet(O.marks))}let S=[];for(let O=0;O<t.childCount;O++)S.push(b(t.child(O)));if(F.from(S).eq(r))return{mark:p,type:c}}(nt.parent.content.cut(nt.parentOffset,ct.parentOffset),Ct.parent.content.cut(Ct.parentOffset,J.endA-Ct.start()))))Ut=r.state.tr,"add"==qt.type?Ut.addMark(Bt,Zt,qt.mark):Ut.removeMark(Bt,Zt,qt.mark);else if(nt.parent.child(nt.index()).isText&&nt.index()==ct.index()-(ct.textOffset?0:1)){let zt=nt.parent.textBetween(nt.parentOffset,ct.parentOffset);if(r.someProp("handleTextInput",Ie=>Ie(r,Bt,Zt,zt)))return;Ut=r.state.tr.insertText(zt,Bt,Zt)}if(Ut||(Ut=r.state.tr.replace(Bt,Zt,b.doc.slice(J.start-b.from,J.endB-b.from))),b.sel){let zt=Ya(r,Ut.doc,b.sel);zt&&!(de&&Ye&&r.composing&&zt.empty&&(J.start!=J.endB||r.input.lastAndroidDelete<Date.now()-100)&&(zt.head==Bt||zt.head==Ut.mapping.map(Zt)-1)||me&&zt.empty&&zt.head==Bt)&&Ut.setSelection(zt)}jt&&Ut.ensureMarks(jt),r.dispatch(Ut.scrollIntoView())}function Ya(r,t,e){return Math.max(e.anchor,e.head)>t.content.size?null:Lo(r,t.resolve(e.anchor),t.resolve(e.head))}function to(r,t,e){let n=r.depth,i=t?r.end():r.pos;for(;n>0&&(t||r.indexAfter(n)==r.node(n).childCount);)n--,i++,t=!1;if(e){let s=r.node(n).maybeChild(r.indexAfter(n));for(;s&&!s.isLeaf;)s=s.firstChild,i++}return i}class ku{constructor(t,e){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new hu,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=e,this.state=e.state,this.directPlugins=e.plugins||[],this.directPlugins.forEach(ss),this.dispatch=this.dispatch.bind(this),this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):"function"==typeof t?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=ja(this),is(this),this.nodeViews=Ka(this),this.docView=da(this.state.doc,rs(this),ci(this),this.dom,this),this.domObserver=new bu(this,(n,i,s,c)=>bc(this,n,i,s,c)),this.domObserver.start(),function yc(r){for(let t in ke){let e=ke[t];r.dom.addEventListener(t,r.input.eventHandlers[t]=n=>{xc(r,n)&&!$o(r,n)&&(r.editable||!(n.type in Ee))&&e(r,n)},Mr[t]?{passive:!0}:void 0)}Ce&&r.dom.addEventListener("input",()=>null),Jo(r)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let t=this._props;this._props={};for(let e in t)this._props[e]=t[e];this._props.state=this.state}return this._props}update(t){t.handleDOMEvents!=this._props.handleDOMEvents&&Jo(this);let e=this._props;this._props=t,t.plugins&&(t.plugins.forEach(ss),this.directPlugins=t.plugins),this.updateStateInner(t.state,e)}setProps(t){let e={};for(let n in this._props)e[n]=this._props[n];e.state=this.state;for(let n in t)e[n]=t[n];this.update(e)}updateState(t){this.updateStateInner(t,this._props)}updateStateInner(t,e){let n=this.state,i=!1,s=!1;t.storedMarks&&this.composing&&(Ko(this),s=!0),this.state=t;let c=n.plugins!=t.plugins||this._props.plugins!=e.plugins;if(c||this._props.plugins!=e.plugins||this._props.nodeViews!=e.nodeViews){let U=Ka(this);(function Mu(r,t){let e=0,n=0;for(let i in r){if(r[i]!=t[i])return!0;e++}for(let i in t)n++;return e!=n})(U,this.nodeViews)&&(this.nodeViews=U,i=!0)}(c||e.handleDOMEvents!=this._props.handleDOMEvents)&&Jo(this),this.editable=ja(this),is(this);let p=ci(this),b=rs(this),S=n.plugins==t.plugins||n.doc.eq(t.doc)?t.scrollToSelection>n.scrollToSelection?"to selection":"preserve":"reset",O=i||!this.docView.matchesNode(t.doc,b,p);(O||!t.selection.eq(n.selection))&&(s=!0);let B="preserve"==S&&s&&null==this.dom.style.overflowAnchor&&function na(r){let n,i,t=r.dom.getBoundingClientRect(),e=Math.max(0,t.top);for(let s=(t.left+t.right)/2,c=e+1;c<Math.min(innerHeight,t.bottom);c+=5){let p=r.root.elementFromPoint(s,c);if(!p||p==r.dom||!r.dom.contains(p))continue;let b=p.getBoundingClientRect();if(b.top>=e-20){n=p,i=b.top;break}}return{refDOM:n,refTop:i,stack:Cr(r.dom)}}(this);if(s){this.domObserver.stop();let U=O&&(me||de)&&!this.composing&&!n.selection.empty&&!t.selection.empty&&function Eu(r,t){let e=Math.min(r.$anchor.sharedDepth(r.head),t.$anchor.sharedDepth(t.head));return r.$anchor.start(e)!=t.$anchor.start(e)}(n.selection,t.selection);if(O){let J=de?this.trackWrites=this.domSelectionRange().focusNode:null;(i||!this.docView.update(t.doc,b,p,this))&&(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=da(t.doc,b,p,this.dom,this)),J&&!this.trackWrites&&(U=!0)}U||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&function ru(r){let t=r.docView.domFromPos(r.state.selection.anchor,0),e=r.domSelectionRange();return $e(t.node,t.offset,e.anchorNode,e.anchorOffset)}(this))?xn(this,U):(Po(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(n),"reset"==S?this.dom.scrollTop=0:"to selection"==S?this.scrollToSelection():B&&function ra({refDOM:r,refTop:t,stack:e}){let n=r?r.getBoundingClientRect().top:0;ei(e,0==n?0:n-t)}(B)}scrollToSelection(){let t=this.domSelectionRange().focusNode;if(!this.someProp("handleScrollToSelection",e=>e(this)))if(this.state.selection instanceof Vt){let e=this.docView.domAfterPos(this.state.selection.from);1==e.nodeType&&ea(this,e.getBoundingClientRect(),t)}else ea(this,this.coordsAtPos(this.state.selection.head,1),t)}destroyPluginViews(){let t;for(;t=this.pluginViews.pop();)t.destroy&&t.destroy()}updatePluginViews(t){if(t&&t.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let e=0;e<this.pluginViews.length;e++){let n=this.pluginViews[e];n.update&&n.update(this,t)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let e=0;e<this.directPlugins.length;e++){let n=this.directPlugins[e];n.spec.view&&this.pluginViews.push(n.spec.view(this))}for(let e=0;e<this.state.plugins.length;e++){let n=this.state.plugins[e];n.spec.view&&this.pluginViews.push(n.spec.view(this))}}}someProp(t,e){let i,n=this._props&&this._props[t];if(null!=n&&(i=e?e(n):n))return i;for(let c=0;c<this.directPlugins.length;c++){let p=this.directPlugins[c].props[t];if(null!=p&&(i=e?e(p):p))return i}let s=this.state.plugins;if(s)for(let c=0;c<s.length;c++){let p=s[c].props[t];if(null!=p&&(i=e?e(p):p))return i}}hasFocus(){if(me){let t=this.root.activeElement;if(t==this.dom)return!0;if(!t||!this.dom.contains(t))return!1;for(;t&&this.dom!=t&&this.dom.contains(t);){if("false"==t.contentEditable)return!1;t=t.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function Ui(r){if(r.setActive)return r.setActive();if(kr)return r.focus(kr);let t=Cr(r);r.focus(null==kr?{get preventScroll(){return kr={preventScroll:!0},!0}}:void 0),kr||(kr=!1,ei(t,0))}(this.dom),xn(this),this.domObserver.start()}get root(){let t=this._root;if(null==t)for(let e=this.dom.parentNode;e;e=e.parentNode)if(9==e.nodeType||11==e.nodeType&&e.host)return e.getSelection||(Object.getPrototypeOf(e).getSelection=()=>e.ownerDocument.getSelection()),this._root=e;return t||document}posAtCoords(t){return on(this,t)}coordsAtPos(t,e=1){return ua(this,t,e)}domAtPos(t,e=0){return this.docView.domFromPos(t,e)}nodeDOM(t){let e=this.docView.descAt(t);return e?e.nodeDOM:null}posAtDOM(t,e,n=-1){let i=this.docView.posFromDOM(t,e,n);if(null==i)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(t,e){return vc(this,e||this.state,t)}pasteHTML(t,e){return cn(this,"",t,!1,e||new ClipboardEvent("paste"))}pasteText(t,e){return cn(this,t,null,!0,e||new ClipboardEvent("paste"))}destroy(){this.docView&&(function du(r){r.domObserver.stop();for(let t in r.input.eventHandlers)r.dom.removeEventListener(t,r.input.eventHandlers[t]);clearTimeout(r.input.composingTimeout),clearTimeout(r.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],ci(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)}get isDestroyed(){return null==this.docView}dispatchEvent(t){return function fu(r,t){!$o(r,t)&&ke[t.type]&&(r.editable||!(t.type in Ee))&&ke[t.type](r,t)}(this,t)}dispatch(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))}domSelectionRange(){return Ce&&11===this.root.nodeType&&function Vl(r){let t=r.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}(this.dom.ownerDocument)==this.dom?function qi(r){let t;function e(b){b.preventDefault(),b.stopImmediatePropagation(),t=b.getTargetRanges()[0]}r.dom.addEventListener("beforeinput",e,!0),document.execCommand("indent"),r.dom.removeEventListener("beforeinput",e,!0);let n=t.startContainer,i=t.startOffset,s=t.endContainer,c=t.endOffset,p=r.domAtPos(r.state.selection.anchor);return $e(p.node,p.offset,s,c)&&([n,i,s,c]=[s,c,n,i]),{anchorNode:n,anchorOffset:i,focusNode:s,focusOffset:c}}(this):this.domSelection()}domSelection(){return this.root.getSelection()}}function rs(r){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(r.editable),t.translate="no",r.someProp("attributes",e=>{if("function"==typeof e&&(e=e(r.state)),e)for(let n in e)"class"==n&&(t.class+=" "+e[n]),"style"==n?t.style=(t.style?t.style+";":"")+e[n]:!t[n]&&"contenteditable"!=n&&"nodeName"!=n&&(t[n]=String(e[n]))}),[Ve.node(0,r.state.doc.content.size,t)]}function is(r){if(r.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),r.cursorWrapper={dom:t,deco:Ve.widget(r.state.selection.head,t,{raw:!0,marks:r.markCursor})}}else r.cursorWrapper=null}function ja(r){return!r.someProp("editable",t=>!1===t(r.state))}function Ka(r){let t=Object.create(null);function e(n){for(let i in n)Object.prototype.hasOwnProperty.call(t,i)||(t[i]=n[i])}return r.someProp("nodeViews",e),r.someProp("markViews",e),t}function ss(r){if(r.spec.state||r.spec.filterTransaction||r.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var ne=f(6895);const Tu=["ol",0],Nu=["ul",0],Su=["li",0],Qa={attrs:{order:{default:1}},parseDOM:[{tag:"ol",getAttrs:r=>({order:r.hasAttribute("start")?+r.getAttribute("start"):1})}],toDOM:r=>1==r.attrs.order?Tu:["ol",{start:r.attrs.order},0]},Xa={parseDOM:[{tag:"ul"}],toDOM:()=>Nu},qa={parseDOM:[{tag:"li"}],toDOM:()=>Su,defining:!0};function Iu(r,t=null){return function(e,n){let{$from:i,$to:s}=e.selection,c=i.blockRange(s),p=!1,b=c;if(!c)return!1;if(c.depth>=2&&i.node(c.depth-1).type.compatibleContent(r)&&0==c.startIndex){if(0==i.index(c.depth-1))return!1;let O=e.doc.resolve(c.start-2);b=new $t(O,O,c.depth),c.endIndex<c.parent.childCount&&(c=new $t(i,e.doc.resolve(s.end(c.depth)),c.depth)),p=!0}let S=Yr(b,r,t,c);return!!S&&(n&&n(function Ou(r,t,e,n,i){let s=F.empty;for(let O=e.length-1;O>=0;O--)s=F.from(e[O].type.create(e[O].attrs,s));r.step(new pe(t.start-(n?2:0),t.end,t.start,t.end,new ot(s,0,0),e.length,!0));let c=0;for(let O=0;O<e.length;O++)e[O].type==i&&(c=O+1);let p=e.length-c,b=t.start+e.length-(n?2:0),S=t.parent;for(let O=t.startIndex,B=t.endIndex,U=!0;O<B;O++,U=!1)!U&&Kn(r.doc,b,p)&&(r.split(b,p),b+=2*p),b+=S.child(O).nodeSize;return r}(e.tr,c,S,p,r).scrollIntoView()),!0)}}function Au(r){return function(t,e){let{$from:n,$to:i,node:s}=t.selection;if(s&&s.isBlock||n.depth<2||!n.sameParent(i))return!1;let c=n.node(-1);if(c.type!=r)return!1;if(0==n.parent.content.size&&n.node(-1).childCount==n.indexAfter(-1)){if(3==n.depth||n.node(-3).type!=r||n.index(-2)!=n.node(-2).childCount-1)return!1;if(e){let O=F.empty,B=n.index(-1)?1:n.index(-2)?2:3;for(let Ct=n.depth-B;Ct>=n.depth-3;Ct--)O=F.from(n.node(Ct).copy(O));let U=n.indexAfter(-1)<n.node(-2).childCount?1:n.indexAfter(-2)<n.node(-3).childCount?2:3;O=O.append(F.from(r.createAndFill()));let J=n.before(n.depth-(B-1)),nt=t.tr.replace(J,n.after(-U),new ot(O,4-B,0)),ct=-1;nt.doc.nodesBetween(J,nt.doc.content.size,(Ct,St)=>{if(ct>-1)return!1;Ct.isTextblock&&0==Ct.content.size&&(ct=St+1)}),ct>-1&&nt.setSelection(Gt.near(nt.doc.resolve(ct))),e(nt.scrollIntoView())}return!0}let p=i.pos==n.end()?c.contentMatchAt(0).defaultType:null,b=t.tr.delete(n.pos,i.pos),S=p?[null,{type:p}]:void 0;return!!Kn(b.doc,n.pos,2,S)&&(e&&e(b.split(n.pos,2,S).scrollIntoView()),!0)}}function tl(r){return function(t,e){let{$from:n,$to:i}=t.selection,s=n.blockRange(i,c=>c.childCount>0&&c.firstChild.type==r);return!!s&&(!e||(n.node(s.depth-1).type==r?function Du(r,t,e,n){let i=r.tr,s=n.end,c=n.$to.end(n.depth);s<c&&(i.step(new pe(s-1,c,s,c,new ot(F.from(e.create(null,n.parent.copy())),1,0),1,!0)),n=new $t(i.doc.resolve(n.$from.pos),i.doc.resolve(c),n.depth));const p=fr(n);if(null==p)return!1;i.lift(n,p);let b=i.mapping.map(s,-1)-1;return Di(i.doc,b)&&i.join(b),t(i.scrollIntoView()),!0}(t,e,r,s):function Pu(r,t,e){let n=r.tr,i=e.parent;for(let J=e.end,nt=e.endIndex-1,ct=e.startIndex;nt>ct;nt--)J-=i.child(nt).nodeSize,n.delete(J-1,J+1);let s=n.doc.resolve(e.start),c=s.nodeAfter;if(n.mapping.map(e.end)!=e.start+s.nodeAfter.nodeSize)return!1;let p=0==e.startIndex,b=e.endIndex==i.childCount,S=s.node(-1),O=s.index(-1);if(!S.canReplace(O+(p?0:1),O+1,c.content.append(b?F.empty:F.from(i))))return!1;let B=s.pos,U=B+c.nodeSize;return n.step(new pe(B-(p?1:0),U+(b?1:0),B+1,U-1,new ot((p?F.empty:F.from(i.copy(F.empty))).append(b?F.empty:F.from(i.copy(F.empty))),p?0:1,b?0:1),p?0:1)),t(n.scrollIntoView()),!0}(t,e,s)))}}function Sr(r){return function(t,e){let{$from:n,$to:i}=t.selection,s=n.blockRange(i,S=>S.childCount>0&&S.firstChild.type==r);if(!s)return!1;let c=s.startIndex;if(0==c)return!1;let p=s.parent,b=p.child(c-1);if(b.type!=r)return!1;if(e){let S=b.lastChild&&b.lastChild.type==p.type,O=F.from(S?r.create():null),B=new ot(F.from(r.create(null,F.from(p.type.create(null,O)))),S?3:1,0),U=s.start,J=s.end;e(t.tr.step(new pe(U-(S?3:1),J,U,J,B,1,!0)).scrollIntoView())}return!0}}const Lu={link:{attrs:{href:{},title:{default:null},target:{default:"_blank"}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs:r=>({href:r.getAttribute("href"),title:r.getAttribute("title"),target:r.getAttribute("target")})}],toDOM(r){const{href:t,title:e,target:n}=r.attrs;return["a",{href:t,title:e,target:n},0]}},em:{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"}],toDOM:()=>["em",0]},strong:{parseDOM:[{tag:"strong"},{tag:"b",getAttrs:r=>"normal"!==r.style.fontWeight&&null},{style:"font-weight",getAttrs:r=>/^(?:bold(?:er)?|[5-9]\d{2,})$/.test(r)&&null}],toDOM:()=>["strong",0]},code:{parseDOM:[{tag:"code"}],toDOM:()=>["code",0]},u:{parseDOM:[{tag:"u"},{style:"text-decoration=underline",consuming:!1}],toDOM:()=>["u",0]},s:{parseDOM:[{tag:"s"},{tag:"strike"},{style:"text-decoration=line-through"}],toDOM:()=>["s",0]},text_color:{attrs:{color:{default:null}},parseDOM:[{style:"color",getAttrs:r=>({color:r})}],toDOM(r){const{color:t}=r.attrs;return["span",{style:`color:${t};`},0]}},text_background_color:{attrs:{backgroundColor:{default:null}},parseDOM:[{style:"background-color",getAttrs:r=>({backgroundColor:r})}],toDOM(r){const{backgroundColor:t}=r.attrs;return["span",{style:`background-color:${t};`},0]}}},Uu={doc:{content:"block+"},text:{group:"inline"},paragraph:{content:"inline*",group:"block",attrs:{align:{default:null}},parseDOM:[{tag:"p",getAttrs(r){const{textAlign:t}=r.style;return{align:r.getAttribute("align")||t||null}}}],toDOM(r){const{align:t}=r.attrs;return["p",{style:V({textAlign:"left"!==t?t:null})||null},0]}},blockquote:{content:"block+",group:"block",defining:!0,parseDOM:[{tag:"blockquote"}],toDOM:()=>["blockquote",0]},horizontal_rule:{group:"block",parseDOM:[{tag:"hr"}],toDOM:()=>["hr"]},heading:{attrs:{level:{default:1},align:{default:null}},content:"inline*",group:"block",defining:!0,parseDOM:[{tag:"h1",getAttrs(r){const{textAlign:t}=r.style;return{level:1,align:r.getAttribute("align")||t||null}}},{tag:"h2",getAttrs(r){const{textAlign:t}=r.style;return{level:2,align:r.getAttribute("align")||t||null}}},{tag:"h3",getAttrs(r){const{textAlign:t}=r.style;return{level:3,align:r.getAttribute("align")||t||null}}},{tag:"h4",getAttrs(r){const{textAlign:t}=r.style;return{level:4,align:r.getAttribute("align")||t||null}}},{tag:"h5",getAttrs(r){const{textAlign:t}=r.style;return{level:5,align:r.getAttribute("align")||t||null}}},{tag:"h6",getAttrs(r){const{textAlign:t}=r.style;return{level:6,align:r.getAttribute("align")||t||null}}}],toDOM(r){const{level:t,align:e}=r.attrs;return[`h${t}`,{style:V({textAlign:"left"!==e?e:null})||null},0]}},hard_break:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:()=>["br"]},code_block:{content:"text*",marks:"",group:"block",code:!0,defining:!0,parseDOM:[{tag:"pre",preserveWhitespace:"full"}],toDOM:()=>["pre",["code",0]]},image:{inline:!0,attrs:{src:{},alt:{default:null},title:{default:null},width:{default:null}},group:"inline",draggable:!0,parseDOM:[{tag:"img[src]",getAttrs:r=>({src:r.getAttribute("src"),title:r.getAttribute("title"),alt:r.getAttribute("alt"),width:r.getAttribute("width")})}],toDOM(r){const{src:t,alt:e,title:n,width:i}=r.attrs;return["img",{src:t,alt:e,title:n,width:i}]}},list_item:{...qa,content:"paragraph block*"},ordered_list:{...Qa,content:"list_item+",group:"block"},bullet_list:{...Xa,content:"list_item+",group:"block"}},fi=new class El{constructor(t){this.cached=Object.create(null);let e=this.spec={};for(let i in t)e[i]=t[i];e.nodes=st.from(t.nodes),e.marks=st.from(t.marks||{}),this.nodes=Ae.compile(this.spec.nodes,this),this.marks=Ci.compile(this.spec.marks,this);let n=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let s=this.nodes[i],c=s.spec.content||"",p=s.spec.marks;s.contentMatch=n[c]||(n[c]=Et.parse(c,this.nodes)),s.inlineContent=s.contentMatch.inlineContent,s.markSet="_"==p?null:p?Is(this,p.split(" ")):""!=p&&s.inlineContent?null:[]}for(let i in this.marks){let s=this.marks[i],c=s.spec.excludes;s.excluded=null==c?[s]:""==c?[]:Is(this,c.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(t,e=null,n,i){if("string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof Ae))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,n,i)}text(t,e){let n=this.nodes.text;return new Qt(n,n.defaultAttrs,t,W.setFrom(e))}mark(t,e){return"string"==typeof t&&(t=this.marks[t]),t.create(e)}nodeFromJSON(t){return Wt.fromJSON(this,t)}markFromJSON(t){return W.fromJSON(this,t)}nodeType(t){let e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e}}({marks:Lu,nodes:Uu}),nl=(r,t)=>!r.selection.empty&&(t&&t(r.tr.deleteSelection().scrollIntoView()),!0);function rl(r,t){let{$cursor:e}=r.selection;return!e||(t?!t.endOfTextblock("backward",r):e.parentOffset>0)?null:e}function Or(r,t,e=!1){for(let n=r;n;n="start"==t?n.firstChild:n.lastChild){if(n.isTextblock)return!0;if(e&&1!=n.childCount)return!1}return!1}function ol(r){if(!r.parent.type.spec.isolating)for(let t=r.depth-1;t>=0;t--){if(r.index(t)>0)return r.doc.resolve(r.before(t+1));if(r.node(t).type.spec.isolating)break}return null}function ls(r,t){let{$cursor:e}=r.selection;return!e||(t?!t.endOfTextblock("forward",r):e.parentOffset<e.parent.content.size)?null:e}function us(r){if(!r.parent.type.spec.isolating)for(let t=r.depth-1;t>=0;t--){let e=r.node(t);if(r.index(t)+1<e.childCount)return r.doc.resolve(r.after(t+1));if(e.type.spec.isolating)break}return null}const zn=(r,t)=>{let{$head:e,$anchor:n}=r.selection;return!(!e.parent.type.spec.code||!e.sameParent(n))&&(t&&t(r.tr.insertText("\n").scrollIntoView()),!0)};function or(r){for(let t=0;t<r.edgeCount;t++){let{type:e}=r.edge(t);if(e.isTextblock&&!e.hasRequiredAttrs())return e}return null}const Hn=(r,t)=>{let{$head:e,$anchor:n}=r.selection;if(!e.parent.type.spec.code||!e.sameParent(n))return!1;let i=e.node(-1),s=e.indexAfter(-1),c=or(i.contentMatchAt(s));if(!c||!i.canReplaceWith(s,s,c))return!1;if(t){let p=e.after(),b=r.tr.replaceWith(p,p,c.createAndFill());b.setSelection(Gt.near(b.doc.resolve(p),1)),t(b.scrollIntoView())}return!0},sr=(r,t)=>{let e=r.selection,{$from:n,$to:i}=e;if(e instanceof be||n.parent.inlineContent||i.parent.inlineContent)return!1;let s=or(i.parent.contentMatchAt(i.indexAfter()));if(!s||!s.isTextblock)return!1;if(t){let c=(!n.parentOffset&&i.index()<i.parent.childCount?n:i).pos,p=r.tr.insert(c,s.createAndFill());p.setSelection(Kt.create(p.doc,c+1)),t(p.scrollIntoView())}return!0},ar=(r,t)=>{let{$cursor:e}=r.selection;if(!e||e.parent.content.size)return!1;if(e.depth>1&&e.after()!=e.end(-1)){let s=e.before();if(Kn(r.doc,s))return t&&t(r.tr.split(s).scrollIntoView()),!0}let n=e.blockRange(),i=n&&fr(n);return null!=i&&(t&&t(r.tr.lift(n,i).scrollIntoView()),!0)};const hs=function cs(r){return(t,e)=>{let{$from:n,$to:i}=t.selection;if(t.selection instanceof Vt&&t.selection.node.isBlock)return!(!n.parentOffset||!Kn(t.doc,n.pos))&&(e&&e(t.tr.split(n.pos).scrollIntoView()),!0);if(!n.parent.isBlock)return!1;if(e){let s=i.parentOffset==i.parent.content.size,c=t.tr;(t.selection instanceof Kt||t.selection instanceof be)&&c.deleteSelection();let p=0==n.depth?null:or(n.node(-1).contentMatchAt(n.indexAfter(-1))),b=r&&r(i.parent,s),S=b?[b]:s&&p?[{type:p}]:void 0,O=Kn(c.doc,c.mapping.map(n.pos),1,S);if(!S&&!O&&Kn(c.doc,c.mapping.map(n.pos),1,p?[{type:p}]:void 0)&&(p&&(S=[{type:p}]),O=!0),O&&(c.split(c.mapping.map(n.pos),1,S),!s&&!n.parentOffset&&n.parent.type!=p)){let B=c.mapping.map(n.before()),U=c.doc.resolve(B);p&&n.node(-1).canReplaceWith(U.index(),U.index()+1,p)&&c.setNodeMarkup(c.mapping.map(n.before()),p)}e(c.scrollIntoView())}return!0}}();function no(r,t,e){let s,c,n=t.nodeBefore,i=t.nodeAfter;if(n.type.spec.isolating||i.type.spec.isolating)return!1;if(function ju(r,t,e){let n=t.nodeBefore,i=t.nodeAfter,s=t.index();return!(!(n&&i&&n.type.compatibleContent(i.type))||(!n.content.size&&t.parent.canReplace(s-1,s)?(e&&e(r.tr.delete(t.pos-n.nodeSize,t.pos).scrollIntoView()),0):!t.parent.canReplace(s,s+1)||!i.isTextblock&&!Di(r.doc,t.pos)||(e&&e(r.tr.clearIncompatible(t.pos,n.type,n.contentMatchAt(n.childCount)).join(t.pos).scrollIntoView()),0)))}(r,t,e))return!0;let p=t.parent.canReplace(t.index(),t.index()+1);if(p&&(s=(c=n.contentMatchAt(n.childCount)).findWrapping(i.type))&&c.matchType(s[0]||i.type).validEnd){if(e){let B=t.pos+i.nodeSize,U=F.empty;for(let ct=s.length-1;ct>=0;ct--)U=F.from(s[ct].create(null,U));U=F.from(n.copy(U));let J=r.tr.step(new pe(t.pos-1,B,t.pos,B,new ot(U,1,0),s.length,!0)),nt=B+2*s.length;Di(J.doc,nt)&&J.join(nt),e(J.scrollIntoView())}return!0}let b=Gt.findFrom(t,1),S=b&&b.$from.blockRange(b.$to),O=S&&fr(S);if(null!=O&&O>=t.depth)return e&&e(r.tr.lift(S,O).scrollIntoView()),!0;if(p&&Or(i,"start",!0)&&Or(n,"end")){let B=n,U=[];for(;U.push(B),!B.isTextblock;)B=B.lastChild;let J=i,nt=1;for(;!J.isTextblock;J=J.firstChild)nt++;if(B.canReplace(B.childCount,B.childCount,J.content)){if(e){let ct=F.empty;for(let St=U.length-1;St>=0;St--)ct=F.from(U[St].copy(ct));e(r.tr.step(new pe(t.pos-U.length,t.pos+i.nodeSize,t.pos+nt,t.pos+i.nodeSize-nt,new ot(ct,U.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function al(r){return function(t,e){let n=t.selection,i=r<0?n.$from:n.$to,s=i.depth;for(;i.node(s).isInline;){if(!s)return!1;s--}return!!i.node(s).isTextblock&&(e&&e(t.tr.setSelection(Kt.create(t.doc,r<0?i.start(s):i.end(s)))),!0)}}const le=al(-1),Ku=al(1);function ds(r,t=null){return function(e,n){let i=!1;for(let s=0;s<e.selection.ranges.length&&!i;s++){let{$from:{pos:c},$to:{pos:p}}=e.selection.ranges[s];e.doc.nodesBetween(c,p,(b,S)=>{if(i)return!1;if(b.isTextblock&&!b.hasMarkup(r,t))if(b.type==r)i=!0;else{let O=e.doc.resolve(S),B=O.index();i=O.parent.canReplaceWith(B,B+1,r)}})}if(!i)return!1;if(n){let s=e.tr;for(let c=0;c<e.selection.ranges.length;c++){let{$from:{pos:p},$to:{pos:b}}=e.selection.ranges[c];s.setBlockType(p,b,r,t)}n(s.scrollIntoView())}return!0}}function Pr(r,t=null){return function(e,n){let{empty:i,$cursor:s,ranges:c}=e.selection;if(i&&!s||!function ll(r,t,e){for(let n=0;n<t.length;n++){let{$from:i,$to:s}=t[n],c=0==i.depth&&r.inlineContent&&r.type.allowsMarkType(e);if(r.nodesBetween(i.pos,s.pos,p=>{if(c)return!1;c=p.inlineContent&&p.type.allowsMarkType(e)}),c)return!0}return!1}(e.doc,c,r))return!1;if(n)if(s)r.isInSet(e.storedMarks||s.marks())?n(e.tr.removeStoredMark(r)):n(e.tr.addStoredMark(r.create(t)));else{let p=!1,b=e.tr;for(let S=0;!p&&S<c.length;S++){let{$from:O,$to:B}=c[S];p=e.doc.rangeHasMark(O.pos,B.pos,r)}for(let S=0;S<c.length;S++){let{$from:O,$to:B}=c[S];if(p)b.removeMark(O.pos,B.pos,r);else{let U=O.pos,J=B.pos,nt=O.nodeAfter,ct=B.nodeBefore,Ct=nt&&nt.isText?/^\s*/.exec(nt.text)[0].length:0,St=ct&&ct.isText?/\s*$/.exec(ct.text)[0].length:0;U+Ct<J&&(U+=Ct,J-=St),b.addMark(U,J,r.create(t))}}n(b.scrollIntoView())}return!0}}function gi(...r){return function(t,e,n){for(let i=0;i<r.length;i++)if(r[i](t,e,n))return!0;return!1}}let fs=gi(nl,(r,t,e)=>{let n=rl(r,e);if(!n)return!1;let i=ol(n);if(!i){let c=n.blockRange(),p=c&&fr(c);return null!=p&&(t&&t(r.tr.lift(c,p).scrollIntoView()),!0)}let s=i.nodeBefore;if(!s.type.spec.isolating&&no(r,i,t))return!0;if(0==n.parent.content.size&&(Or(s,"end")||Vt.isSelectable(s))){let c=Ws(r.doc,n.before(),n.after(),ot.empty);if(c&&c.slice.size<c.to-c.from){if(t){let p=r.tr.step(c);p.setSelection(Or(s,"end")?Gt.findFrom(p.doc.resolve(p.mapping.map(i.pos,-1)),-1):Vt.create(p.doc,i.pos-s.nodeSize)),t(p.scrollIntoView())}return!0}}return!(!s.isAtom||i.depth!=n.depth-1)&&(t&&t(r.tr.delete(i.pos-s.nodeSize,i.pos).scrollIntoView()),!0)},(r,t,e)=>{let{$head:n,empty:i}=r.selection,s=n;if(!i)return!1;if(n.parent.isTextblock){if(e?!e.endOfTextblock("backward",r):n.parentOffset>0)return!1;s=ol(n)}let c=s&&s.nodeBefore;return!(!c||!Vt.isSelectable(c))&&(t&&t(r.tr.setSelection(Vt.create(r.doc,s.pos-c.nodeSize)).scrollIntoView()),!0)}),ul=gi(nl,(r,t,e)=>{let n=ls(r,e);if(!n)return!1;let i=us(n);if(!i)return!1;let s=i.nodeAfter;if(no(r,i,t))return!0;if(0==n.parent.content.size&&(Or(s,"start")||Vt.isSelectable(s))){let c=Ws(r.doc,n.before(),n.after(),ot.empty);if(c&&c.slice.size<c.to-c.from){if(t){let p=r.tr.step(c);p.setSelection(Or(s,"start")?Gt.findFrom(p.doc.resolve(p.mapping.map(i.pos)),1):Vt.create(p.doc,p.mapping.map(i.pos))),t(p.scrollIntoView())}return!0}}return!(!s.isAtom||i.depth!=n.depth-1)&&(t&&t(r.tr.delete(i.pos,i.pos+s.nodeSize).scrollIntoView()),!0)},(r,t,e)=>{let{$head:n,empty:i}=r.selection,s=n;if(!i)return!1;if(n.parent.isTextblock){if(e?!e.endOfTextblock("forward",r):n.parentOffset<n.parent.content.size)return!1;s=us(n)}let c=s&&s.nodeAfter;return!(!c||!Vt.isSelectable(c))&&(t&&t(r.tr.setSelection(Vt.create(r.doc,s.pos)).scrollIntoView()),!0)});const bn={Enter:gi(zn,sr,ar,hs),"Mod-Enter":Hn,Backspace:fs,"Mod-Backspace":fs,"Shift-Backspace":fs,Delete:ul,"Mod-Delete":ul,"Mod-a":(r,t)=>(t&&t(r.tr.setSelection(new be(r.doc))),!0)},cl={"Ctrl-h":bn.Backspace,"Alt-Backspace":bn["Mod-Backspace"],"Ctrl-d":bn.Delete,"Ctrl-Alt-Backspace":bn["Mod-Delete"],"Alt-Delete":bn["Mod-Delete"],"Alt-d":bn["Mod-Delete"],"Ctrl-a":le,"Ctrl-e":Ku};for(let r in bn)cl[r]=bn[r];const vi=(typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&"darwin"==os.platform())?cl:bn;class Cn{constructor(t,e){this.match=t,this.match=t,this.handler="string"==typeof e?function yi(r){return function(t,e,n,i){let s=r;if(e[1]){let c=e[0].lastIndexOf(e[1]);s+=e[0].slice(c+e[1].length);let p=(n+=c)-i;p>0&&(s=e[0].slice(c-p,c)+s,n=i)}return t.tr.insertText(s,n,i)}}(e):e}}function hl(r,t,e,n,i,s){if(r.composing)return!1;let c=r.state,p=c.doc.resolve(t);if(p.parent.type.spec.code)return!1;let b=p.parent.textBetween(Math.max(0,p.parentOffset-500),p.parentOffset,null,"\ufffc")+n;for(let S=0;S<i.length;S++){let O=i[S].match.exec(b),B=O&&i[S].handler(c,O,t-(O[0].length-n.length),e);if(B)return r.dispatch(B.setMeta(s,{transform:B,from:t,to:e,text:n})),!0}return!1}const tc=new Cn(/--$/,"\u2014"),xi=new Cn(/\.\.\.$/,"\u2026"),l=[new Cn(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"\u201c"),new Cn(/"$/,"\u201d"),new Cn(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"\u2018"),new Cn(/'$/,"\u2019")];function u(r,t,e=null,n){return new Cn(r,(i,s,c,p)=>{let b=e instanceof Function?e(s):e,S=i.tr.delete(c,p),B=S.doc.resolve(c).blockRange(),U=B&&Yr(B,t,b);if(!U)return null;S.wrap(B,U);let J=S.doc.resolve(c-1).nodeBefore;return J&&J.type==t&&Di(S.doc,c-1)&&(!n||n(s,J))&&S.join(c-1),S})}function v(r,t,e=null){return new Cn(r,(n,i,s,c)=>{let p=n.doc.resolve(s),b=e instanceof Function?e(i):e;return p.node(-1).canReplaceWith(p.index(-1),p.indexAfter(-1),t)?n.tr.delete(s,c).setBlockType(s,s,t,b):null})}const M=(r,t)=>{const{from:e,$from:n,to:i,empty:s}=r.selection;return s?Boolean(t.isInSet(r.storedMarks||n.marks())):r.doc.rangeHasMark(e,i,t)},R=(r,t,e={})=>{const{selection:n}=r,{$from:i,to:s}=n,c=((r,t)=>{for(let e=t.depth;e>0;e-=1)if(t.node(e).type===r)return t.node(e).type;return null})(t,i);return Object.entries(e).length&&c?s<=i.end()&&i.parent.hasMarkup(t,e):Boolean(c)},G=r=>{const t=[],{selection:{from:e,to:n}}=r;return r.doc.nodesBetween(e,n,i=>{t.push(i)}),t},Q=(r,t,e)=>{for(const n of t){const{$from:i,$to:s}=n;let c=0===i.depth&&r.type.allowsMarkType(e);if(r.nodesBetween(i.pos,s.pos,p=>!c&&(c=p.inlineContent&&p.type.allowsMarkType(e),!0)),c)return!0}return!1},rt=(r,t,e)=>new Cn(r,(n,i,s,c)=>{const{tr:p}=n,b=s;let S=c;if(i[2]){const O=s+i[0].indexOf(i[2]),B=O+i[2].length;B<c&&p.delete(B,c),O>s&&p.delete(s,O),S=s+i[2].length}return p.addMark(b,S,t.create(e))}),xt=(r,t={})=>(e,n)=>{const{tr:i,selection:s}=e,{empty:c,ranges:p,$from:b,$to:S}=s;if(c&&s instanceof Kt){const{$cursor:O}=s;if(!O||!Q(e.doc,p,r)||(i.addStoredMark(r.create(t)),!i.storedMarksSet))return!1;n?.(i)}else{if(i.addMark(b.pos,S.pos,r.create(t)),!i.docChanged)return!1;n?.(i.scrollIntoView())}return!0};var wt=f(1481);function Mt(r){return r.split("-")[1]}function It(r){return"y"===r?"height":"width"}function Dt(r){return r.split("-")[0]}function Ot(r){return["top","bottom"].includes(Dt(r))?"x":"y"}function te(r,t,e){let{reference:n,floating:i}=r;const s=n.x+n.width/2-i.width/2,c=n.y+n.height/2-i.height/2,p=Ot(t),b=It(p),S=n[b]/2-i[b]/2,O="x"===p;let B;switch(Dt(t)){case"top":B={x:s,y:n.y-i.height};break;case"bottom":B={x:s,y:n.y+n.height};break;case"right":B={x:n.x+n.width,y:c};break;case"left":B={x:n.x-i.width,y:c};break;default:B={x:n.x,y:n.y}}switch(Mt(t)){case"start":B[p]-=S*(e&&O?-1:1);break;case"end":B[p]+=S*(e&&O?-1:1)}return B}const re=function(){var r=E(function*(t,e,n){const{placement:i="bottom",strategy:s="absolute",middleware:c=[],platform:p}=n,b=c.filter(Boolean),S=yield null==p.isRTL?void 0:p.isRTL(e);let O=yield p.getElementRects({reference:t,floating:e,strategy:s}),{x:B,y:U}=te(O,i,S),J=i,nt={},ct=0;for(let Ct=0;Ct<b.length;Ct++){const{name:St,fn:Lt}=b[Ct],{x:Bt,y:Zt,data:Ut,reset:jt}=yield Lt({x:B,y:U,initialPlacement:i,placement:J,strategy:s,middlewareData:nt,rects:O,platform:p,elements:{reference:t,floating:e}});B=Bt??B,U=Zt??U,nt={...nt,[St]:{...nt[St],...Ut}},jt&&ct<=50&&(ct++,"object"==typeof jt&&(jt.placement&&(J=jt.placement),jt.rects&&(O=!0===jt.rects?yield p.getElementRects({reference:t,floating:e,strategy:s}):jt.rects),({x:B,y:U}=te(O,J,S))),Ct=-1)}return{x:B,y:U,placement:J,strategy:s,middlewareData:nt}});return function(e,n,i){return r.apply(this,arguments)}}();function ve(r){return"number"!=typeof r?(t=r,{top:0,right:0,bottom:0,left:0,...t}):{top:r,right:r,bottom:r,left:r};var t}function ie(r){return{...r,top:r.y,left:r.x,right:r.x+r.width,bottom:r.y+r.height}}function ye(r,t){return ue.apply(this,arguments)}function ue(){return(ue=E(function*(r,t){var e;void 0===t&&(t={});const{x:n,y:i,platform:s,rects:c,elements:p,strategy:b}=r,{boundary:S="clippingAncestors",rootBoundary:O="viewport",elementContext:B="floating",altBoundary:U=!1,padding:J=0}=t,nt=ve(J),ct=p[U?"floating"===B?"reference":"floating":B],Ct=ie(yield s.getClippingRect({element:null==(e=yield null==s.isElement?void 0:s.isElement(ct))||e?ct:ct.contextElement||(yield null==s.getDocumentElement?void 0:s.getDocumentElement(p.floating)),boundary:S,rootBoundary:O,strategy:b})),St="floating"===B?{...c.floating,x:n,y:i}:c.reference,Lt=yield null==s.getOffsetParent?void 0:s.getOffsetParent(p.floating),Bt=(yield null==s.isElement?void 0:s.isElement(Lt))&&(yield null==s.getScale?void 0:s.getScale(Lt))||{x:1,y:1},Zt=ie(s.convertOffsetParentRelativeRectToViewportRelativeRect?yield s.convertOffsetParentRelativeRectToViewportRelativeRect({rect:St,offsetParent:Lt,strategy:b}):St);return{top:(Ct.top-Zt.top+nt.top)/Bt.y,bottom:(Zt.bottom-Ct.bottom+nt.bottom)/Bt.y,left:(Ct.left-Zt.left+nt.left)/Bt.x,right:(Zt.right-Ct.right+nt.right)/Bt.x}})).apply(this,arguments)}Math.min,Math.max;const zc=["top","right","bottom","left"],Hc=zc.reduce((r,t)=>r.concat(t,t+"-start",t+"-end"),[]),Mh={left:"right",right:"left",bottom:"top",top:"bottom"};function dl(r){return r.replace(/left|right|bottom|top/g,t=>Mh[t])}function Vc(r,t,e){void 0===e&&(e=!1);const n=Mt(r),i=Ot(r),s=It(i);let c="x"===i?n===(e?"end":"start")?"right":"left":"start"===n?"bottom":"top";return t.reference[s]>t.floating[s]&&(c=dl(c)),{main:c,cross:dl(c)}}const Th={start:"end",end:"start"};function fl(r){return r.replace(/start|end/g,t=>Th[t])}const Nh=function(r){return void 0===r&&(r={}),{name:"autoPlacement",options:r,fn:t=>E(function*(){var e,n,i;const{rects:s,middlewareData:c,placement:p,platform:b,elements:S}=t,{crossAxis:O=!1,alignment:B,allowedPlacements:U=Hc,autoAlignment:J=!0,...nt}=r,ct=void 0!==B||U===Hc?(ce=J,Re=U,((ee=B||null)?[...Re.filter(ge=>Mt(ge)===ee),...Re.filter(ge=>Mt(ge)!==ee)]:Re.filter(ge=>Dt(ge)===ge)).filter(ge=>!ee||Mt(ge)===ee||!!ce&&fl(ge)!==ge)):U,Ct=yield ye(t,nt),St=(null==(e=c.autoPlacement)?void 0:e.index)||0,Lt=ct[St];var ee,ce,Re;if(null==Lt)return{};const{main:Bt,cross:Zt}=Vc(Lt,s,yield null==b.isRTL?void 0:b.isRTL(S.floating));if(p!==Lt)return{reset:{placement:ct[0]}};const Ut=[Ct[Dt(Lt)],Ct[Bt],Ct[Zt]],jt=[...(null==(n=c.autoPlacement)?void 0:n.overflows)||[],{placement:Lt,overflows:Ut}],qt=ct[St+1];if(qt)return{data:{index:St+1,overflows:jt},reset:{placement:qt}};const zt=jt.map(ee=>{const ce=Mt(ee.placement);return[ee.placement,ce&&O?ee.overflows.slice(0,2).reduce((Re,ge)=>Re+ge,0):ee.overflows[0],ee.overflows]}).sort((ee,ce)=>ee[1]-ce[1]),Ie=(null==(i=zt.filter(ee=>ee[2].slice(0,Mt(ee[0])?2:3).every(ce=>ce<=0))[0])?void 0:i[0])||zt[0][0];return Ie!==p?{data:{index:St+1,overflows:jt},reset:{placement:Ie}}:{}})()}};function Ke(r){var t;return(null==(t=r.ownerDocument)?void 0:t.defaultView)||window}function Vn(r){return Ke(r).getComputedStyle(r)}const Jc=Math.min,ps=Math.max,pl=Math.round;function $c(r){const t=Vn(r);let e=parseFloat(t.width),n=parseFloat(t.height);const i=r.offsetWidth,s=r.offsetHeight,c=pl(e)!==i||pl(n)!==s;return c&&(e=i,n=s),{width:e,height:n,fallback:c}}function Rr(r){return Wc(r)?(r.nodeName||"").toLowerCase():""}let ml;function Yc(){if(ml)return ml;const r=navigator.userAgentData;return r&&Array.isArray(r.brands)?(ml=r.brands.map(t=>t.brand+"/"+t.version).join(" "),ml):navigator.userAgent}function Zn(r){return r instanceof Ke(r).HTMLElement}function kn(r){return r instanceof Ke(r).Element}function Wc(r){return r instanceof Ke(r).Node}function jc(r){return!(typeof ShadowRoot>"u")&&(r instanceof Ke(r).ShadowRoot||r instanceof ShadowRoot)}function gl(r){const{overflow:t,overflowX:e,overflowY:n,display:i}=Vn(r);return/auto|scroll|overlay|hidden|clip/.test(t+n+e)&&!["inline","contents"].includes(i)}function Ih(r){return["table","td","th"].includes(Rr(r))}function nc(r){const t=/firefox/i.test(Yc()),e=Vn(r),n=e.backdropFilter||e.WebkitBackdropFilter;return"none"!==e.transform||"none"!==e.perspective||!!n&&"none"!==n||t&&"filter"===e.willChange||t&&!!e.filter&&"none"!==e.filter||["transform","perspective"].some(i=>e.willChange.includes(i))||["paint","layout","strict","content"].some(i=>{const s=e.contain;return null!=s&&s.includes(i)})}function rc(){return/^((?!chrome|android).)*safari/i.test(Yc())}function ic(r){return["html","body","#document"].includes(Rr(r))}function Kc(r){return kn(r)?r:r.contextElement}const Qc={x:1,y:1};function ro(r){const t=Kc(r);if(!Zn(t))return Qc;const e=t.getBoundingClientRect(),{width:n,height:i,fallback:s}=$c(t);let c=(s?pl(e.width):e.width)/n,p=(s?pl(e.height):e.height)/i;return c&&Number.isFinite(c)||(c=1),p&&Number.isFinite(p)||(p=1),{x:c,y:p}}function _i(r,t,e,n){var i,s;void 0===t&&(t=!1),void 0===e&&(e=!1);const c=r.getBoundingClientRect(),p=Kc(r);let b=Qc;t&&(n?kn(n)&&(b=ro(n)):b=ro(r));const S=p?Ke(p):window,O=rc()&&e;let B=(c.left+(O&&(null==(i=S.visualViewport)?void 0:i.offsetLeft)||0))/b.x,U=(c.top+(O&&(null==(s=S.visualViewport)?void 0:s.offsetTop)||0))/b.y,J=c.width/b.x,nt=c.height/b.y;if(p){const ct=Ke(p),Ct=n&&kn(n)?Ke(n):n;let St=ct.frameElement;for(;St&&n&&Ct!==ct;){const Lt=ro(St),Bt=St.getBoundingClientRect(),Zt=getComputedStyle(St);Bt.x+=(St.clientLeft+parseFloat(Zt.paddingLeft))*Lt.x,Bt.y+=(St.clientTop+parseFloat(Zt.paddingTop))*Lt.y,B*=Lt.x,U*=Lt.y,J*=Lt.x,nt*=Lt.y,B+=Bt.x,U+=Bt.y,St=Ke(St).frameElement}}return{width:J,height:nt,top:U,right:B+J,bottom:U+nt,left:B,x:B,y:U}}function Br(r){return((Wc(r)?r.ownerDocument:r.document)||window.document).documentElement}function vl(r){return kn(r)?{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}:{scrollLeft:r.pageXOffset,scrollTop:r.pageYOffset}}function Xc(r){return _i(Br(r)).left+vl(r).scrollLeft}function ms(r){if("html"===Rr(r))return r;const t=r.assignedSlot||r.parentNode||jc(r)&&r.host||Br(r);return jc(t)?t.host:t}function qc(r){const t=ms(r);return ic(t)?t.ownerDocument.body:Zn(t)&&gl(t)?t:qc(t)}function gs(r,t){var e;void 0===t&&(t=[]);const n=qc(r),i=n===(null==(e=r.ownerDocument)?void 0:e.body),s=Ke(n);return i?t.concat(s,s.visualViewport||[],gl(n)?n:[]):t.concat(n,gs(n))}function th(r,t,e){let n;if("viewport"===t)n=function(c,p){const b=Ke(c),S=Br(c),O=b.visualViewport;let B=S.clientWidth,U=S.clientHeight,J=0,nt=0;if(O){B=O.width,U=O.height;const ct=rc();(!ct||ct&&"fixed"===p)&&(J=O.offsetLeft,nt=O.offsetTop)}return{width:B,height:U,x:J,y:nt}}(r,e);else if("document"===t)n=function(c){const p=Br(c),b=vl(c),S=c.ownerDocument.body,O=ps(p.scrollWidth,p.clientWidth,S.scrollWidth,S.clientWidth),B=ps(p.scrollHeight,p.clientHeight,S.scrollHeight,S.clientHeight);let U=-b.scrollLeft+Xc(c);const J=-b.scrollTop;return"rtl"===Vn(S).direction&&(U+=ps(p.clientWidth,S.clientWidth)-O),{width:O,height:B,x:U,y:J}}(Br(r));else if(kn(t))n=function(c,p){const b=_i(c,!0,"fixed"===p),S=b.top+c.clientTop,O=b.left+c.clientLeft,B=Zn(c)?ro(c):{x:1,y:1};return{width:c.clientWidth*B.x,height:c.clientHeight*B.y,x:O*B.x,y:S*B.y}}(t,e);else{const c={...t};if(rc()){var i,s;const p=Ke(r);c.x-=(null==(i=p.visualViewport)?void 0:i.offsetLeft)||0,c.y-=(null==(s=p.visualViewport)?void 0:s.offsetTop)||0}n=c}return ie(n)}function eh(r,t){return Zn(r)&&"fixed"!==Vn(r).position?t?t(r):r.offsetParent:null}function nh(r,t){const e=Ke(r);let n=eh(r,t);for(;n&&Ih(n)&&"static"===Vn(n).position;)n=eh(n,t);return n&&("html"===Rr(n)||"body"===Rr(n)&&"static"===Vn(n).position&&!nc(n))?e:n||function(i){let s=ms(i);for(;Zn(s)&&!ic(s);){if(nc(s))return s;s=ms(s)}return null}(r)||e}function Oh(r,t,e){const n=Zn(t),i=Br(t),s=_i(r,!0,"fixed"===e,t);let c={scrollLeft:0,scrollTop:0};const p={x:0,y:0};if(n||!n&&"fixed"!==e)if(("body"!==Rr(t)||gl(i))&&(c=vl(t)),Zn(t)){const b=_i(t,!0);p.x=b.x+t.clientLeft,p.y=b.y+t.clientTop}else i&&(p.x=Xc(i));return{x:s.left+c.scrollLeft-p.x,y:s.top+c.scrollTop-p.y,width:s.width,height:s.height}}const Ah={getClippingRect:function(r){let{element:t,boundary:e,rootBoundary:n,strategy:i}=r;const c=[..."clippingAncestors"===e?function(S,O){const B=O.get(S);if(B)return B;let U=gs(S).filter(Ct=>kn(Ct)&&"body"!==Rr(Ct)),J=null;const nt="fixed"===Vn(S).position;let ct=nt?ms(S):S;for(;kn(ct)&&!ic(ct);){const Ct=Vn(ct),St=nc(ct);(nt?St||J:St||"static"!==Ct.position||!J||!["absolute","fixed"].includes(J.position))?J=Ct:U=U.filter(Lt=>Lt!==ct),ct=ms(ct)}return O.set(S,U),U}(t,this._c):[].concat(e),n],p=c[0],b=c.reduce((S,O)=>{const B=th(t,O,i);return S.top=ps(B.top,S.top),S.right=Jc(B.right,S.right),S.bottom=Jc(B.bottom,S.bottom),S.left=ps(B.left,S.left),S},th(t,p,i));return{width:b.right-b.left,height:b.bottom-b.top,x:b.left,y:b.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(r){let{rect:t,offsetParent:e,strategy:n}=r;const i=Zn(e),s=Br(e);if(e===s)return t;let c={scrollLeft:0,scrollTop:0},p={x:1,y:1};const b={x:0,y:0};if((i||!i&&"fixed"!==n)&&(("body"!==Rr(e)||gl(s))&&(c=vl(e)),Zn(e))){const S=_i(e);p=ro(e),b.x=S.x+e.clientLeft,b.y=S.y+e.clientTop}return{width:t.width*p.x,height:t.height*p.y,x:t.x*p.x-c.scrollLeft*p.x+b.x,y:t.y*p.y-c.scrollTop*p.y+b.y}},isElement:kn,getDimensions:function(r){return Zn(r)?$c(r):r.getBoundingClientRect()},getOffsetParent:nh,getDocumentElement:Br,getScale:ro,getElementRects(r){var t=this;return E(function*(){let{reference:e,floating:n,strategy:i}=r;const s=t.getOffsetParent||nh,c=t.getDimensions;return{reference:Oh(e,yield s(n),i),floating:{x:0,y:0,...yield c(n)}}})()},getClientRects:r=>Array.from(r.getClientRects()),isRTL:r=>"rtl"===Vn(r).direction};for(var zr={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},yl={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Ph=typeof navigator<"u"&&/Mac/.test(navigator.platform),Lh=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Ne=0;Ne<10;Ne++)zr[48+Ne]=zr[96+Ne]=String(Ne);for(Ne=1;Ne<=24;Ne++)zr[Ne+111]="F"+Ne;for(Ne=65;Ne<=90;Ne++)zr[Ne]=String.fromCharCode(Ne+32),yl[Ne]=String.fromCharCode(Ne);for(var oc in zr)yl.hasOwnProperty(oc)||(yl[oc]=zr[oc]);const Rh=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform);function Bh(r){let n,i,s,c,t=r.split(/-(?!$)/),e=t[t.length-1];"Space"==e&&(e=" ");for(let p=0;p<t.length-1;p++){let b=t[p];if(/^(cmd|meta|m)$/i.test(b))c=!0;else if(/^a(lt)?$/i.test(b))n=!0;else if(/^(c|ctrl|control)$/i.test(b))i=!0;else if(/^s(hift)?$/i.test(b))s=!0;else{if(!/^mod$/i.test(b))throw new Error("Unrecognized modifier name: "+b);Rh?c=!0:i=!0}}return n&&(e="Alt-"+e),i&&(e="Ctrl-"+e),c&&(e="Meta-"+e),s&&(e="Shift-"+e),e}function sc(r,t,e){return t.altKey&&(r="Alt-"+r),t.ctrlKey&&(r="Ctrl-"+r),t.metaKey&&(r="Meta-"+r),!1!==e&&t.shiftKey&&(r="Shift-"+r),r}function xl(r){return new oe({props:{handleKeyDown:Hh(r)}})}function Hh(r){let t=function zh(r){let t=Object.create(null);for(let e in r)t[Bh(e)]=r[e];return t}(r);return function(e,n){let c,i=function Fh(r){var e=!(Ph&&r.metaKey&&r.shiftKey&&!r.ctrlKey&&!r.altKey||Lh&&r.shiftKey&&r.key&&1==r.key.length||"Unidentified"==r.key)&&r.key||(r.shiftKey?yl:zr)[r.keyCode]||r.key||"Unidentified";return"Esc"==e&&(e="Escape"),"Del"==e&&(e="Delete"),"Left"==e&&(e="ArrowLeft"),"Up"==e&&(e="ArrowUp"),"Right"==e&&(e="ArrowRight"),"Down"==e&&(e="ArrowDown"),e}(n),s=1==i.length&&" "!=i,p=t[sc(i,n,!s)];if(p&&p(e.state,e.dispatch,e))return!0;if(s&&(n.shiftKey||n.altKey||n.metaKey||i.charCodeAt(0)>127)&&(c=zr[n.keyCode])&&c!=i){let b=t[sc(c,n,!0)];if(b&&b(e.state,e.dispatch,e))return!0}else if(s&&n.shiftKey){let b=t[sc(i,n,!0)];if(b&&b(e.state,e.dispatch,e))return!0}return!1}}var Se=function(){};Se.prototype.append=function(t){return t.length?(t=Se.from(t),!this.length&&t||t.length<200&&this.leafAppend(t)||this.length<200&&t.leafPrepend(this)||this.appendInner(t)):this},Se.prototype.prepend=function(t){return t.length?Se.from(t).append(this):this},Se.prototype.appendInner=function(t){return new Vh(this,t)},Se.prototype.slice=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.length),t>=e?Se.empty:this.sliceInner(Math.max(0,t),Math.min(this.length,e))},Se.prototype.get=function(t){if(!(t<0||t>=this.length))return this.getInner(t)},Se.prototype.forEach=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=this.length),e<=n?this.forEachInner(t,e,n,0):this.forEachInvertedInner(t,e,n,0)},Se.prototype.map=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=this.length);var i=[];return this.forEach(function(s,c){return i.push(t(s,c))},e,n),i},Se.from=function(t){return t instanceof Se?t:t&&t.length?new rh(t):Se.empty};var rh=function(r){function t(n){r.call(this),this.values=n}r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t;var e={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(i,s){return 0==i&&s==this.length?this:new t(this.values.slice(i,s))},t.prototype.getInner=function(i){return this.values[i]},t.prototype.forEachInner=function(i,s,c,p){for(var b=s;b<c;b++)if(!1===i(this.values[b],p+b))return!1},t.prototype.forEachInvertedInner=function(i,s,c,p){for(var b=s-1;b>=c;b--)if(!1===i(this.values[b],p+b))return!1},t.prototype.leafAppend=function(i){if(this.length+i.length<=200)return new t(this.values.concat(i.flatten()))},t.prototype.leafPrepend=function(i){if(this.length+i.length<=200)return new t(i.flatten().concat(this.values))},e.length.get=function(){return this.values.length},e.depth.get=function(){return 0},Object.defineProperties(t.prototype,e),t}(Se);Se.empty=new rh([]);var Vh=function(r){function t(e,n){r.call(this),this.left=e,this.right=n,this.length=e.length+n.length,this.depth=Math.max(e.depth,n.depth)+1}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(n){return n<this.left.length?this.left.get(n):this.right.get(n-this.left.length)},t.prototype.forEachInner=function(n,i,s,c){var p=this.left.length;if(i<p&&!1===this.left.forEachInner(n,i,Math.min(s,p),c)||s>p&&!1===this.right.forEachInner(n,Math.max(i-p,0),Math.min(this.length,s)-p,c+p))return!1},t.prototype.forEachInvertedInner=function(n,i,s,c){var p=this.left.length;if(i>p&&!1===this.right.forEachInvertedInner(n,i-p,Math.max(s,p)-p,c+p)||s<p&&!1===this.left.forEachInvertedInner(n,Math.min(i,p),s,c))return!1},t.prototype.sliceInner=function(n,i){if(0==n&&i==this.length)return this;var s=this.left.length;return i<=s?this.left.slice(n,i):n>=s?this.right.slice(n-s,i-s):this.left.slice(n,s).append(this.right.slice(0,i-s))},t.prototype.leafAppend=function(n){var i=this.right.leafAppend(n);if(i)return new t(this.left,i)},t.prototype.leafPrepend=function(n){var i=this.left.leafPrepend(n);if(i)return new t(i,this.right)},t.prototype.appendInner=function(n){return this.left.depth>=Math.max(this.right.depth,n.depth)+1?new t(this.left,new t(this.right,n)):new t(this,n)},t}(Se);const ih=Se;class En{constructor(t,e){this.items=t,this.eventCount=e}popEvent(t,e){if(0==this.eventCount)return null;let i,s,n=this.items.length;for(;;n--)if(this.items.get(n-1).selection){--n;break}e&&(i=this.remapping(n,this.items.length),s=i.maps.length);let p,b,c=t.tr,S=[],O=[];return this.items.forEach((B,U)=>{if(!B.step)return i||(i=this.remapping(n,U+1),s=i.maps.length),s--,void O.push(B);if(i){O.push(new Gn(B.map));let nt,J=B.step.map(i.slice(s));J&&c.maybeStep(J).doc&&(nt=c.mapping.maps[c.mapping.maps.length-1],S.push(new Gn(nt,void 0,void 0,S.length+O.length))),s--,nt&&i.appendMap(nt,s)}else c.maybeStep(B.step);return B.selection?(p=i?B.selection.map(i.slice(s)):B.selection,b=new En(this.items.slice(0,n).append(O.reverse().concat(S)),this.eventCount-1),!1):void 0},this.items.length,0),{remaining:b,transform:c,selection:p}}addTransform(t,e,n,i){let s=[],c=this.eventCount,p=this.items,b=!i&&p.length?p.get(p.length-1):null;for(let O=0;O<t.steps.length;O++){let J,B=t.steps[O].invert(t.docs[O]),U=new Gn(t.mapping.maps[O],B,e);(J=b&&b.merge(U))&&(U=J,O?s.pop():p=p.slice(0,p.length-1)),s.push(U),e&&(c++,e=void 0),i||(b=U)}let S=c-n.depth;return S>Uh&&(p=function Gh(r,t){let e;return r.forEach((n,i)=>{if(n.selection&&0==t--)return e=i,!1}),r.slice(e)}(p,S),c-=S),new En(p.append(s),c)}remapping(t,e){let n=new dr;return this.items.forEach((i,s)=>{let c=null!=i.mirrorOffset&&s-i.mirrorOffset>=t?n.maps.length-i.mirrorOffset:void 0;n.appendMap(i.map,c)},t,e),n}addMaps(t){return 0==this.eventCount?this:new En(this.items.append(t.map(e=>new Gn(e))),this.eventCount)}rebased(t,e){if(!this.eventCount)return this;let n=[],i=Math.max(0,this.items.length-e),s=t.mapping,c=t.steps.length,p=this.eventCount;this.items.forEach(U=>{U.selection&&p--},i);let b=e;this.items.forEach(U=>{let J=s.getMirror(--b);if(null==J)return;c=Math.min(c,J);let nt=s.maps[J];if(U.step){let ct=t.steps[J].invert(t.docs[J]),Ct=U.selection&&U.selection.map(s.slice(b+1,J));Ct&&p++,n.push(new Gn(nt,ct,Ct))}else n.push(new Gn(nt))},i);let S=[];for(let U=e;U<c;U++)S.push(new Gn(s.maps[U]));let O=this.items.slice(0,i).append(S).append(n),B=new En(O,p);return B.emptyItemCount()>500&&(B=B.compress(this.items.length-n.length)),B}emptyItemCount(){let t=0;return this.items.forEach(e=>{e.step||t++}),t}compress(t=this.items.length){let e=this.remapping(0,t),n=e.maps.length,i=[],s=0;return this.items.forEach((c,p)=>{if(p>=t)i.push(c),c.selection&&s++;else if(c.step){let b=c.step.map(e.slice(n)),S=b&&b.getMap();if(n--,S&&e.appendMap(S,n),b){let O=c.selection&&c.selection.map(e.slice(n));O&&s++;let U,B=new Gn(S.invert(),b,O),J=i.length-1;(U=i.length&&i[J].merge(B))?i[J]=U:i.push(B)}}else c.map&&n--},this.items.length,0),new En(ih.from(i.reverse()),s)}}En.empty=new En(ih.empty,0);class Gn{constructor(t,e,n,i){this.map=t,this.step=e,this.selection=n,this.mirrorOffset=i}merge(t){if(this.step&&t.step&&!t.selection){let e=t.step.merge(this.step);if(e)return new Gn(e.getMap().invert(),e,this.selection)}}}class Hr{constructor(t,e,n,i){this.done=t,this.undone=e,this.prevRanges=n,this.prevTime=i}}const Uh=20;function oh(r){let t=[];return r.forEach((e,n,i,s)=>t.push(i,s)),t}function ac(r,t){if(!r)return null;let e=[];for(let n=0;n<r.length;n+=2){let i=t.map(r[n],1),s=t.map(r[n+1],-1);i<=s&&e.push(i,s)}return e}function sh(r,t,e,n){let i=wl(t),s=Un.get(t).spec.config,c=(n?r.undone:r.done).popEvent(t,i);if(!c)return;let p=c.selection.resolve(c.transform.doc),b=(n?r.done:r.undone).addTransform(c.transform,t.selection.getBookmark(),s,i),S=new Hr(n?b:c.remaining,n?c.remaining:b,null,0);e(c.transform.setSelection(p).setMeta(Un,{redo:n,historyState:S}).scrollIntoView())}let lc=!1,ah=null;function wl(r){let t=r.plugins;if(ah!=t){lc=!1,ah=t;for(let e=0;e<t.length;e++)if(t[e].spec.historyPreserveItems){lc=!0;break}}return lc}const Un=new vn("history"),lh=new vn("closeHistory");function Yh(r={}){return r={depth:r.depth||100,newGroupDelay:r.newGroupDelay||500},new oe({key:Un,state:{init:()=>new Hr(En.empty,En.empty,null,0),apply:(t,e,n)=>function Jh(r,t,e,n){let s,i=e.getMeta(Un);if(i)return i.historyState;e.getMeta(lh)&&(r=new Hr(r.done,r.undone,null,0));let c=e.getMeta("appendedTransaction");if(0==e.steps.length)return r;if(c&&c.getMeta(Un))return c.getMeta(Un).redo?new Hr(r.done.addTransform(e,void 0,n,wl(t)),r.undone,oh(e.mapping.maps[e.steps.length-1]),r.prevTime):new Hr(r.done,r.undone.addTransform(e,void 0,n,wl(t)),null,r.prevTime);if(!1===e.getMeta("addToHistory")||c&&!1===c.getMeta("addToHistory"))return(s=e.getMeta("rebased"))?new Hr(r.done.rebased(e,s),r.undone.rebased(e,s),ac(r.prevRanges,e.mapping),r.prevTime):new Hr(r.done.addMaps(e.mapping.maps),r.undone.addMaps(e.mapping.maps),ac(r.prevRanges,e.mapping),r.prevTime);{let p=0==r.prevTime||!c&&(r.prevTime<(e.time||0)-n.newGroupDelay||!function $h(r,t){if(!t)return!1;if(!r.docChanged)return!0;let e=!1;return r.mapping.maps[0].forEach((n,i)=>{for(let s=0;s<t.length;s+=2)n<=t[s+1]&&i>=t[s]&&(e=!0)}),e}(e,r.prevRanges)),b=c?ac(r.prevRanges,e.mapping):oh(e.mapping.maps[e.steps.length-1]);return new Hr(r.done.addTransform(e,p?t.selection.getBookmark():void 0,n,wl(t)),En.empty,b,e.time)}}(e,n,t,r)},config:r,props:{handleDOMEvents:{beforeinput(t,e){let n=e.inputType,i="historyUndo"==n?uh:"historyRedo"==n?uc:null;return!!i&&(e.preventDefault(),i(t.state,t.dispatch))}}}})}const uh=(r,t)=>{let e=Un.getState(r);return!(!e||0==e.done.eventCount)&&(t&&sh(e,r,t,!1),!0)},uc=(r,t)=>{let e=Un.getState(r);return!(!e||0==e.undone.eventCount)&&(t&&sh(e,r,t,!0),!0)};const Wh=["imgEl"];function jh(r,t){if(1&r){const e=h.EpF();h.TgZ(0,"span",4)(1,"span",5),h.NdJ("mousedown",function(i){h.CHM(e);const s=h.oxw();return h.KtG(s.startResizing(i,"left"))}),h.qZA(),h.TgZ(2,"span",6),h.NdJ("mousedown",function(i){h.CHM(e);const s=h.oxw();return h.KtG(s.startResizing(i,"right"))}),h.qZA(),h.TgZ(3,"span",7),h.NdJ("mousedown",function(i){h.CHM(e);const s=h.oxw();return h.KtG(s.startResizing(i,"left"))}),h.qZA(),h.TgZ(4,"span",8),h.NdJ("mousedown",function(i){h.CHM(e);const s=h.oxw();return h.KtG(s.startResizing(i,"right"))}),h.qZA()()}}const Kh=function(r){return{"NgxEditor__Resizer--Active":r}},Qh=["ngxEditor"],ch=["*"];function Xh(r,t){if(1&r&&(h.TgZ(0,"div",12),h._uU(1),h.qZA()),2&r){const e=h.oxw(2);h.xp6(1),h.hij(" ",(null==e.href.errors?null:e.href.errors.pattern)&&"Please enter valid url."," ")}}function qh(r,t){if(1&r&&(h.TgZ(0,"div",12),h._uU(1),h.qZA()),2&r){const e=h.oxw(2);h.xp6(1),h.hij(" ",(null==e.text.errors?null:e.text.errors.required)&&"This is required"," ")}}function td(r,t){if(1&r){const e=h.EpF();h.TgZ(0,"div",2)(1,"form",3),h.NdJ("ngSubmit",function(i){h.CHM(e);const s=h.oxw();return h.KtG(s.insertLink(i))}),h.TgZ(2,"div",4)(3,"div",5)(4,"label",6),h._uU(5),h.qZA(),h._UZ(6,"input",7),h.YNc(7,Xh,2,1,"div",8),h.qZA()(),h.TgZ(8,"div",4)(9,"div",5)(10,"label",6),h._uU(11),h.qZA(),h._UZ(12,"input",9),h.YNc(13,qh,2,1,"div",8),h.qZA()(),h.TgZ(14,"div",4)(15,"div",5)(16,"label"),h._UZ(17,"input",10),h._uU(18),h.qZA()()(),h.TgZ(19,"button",11),h._uU(20),h.qZA()()()}if(2&r){const e=h.oxw();h.xp6(1),h.Q6J("formGroup",e.form),h.xp6(4),h.Oqu(e.getLabel("url")),h.xp6(2),h.Q6J("ngIf",e.href.touched&&e.href.invalid),h.xp6(4),h.Oqu(e.getLabel("text")),h.xp6(2),h.Q6J("ngIf",e.text.touched&&e.text.invalid),h.xp6(5),h.hij(" ",e.getLabel("openInNewTab")," "),h.xp6(1),h.Q6J("disabled",!e.form.valid),h.xp6(1),h.Oqu(e.getLabel("insert"))}}const ed=function(r,t){return{"NgxEditor__Dropdown--Active":r,"NgxEditor--Disabled":t}};function nd(r,t){if(1&r){const e=h.EpF();h.TgZ(0,"div",4),h.NdJ("mousedown",function(i){const c=h.CHM(e).$implicit,p=h.oxw(2);return h.KtG(p.onClick(i,c))}),h._uU(1),h.qZA()}if(2&r){const e=t.$implicit,n=h.oxw(2);h.Q6J("ngClass",h.WLB(2,ed,e===n.activeItem,n.disabledItems.includes(e))),h.xp6(1),h.hij(" ",n.getName(e)," ")}}function rd(r,t){if(1&r&&(h.TgZ(0,"div",2),h.YNc(1,nd,2,5,"div",3),h.qZA()),2&r){const e=h.oxw();h.xp6(1),h.Q6J("ngForOf",e.items)("ngForTrackBy",e.trackByIndex)}}function id(r,t){if(1&r&&(h.TgZ(0,"div",12),h._uU(1),h.qZA()),2&r){const e=h.oxw(2);h.xp6(1),h.hij(" ",(null==e.src.errors?null:e.src.errors.pattern)&&"Please enter valid url."," ")}}function od(r,t){if(1&r){const e=h.EpF();h.TgZ(0,"div",2)(1,"form",3),h.NdJ("ngSubmit",function(i){h.CHM(e);const s=h.oxw();return h.KtG(s.insertLink(i))}),h.TgZ(2,"div",4)(3,"div",5)(4,"label",6),h._uU(5),h.qZA(),h._UZ(6,"input",7),h.YNc(7,id,2,1,"div",8),h.qZA()(),h.TgZ(8,"div",4)(9,"div",5)(10,"label",6),h._uU(11),h.qZA(),h._UZ(12,"input",9),h.qZA()(),h.TgZ(13,"div",4)(14,"div",5)(15,"label",6),h._uU(16),h.qZA(),h._UZ(17,"input",10),h.qZA()(),h.TgZ(18,"button",11),h._uU(19),h.qZA()()()}if(2&r){const e=h.oxw();h.xp6(1),h.Q6J("formGroup",e.form),h.xp6(4),h.Oqu(e.getLabel("url")),h.xp6(2),h.Q6J("ngIf",e.src.touched&&e.src.invalid),h.xp6(4),h.Oqu(e.getLabel("altText")),h.xp6(5),h.Oqu(e.getLabel("title")),h.xp6(2),h.Q6J("disabled",!e.form.valid||!e.form.dirty),h.xp6(1),h.Oqu(e.getLabel("insert"))}}const sd=function(r,t){return{backgroundColor:r,color:t}},ad=function(r){return{"NgxEditor__Color--Active":r}};function ld(r,t){if(1&r){const e=h.EpF();h.TgZ(0,"button",7),h.NdJ("mousedown",function(i){const c=h.CHM(e).$implicit,p=h.oxw(3);return h.KtG(p.onColorSelect(i,c))}),h.qZA()}if(2&r){const e=t.$implicit,n=h.oxw(3);h.Q6J("ngStyle",h.WLB(3,sd,e,n.getContrastYIQ(e)))("title",e)("ngClass",h.VKq(6,ad,n.activeColors.includes(e)))}}function ud(r,t){if(1&r&&(h.TgZ(0,"div",5),h.YNc(1,ld,1,8,"button",6),h.qZA()),2&r){const e=t.$implicit,n=h.oxw(2);h.xp6(1),h.Q6J("ngForOf",e)("ngForTrackBy",n.trackByIndex)}}function cd(r,t){if(1&r){const e=h.EpF();h.TgZ(0,"div",2),h.YNc(1,ud,2,2,"div",3),h.TgZ(2,"button",4),h.NdJ("mousedown",function(i){h.CHM(e);const s=h.oxw();return h.KtG(s.remove(i))}),h._uU(3),h.qZA()()}if(2&r){const e=h.oxw();h.xp6(1),h.Q6J("ngForOf",e.presets)("ngForTrackBy",e.trackByIndex),h.xp6(1),h.Q6J("disabled",!e.isActive),h.xp6(1),h.hij(" ",e.getLabel("remove")," ")}}function hd(r,t){if(1&r&&h._UZ(0,"ngx-toggle-command",7),2&r){const e=h.oxw().$implicit,n=h.oxw(2);h.Tol(n.iconContainerClass),h.Q6J("toolbarItem",e)}}function dd(r,t){if(1&r&&h._UZ(0,"ngx-insert-command",7),2&r){const e=h.oxw().$implicit,n=h.oxw(2);h.Tol(n.iconContainerClass),h.Q6J("toolbarItem",e)}}function fd(r,t){if(1&r&&h._UZ(0,"ngx-link"),2&r){const e=h.oxw(3);h.Tol(e.iconContainerClass)}}function pd(r,t){if(1&r&&h._UZ(0,"ngx-image"),2&r){const e=h.oxw(3);h.Tol(e.iconContainerClass)}}function md(r,t){if(1&r&&h._UZ(0,"ngx-dropdown",9),2&r){const e=t.$implicit,n=h.oxw(4);h.Tol(n.dropdownContainerClass),h.Q6J("group",e.key)("items",e.value)}}function gd(r,t){if(1&r&&(h.ynx(0),h.YNc(1,md,1,4,"ngx-dropdown",8),h.ALo(2,"keyvalue"),h.BQk()),2&r){const e=h.oxw().$implicit,n=h.oxw(2);h.xp6(1),h.Q6J("ngForOf",h.lcZ(2,2,n.getDropdownItems(e)))("ngForTrackBy",n.trackByIndex)}}function vd(r,t){if(1&r&&h._UZ(0,"ngx-color-picker",10),2&r){const e=h.oxw(3);h.Tol(e.iconContainerClass),h.Q6J("presets",e.presets)}}function yd(r,t){if(1&r&&h._UZ(0,"ngx-color-picker",11),2&r){const e=h.oxw(3);h.Tol(e.iconContainerClass),h.Q6J("presets",e.presets)}}function xd(r,t){if(1&r&&h._UZ(0,"div"),2&r){const e=h.oxw(3);h.Tol(e.seperatorClass)}}function _d(r,t){if(1&r&&(h.ynx(0),h.YNc(1,hd,1,3,"ngx-toggle-command",3),h.YNc(2,dd,1,3,"ngx-insert-command",3),h.YNc(3,fd,1,2,"ngx-link",4),h.YNc(4,pd,1,2,"ngx-image",4),h.YNc(5,gd,3,4,"ng-container",2),h.YNc(6,vd,1,3,"ngx-color-picker",5),h.YNc(7,yd,1,3,"ngx-color-picker",6),h.YNc(8,xd,1,2,"div",4),h.BQk()),2&r){const e=t.$implicit,n=t.last,i=h.oxw().last,s=h.oxw();h.xp6(1),h.Q6J("ngIf",s.toggleCommands.includes(e)),h.xp6(1),h.Q6J("ngIf",s.insertCommands.includes(e)),h.xp6(1),h.Q6J("ngIf","link"===e),h.xp6(1),h.Q6J("ngIf","image"===e),h.xp6(1),h.Q6J("ngIf",s.isDropDown(e)),h.xp6(1),h.Q6J("ngIf","text_color"===e),h.xp6(1),h.Q6J("ngIf","background_color"===e),h.xp6(1),h.Q6J("ngIf",n&&!i)}}function wd(r,t){if(1&r&&(h.ynx(0),h.YNc(1,_d,9,8,"ng-container",1),h.BQk()),2&r){const e=t.$implicit,n=h.oxw();h.xp6(1),h.Q6J("ngForOf",e)("ngForTrackBy",n.trackByIndex)}}function bd(r,t){if(1&r&&(h.ynx(0),h.GkF(1,12),h.BQk()),2&r){const e=h.oxw();h.xp6(1),h.Q6J("ngTemplateOutlet",e.customMenuRef)}}const Cd=function(r,t){return{"NgxEditor--Disabled":r,"NgxEditor__MenuBar--Reverse":t}},kd=function(r,t){return{"NgxBubbleMenu__Icon--Active":r,"NgxEditor--Disabled":t}};function Ed(r,t){if(1&r){const e=h.EpF();h.TgZ(0,"div",3),h.NdJ("mousedown",function(i){h.CHM(e);const s=h.oxw().$implicit,c=h.oxw(2);return h.KtG(c.onClick(i,s))}),h.qZA()}if(2&r){const e=h.oxw().$implicit,n=h.oxw(2);h.Q6J("ngClass",h.WLB(3,kd,n.activeItems.includes(e),!n.execulableItems.includes(e)))("title",n.getTitle(e))("innerHTML",n.getIcon(e),h.oJD)}}function Md(r,t){1&r&&h._UZ(0,"div",4)}function Td(r,t){if(1&r&&(h.ynx(0),h.YNc(1,Ed,1,6,"div",1),h.YNc(2,Md,1,0,"div",2),h.BQk()),2&r){const e=t.$implicit,n=t.last,i=h.oxw().last,s=h.oxw();h.xp6(1),h.Q6J("ngIf",s.toggleCommands.includes(e)),h.xp6(1),h.Q6J("ngIf",n&&!i)}}function Nd(r,t){if(1&r&&(h.ynx(0),h.YNc(1,Td,3,2,"ng-container",0),h.BQk()),2&r){const e=t.$implicit,n=h.oxw();h.xp6(1),h.Q6J("ngForOf",e)("ngForTrackBy",n.trackByIndex)}}function Sd(r,t){if(1&r&&(h.ynx(0),h._UZ(1,"ngx-bubble",2),h.BQk()),2&r){const e=h.oxw();h.xp6(1),h.Q6J("editor",e.editor)}}const Id=(r=!0)=>new oe({key:new vn("editable"),state:{init:()=>r,apply:(t,e)=>t.getMeta("UPDATE_EDITABLE")??e},props:{editable(t){return this.getState(t)},attributes(t){return this.getState(t)?null:{class:"NgxEditor__Content--Disabled"}}}}),Ad=r=>new oe({key:new vn("placeholder"),state:{init:()=>r??"",apply:(t,e)=>t.getMeta("UPDATE_PLACEHOLDER")??e},props:{decorations(t){const{doc:e}=t,{textContent:n,childCount:i}=e,s=this.getState(t);if(!s||i>1)return Yt.empty;const c=[];return e.descendants((b,S)=>{if(b.type.isBlock&&0===b.childCount&&0===n.length){const O=S,B=S+b.nodeSize,U=Ve.node(O,B,{class:"NgxEditor__Placeholder","data-placeholder":s,"data-align":b.attrs.align??null});c.push(U)}return!1}),Yt.create(e,c)}}});class vs{constructor(){this.alt="",this.title="",this.outerWidth="",this.selected=!1,this.imageResize=new h.vpe}startResizing(t,e){t.preventDefault(),this.resizeImage(t,e)}resizeImage(t,e){const n=t.pageX,i=this.imgEl.nativeElement.clientWidth,s="left"===e,{width:c}=window.getComputedStyle(this.view.dom),p=parseInt(c,10),b=O=>{const U=O.pageX-n,J=s?i-U:i+U;J>p||J<20||(this.outerWidth=`${J}px`)},S=O=>{O.preventDefault(),document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",S),this.imageResize.emit()};document.addEventListener("mousemove",b),document.addEventListener("mouseup",S)}}vs.\u0275fac=function(t){return new(t||vs)},vs.\u0275cmp=h.Xpm({type:vs,selectors:[["ngx-image-view"]],viewQuery:function(t,e){if(1&t&&h.Gf(Wh,7),2&t){let n;h.iGM(n=h.CRH())&&(e.imgEl=n.first)}},inputs:{src:"src",alt:"alt",title:"title",outerWidth:"outerWidth",selected:"selected",view:"view"},outputs:{imageResize:"imageResize"},decls:4,vars:9,consts:[[1,"NgxEditor__ImageWrapper",3,"ngClass"],["class","NgxEditor__ResizeHandle",4,"ngIf"],[3,"src","alt","title"],["imgEl",""],[1,"NgxEditor__ResizeHandle"],[1,"NgxEditor__ResizeHandle--TL",3,"mousedown"],[1,"NgxEditor__ResizeHandle--TR",3,"mousedown"],[1,"NgxEditor__ResizeHandle--BL",3,"mousedown"],[1,"NgxEditor__ResizeHandle--BR",3,"mousedown"]],template:function(t,e){1&t&&(h.TgZ(0,"span",0),h.YNc(1,jh,5,0,"span",1),h._UZ(2,"img",2,3),h.qZA()),2&t&&(h.Udp("width",e.outerWidth),h.Q6J("ngClass",h.VKq(7,Kh,e.selected)),h.xp6(1),h.Q6J("ngIf",e.selected),h.xp6(1),h.Q6J("src",e.src,h.LSH)("alt",e.alt)("title",e.title))},dependencies:[ne.mk,ne.O5],styles:["*[_ngcontent-%COMP%], *[_ngcontent-%COMP%]:before, *[_ngcontent-%COMP%]:after{box-sizing:border-box}img[_ngcontent-%COMP%]{width:100%;height:100%}.NgxEditor__ImageWrapper[_ngcontent-%COMP%]{position:relative;display:inline-block;line-height:0;padding:2px}.NgxEditor__ImageWrapper.NgxEditor__Resizer--Active[_ngcontent-%COMP%]{padding:1px;border:1px solid #1a73e8}.NgxEditor__ImageWrapper[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle[_ngcontent-%COMP%]{position:absolute;height:100%;width:100%}.NgxEditor__ImageWrapper[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle--TL[_ngcontent-%COMP%], .NgxEditor__ImageWrapper[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle--BL[_ngcontent-%COMP%], .NgxEditor__ImageWrapper[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle--TR[_ngcontent-%COMP%], .NgxEditor__ImageWrapper[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle--BR[_ngcontent-%COMP%]{position:absolute;width:7px;height:7px;background-color:#1a73e8;border:1px solid white}.NgxEditor__ImageWrapper[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle--BR[_ngcontent-%COMP%]{bottom:-5px;right:-5px;cursor:se-resize}.NgxEditor__ImageWrapper[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle--TR[_ngcontent-%COMP%]{top:-5px;right:-5px;cursor:ne-resize}.NgxEditor__ImageWrapper[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle--TL[_ngcontent-%COMP%]{top:-5px;left:-5px;cursor:nw-resize}.NgxEditor__ImageWrapper[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle[_ngcontent-%COMP%]   .NgxEditor__ResizeHandle--BL[_ngcontent-%COMP%]{bottom:-5px;left:-5px;cursor:sw-resize}"]});class Fd{constructor(t,e,n,i){this.updating=!1,this.handleResize=()=>{if(this.updating)return;const{state:s,dispatch:c}=this.view,{tr:p}=s,b=p.setNodeMarkup(this.getPos(),void 0,{...this.node.attrs,width:this.imageComponentRef.instance.outerWidth}),S=b.doc.resolve(this.getPos()),O=new Vt(S);b.setSelection(O),c(b)},this.applicationRef=i.get(h.z2F),this.imageComponentRef=(0,h.LMc)(vs,{environmentInjector:this.applicationRef.injector}),this.applicationRef.attachView(this.imageComponentRef.hostView),this.setNodeAttributes(t.attrs),this.imageComponentRef.instance.view=e,this.dom=this.imageComponentRef.location.nativeElement,this.view=e,this.node=t,this.getPos=n,this.resizeSubscription=this.imageComponentRef.instance.imageResize.subscribe(()=>{this.handleResize()})}computeChanges(t,e){return JSON.stringify(t)===JSON.stringify(e)}setNodeAttributes(t){this.imageComponentRef.instance.src=t.src,this.imageComponentRef.instance.alt=t.alt,this.imageComponentRef.instance.title=t.title,this.imageComponentRef.instance.outerWidth=t.width}update(t){return t.type===this.node.type&&(this.node=t,this.computeChanges(this.node.attrs,t.attrs)&&(this.updating=!0,this.setNodeAttributes(t.attrs),this.updating=!1),!0)}ignoreMutation(){return!0}selectNode(){this.imageComponentRef.instance.selected=!0}deselectNode(){this.imageComponentRef.instance.selected=!1}destroy(){this.resizeSubscription.unsubscribe(),this.applicationRef.detachView(this.imageComponentRef.hostView)}}const Bd=/(?:https?:\/\/)?[\w-]+(?:\.[\w-]+)+\.?(?:\d+)?(?:\/\S*)?$/,hh=r=>{const t=[];return r.forEach(e=>{if(e.isText){const n=e.text;let i=0;const s=Bd.exec(n);if(s){const c=s.index,p=c+s[0].length,{link:b}=e.type.schema.marks;c>0&&t.push(e.cut(i,c));const S=n.slice(c,p);t.push(e.cut(c,p).mark(b.create({href:S}).addToSet(e.marks))),i=p}i<n.length&&t.push(e.cut(i))}else t.push(e.copy(hh(e.content)))}),F.fromArray(t)},Hd={type:"doc",content:[{type:"paragraph"}]},dh=(r,t)=>{const e=t??fi,n=e.nodeFromJSON(r),i=qe.fromSchema(e).serializeFragment(n.content),s=document.createElement("div");return s.appendChild(i),s.innerHTML},ys=(r,t)=>{if(!r)return t.nodeFromJSON(Hd);if("string"!=typeof r)return t.nodeFromJSON(r);const e=((r,t)=>{const e=t??fi,n=document.createElement("div");return n.innerHTML=r,$n.fromSchema(e).parse(n).toJSON()})(r,t);return t.nodeFromJSON(e)};class io{constructor(t,e,n){this.renderer=t,this.injector=e,this.elementRef=n,this.placeholder="Type Here...",this.focusOut=new h.vpe,this.focusIn=new h.vpe,this.unsubscribe=new x.x,this.onChange=()=>{},this.onTouched=()=>{}}writeValue(t){!this.outputFormat&&"string"==typeof t&&(this.outputFormat="html"),this.editor.setContent(t??"")}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this.setMeta("UPDATE_EDITABLE",!t),this.renderer.setProperty(this.elementRef.nativeElement,"disabled",t)}handleChange(t){if("html"!==this.outputFormat)this.onChange(t);else{const e=dh(t,this.editor.schema);this.onChange(e)}}setMeta(t,e){const{dispatch:n,state:{tr:i}}=this.editor.view;n(i.setMeta(t,e))}setPlaceholder(t){this.setMeta("UPDATE_PLACEHOLDER",t)}registerPlugins(){var r;this.editor.registerPlugin(Id()),this.editor.registerPlugin(Ad(this.placeholder)),this.editor.registerPlugin(((r={})=>new oe({key:new vn("attributes"),props:{attributes:r}}))({class:"NgxEditor__Content"})),this.editor.registerPlugin((r=()=>{this.focusIn.emit()},new oe({key:new vn("focus"),props:{handleDOMEvents:{focus:()=>(r(),!1)}}}))),this.editor.registerPlugin((r=>new oe({key:new vn("blur"),props:{handleDOMEvents:{blur:()=>(r(),!1)}}}))(()=>{this.focusOut.emit(),this.onTouched()})),this.editor.features.resizeImage&&this.editor.registerPlugin((r=>new oe({key:new vn("image-resize"),props:{nodeViews:{image:(t,e,n)=>new Fd(t,e,n,r)}}}))(this.injector)),this.editor.features.linkOnPaste&&this.editor.registerPlugin(new oe({key:new vn("linkify"),props:{transformPasted:r=>new ot(hh(r.content),r.openStart,r.openEnd)}}))}ngOnInit(){if(!this.editor)throw new K("Required editor instance for initializing editor component");this.registerPlugins(),this.renderer.appendChild(this.ngxEditor.nativeElement,this.editor.view.dom),this.editor.valueChanges.pipe((0,g.R)(this.unsubscribe)).subscribe(t=>{this.handleChange(t)})}ngOnChanges(t){t.placeholder&&!t.placeholder.isFirstChange()&&this.setPlaceholder(t.placeholder.currentValue)}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}}io.\u0275fac=function(t){return new(t||io)(h.Y36(h.Qsj),h.Y36(h.zs3),h.Y36(h.SBq))},io.\u0275cmp=h.Xpm({type:io,selectors:[["ngx-editor"]],viewQuery:function(t,e){if(1&t&&h.Gf(Qh,7),2&t){let n;h.iGM(n=h.CRH())&&(e.ngxEditor=n.first)}},inputs:{editor:"editor",outputFormat:"outputFormat",placeholder:"placeholder"},outputs:{focusOut:"focusOut",focusIn:"focusIn"},features:[h._Bn([{provide:k.JU,useExisting:(0,h.Gpc)(()=>io),multi:!0}]),h.TTD],ngContentSelectors:ch,decls:3,vars:0,consts:[[1,"NgxEditor"],["ngxEditor",""]],template:function(t,e){1&t&&(h.F$t(),h.TgZ(0,"div",0,1),h.Hsn(2),h.qZA())},styles:['.NgxEditor{background:white;color:#000;background-clip:padding-box;border-radius:4px;border:1px solid rgba(0,0,0,.2);position:relative}.NgxEditor--Disabled{opacity:.5;pointer-events:none}.NgxEditor__Placeholder:before{color:#6c757d;opacity:1;-webkit-user-select:none;user-select:none;position:absolute;cursor:text;content:attr(data-placeholder)}.NgxEditor__Placeholder[data-align=right]:before{position:relative}.NgxEditor__Content{padding:8px;white-space:pre-wrap;outline:none;font-variant-ligatures:none;font-feature-settings:"liga" 0,none}.NgxEditor__Content p{margin:0 0 10px}.NgxEditor__Content blockquote{padding-left:16px;border-left:3px solid #ddd;margin-left:0;margin-right:0}.NgxEditor__Content--Disabled{-webkit-user-select:none;user-select:none;pointer-events:none}.NgxEditor__Wrapper{border:1px solid rgba(0,0,0,.4);border-radius:4px}.NgxEditor__Wrapper .NgxEditor__MenuBar{border-top-left-radius:4px;border-top-right-radius:4px;border-bottom:1px solid rgba(0,0,0,.2)}.NgxEditor__Wrapper .NgxEditor{border-top-left-radius:0;border-top-right-radius:0;border:none}.NgxEditor__MenuBar{display:flex;flex-wrap:wrap;padding:3px;cursor:default;background-color:#fff}.NgxEditor__MenuItem{border-radius:2px;display:flex;align-items:center;justify-content:center;position:relative;flex-shrink:0}.NgxEditor__MenuItem:hover{background-color:#f1f1f1}.NgxEditor__MenuItem.NgxEditor__MenuItem--Icon{height:30px;width:30px;transition:.3s ease-in-out}.NgxEditor__MenuItem.NgxEditor__MenuItem--Icon+.NgxEditor__MenuItem--Icon{margin-left:2px}.NgxEditor__MenuItem .NgxEditor__MenuItem--IconContainer{display:flex;height:100%;width:100%;align-items:center;justify-content:center}.NgxEditor__MenuItem.NgxEditor__MenuItem--Text{padding:0 5px}.NgxEditor__MenuItem.NgxEditor__MenuItem--Active,.NgxEditor__MenuItem .NgxEditor__MenuItem--Active{background-color:#e8f0fe;color:#1a73e8}.NgxEditor__Dropdown{min-width:64px;position:relative;display:flex;align-items:center;flex-shrink:0}.NgxEditor__Dropdown:hover{background-color:#f1f1f1}.NgxEditor__Dropdown .NgxEditor__Dropdown--Text{display:flex;align-items:center;justify-content:center;padding:0 5px;height:100%;width:100%}.NgxEditor__Dropdown .NgxEditor__Dropdown--Text:after{display:inline-block;content:"";margin-left:24px;vertical-align:4px;border-top:4px solid;border-right:4px solid transparent;border-bottom:0;border-left:4px solid transparent}.NgxEditor__Dropdown .NgxEditor__Dropdown--DropdownMenu{position:absolute;left:0;box-shadow:#3c404326 0 2px 6px 2px;border-radius:4px;background-color:#fff;z-index:10;width:100%;top:32px}.NgxEditor__Dropdown .NgxEditor__Dropdown--Item{padding:8px;white-space:nowrap;color:inherit}.NgxEditor__Dropdown .NgxEditor__Dropdown--Item:hover{background-color:#ececec}.NgxEditor__Dropdown .NgxEditor__Dropdown--Selected,.NgxEditor__Dropdown .NgxEditor__Dropdown--Open{color:#1a73e8;background-color:#e8f0fe}.NgxEditor__Dropdown .NgxEditor__Dropdown--Active{background-color:#f1f1f1}.NgxEditor__Dropdown .NgxEditor__Dropdown--Active:hover{background-color:#e7e7e7}.NgxEditor__MenuBar--Reverse .NgxEditor__Dropdown--DropdownMenu{top:unset;bottom:32px}.NgxEditor__MenuBar--Reverse .NgxEditor__Dropdown--Text:after{transform:rotate(180deg)}.NgxEditor__MenuBar--Reverse .NgxEditor__Popup{top:unset;bottom:32px}.NgxEditor__Popup{position:absolute;top:32px;box-shadow:#3c404326 0 2px 6px 2px;border-radius:4px;background-color:#fff;z-index:10;min-width:192px;padding:8px}.NgxEditor__Popup .NgxEditor__Popup--FormGroup{margin-bottom:8px}.NgxEditor__Popup .NgxEditor__Popup--FormGroup label{margin-bottom:3px}.NgxEditor__Popup .NgxEditor__Popup--FormGroup input[type=text],.NgxEditor__Popup .NgxEditor__Popup--FormGroup input[type=url]{padding:2px 4px}.NgxEditor__Popup .NgxEditor__Popup--Col{display:flex;flex-direction:column;position:relative}.NgxEditor__Popup .NgxEditor__Popup--Label{font-size:85%}.NgxEditor__Seperator{border-left:1px solid #ccc;margin:0 5px}.NgxEditor__HelpText{font-size:80%}.NgxEditor__HelpText.NgxEditor__HelpText--Error{color:red}\n'],encapsulation:2});class Qe{constructor(){this.customMenuRefChange=new x.x}setCustomMenuRef(t){this.customMenuRefChange.next(t)}}Qe.\u0275fac=function(t){return new(t||Qe)},Qe.\u0275prov=h.Yz7({token:Qe,factory:Qe.\u0275fac,providedIn:"root"});class oo{constructor(t){this.name=t}apply(){return(t,e)=>{const{schema:n}=t,i=n.marks[this.name];return!!i&&xt(i)(t,e)}}toggle(){return(t,e)=>{const{schema:n}=t,i=n.marks[this.name];return!!i&&Pr(i)(t,e)}}isActive(t){const{schema:e}=t,n=e.marks[this.name];return!!n&&M(t,n)}canExecute(t){return this.toggle()(t)}}class bl{constructor(t=!1){this.isBulletList=!1,this.isBulletList=t}getType(t){return this.isBulletList?t.nodes.bullet_list:t.nodes.ordered_list}toggle(){return(t,e)=>{const{schema:n}=t,i=this.getType(n);return!!i&&(this.isActive(t)?tl(n.nodes.list_item)(t,e):Iu(i)(t,e))}}isActive(t){const{schema:e}=t,n=this.getType(e);return!!n&&R(t,n)}canExecute(t){return this.toggle()(t)}}class wi{constructor(t){this.level=t}apply(){return(t,e)=>{const{schema:n}=t,i=n.nodes.heading;return!!i&&ds(i)(t,e)}}toggle(){return(t,e)=>{const{schema:n,selection:i,doc:s}=t,c=n.nodes.heading;if(!c)return!1;const p=i.$from.before(1),S=s.nodeAt(p)?.attrs??{};return this.isActive(t)?ds(n.nodes.paragraph,S)(t,e):ds(c,{...S,level:this.level})(t,e)}}isActive(t){const{schema:e}=t,n=G(t),i=e.nodes.heading;if(!i)return!1;const s=[i,e.nodes.text,e.nodes.blockquote],p=n.filter(b=>s.includes(b.type)).find(b=>b.attrs.level===this.level);return Boolean(p)}canExecute(t){return this.toggle()(t)}}class xs{constructor(t){this.align=t}toggle(){return(t,e)=>{const{doc:n,selection:i,tr:s,schema:c}=t,{from:p,to:b}=i;let S=!1;return n.nodesBetween(p,b,(O,B)=>{const U=O.type;return[c.nodes.paragraph,c.nodes.heading].includes(U)&&(S=!0,s.setNodeMarkup(B,U,{...O.attrs,align:this.align})),!0}),!!S&&(s.docChanged&&e?.(s),!0)}}isActive(t){const n=G(t).find(i=>i.attrs.align===this.align);return Boolean(n)}canExecute(t){return this.toggle()(t)}}const Ud={strict:!0};class cc{update(t){return(e,n)=>{const{schema:i,selection:s}=e,c=i.marks.link;return!(!c||s.empty)&&Pr(c,t)(e,n)}}insert(t,e){return(n,i)=>{const{schema:s,tr:c}=n;if(!s.marks.link)return!1;const b={href:e.href,title:e.title??t,target:e.target??"_blank"},S=s.text(t,[s.marks.link.create(b)]);return c.replaceSelectionWith(S,!1).scrollIntoView(),!!c.docChanged&&(i?.(c),!0)}}isActive(t,e=Ud){if(e.strict)return!0;const{schema:n}=t,i=n.marks.link;return!!i&&M(t,i)}remove(t,e){return((r,t)=>{const{doc:e,selection:n,tr:i}=r,{$head:{pos:s},from:c,to:p}=n;if(c===p){const b=e.resolve(s),S=s-b.textOffset,O=S+b.parent.child(b.index()).nodeSize;i.removeMark(S,O)}else i.removeMark(c,p);return!!i.docChanged&&(t?.(i),!0)})(t,e)}canExecute(t){const e={href:""};return this.insert("Exec",e)(t)||this.update(e)(t)}}class fh{insert(t,e){return(n,i)=>{const{schema:s,tr:c,selection:p}=n,b=s.nodes.image;if(!b)return!1;const S={width:null,src:t,...e};!S.width&&p instanceof Vt&&p.node.type===b&&(S.width=p.node.attrs.width),c.replaceSelectionWith(b.createAndFill(S));const O=c.doc.resolve(c.selection.anchor-c.selection.$anchor.nodeBefore.nodeSize);return c.setSelection(new Vt(O)).scrollIntoView(),!!c.docChanged&&(i?.(c),!0)}}isActive(t){const{selection:e}=t;return e instanceof Vt&&"image"===e.node.type.name}}class so{constructor(t,e="color"){this.name=t,this.attrName=e}apply(t){return(e,n)=>{const{schema:i,selection:s,doc:c}=e,p=i.marks[this.name];if(!p)return!1;const{from:b,to:S,empty:O}=s;if(!O&&b+1===S){const B=c.nodeAt(b);if(B?.isAtom&&!B.isText&&B.isLeaf)return!1}return xt(p,t)(e,n)}}isActive(t){const{schema:e}=t,n=e.marks[this.name];return!!n&&M(t,n)}getActiveColors(t){if(!this.isActive(t))return[];const{schema:e}=t;return(r=>{let t=[];const{selection:e,storedMarks:n}=r,{from:i,to:s,empty:c,$from:p}=e;return c?t=n||p.marks():r.doc.nodesBetween(i,s,b=>{t=[...t,...b.marks]}),t})(t).filter(s=>s.type===e.marks[this.name]).map(s=>s.attrs[this.attrName]).filter(Boolean)}remove(){return(t,e)=>{const{schema:n}=t,i=n.marks[this.name];return!!i&&(r=i,(t,e)=>{const{tr:n,selection:i,storedMarks:s,doc:c}=t,{empty:p,ranges:b}=i;if(p&&i instanceof Kt){const{$cursor:S}=i;if(!S||!Q(t.doc,b,r))return!1;if(r.isInSet(s||S.marks()))return n.removeStoredMark(r),e?.(n),!0}else{for(const S of b){const{$from:O,$to:B}=S;c.rangeHasMark(O.pos,B.pos,r)&&n.removeMark(O.pos,B.pos,r)}if(!n.docChanged)return!1;e?.(n.scrollIntoView())}return!1})(t,e);var r}}canExecute(t){const e="text_color"===this.name?{color:""}:{backgroundColor:""};return this.apply(e)(t)}}const Jd=["link"];const Yd=new oo("strong"),Wd=new oo("em"),jd=new oo("code"),Kd=new oo("u"),Qd=new oo("s"),Xd=new class Zd{toggle(){return(t,e)=>{const{schema:n}=t,i=n.nodes.blockquote;return!!i&&(this.isActive(t)?((r,t)=>{let{$from:e,$to:n}=r.selection,i=e.blockRange(n),s=i&&fr(i);return null!=s&&(t&&t(r.tr.lift(i,s).scrollIntoView()),!0)})(t,e):function Dr(r,t=null){return function(e,n){let{$from:i,$to:s}=e.selection,c=i.blockRange(s),p=c&&Yr(c,r,t);return!!p&&(n&&n(e.tr.wrap(c,p).scrollIntoView()),!0)}}(i)(t,e))}}isActive(t){const{schema:e}=t,n=e.nodes.blockquote;return!!n&&R(t,n)}canExecute(t){return this.toggle()(t)}},qd=new class Gd{insert(){return(t,e)=>{const{schema:n,tr:i}=t,s=n.nodes.horizontal_rule;return!!s&&(e(i.replaceSelectionWith(s.create()).scrollIntoView()),!0)}}canExecute(t){return((r,t)=>{const{$from:e}=r.selection;for(let n=e.depth;n>=0;n-=1){const i=e.index(n);if(e.node(n).canReplaceWith(i,i,t))return!0}return!1})(t,t.schema.nodes.horizontal_rule)}},tf=new class $d{insert(){return(t,e)=>{const{tr:n}=t,{ranges:i,empty:s}=n.selection;return s||(Object.entries(t.schema.marks).forEach(([c,p])=>{Jd.includes(c)||i.forEach(b=>{n.removeMark(b.$from.pos,b.$to.pos,p)})}),e(n)),!0}}canExecute(){return!0}},ef=new bl(!0),nf=new bl(!1),rf=new wi(1),of=new wi(2),sf=new wi(3),af=new wi(4),lf=new wi(5),uf=new wi(6),cf=new xs("left"),hf=new xs("center"),df=new xs("right"),ff=new xs("justify"),pf=new cc,mf=new fh,gf=new so("text_color","color"),vf=new so("text_background_color","backgroundColor"),ao={bold:Yd,italic:Wd,code:jd,underline:Kd,strike:Qd,blockquote:Xd,bullet_list:ef,ordered_list:nf,h1:rf,h2:of,h3:sf,h4:af,h5:lf,h6:uf,align_left:cf,align_center:hf,align_right:df,align_justify:ff},ph={horizontal_rule:qd,format_clear:tf},_s=pf,mh=mf,yf=gf,xf=vf,hc={bold:"Bold",italic:"Italic",code:"Code",underline:"Underline",strike:"Strike",blockquote:"Blockquote",bullet_list:"Bullet List",ordered_list:"Ordered List",heading:"Heading",h1:"Header 1",h2:"Header 2",h3:"Header 3",h4:"Header 4",h5:"Header 5",h6:"Header 6",align_left:"Left Align",align_center:"Center Align",align_right:"Right Align",align_justify:"Justify",text_color:"Text Color",background_color:"Background Color",horizontal_rule:"Horizontal rule",format_clear:"Clear Formatting",insertLink:"Insert Link",removeLink:"Remove Link",insertImage:"Insert Image",url:"URL",text:"Text",openInNewTab:"Open in new tab",insert:"Insert",altText:"Alt Text",title:"Title",remove:"Remove"};class _f{constructor(t={}){this.locals=hc,this.get=e=>this.locals[e]??"",this.locals={...hc,...t}}}const gh={bold:'\n  <path d="M15.6 10.79c.97-.67 1.65-1.77 1.65-2.79 0-2.26-1.75-4-4-4H7v14h7.04c2.09 0 3.71-1.7 3.71-3.79 0-1.52-.86-2.82-2.15-3.42zM10 6.5h3c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-3v-3zm3.5 9H10v-3h3.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5z" />\n',italic:'\n  <path d="M10 4v3h2.21l-3.42 8H6v3h8v-3h-2.21l3.42-8H18V4z" />\n',code:'\n<path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"/>\n',underline:'\n<path d="M12 17c3.31 0 6-2.69 6-6V3h-2.5v8c0 1.93-1.57 3.5-3.5 3.5S8.5 12.93 8.5 11V3H6v8c0 3.31 2.69 6 6 6zm-7 2v2h14v-2H5z"/>\n',strike:'\n<path d="M6.85,7.08C6.85,4.37,9.45,3,12.24,3c1.64,0,3,0.49,3.9,1.28c0.77,0.65,1.46,1.73,1.46,3.24h-3.01 c0-0.31-0.05-0.59-0.15-0.85c-0.29-0.86-1.2-1.28-2.25-1.28c-1.86,0-2.34,1.02-2.34,1.7c0,0.48,0.25,0.88,0.74,1.21 C10.97,8.55,11.36,8.78,12,9H7.39C7.18,8.66,6.85,8.11,6.85,7.08z M21,12v-2H3v2h9.62c1.15,0.45,1.96,0.75,1.96,1.97 c0,1-0.81,1.67-2.28,1.67c-1.54,0-2.93-0.54-2.93-2.51H6.4c0,0.55,0.08,1.13,0.24,1.58c0.81,2.29,3.29,3.3,5.67,3.3 c2.27,0,5.3-0.89,5.3-4.05c0-0.3-0.01-1.16-0.48-1.94H21V12z"/>\n',ordered_list:'\n<path d="M2 17h2v.5H3v1h1v.5H2v1h3v-4H2v1zm1-9h1V4H2v1h1v3zm-1 3h1.8L2 13.1v.9h3v-1H3.2L5 10.9V10H2v1zm5-6v2h14V5H7zm0 14h14v-2H7v2zm0-6h14v-2H7v2z"/>\n',bullet_list:'\n<path d="M4 10.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm0-6c-.83 0-1.5.67-1.5 1.5S3.17 7.5 4 7.5 5.5 6.83 5.5 6 4.83 4.5 4 4.5zm0 12c-.83 0-1.5.68-1.5 1.5s.68 1.5 1.5 1.5 1.5-.68 1.5-1.5-.67-1.5-1.5-1.5zM7 19h14v-2H7v2zm0-6h14v-2H7v2zm0-8v2h14V5H7z"/>\n',blockquote:'\n<path d="M0 0h24v24H0z" fill="none"/><path d="M6 17h3l2-4V7H5v6h3zm8 0h3l2-4V7h-6v6h3z"/>\n',link:'\n<path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"/>\n',unlink:'\n<path d="M17 7h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1 0 1.43-.98 2.63-2.31 2.98l1.46 1.46C20.88 15.61 22 13.95 22 12c0-2.76-2.24-5-5-5zm-1 4h-2.19l2 2H16zM2 4.27l3.11 3.11C3.29 8.12 2 9.91 2 12c0 2.76 2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1 0-1.59 1.21-2.9 2.76-3.07L8.73 11H8v2h2.73L13 15.27V17h1.73l4.01 4L20 19.74 3.27 3 2 4.27z"/>\n',image:'\n<path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/>\n',align_left:'\n<path d="M15 15H3v2h12v-2zm0-8H3v2h12V7zM3 13h18v-2H3v2zm0 8h18v-2H3v2zM3 3v2h18V3H3z"/>\n',align_center:'\n<path d="M7 15v2h10v-2H7zm-4 6h18v-2H3v2zm0-8h18v-2H3v2zm4-6v2h10V7H7zM3 3v2h18V3H3z"/>\n',align_right:'\n<path d="M3 21h18v-2H3v2zm6-4h12v-2H9v2zm-6-4h18v-2H3v2zm6-4h12V7H9v2zM3 3v2h18V3H3z"/>\n',align_justify:'\n<path d="M3 21h18v-2H3v2zm0-4h18v-2H3v2zm0-4h18v-2H3v2zm0-4h18V7H3v2zm0-6v2h18V3H3z"/>\n',text_color:'\n<path d="M2,20h20v4H2V20z M5.49,17h2.42l1.27-3.58h5.65L16.09,17h2.42L13.25,3h-2.5L5.49,17z M9.91,11.39l2.03-5.79h0.12l2.03,5.79 H9.91z"/>\n',color_fill:'\n<path d="M16.56,8.94L7.62,0L6.21,1.41l2.38,2.38L3.44,8.94c-0.59,0.59-0.59,1.54,0,2.12l5.5,5.5C9.23,16.85,9.62,17,10,17 s0.77-0.15,1.06-0.44l5.5-5.5C17.15,10.48,17.15,9.53,16.56,8.94z M5.21,10L10,5.21L14.79,10H5.21z M19,11.5c0,0-2,2.17-2,3.5 c0,1.1,0.9,2,2,2s2-0.9,2-2C21,13.67,19,11.5,19,11.5z M2,20h20v4H2V20z"/>\n',horizontal_rule:'\n  <g>\n    <rect fill="none" fill-rule="evenodd" height="24" width="24"/>\n    <rect fill-rule="evenodd" height="2" width="16" x="4" y="11"/>\n  </g>\n',format_clear:'\n<path d="M0 0h24v24H0z" fill="none"/><path d="M3.27 5L2 6.27l6.97 6.97L6.5 19h3l1.57-3.66L16.73 21 18 19.73 3.55 5.27 3.27 5zM6 5v.18L8.82 8h2.4l-.72 1.68 2.1 2.1L14.21 8H20V5H6z"/>\n',path:"<path></path>"};class vh{static get(t,e="currentColor"){const n=gh[t];return n&&(n.includes("<path")||n.includes("<g"))?`\n        <svg\n          xmlns="http://www.w3.org/2000/svg"\n          viewBox="0 0 24 24"\n          fill=${e}\n          height=20\n          width=20\n        >\n          ${n}\n        </svg>\n      `:n}}class Vr{constructor(){this.locals={},this.icons={}}}Vr.\u0275fac=function(t){return new(t||Vr)},Vr.\u0275prov=h.Yz7({token:Vr,factory:Vr.\u0275fac,providedIn:"root"});class Xe{constructor(t){this.config=t}get locals(){return new _f(this.config.locals)}getIcon(t){return this.config.icons[t]?this.config.icons[t]:vh.get(t)}}Xe.\u0275fac=function(t){return new(t||Xe)(h.LFG(Vr,8))},Xe.\u0275prov=h.Yz7({token:Xe,factory:Xe.\u0275fac,providedIn:"root"});const yh=r=>({locals:r.locals??{},icons:r.icons??{}});class Mn{constructor(t){this.sanitizer=t}transform(t){return this.sanitizer.bypassSecurityTrustHtml(t)}}Mn.\u0275fac=function(t){return new(t||Mn)(h.Y36(wt.H7,16))},Mn.\u0275pipe=h.Yjl({name:"sanitizeHtml",type:Mn,pure:!0});class ws{constructor(t,e){this.ngxeService=t,this.menuService=e,this.isActive=!1,this.disabled=!1,this.update=n=>{const{state:i}=n,s=ao[this.name];this.isActive=s.isActive(i),this.disabled=!s.canExecute(i)}}get name(){return this.toolbarItem}toggle(t){if(t.preventDefault(),0!==t.button)return;const{state:e,dispatch:n}=this.editorView;ao[this.name].toggle()(e,n)}getTitle(t){return this.ngxeService.locals.get(t)}ngOnInit(){this.html=this.ngxeService.getIcon(this.name),this.editorView=this.menuService.editor.view,this.updateSubscription=this.menuService.editor.update.subscribe(t=>{this.update(t)})}ngOnDestroy(){this.updateSubscription.unsubscribe()}}ws.\u0275fac=function(t){return new(t||ws)(h.Y36(Xe),h.Y36(Qe))},ws.\u0275cmp=h.Xpm({type:ws,selectors:[["ngx-toggle-command"]],inputs:{toolbarItem:"toolbarItem"},decls:2,vars:8,consts:[[1,"NgxEditor__MenuItem--IconContainer",3,"innerHTML","title","mousedown"]],template:function(t,e){1&t&&(h.TgZ(0,"div",0),h.NdJ("mousedown",function(i){return e.toggle(i)}),h.ALo(1,"sanitizeHtml"),h.qZA()),2&t&&(h.ekj("NgxEditor__MenuItem--Active",e.isActive)("NgxEditor--Disabled",e.disabled),h.Q6J("innerHTML",h.lcZ(1,6,e.html),h.oJD)("title",e.getTitle(e.name)))},dependencies:[Mn]});class bs{constructor(t,e){this.ngxeService=t,this.menuService=e,this.disabled=!1,this.update=n=>{const{state:i}=n,s=ph[this.name];this.disabled=!s.canExecute(i)}}get name(){return this.toolbarItem}insert(t){if(t.preventDefault(),0!==t.button)return;const{state:e,dispatch:n}=this.editorView;ph[this.name].insert()(e,n)}getTitle(t){return this.ngxeService.locals.get(t)}ngOnInit(){this.html=vh.get(this.name),this.editorView=this.menuService.editor.view,this.updateSubscription=this.menuService.editor.update.subscribe(t=>{this.update(t)})}ngOnDestroy(){this.updateSubscription.unsubscribe()}}bs.\u0275fac=function(t){return new(t||bs)(h.Y36(Xe),h.Y36(Qe))},bs.\u0275cmp=h.Xpm({type:bs,selectors:[["ngx-insert-command"]],inputs:{toolbarItem:"toolbarItem"},decls:2,vars:6,consts:[[1,"NgxEditor__MenuItem--IconContainer",3,"innerHTML","title","mousedown"]],template:function(t,e){1&t&&(h.TgZ(0,"div",0),h.NdJ("mousedown",function(i){return e.insert(i)}),h.ALo(1,"sanitizeHtml"),h.qZA()),2&t&&(h.ekj("NgxEditor--Disabled",e.disabled),h.Q6J("innerHTML",h.lcZ(1,4,e.html),h.oJD)("title",e.getTitle(e.name)))},dependencies:[Mn]});class Cs{constructor(t,e,n){this.el=t,this.ngxeService=e,this.menuService=n,this.showPopup=!1,this.isActive=!1,this.canExecute=!0,this.setText=()=>{const{state:{selection:i,doc:s}}=this.editorView,{empty:c,from:p,to:b}=i,S=c?"":s.textBetween(p,b);S&&(this.text.patchValue(S),this.text.disable())},this.update=i=>{const{state:s}=i;this.isActive=_s.isActive(s,{strict:!1}),this.canExecute=_s.canExecute(s)}}get icon(){return this.ngxeService.getIcon(this.isActive?"unlink":"link")}get title(){return this.ngxeService.locals.get(this.isActive?"removeLink":"insertLink")}get href(){return this.form.get("href")}get text(){return this.form.get("text")}onDocumentClick(t){!this.el.nativeElement.contains(t.target)&&this.showPopup&&this.hideForm()}getLabel(t){return this.ngxeService.locals.get(t)}hideForm(){this.showPopup=!1,this.form.reset({href:"",text:"",openInNewTab:!0}),this.text.enable()}onMouseDown(t){if(0!==t.button)return;const{state:e,dispatch:n}=this.editorView;this.isActive?_s.remove(e,n):(this.showPopup=!this.showPopup,this.showPopup&&this.setText())}insertLink(t){t.preventDefault();const{text:e,href:n,openInNewTab:i}=this.form.getRawValue(),{dispatch:s,state:c}=this.editorView,{selection:p}=c,b={title:n,href:n,target:i?"_blank":"_self"};p.empty?(_s.insert(e,b)(c,s),this.editorView.focus()):_s.update(b)(c,s),this.hideForm()}ngOnInit(){this.editorView=this.menuService.editor.view,this.form=new k.cw({href:new k.NI("",[k.kI.required,k.kI.pattern(this.menuService.editor.linkValidationPattern)]),text:new k.NI("",[k.kI.required]),openInNewTab:new k.NI(!0)}),this.updateSubscription=this.menuService.editor.update.subscribe(t=>{this.update(t)})}ngOnDestroy(){this.updateSubscription.unsubscribe()}}Cs.\u0275fac=function(t){return new(t||Cs)(h.Y36(h.SBq),h.Y36(Xe),h.Y36(Qe))},Cs.\u0275cmp=h.Xpm({type:Cs,selectors:[["ngx-link"]],hostBindings:function(t,e){1&t&&h.NdJ("mousedown",function(i){return e.onDocumentClick(i)},!1,h.evT)},decls:3,vars:9,consts:[[1,"NgxEditor__MenuItem--IconContainer",3,"innerHTML","title","mousedown"],["class","NgxEditor__Popup",4,"ngIf"],[1,"NgxEditor__Popup"],[1,"NgxEditor__Popup--Form",3,"formGroup","ngSubmit"],[1,"NgxEditor__Popup--FormGroup"],[1,"NgxEditor__Popup--Col"],[1,"NgxEditor__Popup--Label"],["type","href","id","href","formControlName","href","autofocus","","autocomplete","off"],["class","NgxEditor__HelpText NgxEditor__HelpText--Error",4,"ngIf"],["type","text","formControlName","text","autocomplete","off"],["type","checkbox","formControlName","openInNewTab"],["type","submit",3,"disabled"],[1,"NgxEditor__HelpText","NgxEditor__HelpText--Error"]],template:function(t,e){1&t&&(h.TgZ(0,"div",0),h.NdJ("mousedown",function(i){return e.onMouseDown(i)}),h.ALo(1,"sanitizeHtml"),h.qZA(),h.YNc(2,td,21,8,"div",1)),2&t&&(h.ekj("NgxEditor__MenuItem--Active",e.isActive||e.showPopup)("NgxEditor--Disabled",!e.canExecute),h.Q6J("innerHTML",h.lcZ(1,7,e.icon),h.oJD)("title",e.title),h.xp6(2),h.Q6J("ngIf",e.showPopup))},dependencies:[ne.O5,k._Y,k.Fj,k.Wl,k.JJ,k.JL,k.sg,k.u,Mn]});class ks{constructor(t,e,n){this.ngxeService=t,this.menuService=e,this.el=n,this.isDropdownOpen=!1,this.disabledItems=[],this.update=i=>{const{state:s}=i;this.disabledItems=[];const c=[];this.items.forEach(p=>{const b=ao[p];b.isActive(s)&&c.push(p),b.canExecute(s)||this.disabledItems.push(p)}),1===c.length?[this.activeItem]=c:this.activeItem=null}}get isSelected(){return Boolean(this.activeItem||this.isDropdownOpen)}get isDropdownDisabled(){return this.disabledItems.length===this.items.length}onDocumentClick(t){!this.el.nativeElement.contains(t)&&this.isDropdownOpen&&(this.isDropdownOpen=!1)}getName(t){return this.ngxeService.locals.get(t)}toggleDropdown(t){t.preventDefault(),this.isDropdownOpen=!this.isDropdownOpen}trackByIndex(t){return t}onClick(t,e){if(t.preventDefault(),0!==t.button)return;const n=ao[e],{state:i,dispatch:s}=this.editorView;n.toggle()(i,s),this.isDropdownOpen=!1}ngOnInit(){this.editorView=this.menuService.editor.view,this.updateSubscription=this.menuService.editor.update.subscribe(t=>{this.update(t)})}ngOnDestroy(){this.updateSubscription.unsubscribe()}}ks.\u0275fac=function(t){return new(t||ks)(h.Y36(Xe),h.Y36(Qe),h.Y36(h.SBq))},ks.\u0275cmp=h.Xpm({type:ks,selectors:[["ngx-dropdown"]],hostBindings:function(t,e){1&t&&h.NdJ("mousedown",function(i){return e.onDocumentClick(i.target)},!1,h.evT)},inputs:{group:"group",items:"items"},decls:3,vars:6,consts:[[1,"NgxEditor__Dropdown--Text",3,"mousedown"],["class","NgxEditor__Dropdown--DropdownMenu",4,"ngIf"],[1,"NgxEditor__Dropdown--DropdownMenu"],["class","NgxEditor__Dropdown--Item",3,"ngClass","mousedown",4,"ngFor","ngForOf","ngForTrackBy"],[1,"NgxEditor__Dropdown--Item",3,"ngClass","mousedown"]],template:function(t,e){1&t&&(h.TgZ(0,"div",0),h.NdJ("mousedown",function(i){return e.toggleDropdown(i)}),h._uU(1),h.qZA(),h.YNc(2,rd,2,2,"div",1)),2&t&&(h.ekj("NgxEditor__Dropdown--Selected",e.isSelected)("NgxEditor--Disabled",e.isDropdownDisabled),h.xp6(1),h.hij(" ",e.getName(e.activeItem||e.group),"\n"),h.xp6(1),h.Q6J("ngIf",e.isDropdownOpen))},dependencies:[ne.mk,ne.sg,ne.O5]});class Es{constructor(t,e,n){this.el=t,this.ngxeService=e,this.menuService=n,this.showPopup=!1,this.isActive=!1,this.form=new k.cw({src:new k.NI("",[k.kI.required,k.kI.pattern("(https?://)?([\\da-z.-]+)\\.([a-z.]{2,6})[/\\w .-]*/??([^#\n\r]*)?#?([^\n\r]*)")]),alt:new k.NI(""),title:new k.NI("")}),this.update=i=>{const{state:s}=i;this.isActive=mh.isActive(s)}}get icon(){return this.ngxeService.getIcon("image")}get src(){return this.form.get("src")}onDocumentClick(t){!this.el.nativeElement.contains(t.target)&&this.showPopup&&this.hideForm()}getLabel(t){return this.ngxeService.locals.get(t)}hideForm(){this.showPopup=!1,this.form.reset({src:"",alt:"",title:""})}onMouseDown(t){0===t.button&&(this.showPopup=!this.showPopup,this.showPopup&&this.fillForm())}fillForm(){const{state:t}=this.editorView,{selection:e}=t;if(e instanceof Vt&&this.isActive){const{src:n,alt:i="",title:s=""}=e.node.attrs;this.form.setValue({src:n,alt:i,title:s})}}insertLink(t){t.preventDefault();const{src:e,alt:n,title:i}=this.form.getRawValue(),{dispatch:s,state:c}=this.editorView,p={alt:n,title:i};mh.insert(e,p)(c,s),this.editorView.focus(),this.hideForm()}ngOnInit(){this.editorView=this.menuService.editor.view,this.updateSubscription=this.menuService.editor.update.subscribe(t=>{this.update(t)})}ngOnDestroy(){this.updateSubscription.unsubscribe()}}Es.\u0275fac=function(t){return new(t||Es)(h.Y36(h.SBq),h.Y36(Xe),h.Y36(Qe))},Es.\u0275cmp=h.Xpm({type:Es,selectors:[["ngx-image"]],hostBindings:function(t,e){1&t&&h.NdJ("mousedown",function(i){return e.onDocumentClick(i)},!1,h.evT)},decls:3,vars:7,consts:[[1,"NgxEditor__MenuItem--IconContainer",3,"innerHTML","title","mousedown"],["class","NgxEditor__Popup",4,"ngIf"],[1,"NgxEditor__Popup"],[1,"NgxEditor__Popup--Form",3,"formGroup","ngSubmit"],[1,"NgxEditor__Popup--FormGroup"],[1,"NgxEditor__Popup--Col"],[1,"NgxEditor__Popup--Label"],["type","href","id","href","formControlName","src","autofocus","","autocomplete","off"],["class","NgxEditor__HelpText NgxEditor__HelpText--Error",4,"ngIf"],["type","text","formControlName","alt","autocomplete","off"],["type","text","formControlName","title","autocomplete","off"],["type","submit",3,"disabled"],[1,"NgxEditor__HelpText","NgxEditor__HelpText--Error"]],template:function(t,e){1&t&&(h.TgZ(0,"div",0),h.NdJ("mousedown",function(i){return e.onMouseDown(i)}),h.ALo(1,"sanitizeHtml"),h.qZA(),h.YNc(2,od,20,7,"div",1)),2&t&&(h.ekj("NgxEditor__MenuItem--Active",e.isActive||e.showPopup),h.Q6J("innerHTML",h.lcZ(1,5,e.icon),h.oJD)("title",e.getLabel("insertImage")),h.xp6(2),h.Q6J("ngIf",e.showPopup))},dependencies:[ne.O5,k._Y,k.Fj,k.JJ,k.JL,k.sg,k.u,Mn]});class Ms{constructor(t,e,n){this.el=t,this.menuService=e,this.ngxeService=n,this.showPopup=!1,this.isActive=!1,this.activeColors=[],this.canExecute=!0,this.update=i=>{const{state:s}=i;this.canExecute=this.command.canExecute(s),this.isActive=this.command.isActive(s),this.activeColors=[],this.isActive&&(this.activeColors=this.command.getActiveColors(s))}}get title(){return this.getLabel("text_color"===this.type?"text_color":"background_color")}get icon(){return this.ngxeService.getIcon("text_color"===this.type?"text_color":"color_fill")}get command(){return"text_color"===this.type?yf:xf}getContrastYIQ(t){const e=t.replace("#","");return(299*parseInt(e.substring(0,2),16)+587*parseInt(e.substring(2,4),16)+114*parseInt(e.substring(4,6),16))/1e3>=128?"black":"white"}onDocumentClick(t){!this.el.nativeElement.contains(t.target)&&this.showPopup&&this.hidePopup()}hidePopup(){this.showPopup=!1}togglePopup(t){t.preventDefault(),0===t.button&&(this.showPopup=!this.showPopup)}remove(t){t.preventDefault();const{state:e,dispatch:n}=this.editorView;this.command.remove()(e,n),this.hidePopup()}trackByIndex(t){return t}onColorSelect(t,e){if(t.preventDefault(),0!==t.button)return;const{state:n,dispatch:i}=this.editorView;if("text_color"===this.type){const s={color:e};this.command.apply(s)(n,i)}else{const s={backgroundColor:e};this.command.apply(s)(n,i)}this.editorView.hasFocus()||this.editorView.focus(),this.hidePopup()}getLabel(t){return this.ngxeService.locals.get(t)}ngOnInit(){this.editorView=this.menuService.editor.view,this.updateSubscription=this.menuService.editor.update.subscribe(t=>{this.update(t)})}ngOnDestroy(){this.updateSubscription.unsubscribe()}}Ms.\u0275fac=function(t){return new(t||Ms)(h.Y36(h.SBq),h.Y36(Qe),h.Y36(Xe))},Ms.\u0275cmp=h.Xpm({type:Ms,selectors:[["ngx-color-picker"]],hostBindings:function(t,e){1&t&&h.NdJ("mousedown",function(i){return e.onDocumentClick(i)},!1,h.evT)},inputs:{presets:"presets",type:"type"},decls:3,vars:9,consts:[[1,"NgxEditor__MenuItem--IconContainer",3,"innerHTML","title","mousedown"],["class","NgxEditor__Popup",4,"ngIf"],[1,"NgxEditor__Popup"],["class","NgxEditor__ColorContainer",4,"ngFor","ngForOf","ngForTrackBy"],[1,"NgxEditor__MenuItem--Button",3,"disabled","mousedown"],[1,"NgxEditor__ColorContainer"],["class","NgxEditor__Color",3,"ngStyle","title","ngClass","mousedown",4,"ngFor","ngForOf","ngForTrackBy"],[1,"NgxEditor__Color",3,"ngStyle","title","ngClass","mousedown"]],template:function(t,e){1&t&&(h.TgZ(0,"div",0),h.NdJ("mousedown",function(i){return e.togglePopup(i)}),h.ALo(1,"sanitizeHtml"),h.qZA(),h.YNc(2,cd,4,4,"div",1)),2&t&&(h.ekj("NgxEditor__MenuItem--Active",e.isActive||e.showPopup)("NgxEditor--Disabled",!e.canExecute),h.Q6J("innerHTML",h.lcZ(1,7,e.icon),h.oJD)("title",e.title),h.xp6(2),h.Q6J("ngIf",e.showPopup))},dependencies:[ne.mk,ne.sg,ne.O5,ne.PC,Mn],styles:['@charset "UTF-8";.NgxEditor__Popup[_ngcontent-%COMP%]{width:230px}.NgxEditor__ColorContainer[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.NgxEditor__ColorContainer[_ngcontent-%COMP%] + .NgxEditor__ColorContainer[_ngcontent-%COMP%]{margin-top:5px}.NgxEditor__Color[_ngcontent-%COMP%]{border:none;outline:none;border-radius:6px;width:24px;height:24px;flex-shrink:0}.NgxEditor__Color--Active[_ngcontent-%COMP%]:after{content:"\\2714";font-size:90%}.NgxEditor__MenuItem--Button[_ngcontent-%COMP%]{margin-top:5px}']});const Gf=[["bold","italic"],[{heading:["h1","h2","h3","h4","h5","h6"]}],["link","image"],["text_color","background_color"]],Uf=["#b60205","#d93f0b","#fbca04","#0e8a16","#006b75","#1d76db","#0052cc","#5319e7","#e99695","#f9d0c4","#fef2c0","#c2e0c6","#bfdadc","#c5def5","#bfd4f2","#d4c5f9"];class Ts{constructor(t){this.menuService=t,this.toolbar=Gf,this.colorPresets=Uf,this.disabled=!1,this.customMenuRef=null,this.dropdownPlacement="bottom",this.toggleCommands=["bold","italic","underline","strike","code","blockquote","ordered_list","bullet_list","align_left","align_center","align_right","align_justify"],this.insertCommands=["horizontal_rule","format_clear"],this.iconContainerClass=["NgxEditor__MenuItem","NgxEditor__MenuItem--Icon"],this.dropdownContainerClass=["NgxEditor__Dropdown"],this.seperatorClass=["NgxEditor__Seperator"]}get presets(){const e=[];return this.colorPresets.forEach((n,i)=>{const s=Math.floor(i/8);e[s]||e.push([]),e[s].push(n)}),e}trackByIndex(t){return t}isDropDown(t){return!!t?.heading}getDropdownItems(t){return t}ngOnInit(){if(!this.editor)throw new K("Required editor instance to initialize menu component");this.menuService.editor=this.editor}}Ts.\u0275fac=function(t){return new(t||Ts)(h.Y36(Qe))},Ts.\u0275cmp=h.Xpm({type:Ts,selectors:[["ngx-editor-menu"]],inputs:{toolbar:"toolbar",colorPresets:"colorPresets",disabled:"disabled",editor:"editor",customMenuRef:"customMenuRef",dropdownPlacement:"dropdownPlacement"},features:[h._Bn([Qe])],decls:3,vars:7,consts:[[1,"NgxEditor__MenuBar",3,"ngClass"],[4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],[3,"toolbarItem","class",4,"ngIf"],[3,"class",4,"ngIf"],["type","text_color",3,"class","presets",4,"ngIf"],["type","background_color",3,"class","presets",4,"ngIf"],[3,"toolbarItem"],[3,"class","group","items",4,"ngFor","ngForOf","ngForTrackBy"],[3,"group","items"],["type","text_color",3,"presets"],["type","background_color",3,"presets"],[3,"ngTemplateOutlet"]],template:function(t,e){1&t&&(h.TgZ(0,"div",0),h.YNc(1,wd,2,2,"ng-container",1),h.YNc(2,bd,2,1,"ng-container",2),h.qZA()),2&t&&(h.Q6J("ngClass",h.WLB(4,Cd,e.disabled,"top"===e.dropdownPlacement)),h.xp6(1),h.Q6J("ngForOf",e.toolbar)("ngForTrackBy",e.trackByIndex),h.xp6(1),h.Q6J("ngIf",e.customMenuRef))},dependencies:[ne.mk,ne.sg,ne.O5,ne.tP,ws,bs,Cs,ks,Es,Ms,ne.Nd]});class Ns{constructor(t,e){this.sanitizeHTML=t,this.ngxeService=e,this.execulableItems=[],this.activeItems=[],this.toolbar=[["bold","italic","underline","strike"],["ordered_list","bullet_list","blockquote","code"],["align_left","align_center","align_right","align_justify"]],this.toggleCommands=["bold","italic","underline","strike","ordered_list","bullet_list","blockquote","code","align_left","align_center","align_right","align_justify"]}get view(){return this.editor.view}getIcon(t){return this.sanitizeHTML.transform(this.ngxeService.getIcon(t))}getTitle(t){return this.ngxeService.locals.get(t)}trackByIndex(t){return t}onClick(t,e){if(t.preventDefault(),t.stopPropagation(),0!==t.button)return;const{state:n,dispatch:i}=this.view;ao[e].toggle()(n,i)}update(t){this.activeItems=[],this.execulableItems=[];const{state:e}=t;this.toggleCommands.forEach(n=>{const i=ao[n];i.isActive(e)&&this.activeItems.push(n),i.canExecute(e)&&this.execulableItems.push(n)})}ngOnInit(){this.updateSubscription=this.editor.update.subscribe(t=>{this.update(t)})}ngOnDestroy(){this.updateSubscription.unsubscribe()}}Ns.\u0275fac=function(t){return new(t||Ns)(h.Y36(Mn),h.Y36(Xe))},Ns.\u0275cmp=h.Xpm({type:Ns,selectors:[["ngx-bubble"]],inputs:{editor:"editor"},decls:1,vars:2,consts:[[4,"ngFor","ngForOf","ngForTrackBy"],["class","NgxBubbleMenu__Icon",3,"ngClass","title","innerHTML","mousedown",4,"ngIf"],["class","NgxBubbleMenu__Seperator",4,"ngIf"],[1,"NgxBubbleMenu__Icon",3,"ngClass","title","innerHTML","mousedown"],[1,"NgxBubbleMenu__Seperator"]],template:function(t,e){1&t&&h.YNc(0,Nd,2,2,"ng-container",0),2&t&&h.Q6J("ngForOf",e.toolbar)("ngForTrackBy",e.trackByIndex)},dependencies:[ne.mk,ne.sg,ne.O5],styles:["*[_ngcontent-%COMP%], *[_ngcontent-%COMP%]:before, *[_ngcontent-%COMP%]:after{box-sizing:border-box}[_nghost-%COMP%]{display:flex;flex-wrap:wrap;background-color:#000;color:#fff;padding:5px;border-radius:4px}.NgxBubbleMenu__Icon[_ngcontent-%COMP%]{height:30px;width:30px;transition:.3s ease-in-out;border-radius:2px;display:flex;align-items:center;justify-content:center;color:#fff}.NgxBubbleMenu__Icon[_ngcontent-%COMP%]:hover{background-color:#636262}.NgxBubbleMenu__Icon[_ngcontent-%COMP%] + .NgxBubbleMenu__Icon[_ngcontent-%COMP%]{margin-left:5px}.NgxBubbleMenu__Icon.NgxBubbleMenu__Icon--Active[_ngcontent-%COMP%]{background-color:#fff;color:#000}.NgxBubbleMenu__Seperator[_ngcontent-%COMP%]{border-left:1px solid white;margin:0 5px}"]});class Cl{constructor(t){this.el=t,this.autoPlace=!1,this.posLeft=0,this.posTop=0,this.showMenu=!1,this.dragging=!1}get display(){return{visibility:this.showMenu?"visible":"hidden",opacity:this.showMenu?"1":"0",top:`${this.posTop}px`,left:`${this.posLeft}px`}}get view(){return this.editor.view}onMouseDown(t){const e=t.target;this.el.nativeElement.contains(e)&&"INPUT"!==e.nodeName?t.preventDefault():this.dragging=!0}onKeyDown(t){"INPUT"!==t.target.nodeName&&(this.dragging=!0,this.hide())}onMouseUp(t){const e=t.target;this.el.nativeElement.contains(e)||"INPUT"===e.nodeName?t.preventDefault():(this.dragging=!1,this.useUpdate())}onKeyUp(t){"INPUT"!==t.target.nodeName&&(this.dragging=!1,this.useUpdate())}useUpdate(){this.view&&this.update(this.view)}hide(){this.showMenu=!1}show(){this.showMenu=!0}calculateBubblePosition(t){var e=this;return E(function*(){const{state:{selection:n}}=t,{from:i,to:s}=n,c=t.coordsAtPos(i),p=t.coordsAtPos(s),b={getBoundingClientRect(){if(n instanceof Vt)return t.nodeDOM(i).getBoundingClientRect();const{top:U,left:J}=c,{bottom:nt,right:ct}=p;return{x:J,y:U,top:U,bottom:nt,left:J,right:ct,width:ct-J,height:nt-U}}},S=e.el.nativeElement,{x:O,y:B}=yield((r,t,e)=>{const n=new Map,i={platform:Ah,...e},s={...i.platform,_c:n};return re(r,t,{...i,platform:s})})(b,S,{placement:"top",middleware:[(r=5,void 0===r&&(r=0),{name:"offset",options:r,fn:t=>E(function*(){const{x:e,y:n}=t,i=yield(s=E(function*(c,p){const{placement:b,platform:S,elements:O}=c,B=yield null==S.isRTL?void 0:S.isRTL(O.floating),U=Dt(b),J=Mt(b),nt="x"===Ot(b),ct=["left","top"].includes(U)?-1:1,Ct=B&&nt?-1:1,St="function"==typeof p?p(c):p;let{mainAxis:Lt,crossAxis:Bt,alignmentAxis:Zt}="number"==typeof St?{mainAxis:St,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...St};return J&&"number"==typeof Zt&&(Bt="end"===J?-1*Zt:Zt),nt?{x:Bt*Ct,y:Lt*ct}:{x:Lt*ct,y:Bt*Ct}}),function(c,p){return s.apply(this,arguments)})(t,r);var s;return{x:e+i.x,y:n+i.y,data:i}})()}),e.autoPlace&&Nh({boundary:t.dom,padding:5,allowedPlacements:["top","bottom"]}),{name:"overflowMiddleware",fn:U=>E(function*(){const J=yield ye(U,{boundary:t.dom,padding:5});return J.left>0?{x:U.x+J.left}:J.right>0?{x:U.x-J.right}:{}})()}].filter(Boolean)});var r;return{left:O,top:B}})()}canShowMenu(t){const{state:e}=t,{selection:n}=e,{empty:i}=n;return!(n instanceof Vt&&"image"===n.node.type.name)&&(!(!this.view.hasFocus()||i||this.dragging)||(this.hide(),!1))}update(t){this.canShowMenu(t)?this.calculateBubblePosition(this.view).then(({top:n,left:i})=>{this.canShowMenu?(this.posLeft=i,this.posTop=n,this.show()):this.hide()}):this.hide()}ngOnInit(){if(!this.editor)throw new K("Required editor instance to initialize floating menu component");this.updateSubscription=this.editor.update.subscribe(t=>{this.update(t)}),this.resizeSubscription=(0,_.R)(window,"resize").pipe(L(500,d.z,{leading:!0,trailing:!0})).subscribe(()=>{this.useUpdate()})}ngOnDestroy(){this.updateSubscription.unsubscribe(),this.resizeSubscription.unsubscribe()}}Cl.\u0275fac=function(t){return new(t||Cl)(h.Y36(h.SBq))},Cl.\u0275cmp=h.Xpm({type:Cl,selectors:[["ngx-editor-floating-menu"]],hostVars:2,hostBindings:function(t,e){1&t&&h.NdJ("mousedown",function(i){return e.onMouseDown(i)},!1,h.evT)("keydown",function(i){return e.onKeyDown(i)},!1,h.evT)("mouseup",function(i){return e.onMouseUp(i)},!1,h.evT)("keyup",function(i){return e.onKeyUp(i)},!1,h.evT),2&t&&h.Akn(e.display)},inputs:{editor:"editor",autoPlace:"autoPlace"},ngContentSelectors:ch,decls:4,vars:1,consts:[["ref",""],[4,"ngIf"],[3,"editor"]],template:function(t,e){if(1&t&&(h.F$t(),h.TgZ(0,"div",null,0),h.Hsn(2),h.qZA(),h.YNc(3,Sd,2,1,"ng-container",1)),2&t){const n=h.MAs(1);h.xp6(3),h.Q6J("ngIf",0===n.children.length)}},dependencies:[ne.O5,Ns],styles:["*[_ngcontent-%COMP%], *[_ngcontent-%COMP%]:before, *[_ngcontent-%COMP%]:after{box-sizing:border-box}[_nghost-%COMP%]{position:absolute;z-index:20;margin-bottom:5px;visibility:hidden;opacity:0}"]});class lo{}lo.\u0275fac=function(t){return new(t||lo)},lo.\u0275mod=h.oAB({type:lo}),lo.\u0275inj=h.cJS({providers:[Mn],imports:[ne.ez,k.UX]});const kl=new h.OlP("NgxEditorConfig"),xh={locals:hc,icons:gh};class lr{static forRoot(t=xh){return{ngModule:lr,providers:[{provide:kl,useValue:t},{provide:Vr,useFactory:yh,deps:[kl]}]}}static forChild(t=xh){return{ngModule:lr,providers:[{provide:kl,useValue:t},{provide:Vr,useFactory:yh,deps:[kl]},Xe]}}}lr.\u0275fac=function(t){return new(t||lr)},lr.\u0275mod=h.oAB({type:lr}),lr.\u0275inj=h.cJS({imports:[ne.ez,lo]});const hn=(r,t=!1)=>(e,n)=>{const i=new oo(r);return t?i.toggle()(e,n):i.apply()(e,n)};class Yf{constructor(t){if(this.applyTrx=e=>{this.state=this.state.apply(e??this.tr),this.tr=this.state.tr,this.tr.setMeta("APPLIED_TRX",!0)},this.dispatch=e=>{this.applyTrx(e)},!t)throw new K("Required view to initialize commands.");this.view=t,this.state=t.state,this.tr=this.view.state.tr}exec(){if(!this.tr.getMeta("APPLIED_TRX"))return!1;const t=!this.view.state.doc.eq(this.state.doc);this.view.updateState(this.state);const e=this.tr.setMeta("FORCE_EMIT",t);return this.view.dispatch(e),!0}focus(t="end"){const e="start"===t?Gt.atStart(this.state.doc):Gt.atEnd(this.state.doc);return this.tr.setSelection(e),this.applyTrx(),this.view.focus(),this}scrollIntoView(){return this.tr.scrollIntoView(),this.applyTrx(),this}insertText(t){return this.tr.insertText(t),this.applyTrx(),this}insertNewLine(){return gi(zn,sr,ar,hs)(this.state,this.dispatch),this}applyMark(t){return hn(t,!1)(this.state,this.dispatch),this}toggleMark(t){return hn(t,!0)(this.state,this.dispatch),this}bold(){return hn("strong")(this.state,this.dispatch),this}toggleBold(){return hn("strong",!0)(this.state,this.dispatch),this}italics(){return hn("em")(this.state,this.dispatch),this}toggleItalics(){return hn("em",!0)(this.state,this.dispatch),this}underline(){return hn("u")(this.state,this.dispatch),this}toggleUnderline(){return hn("u",!0)(this.state,this.dispatch),this}strike(){return hn("s")(this.state,this.dispatch),this}toggleStrike(){return hn("s",!0)(this.state,this.dispatch),this}code(){return hn("code")(this.state,this.dispatch),this}toggleCode(){return hn("code",!0)(this.state,this.dispatch),this}toggleOrderedList(){return new bl(!1).toggle()(this.state,this.dispatch),this}toggleBulletList(){return new bl(!0).toggle()(this.state,this.dispatch),this}toggleHeading(t){return new wi(t).toggle()(this.state,this.dispatch),this}insertLink(t,e){return(new cc).insert(t,e)(this.state,this.dispatch),this}updateLink(t){return(new cc).update(t)(this.state,this.dispatch),this}insertImage(t,e={}){return(new fh).insert(t,e)(this.state,this.dispatch),this}textColor(t){return new so("text_color").apply({color:t})(this.state,this.dispatch),this}backgroundColor(t){return new so("text_background_color").apply({backgroundColor:t})(this.state,this.dispatch),this}removeTextColor(){return new so("text_color").remove()(this.state,this.dispatch),this}removeBackgroundColor(){return new so("text_background_color").remove()(this.state,this.dispatch),this}align(t){return new xs(t).toggle()(this.state,this.dispatch),this}insertHTML(t){const{selection:e,schema:n,tr:i}=this.state,{from:s,to:c}=e,p=document.createElement("div");p.innerHTML=t.trim();const b=$n.fromSchema(n).parseSlice(p),S=i.replaceRange(s,c,b);return this.applyTrx(S),this}}const Wf=typeof navigator<"u"&&/Mac/.test(navigator.platform),np=r=>{const t=l.concat(xi,tc);return t.push((r=>rt(/(?:^|\s)(?:(?:\*\*|__)(?:(?:[^*_]+))(?:\*\*|__))$/,r))(r.marks.strong)),t.push((r=>rt(/(?:^|\s)(?:(?:\*|_)(?:(?:[^*_]+))(?:\*|_))$/,r))(r.marks.em)),t.push((r=>u(/^\s*>\s$/,r))(r.nodes.blockquote)),t.push((r=>u(/^(?:\d+)\.\s$/,r,t=>({order:Number(t[1])}),(t,e)=>e.childCount+e.attrs.order===Number(t[1])))(r.nodes.ordered_list)),t.push((r=>u(/^\s*(?:[-+*])\s$/,r))(r.nodes.bullet_list)),t.push((r=>v(/^```$/,r))(r.nodes.code_block)),t.push(((r,t)=>v(new RegExp(`^(#{1,${t}})\\s$`),r,e=>({level:e[1].length})))(r.nodes.heading,6)),function qu({rules:r}){let t=new oe({state:{init:()=>null,apply(e,n){return e.getMeta(this)||(e.selectionSet||e.docChanged?null:n)}},props:{handleTextInput:(e,n,i,s)=>hl(e,n,i,s,r,t),handleDOMEvents:{compositionend:e=>{setTimeout(()=>{let{$cursor:n}=e.state.selection;n&&hl(e,n.pos,n.pos,"",r,t)})}}},isInputRules:!0});return t}({rules:t})},ip=(r,t)=>{const e=[];return t.keyboardShortcuts&&e.push(...((r,t)=>{const e={};e["Mod-z"]=uh,Wf?e["Shift-Mod-z"]=uc:e["Mod-y"]=uc;const n=[xl({"Mod-b":Pr(r.marks.strong),"Mod-i":Pr(r.marks.em),"Mod-u":Pr(r.marks.u),"Mod-`":Pr(r.marks.code)}),xl({Enter:Au(r.nodes.list_item),"Shift-Enter":gi(Hn,(i,s)=>{const{tr:c}=i,p=r.nodes.hard_break;return s(c.replaceSelectionWith(p.create()).scrollIntoView()),!0}),"Mod-[":tl(r.nodes.list_item),"Mod-]":Sr(r.nodes.list_item),Tab:Sr(r.nodes.list_item)}),xl(vi)];return t.history&&n.push(xl(e)),n})(r,{history:t.history})),t.history&&e.push(Yh()),t.inputRules&&e.push(np(r)),e},wh={linkOnPaste:!0,resizeImage:!0},bh={content:null,history:!0,keyboardShortcuts:!0,inputRules:!0,schema:fi,plugins:[],nodeViews:{},attributes:{},features:wh,handleScrollToSelection:null,linkValidationPattern:"(https?://)?([\\da-z.-]+)\\.([a-z.]{2,6})[/\\w .-]*/??([^#\n\r]*)?#?([^\n\r]*)|(mailto:.*[@].*)"};class op{constructor(t=bh){this.valueChangesSubject=new x.x,this.updateSubject=new x.x,this.options={...bh,...t},this.createEditor()}get valueChanges(){return this.valueChangesSubject.asObservable()}get update(){return this.updateSubject.asObservable()}get schema(){return this.options.schema||fi}get linkValidationPattern(){return this.options.linkValidationPattern}get commands(){return new Yf(this.view)}get features(){return{...wh,...this.options.features}}handleTransactions(t){const e=this.view.state.apply(t);if(this.view.updateState(e),this.updateSubject.next(this.view),!t.docChanged&&!t.getMeta("FORCE_EMIT"))return;const n=e.doc.toJSON();this.valueChangesSubject.next(n)}createEditor(){const{options:t,schema:e}=this,{content:n=null,nodeViews:i}=t,{history:s=!0,keyboardShortcuts:c=!0,inputRules:p=!0}=t,b=ys(n,e),S=t.plugins??[],O=t.attributes??{},B=ip(e,{history:s,keyboardShortcuts:c,inputRules:p});this.view=new ku(null,{state:An.create({doc:b,schema:e,plugins:[...B,...S]}),nodeViews:i,dispatchTransaction:this.handleTransactions.bind(this),attributes:O,handleScrollToSelection:t.handleScrollToSelection})}setContent(t){if(typeof(r=t)>"u"||null===r)return;var r;const{state:e}=this.view,{tr:n,doc:i}=e,s=ys(t,this.schema);n.replaceWith(0,e.doc.content.size,s),!i.eq(n.doc)&&n.docChanged&&this.view.dispatch(n)}registerPlugin(t){const{state:e}=this.view,n=[...e.plugins,t],i=e.reconfigure({plugins:n});this.view.updateState(i)}destroy(){this.view.destroy()}}}}]);